<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>12  Supervised Learning – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="12  Supervised Learning – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="12  Supervised Learning – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">12.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#what-are-the-data" href="#what-are-the-data" id="toc-what-are-the-data"><span class="header-section-number">12.2</span>데이터는 무엇입니까?</a></li>
<li><a class="nav-link" data-scroll-target="#linear-discrimination" href="#linear-discrimination" id="toc-linear-discrimination"><span class="header-section-number">12.3</span>선형 차별</a></li>
<li><a class="nav-link" data-scroll-target="#machine-learning-vs-rote-learning" href="#machine-learning-vs-rote-learning" id="toc-machine-learning-vs-rote-learning"><span class="header-section-number">12.4</span>머신 러닝 대 Rote 학습</a></li>
<li><a class="nav-link" data-scroll-target="#sec-supervised-objective" href="#sec-supervised-objective" id="toc-sec-supervised-objective"><span class="header-section-number">12.5</span>객관적인 기능</a></li>
<li><a class="nav-link" data-scroll-target="#variancebias-trade-off" href="#variancebias-trade-off" id="toc-variancebias-trade-off"><span class="header-section-number">12.6</span>분산-바이어스 트레이드 오프</a></li>
<li><a class="nav-link" data-scroll-target="#sec\:ML\:caret" href="#sec:ML:caret" id="toc-sec:ML:caret"><span class="header-section-number">12.7</span>다양한 방법</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">12.8</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">12.9</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">12.10</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-supervised"><span class="chapter-number">12</span>  <span class="chapter-title">감독 학습</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="no-row-height column-margin column-container"><div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/BuildWall.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BuildWall.png"/></a></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="imgs/EWall.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/EWall.png"/></a></p>
</figure>
</div>
</div>
</div>
</div></div><div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">감독 된 학습 환경에서, 우리는 우리가 얼마나 잘하고 있는지 판단 할 척도 또는 plumbline이 있습니다 : 응답 자체.</span></div></div>
<p>생물학적 및 생물 의학 응용에서 빈번한 질문은 관심있는 특성 (예 : 질병 유형, 세포 유형, 환자의 예후)이 하나 이상의 다른 특성을 고려할 때 "예측"될 수 있는지 여부입니다.<strong>예측 자</strong>. 종종 우리는 예측 될 속성이 알려지지 않은 상황 (미래에 있거나 측정하기가 어렵음)에 동기를 부여받는 반면, 예측자는 알려져 있습니다. 중요한 요점은 우리입니다<em>배우다</em>세트의 예측 규칙<em>교육 데이터</em>이해의 재산도 알려져 있습니다. 일단 규칙이 있으면 새로운 데이터에 적용하고 알 수없는 결과에 대한 실제 예측을 할 수 있습니다. 또는 우리는 근본적인 생물학을 더 잘 이해하기 위해 규칙을 해부 할 수 있습니다.</p>
<p>감독되지 않은 학습 및 장에서 본 것과 비교<a class="quarto-xref" href="05-chap.html"><span>5</span></a>,,,<a class="quarto-xref" href="07-chap.html"><span>7</span></a>그리고<a class="quarto-xref" href="09-chap.html"><span>9</span></a>, 우리가 무엇을 찾고 있는지 또는 우리의 결과가 "올바른"지 여부를 결정하는 방법을 모르는 경우, 우리는 감독 된 학습으로 훨씬 더 확실한 근거가 있습니다. 목표는 명확하게 명시되어 있으며, 우리가 얼마나 잘하고 있는지 측정하기위한 간단한 기준이 있습니다.</p>
<p>중심 문제<strong>감독 학습</strong><a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>~이다<strong>지나치게 적합합니다</strong>그리고<strong>일반화 가능성</strong>: 우리는 훈련 데이터에 대해 100% 정확도를 가진 규칙을 구성하지만 새로운 데이터에서는 제대로 수행하지 못한 규칙을 구성하여 훈련 데이터를“마음으로”배웠습니까? 아니면 우리의 규칙이 실제로 연구중인 시스템의 일부 적절한 패턴을 선택했는데, 이는 아직 보이지 않는 새로운 데이터에도 적용될 것입니까? (<a class="quarto-xref" href="#fig-overfitting-1">수치<span>12.1</span></a>))</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>때때로 용어<strong>통계 학습</strong>다소 교환 적으로 사용됩니다.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-overfitting-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overfitting-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="12-chap_files/figure-html/fig-overfitting-1-1.png" title="Figure 12.1: An example for overfitting: two regression lines are fit to data in the (x, y)-plane (black points). We can think of such a line as a rule that predicts the y-value, given an x-value. Both lines are smooth, but the fits differ in what is called their bandwidth, which intuitively can be interpreted their stiffness. The blue line seems overly keen to follow minor wiggles in the data, while the orange line captures the general trend but is less detailed. The effective number of parameters needed to describe the blue line is much higher than for the orange line. Also, if we were to obtain additional data, it is likely that the blue line would do a worse job than the orange line in modeling the new data. We’ll formalize these concepts –training error and test set error– later in this chapter. Although exemplified here with line fitting, the concept applies more generally to prediction models."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-overfitting-1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overfitting-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.1 : 예제<strong>지나치게 적합합니다</strong>: 두 개의 회귀선이 데이터에 적합합니다.<span class="math inline">\ ((x, y) \)</span>-평면 (검은 점). 우리는 그러한 선을 규칙적으로 생각할 수 있습니다.<span class="math inline">\(와이\)</span>-값, 주어진<span class="math inline">\(엑스\)</span>-값. 두 줄 모두 매끄럽지 만 적합은 그들의 것과 다릅니다.<strong>대역폭</strong>직관적으로 강성을 해석 할 수 있습니다. 블루 라인은 데이터에서 작은 흔들림을 따르고 싶어하는 반면, 오렌지 라인은 일반적인 추세를 포착하지만 덜 상세합니다. 파란색 선을 설명하는 데 필요한 유효 매개 변수는 주황색 선보다 훨씬 높습니다. 또한 추가 데이터를 얻으려면 파란색 선이<strong>더 나쁜</strong>새로운 데이터를 모델링하는 데있어 오렌지 라인보다 작업. 이 장의 뒷부분에서 이러한 개념 (트레이닝 오류 및 테스트 세트 오류)을 공식화합니다. 여기서 라인 피팅으로 예시되어 있지만 개념은보다 일반적으로 예측 모델에 적용됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<section class="level2" data-number="12.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="12.1"><span class="header-section-number">12.1</span>이 장의 목표</h2>
<p>이 장에서는 다음과 같습니다.</p>
<ul>
<li><p>감독 학습 방법의 사용에 동기를 부여하는 예시 적용을 참조하십시오.</p></li>
<li><p>차별적 분석이 무엇을하는지 배우십시오.</p></li>
<li><p>성능 측정을 정의합니다.</p></li>
<li><p>치수의 저주를 만나고 과적이 무엇인지 확인하십시오.</p></li>
<li><p>정규화, 특히 처벌에 대해 알아 내고 일반화 가능성과 모델 복잡성의 개념을 이해하십시오.</p></li>
<li><p>교차 검증을 사용하여 알고리즘의 매개 변수를 조정하는 방법을 참조하십시오.</p></li>
<li><p>방법 해킹에 대해 토론하십시오.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="12.2" id="what-are-the-data">
<h2 class="anchored" data-anchor-id="what-are-the-data" data-number="12.2"><span class="header-section-number">12.2</span>데이터는 무엇입니까?</h2>
<p>감독 된 학습 및 감독되지 않은 학습의 기본 데이터 구조는 (적어도 개념적으로) 데이터 프레임입니다. 각 행은 객체에 해당하고 열은 객체의 다른 기능 (일반적으로 숫자 값)입니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>. 감독되지 않은 학습에서는 기능 값 (예 : 클러스터링 또는 안수)을 기반으로 객체 간의 (DIS) 유사성 관계를 찾는 것을 목표로하고, 감독 된 학습에서 우리는 다른 기능에서 기능 중 하나의 값을 예측하는 수학적 기능 (또는 계산 알고리즘)을 찾는 것을 목표로합니다. 많은 구현에서는 결 측값이 없어야하는 반면, 다른 방법은 어느 정도의 누락 된 데이터와 함께 작동하도록 할 수 있습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>이것은 단순화 된 설명입니다. 머신 러닝은 큰 분야이며,이 간단한 개념적 그림의 많은 일반화가 이루어졌습니다. 이미 관련 기능의 구성은 그 자체로 예술입니다. 우리는 셀 이미지가있는 예를 보았습니다.<a class="quarto-xref" href="11-chap.html"><span>11 장</span></a>더 일반적으로 이미지, 사운드, 영화, 무료 텍스트에서 기능을 추출 할 수있는 많은 가능성이 있습니다.<span class="math inline">\ (... \)</span>또한, 기계 학습 방법의 변형이 있습니다.<strong>커널 방법</strong>그것은 전혀 기능이 필요하지 않습니다. 대신 커널 방법은 객체 간의 거리 또는 유사성 측정을 사용합니다. 예를 들어, 두 자연 언어 텍스트 객체 사이의 유사성 척도를 정의하는 것이 더 쉬울 수 있습니다. 커널 방법은이 책의 범위를 벗어납니다.</p></div></div><p>예측을 목표로 다른 모든 것을 선택하는 기능을<strong>목적</strong>또는<strong>응답</strong>. 때때로 선택은 자연 스럽지만 때로는 생물학적 이해의 목적으로 예측 기능을 해부하거나 원인으로부터의 상관 관계를 분리하는 데 관심이있는 경우 역할을 되돌리는 것이 유익합니다.</p>
<p>감독 학습을위한 프레임 워크는 지속적인 및 범주 형 반응 변수를 다룹니다. 연속적인 경우에도 우리는 그것을 부릅니다<strong>회귀</strong>, 범주적인 경우,<strong>분류</strong>. 이 차이는 손실 함수 선택에 매우 광범위한 결과를 초래하기 때문에 세부 사항이 아닙니다.<a class="quarto-xref" href="#sec-supervised-objective"><span>섹션 12.5</span></a>) 따라서 알고리즘 선택<span class="citation" data-cites="friedmanbiasvariance01">(<a href="16-chap.html#ref-friedmanbiasvariance01" role="doc-biblioref">Friedman 1997</a>))</span>.</p>
<p>감독 된 학습 과제에서 고려해야 할 첫 번째 질문은 객체 수가 예측 변수 수와 비교되는 방법입니다. 대상이 많을수록 감독 된 학습의 많은 노력은 유한 (그리고 일반적으로 너무 작은) 교육 세트의 한계를 극복하는 것과 관련이 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-fourtypes">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourtypes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="imgs/fourquad.png" title="Figure 12.2: In supervised learning, we assign two different roles to our variables. We have labeled the explanatory variables X and the response variable(s) Y. There are also two different sets of observations: the training set X_\ell and Y_\ell and the test set X_v and Y_v. (The subscripts refer to alternative names for the two sets: “learning” and “validation”.)"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/fourquad.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourtypes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.2 : 감독 학습에서 우리는 변수에 두 가지 다른 역할을 할당합니다. 우리는 설명 변수에 레이블을 지정했습니다<span class="math inline">\(엑스\)</span>그리고 응답 변수 (들)<span class="math inline">\(와이\)</span>. 두 가지 관측 세트도 있습니다 : 훈련 세트<span class="math inline">\ (x_ \ ell \)</span>그리고<span class="math inline">\ (소리치다 \)</span>그리고 테스트 세트<span class="math inline">\ (x_v \)</span>그리고<span class="math inline">\ (y_v \)</span>. (구독자는 두 세트의 대체 이름을 말합니다 :“학습”및“검증”).)</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>이 책의 범주 적 반응으로 감독 학습 사례를 만난 예를 제시하십시오.</p>
</div>
</div>
<section class="level3 page-columns page-full" data-number="12.2.1" id="motivating-examples">
<h3 class="anchored" data-anchor-id="motivating-examples" data-number="12.2.1"><span class="header-section-number">12.2.1</span>동기 부여 예</h3>
<section class="level4 unnumbered page-columns page-full" id="predicting-diabetes-type">
<h4 class="unnumbered anchored" data-anchor-id="predicting-diabetes-type">당뇨병 유형 예측</h4>
<p>그만큼<code>당뇨병</code>데이터 세트<span class="citation" data-cites="diabetes">(<a href="16-chap.html#ref-diabetes" role="doc-biblioref">Reaven and Miller 1979</a>))</span>당뇨병 환자의 3 개 그룹과 그에 따라 측정 된 5 가지 임상 변수를 나타냅니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"당뇨병"</span>,,,<span class="at">패키지 =</span> <span class="st">"rrks"</span>))</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a><span class="fu">머리</span>(당뇨병)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RW FPG 포도당 인슐린 SSPG 그룹
1 0.81 80 356 124 55 정상
2 0.95 97 289 117 76 정상
3 0.94 105 319 143 105 정상
4 1.04 90 356 199 108 정상
5 1.00 90 323 240 143 정상
6 0.76 86 381 157 165 정상</code></pre>
</div>
</div>
<p>일 변량 분포 (보다 정확하게는 밀도 추정치)가 표시됩니다.<a class="quarto-xref" href="#fig-ldagroups-1">수치<span>12.3</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"reshape2"</span>))</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">녹다</span>(당뇨병,<span class="at">id.vars =</span> <span class="st">"그룹"</span>),)<span class="fu">AES</span>(<span class="at">x =</span>값,<span class="at">col =</span>그룹))<span class="sc">+</span></span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a> <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span>변하기 쉬운,<span class="at">NCOL =</span> <span class="dv">1</span>,,,<span class="at">스케일 =</span> <span class="st">"무료"</span>))<span class="sc">+</span></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a> <span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span> <span class="st">"맨 아래"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ldagroups-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ldagroups-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="12-chap_files/figure-html/fig-ldagroups-1-1.png" title="Figure 12.3: We see already from the one-dimensional distributions that some of the individual variables could potentially predict which group a patient is more likely to belong to. Our goal is to combine variables to improve over such one-dimensional prediction models."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-ldagroups-1-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ldagroups-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.3 : 우리는 이미 1 차원 분포에서 일부 개별 변수 중 일부가 어떤 그룹 A 환자가 속한지를 예측할 수있는 것으로 보입니다. 우리의 목표는 변수를 결합하여 이러한 1 차원 예측 모델을 개선하는 것입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>변수는 데이터 세트의 매뉴얼 페이지와 논문에 설명되어 있습니다.<span class="citation" data-cites="diabetes">(<a href="16-chap.html#ref-diabetes" role="doc-biblioref">Reaven and Miller 1979</a>))</span>:</p>
<ul>
<li><p>RW : 상대적인 무게</p></li>
<li><p>FPG : 공복 혈장 포도당</p></li>
<li><p>포도당 : 3 시간 구강 포도당 내성 검사 (OGTT)에 대한 혈장 포도당 곡선 하의 영역</p></li>
<li><p>인슐린 : OGTT의 혈장 인슐린 곡선 아래 지역</p></li>
<li><p>SSPG : 정상 상태 혈장 포도당 반응</p></li>
<li><p>그룹 : 정상, 화학 당뇨병 및 명백한 당뇨병</p></li>
</ul>
</section>
<section class="level4 unnumbered page-columns page-full" id="predicting-cellular-phenotypes">
<h4 class="unnumbered anchored" data-anchor-id="predicting-cellular-phenotypes">세포 표현형 예측</h4>
<p><span class="citation" data-cites="Neumann:2010">Neumann et al. (<a href="16-chap.html#ref-Neumann:2010" role="doc-biblioref">2010 년</a>))</span>살아있는 세포 영상을 사용하여 인간 암 세포를 관찰했습니다. 그들의 히스톤에 녹색 형광 단백질 (GFP)이 태그되도록 세포를 유전자 조작 하였다. 게놈 전체 RNAI 라이브러리를 세포에 적용하고, 각각의 siRNA 섭동에 대해, 세포주기, 핵 형태 및 세포 증식에 ​​대한 각 유전자의 고갈이 어떤 영향을 미치는지 약 2 일 동안 수백 세포의 영화를 기록 하였다. 그들의 논문은 각 세포의 핵의 시각적 외관을 정량화하고 정상적인 유사 분열 상태 또는 비정상적인 핵의 예측을 가능하게하는 자동화 된 이미지 분류 알고리즘의 사용을보고합니다. 알고리즘은 인간 전문가가 주석을 달린 약 3000 개의 셀의 데이터에 대해 교육을 받았습니다. 그런 다음 거의 20 억 개의 핵 이미지에 적용되었습니다 (<a class="quarto-xref" href="#fig-cellshape">수치<span>12.4</span></a>). 자동화 된 이미지 분류를 사용하여 확장 성 (수동으로 20 억 개의 이미지를 주석을 달게하는 데 오랜 시간이 걸릴 수 있음)과 객관성을 사용합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-cellshape">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-cellshape-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="imgs/Neumann2010Fig1b_web.jpg" title="Figure 12.4: The data were images of 2\times10^9 nuclei from movies. The images were segmented to identify the nuclei, and numeric features were computed for each nucleus, corresponding to size, shape, brightness and lots of other more or less abstract quantitative summaries of the joint distribution of pixel intensities. From the features, the cells were classified into 16 different nuclei morphology classes, represented by the rows of the barplot. Representative images for each class are shown in black and white in the center column. The class frequencies, which are very unbalanced, are shown by the lengths of the bars."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Neumann2010Fig1b_web.jpg" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cellshape-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.4 : 데이터는 이미지였습니다<span class="math inline">\ (2 \ times10^9 \)</span>영화에서 핵. 이미지는 핵을 식별하기 위해 분할되고, 숫자 특징은 각 핵에 대해 크기, 모양, 밝기 및 픽셀 강도의 관절 분포에 대한 다소 추상적 인 양적 요약에 해당하는 각 핵에 대해 계산되었다. 특징들로부터, 세포는 바 플로트의 행으로 표시되는 16 가지 핵 형태 클래스로 분류되었다. 각 클래스의 대표 이미지는 중앙 열에 흑백으로 표시됩니다. 매우 불균형 인 클래스 주파수는 막대의 길이로 표시됩니다.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section class="level4 unnumbered" id="predicting-embryonic-cell-states">
<h4 class="unnumbered anchored" data-anchor-id="predicting-embryonic-cell-states">배아 세포 상태 예측</h4>
<p>우리는 마우스 배아 데이터를 다시 방문 할 것입니다<span class="citation" data-cites="Ohnishi2014">(<a href="16-chap.html#ref-Ohnishi2014" role="doc-biblioref">Ohnishi et al. 2014</a>))</span>우리는 이미 챕터에서 본 것입니다<a class="quarto-xref" href="03-chap.html"><span>3</span></a>,,,<a class="quarto-xref" href="05-chap.html"><span>5</span></a>그리고<a class="quarto-xref" href="07-chap.html"><span>7</span></a>. 우리는 섹션에서 유전자 발현 측정에서 세포 상태와 유전자형을 예측하려고 노력할 것입니다.<a class="quarto-xref" href="#sec-supervised-predictembryonicday"><span>12.3.2</span></a>그리고<a class="quarto-xref" href="#sec-supervised-classifymousecells"><span>12.6.3</span></a>.</p>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="12.3" id="linear-discrimination">
<h2 class="anchored" data-anchor-id="linear-discrimination" data-number="12.3"><span class="header-section-number">12.3</span>선형 차별</h2>
<p>우리는 가장 간단한 가능한 차별 문제 중 하나부터 시작합니다.<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>: 우리는 두 가지 연속적인 특징으로 설명 된 객체 (객체는 2D 평면의 지점으로 생각할 수 있음)를 가지고 있으며 세 그룹으로 떨어집니다. 우리의 목표는 2D 공간의 선인 클래스 경계를 ​​정의하는 것입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>아마도 가장 간단한 문제는 단일 연속 기능, 두 클래스 및 두 그룹을 구별하기 위해 단일 임계 값을 찾는 작업입니다.<a class="quarto-xref" href="06-chap.html#fig-testing-FDRvspstatic1">수치<span>6.2</span></a>.</p></div></div><section class="level3 page-columns page-full" data-number="12.3.1" id="diabetes-data">
<h3 class="anchored" data-anchor-id="diabetes-data" data-number="12.3.1"><span class="header-section-number">12.3.1</span>당뇨병 데이터</h3>
<p>우리가 예측할 수 있는지 봅시다<code>그룹</code>에서<code>SSPG</code>그리고<code>포도당</code>의 변수<code>당뇨병</code>데이터. 먼저 데이터를 시각화하는 것이 좋습니다.<a class="quarto-xref" href="#fig-scatterdiabetes-1">수치<span>12.5</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a>GGDB<span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">매핑 =</span> <span class="fu">AES</span>(<span class="at">x =</span>SSPG,<span class="at">y =</span>포도당))<span class="sc">+</span></span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>그룹),<span class="at">데이터 =</span>당뇨병)</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a>GGDB</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-scatterdiabetes-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatterdiabetes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="12-chap_files/figure-html/fig-scatterdiabetes-1-1.png" title="Figure 12.5: Scatterplot of two of the variables in the diabetes data. Each point is a sample, and the color indicates the diabetes type as encoded in the group variable."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-scatterdiabetes-1-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterdiabetes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.5 : 두 변수의 산점도<code>당뇨병</code>데이터. 각 지점은 샘플이며 색상은<code>그룹</code>변하기 쉬운.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는라는 메소드로 시작하겠습니다<strong>선형 판별 분석</strong> (<strong>LDA</strong>). 이 방법은 분류의 기초 석재이며, 더 복잡한 (그리고 때로는 더 강력한) 알고리즘은 실제로 LDA의 일반화 일뿐입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"대량의"</span>))</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a>Diabetes_LDA<span class="ot">=</span> <span class="fu">LDA</span>(그룹<span class="sc">~</span>SSPG<span class="sc">+</span>포도당,<span class="at">데이터 =</span>당뇨병)</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3" tabindex="-1"></a>Diabetes_LDA</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>부르다:
LDA (그룹 ~ SSPG + 포도당, 데이터 = 당뇨병)

그룹의 사전 확률 :
   정상적인 화학적 명백 
0.5241379 0.2482759 0.2275862 

그룹 수단 :
             SSPG 포도당
정상 114.0000 349.9737
화학 물질 208.9722 493.9444
명백한 318.8788 1043.7576

선형 판별 계수 :
                LD1 LD2
SSPG 0.005036943 -0.01539281
포도당 0.005461400 0.00449050

추적 비율 :
   LD1 LD2 
0.9683 0.0317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a>산길<span class="ot">=</span> <span class="fu">예측하다</span>(Diabetes_LDA)<span class="sc">$</span>수업</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a><span class="fu">테이블</span>(GHAT, 당뇨병<span class="sc">$</span>그룹)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ghat 정상 화학적 명백
  정상 69 12 1
  화학 물질 7 24 6
  명백한 0 0 26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="fu">평균</span>(산길<span class="sc">! =</span>당뇨병<span class="sc">$</span>그룹)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1793103</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-ladoutput">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.1</div>
</div>
<div class="callout-body-container callout-body">
<p>위의 출력의 다른 부분은 무엇을 의미합니까?</p>
</div>
</div>
<p>이제 LDA 결과를 시각화하겠습니다. 우리는 세 그룹 각각에 대한 예측 영역을 계획 할 것입니다. 우리는 포인트의 그리드를 만들고 각각에 대한 예측 규칙을 사용하여이를 수행합니다. 그런 다음 LDA의 역학을 조금 더 깊이 파고 클래스 센터를 플로팅합니다 (<code>Diabetes_lda $는 의미합니다</code>) 및 적합 공분산 행렬에 해당하는 타원 (<code>Diabetes_lda $ 스케일링</code>). 이 시각화를 조립하려면 약간의 코드를 작성해야합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a>make1dgrid<span class="ot">=</span> <span class="cf">기능</span>(x) {</span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>Rg<span class="ot">=</span>GRDEVICES<span class="sc">::</span><span class="fu">ExtendRange</span>(엑스)</span>
<span id="cb11-3"><a aria-hidden="true" href="#cb11-3" tabindex="-1"></a>  <span class="fu">서열</span>(<span class="at">From =</span>rg [<span class="dv">1</span>],,<span class="at">to =</span>rg [<span class="dv">2</span>],,<span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb11-4"><a aria-hidden="true" href="#cb11-4" tabindex="-1"></a>}</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>예측 포인트를 설정하십시오<span class="math inline">\ (100 \ times 100 \)</span>데이터 범위를 다루는 그리드.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a>Diabetes_grid<span class="ot">=</span> <span class="fu">~와 함께</span>(당뇨병,</span>
<span id="cb12-2"><a aria-hidden="true" href="#cb12-2" tabindex="-1"></a>  <span class="fu">확장 .grid</span>(<span class="at">sspg =</span> <span class="fu">make1dgrid</span>(SSPG),</span>
<span id="cb12-3"><a aria-hidden="true" href="#cb12-3" tabindex="-1"></a>              <span class="at">포도당 =</span> <span class="fu">make1dgrid</span>(포도당)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>예측을하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a>Diabetes_grid<span class="sc">$</span>산길<span class="ot">=</span></span>
<span id="cb13-2"><a aria-hidden="true" href="#cb13-2" tabindex="-1"></a>  <span class="fu">예측하다</span>(Diabetes_lda,<span class="at">NewData =</span>Diabetes_grid)<span class="sc">$</span>수업</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>그룹 센터.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" href="#cb14-1" tabindex="-1"></a>센터<span class="ot">=</span>Diabetes_LDA<span class="sc">$</span>수단</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>타원을 계산하십시오. 우리는 단위 원에서 시작하여 (360면의 다각형에 의해 근사) LDA 출력에서 ​​해당 아핀 변환을 적용합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a>단위<span class="ot">=</span> <span class="fu">exp</span>(<span class="dv">1</span>나<span class="sc">*</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">2</span><span class="sc">*</span>PI,<span class="at">length.out =</span> <span class="dv">360</span>)))<span class="sc">|&gt;</span></span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a>(\(지)<span class="fu">cbind</span>(<span class="fu">답장</span>(지),<span class="fu">나는</span>(지)))()</span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a>타원<span class="ot">=</span>단위<span class="sc">%*%</span> <span class="fu">해결하다</span>(Diabetes_LDA<span class="sc">$</span>스케일링)<span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>각 그룹 센터마다 하나씩 세 개의 타원 모두.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb16-2"><a aria-hidden="true" href="#cb16-2" tabindex="-1"></a>타원<span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">Rownames</span>(센터),<span class="cf">기능</span>(gr) {</span>
<span id="cb16-3"><a aria-hidden="true" href="#cb16-3" tabindex="-1"></a>  <span class="fu">돌연변이</span>(타원,</span>
<span id="cb16-4"><a aria-hidden="true" href="#cb16-4" tabindex="-1"></a>     <span class="at">sspg =</span>SSPG<span class="sc">+</span>센터 [Gr,<span class="st">"SSPG"</span>],,</span>
<span id="cb16-5"><a aria-hidden="true" href="#cb16-5" tabindex="-1"></a>     <span class="at">포도당 =</span>포도당<span class="sc">+</span>센터 [Gr,<span class="st">"포도당"</span>],,</span>
<span id="cb16-6"><a aria-hidden="true" href="#cb16-6" tabindex="-1"></a>     <span class="at">그룹 =</span>Gr)</span>
<span id="cb16-7"><a aria-hidden="true" href="#cb16-7" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 우리는 음모 할 준비가되었습니다 (<a class="quarto-xref" href="#fig-modeldiabetes-1">수치<span>12.6</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a>GGDB<span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">AES</span>(<span class="at">fill =</span>산길),</span>
<span id="cb17-2"><a aria-hidden="true" href="#cb17-2" tabindex="-1"></a>            <span class="at">데이터 =</span>diabetes_grid,<span class="at">알파 =</span> <span class="fl">0.25</span>,,,<span class="at">보간 =</span> <span class="cn">진실</span>))<span class="sc">+</span></span>
<span id="cb17-3"><a aria-hidden="true" href="#cb17-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">데이터 =</span> <span class="fu">as_tibble</span>(센터),<span class="at">pch =</span> <span class="st">"+"</span>,,,<span class="at">크기 =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb17-4"><a aria-hidden="true" href="#cb17-4" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>그룹),<span class="at">데이터 =</span>타원)<span class="sc">+</span></span>
<span id="cb17-5"><a aria-hidden="true" href="#cb17-5" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb17-6"><a aria-hidden="true" href="#cb17-6" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-modeldiabetes-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-modeldiabetes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="12-chap_files/figure-html/fig-modeldiabetes-1-1.png" title="Figure 12.6: As Figure fig-scatterdiabetes-1, with the classification regions from the LDA model shown. The three ellipses represent the class centers and the covariance matrix of the LDA model; note that there is only one covariance matrix, which is the same for all three classes. Therefore also the sizes and orientations of the ellipses are the same for the three classes, only their centers differ. They represent contours of equal class membership probability."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-modeldiabetes-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-modeldiabetes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.6 : AS<a class="quarto-xref" href="#fig-scatterdiabetes-1">수치<span>12.5</span></a>LDA 모델의 분류 영역이 표시되어 있습니다. 3 개의 타원은 클래스 센터와 LDA 모델의 공분산 행렬을 나타냅니다. 공분산 행렬은 하나 뿐이며 세 클래스 모두에서 동일합니다. 따라서 타원의 크기와 방향은 세 클래스의 경우 동일하며 중심 만 다릅니다. 동등한 클래스 멤버쉽 확률의 윤곽을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-decisionboundarynotperpendicular">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.2</div>
</div>
<div class="callout-body-container callout-body">
<p>예측 영역 사이의 경계가있는 이유<em>화학적인</em>그리고<em>명백한</em>그룹 센터 사이의 경계에 수직이 아닌가?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-4-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-4-contents callout-collapse collapse" id="callout-4">
<div class="callout-body-container callout-body">
<p>타원이 원인 경우 경계는 수직입니다. 일반적으로, 경계는 동일한 클래스 확률의 윤곽에 접하는 것이며, 윤곽의 타원 모양으로 인해 경계는 일반적으로 중심 사이의 선에 수직이 아닙니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-extrapolation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.3</div>
</div>
<div class="callout-body-container callout-body">
<p>모든 클러스터 센터에서 멀리 떨어진 2D 평면의 해당 영역에서 예측에 대해 얼마나 자신감을 갖고 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-6-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-6-contents callout-collapse collapse" id="callout-6">
<div class="callout-body-container callout-body">
<p>이 클러스터 센터에서 멀리 떨어진 예측은 LDA 모델이 그다지 좋지 않을 수 있고/또는 예측을지지하기 위해 근처의 훈련 데이터가 없을 수있는 영역으로의 외삽에 해당하기 때문에 비판적으로 평가되어야합니다. 우리는 가장 가까운 센터까지의 거리를 특정 지점에 대한 예측에 대한 신뢰 측정으로 사용할 수 있습니다. 비록 우리는 리 샘플링 및 교차 검증 기반 방법이보다 일반적이고 일반적으로 더 신뢰할 수있는 조치를 제공한다는 것을 알게 될 것입니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-decisionboundarynothalfway">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.4</div>
</div>
<div class="callout-body-container callout-body">
<p>예측 영역 사이의 경계가있는 이유<em>정상</em>그리고<em>화학적인</em>센터 사이의 반쯤이 아니라<em>정상</em>? 힌트 :<code>이전의</code>논쟁<code>LDA</code>. 유니폼을 입고 다시 시도하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-8-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-8-contents callout-collapse collapse" id="callout-8">
<div class="callout-body-container callout-body">
<p>다음 코드 청크의 결과가 표시됩니다.<a class="quarto-xref" href="#fig-diabetes-lda-uniform-prior-1">수치<span>12.7</span></a>. 접미사<code>_위로</code>"균일 한 사전"의 경우 짧습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a>Diabetes_UP<span class="ot">=</span> <span class="fu">LDA</span>(그룹<span class="sc">~</span>SSPG<span class="sc">+</span>포도당,<span class="at">데이터 =</span>당뇨병,</span>
<span id="cb18-2"><a aria-hidden="true" href="#cb18-2" tabindex="-1"></a>  <span class="at">이전 =</span>(\(N)<span class="fu">대표</span>(<span class="dv">1</span><span class="sc">/</span>n, n)) (<span class="fu">nlevels</span>(당뇨병<span class="sc">$</span>그룹)))</span>
<span id="cb18-3"><a aria-hidden="true" href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a aria-hidden="true" href="#cb18-4" tabindex="-1"></a>Diabetes_grid<span class="sc">$</span>ghat_up<span class="ot">=</span></span>
<span id="cb18-5"><a aria-hidden="true" href="#cb18-5" tabindex="-1"></a>  <span class="fu">예측하다</span>(diabetes_up,<span class="at">NewData =</span>Diabetes_grid)<span class="sc">$</span>수업</span>
<span id="cb18-6"><a aria-hidden="true" href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a aria-hidden="true" href="#cb18-7" tabindex="-1"></a><span class="fu">Stopifnot</span>(<span class="fu">모두</span>(diabetes_up<span class="sc">$</span>수단, Diabetes_lda<span class="sc">$</span>수단))</span>
<span id="cb18-8"><a aria-hidden="true" href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a aria-hidden="true" href="#cb18-9" tabindex="-1"></a>Ellipse_up<span class="ot">=</span>단위<span class="sc">%*%</span> <span class="fu">해결하다</span>(diabetes_up<span class="sc">$</span>스케일링)<span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb18-10"><a aria-hidden="true" href="#cb18-10" tabindex="-1"></a>Ellipses_up<span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">Rownames</span>(센터),<span class="cf">기능</span>(gr) {</span>
<span id="cb18-11"><a aria-hidden="true" href="#cb18-11" tabindex="-1"></a>  <span class="fu">돌연변이</span>(Ellipse_up,</span>
<span id="cb18-12"><a aria-hidden="true" href="#cb18-12" tabindex="-1"></a>     <span class="at">sspg =</span>SSPG<span class="sc">+</span>센터 [Gr,<span class="st">"SSPG"</span>],,</span>
<span id="cb18-13"><a aria-hidden="true" href="#cb18-13" tabindex="-1"></a>     <span class="at">포도당 =</span>포도당<span class="sc">+</span>센터 [Gr,<span class="st">"포도당"</span>],,</span>
<span id="cb18-14"><a aria-hidden="true" href="#cb18-14" tabindex="-1"></a>     <span class="at">그룹 =</span>Gr)</span>
<span id="cb18-15"><a aria-hidden="true" href="#cb18-15" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb18-16"><a aria-hidden="true" href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a aria-hidden="true" href="#cb18-17" tabindex="-1"></a>GGDB<span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">AES</span>(<span class="at">fill =</span>ghat_up),</span>
<span id="cb18-18"><a aria-hidden="true" href="#cb18-18" tabindex="-1"></a>            <span class="at">데이터 =</span>diabetes_grid,<span class="at">알파 =</span> <span class="fl">0.4</span>,,,<span class="at">보간 =</span> <span class="cn">진실</span>))<span class="sc">+</span></span>
<span id="cb18-19"><a aria-hidden="true" href="#cb18-19" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">데이터 =</span> <span class="fu">데이터. 프레임</span>(센터),<span class="at">pch =</span> <span class="st">"+"</span>,,,<span class="at">크기 =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb18-20"><a aria-hidden="true" href="#cb18-20" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>그룹),<span class="at">데이터 =</span>Ellipses_up)<span class="sc">+</span></span>
<span id="cb18-21"><a aria-hidden="true" href="#cb18-21" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb18-22"><a aria-hidden="true" href="#cb18-22" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-diabetes-lda-uniform-prior-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diabetes-lda-uniform-prior-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="12-chap_files/figure-html/fig-diabetes-lda-uniform-prior-1-1.png" title="Figure 12.7: As Figure fig-modeldiabetes-1, but with uniform class priors."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-diabetes-lda-uniform-prior-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes-lda-uniform-prior-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.7 : AS<a class="quarto-xref" href="#fig-modeldiabetes-1">수치<span>12.6</span></a>그러나 균일 한 클래스 사전.</figcaption>
</figure>
</div>
</div>
</div>
<p>그만큼<code>Stopifnot</code>라인은 클래스 센터가 이전과 무관 한 것과 동일하다는 것을 확인합니다. 관절 공분산은 아닙니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-ellipses">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.5</div>
</div>
<div class="callout-body-container callout-body">
<p>인물<a class="quarto-xref" href="#fig-modeldiabetes-1"><span>12.6</span></a>그리고<a class="quarto-xref" href="#fig-diabetes-lda-uniform-prior-1"><span>12.7</span></a>적합한 LDA 모델, 타원 및 예측 영역을 통해 영역 채색을 통해 두 가지를 보여줍니다. 이 시각화의 어떤 부분이 모든 종류의 분류 방법에 대해 일반적으로, 메소드 별 부분은 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-10-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-10-contents callout-collapse collapse" id="callout-10">
<div class="callout-body-container callout-body">
<p>예측 영역은 "블랙 박스"방법을 포함한 모든 분류 방법에 대해 표시 될 수 있습니다. 클러스터 중심 및 타원 수치<a class="quarto-xref" href="#fig-modeldiabetes-1"><span>12.6</span></a>그리고<a class="quarto-xref" href="#fig-diabetes-lda-uniform-prior-1"><span>12.7</span></a>메소드 별입니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-fivevar">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.6</div>
</div>
<div class="callout-body-container callout-body">
<p>단지 5 개의 변수를 모두 사용하는 경우 예측 정확도의 차이는 무엇입니까?<code>포도당</code>그리고<code>SSPG</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-12-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-12-contents callout-collapse collapse" id="callout-12">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a>Diabetes_LDA5<span class="ot">=</span> <span class="fu">LDA</span>(그룹<span class="sc">~</span>RW<span class="sc">+</span>FPG<span class="sc">+</span>포도당<span class="sc">+</span>SSPG<span class="sc">+</span>인슐린,<span class="at">데이터 =</span>당뇨병)</span>
<span id="cb19-2"><a aria-hidden="true" href="#cb19-2" tabindex="-1"></a>Diabetes_LDA5</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>부르다:
LDA (그룹 ~ RW + FPG + 포도당 + SSPG + 인슐린, 데이터 = 당뇨병)

그룹의 사전 확률 :
   정상적인 화학적 명백 
0.5241379 0.2482759 0.2275862 

그룹 수단 :
                RW FPG 포도당 SSPG 인슐린
정상 0.9372368 91.18421 349.9737 114.0000 172.6447
화학 1.0558333 99.30556 493.9444 208.9722 288.0000
Overt 0.9839394 217.66667 1043.7576 318.8788 106.0000

선형 판별 계수 :
                  LD1 LD2
RW 1.3624356881 -3.784142444
FPG -0.0336487883 0.036633317
포도당 0.0125763942 -0.007092017
SSPG 0.0042431866 0.001134070
인슐린 -0.0001022245 -0.006173424

추적 비율 :
   LD1 LD2 
0.8812 0.1188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a>GHAT5<span class="ot">=</span> <span class="fu">예측하다</span>(Diabetes_LDA5)<span class="sc">$</span>수업</span>
<span id="cb21-2"><a aria-hidden="true" href="#cb21-2" tabindex="-1"></a><span class="fu">테이블</span>(GHAT5, 당뇨병<span class="sc">$</span>그룹)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GHAT5 정상 화학적 명백
  정상 73 5 1
  화학 3 31 5
  명백한 0 0 27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="fu">평균</span>(GHAT5<span class="sc">! =</span>당뇨병<span class="sc">$</span>그룹)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09655172</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-paperandpencil">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.7</div>
</div>
<div class="callout-body-container callout-body">
<p>점 그리드의 분류에 의해 예측 영역을 근사화하는 대신, 선형 결정 계수로부터 분리선을 명시 적으로 계산합니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-14-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-14-contents callout-collapse collapse" id="callout-14">
<div class="callout-body-container callout-body">
<p>4.3 절, 방정식 (4.10)을 참조하십시오<span class="citation" data-cites="HastieTibshiraniFriedman">(<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">Hastie, Tibshirani 및 Friedman 2008</a>))</span>.</p>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="12.3.2" id="sec-supervised-predictembryonicday">
<h3 class="anchored" data-anchor-id="sec-supervised-predictembryonicday" data-number="12.3.2"><span class="header-section-number">12.3.2</span>유전자 발현으로부터 배아 세포 상태 예측</h3>
<p>우리는 이미 네 가지 유전자를 알고 있다고 가정합니다<em>FN1</em>,,,<em>TIMD2</em>,,,<em>Gata4</em>그리고<em>sox7</em>분류 작업과 관련이 있습니다<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>. 우리는 발달 시간을 예측하는 분류기를 구축하려고합니다 (Embryonic Days : E3.25, E3.5, E4.5). 데이터를로드하고 4 개의 해당 프로브를 선택합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>이 장의 뒷부분에서 우리는이 가정을 중단하고 사용 가능한 모든 기능을 스크리닝 할 수있는 방법을 볼 수 있습니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Hiiragi2013"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="warning">
<pre class="knitr r">inchunk 'loadhiiragi2': 경고 : 'gtools :: logit'의 이전 가져 오기 'boot :: logit'를 교체 할 때 'hiiragi2013'</pre>
</div>
<div class="warning">
<pre class="knitr r">chunk 'loadhiiragi2': 경고 : 이전 가져 오기 'boot :: inv.logit'를 'gtools :: inv.logit''Hiiragi2013'으로 대체합니다.</pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"엑스"</span>))</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a>프로브<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"1426642_at"</span>,,,<span class="st">"1418765_at"</span>,,,<span class="st">"1418864_at"</span>,,,<span class="st">"1416564_at"</span>))</span>
<span id="cb26-3"><a aria-hidden="true" href="#cb26-3" tabindex="-1"></a>배아 셀<span class="ot">=</span> <span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(x) [프로브]))<span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a aria-hidden="true" href="#cb26-4" tabindex="-1"></a>  <span class="fu">돌연변이</span>(<span class="at">배아 .day =</span>엑스<span class="sc">$</span>배아 .day)<span class="sc">|&gt;</span></span>
<span id="cb26-5"><a aria-hidden="true" href="#cb26-5" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">필터</span>(엑스<span class="sc">$</span>유전자형<span class="sc">==</span> <span class="st">"wt"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 마이크로 어레이와 관련된 바이오 컨덕터 주석 패키지를 사용하여 프로브가 의도 된 유전자에 해당하는지 확인할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a><span class="fu">주석</span>(엑스)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "마우스 4302"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"마우스 4302.db"</span>))</span>
<span id="cb29-2"><a aria-hidden="true" href="#cb29-2" tabindex="-1"></a>아노<span class="ot">=</span>AnnotationDbi<span class="sc">::</span><span class="fu">선택하다</span>(Mouse4302.db,<span class="at">키 =</span>프로브,</span>
<span id="cb29-3"><a aria-hidden="true" href="#cb29-3" tabindex="-1"></a>                             <span class="at">열 =</span> <span class="fu">기음</span>(<span class="st">"상징"</span>,,,<span class="st">"GeneName"</span>)))</span>
<span id="cb29-4"><a aria-hidden="true" href="#cb29-4" tabindex="-1"></a>아노</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>probeid 기호 geneName
1 1426642_at fn1 피브로넥틴 1
2 1418765_at Timd2 T 세포 면역 글로불린 및 뮤신 도메인 2
3 1418864_AT GATA4 GATA 결합 단백질 4
4 1416564_at sox7 sry (성 결정 영역 y) -Box 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a>산<span class="ot">=</span> <span class="fu">성냥</span>(Anno<span class="sc">$</span>샘플링,<span class="fu">colnames</span>(배아 셀)))</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a><span class="fu">colnames</span>(Embryocells) [MT]<span class="ot">=</span>아노<span class="sc">$</span>상징</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 우리는 쌍 플롯에서 데이터를 시각화 할 준비가되었습니다 (<a class="quarto-xref" href="#fig-HiiragiFourGenesPairs-1">수치<span>12.8</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Ggally"</span>))</span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a><span class="fu">ggpairs</span>(배아,<span class="at">매핑 =</span> <span class="fu">AES</span>(<span class="at">col =</span>배아 .day),</span>
<span id="cb32-3"><a aria-hidden="true" href="#cb32-3" tabindex="-1"></a>  <span class="at">열 =</span>아노<span class="sc">$</span>상징,<span class="at">어퍼 =</span> <span class="fu">목록</span>(<span class="at">연속 =</span> <span class="st">"전철기"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HiiragiFourGenesPairs-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HiiragiFourGenesPairs-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="12-chap_files/figure-html/fig-HiiragiFourGenesPairs-1-1.png" title="Figure 12.8: Expression values of the discriminating genes, with the prediction target Embryonic.day shown by color."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-HiiragiFourGenesPairs-1-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HiiragiFourGenesPairs-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.8 : 예측 목표 배아.</figcaption>
</figure>
</div>
</div></div></div>
<p>이제 우리는 전화 할 수 있습니다<code>LDA</code>이 데이터에. 선형 조합<code>LD1</code>그리고<code>LD2</code>구별되는 변수 역할을하는 것은 슬롯에 나와 있습니다.<code>ed_lda $ 스케일링</code>출력의<code>LDA</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a>적어도<span class="ot">=</span> <span class="fu">LDA</span>(배아 .day<span class="sc">~</span>FN1<span class="sc">+</span>TIMD2<span class="sc">+</span>Gata4<span class="sc">+</span>sox7,</span>
<span id="cb33-2"><a aria-hidden="true" href="#cb33-2" tabindex="-1"></a>             <span class="at">데이터 =</span>배아 셀)</span>
<span id="cb33-3"><a aria-hidden="true" href="#cb33-3" tabindex="-1"></a><span class="fu">둥근</span>(E_DA<span class="sc">$</span>스케일링,<span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LD1 LD2
FN1 -0.2 0.4
TIMD2 0.5 0.0
Gata4 -0.1 0.6
Sox7 -0.7 -0.5</code></pre>
</div>
</div>
<p>학습 된 모델의 시각화를 위해<a class="quarto-xref" href="#fig-edcontour-1">수치<span>12.9</span></a>, 우리는 두 개의 새로운 좌표 LD1과 LD2의 공간에서 그리드를 확장하여 예측 영역과 경계를 구축해야합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>EC_ROT<span class="ot">=</span> <span class="fu">예측하다</span>(ecst_da)<span class="sc">$</span>엑스<span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a>           <span class="fu">돌연변이</span>(<span class="at">ed =</span>배아 셀<span class="sc">$</span>배아 .day)</span>
<span id="cb35-3"><a aria-hidden="true" href="#cb35-3" tabindex="-1"></a>EC_LDA2<span class="ot">=</span> <span class="fu">LDA</span>(ec_rot [,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],,<span class="fu">예측하다</span>(ecst_da)<span class="sc">$</span>수업)</span>
<span id="cb35-4"><a aria-hidden="true" href="#cb35-4" tabindex="-1"></a>EC_GRID<span class="ot">=</span> <span class="fu">~와 함께</span>(EC_ROT,<span class="fu">확장 .grid</span>(</span>
<span id="cb35-5"><a aria-hidden="true" href="#cb35-5" tabindex="-1"></a>  <span class="at">ld1 =</span> <span class="fu">make1dgrid</span>(ld1),</span>
<span id="cb35-6"><a aria-hidden="true" href="#cb35-6" tabindex="-1"></a>  <span class="at">ld2 =</span> <span class="fu">make1dgrid</span>(LD2)))</span>
<span id="cb35-7"><a aria-hidden="true" href="#cb35-7" tabindex="-1"></a>EC_GRID<span class="sc">$</span>에다트<span class="ot">=</span> <span class="fu">예측하다</span>(EC_LDA2,<span class="at">NewData =</span>EC_GRID)<span class="sc">$</span>수업</span>
<span id="cb35-8"><a aria-hidden="true" href="#cb35-8" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb35-9"><a aria-hidden="true" href="#cb35-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">x =</span>ld1,<span class="at">y =</span>ld2,<span class="at">색상 =</span>ed),<span class="at">데이터 =</span>EC_ROT)<span class="sc">+</span></span>
<span id="cb35-10"><a aria-hidden="true" href="#cb35-10" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">AES</span>(<span class="at">x =</span>ld1,<span class="at">y =</span>ld2,<span class="at">fill =</span>Edhat),</span>
<span id="cb35-11"><a aria-hidden="true" href="#cb35-11" tabindex="-1"></a>            <span class="at">데이터 =</span>ec_grid,<span class="at">알파 =</span> <span class="fl">0.4</span>,,,<span class="at">보간 =</span> <span class="cn">진실</span>))<span class="sc">+</span></span>
<span id="cb35-12"><a aria-hidden="true" href="#cb35-12" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb35-13"><a aria-hidden="true" href="#cb35-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb35-14"><a aria-hidden="true" href="#cb35-14" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-edcontour-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-edcontour-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="12-chap_files/figure-html/fig-edcontour-1-1.png" title="Figure 12.9: LDA classification regions for Embryonic.day."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-edcontour-1-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-edcontour-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.9 : 배아에 대한 LDA 분류 영역.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-qda">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.8</div>
</div>
<div class="callout-body-container callout-body">
<p>2 차 판별 분석을 사용하여 이러한 분석을 반복합니다 (<code>비</code>). 경계의 모양에서 어떤 차이가 보입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-16-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-16-contents callout-collapse collapse" id="callout-16">
<div class="callout-body-container callout-body">
<p>아래 코드를 참조하십시오<a class="quarto-xref" href="#fig-qdamouse-1">수치<span>12.10</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"gridextra"</span>))</span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a>EC_QDA<span class="ot">=</span> <span class="fu">비</span>(배아 .day<span class="sc">~</span>FN1<span class="sc">+</span>TIMD2<span class="sc">+</span>Gata4<span class="sc">+</span>sox7,</span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a>             <span class="at">데이터 =</span>배아 셀)</span>
<span id="cb36-5"><a aria-hidden="true" href="#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a aria-hidden="true" href="#cb36-6" tabindex="-1"></a>변수<span class="ot">=</span> <span class="fu">colnames</span>(EC_QDA<span class="sc">$</span>수단)</span>
<span id="cb36-7"><a aria-hidden="true" href="#cb36-7" tabindex="-1"></a>한 쌍<span class="ot">=</span> <span class="fu">콤브</span>(변수,<span class="dv">2</span>))</span>
<span id="cb36-8"><a aria-hidden="true" href="#cb36-8" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">seq_len</span>(<span class="fu">NCOL</span>(한 쌍)),<span class="cf">기능</span>(나) {</span>
<span id="cb36-9"><a aria-hidden="true" href="#cb36-9" tabindex="-1"></a>그리드<span class="ot">=</span> <span class="fu">~와 함께</span>(배아,</span>
<span id="cb36-10"><a aria-hidden="true" href="#cb36-10" tabindex="-1"></a>    <span class="fu">확장 .grid</span>(<span class="at">x =</span> <span class="fu">make1dgrid</span>(<span class="fu">얻다</span>(한 쌍[<span class="dv">1</span>, 나])),</span>
<span id="cb36-11"><a aria-hidden="true" href="#cb36-11" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">make1dgrid</span>(<span class="fu">얻다</span>(한 쌍[<span class="dv">2</span>, 나]))))<span class="sc">|&gt;</span></span>
<span id="cb36-12"><a aria-hidden="true" href="#cb36-12" tabindex="-1"></a>    <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(쌍 [, i])</span>
<span id="cb36-13"><a aria-hidden="true" href="#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a aria-hidden="true" href="#cb36-14" tabindex="-1"></a>  <span class="cf">~을 위한</span>(다섯<span class="cf">~에</span> <span class="fu">세트 디프</span>(변수, 쌍 [, i])))</span>
<span id="cb36-15"><a aria-hidden="true" href="#cb36-15" tabindex="-1"></a>그리드 [[V]]<span class="ot">=</span> <span class="fu">중앙값</span>(Embryocells [[V]])</span>
<span id="cb36-16"><a aria-hidden="true" href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a aria-hidden="true" href="#cb36-17" tabindex="-1"></a>그리드<span class="sc">$</span>에다트<span class="ot">=</span> <span class="fu">예측하다</span>(EC_QDA,<span class="at">NewData =</span>그리드)<span class="sc">$</span>수업</span>
<span id="cb36-18"><a aria-hidden="true" href="#cb36-18" tabindex="-1"></a></span>
<span id="cb36-19"><a aria-hidden="true" href="#cb36-19" tabindex="-1"></a>엑스<span class="ot">&lt;-</span>한 쌍[<span class="dv">1</span>,나]</span>
<span id="cb36-20"><a aria-hidden="true" href="#cb36-20" tabindex="-1"></a>와이<span class="ot">&lt;-</span>한 쌍[<span class="dv">2</span>,나]</span>
<span id="cb36-21"><a aria-hidden="true" href="#cb36-21" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb36-22"><a aria-hidden="true" href="#cb36-22" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb36-23"><a aria-hidden="true" href="#cb36-23" tabindex="-1"></a>      <span class="at">데이터 =</span>배아 셀,</span>
<span id="cb36-24"><a aria-hidden="true" href="#cb36-24" tabindex="-1"></a>      <span class="fu">AES</span>(<span class="at">x =</span>.data [[x]],<span class="at">y =</span>.Data [[및]],<span class="at">색상 =</span>배아 .day)</span>
<span id="cb36-25"><a aria-hidden="true" href="#cb36-25" tabindex="-1"></a>))<span class="sc">+</span></span>
<span id="cb36-26"><a aria-hidden="true" href="#cb36-26" tabindex="-1"></a>    <span class="fu">geom_raster</span>(</span>
<span id="cb36-27"><a aria-hidden="true" href="#cb36-27" tabindex="-1"></a>      <span class="fu">AES</span>(<span class="at">x =</span>.data [[x]],<span class="at">y =</span>.Data [[및]],<span class="at">fill =</span>Edhat),</span>
<span id="cb36-28"><a aria-hidden="true" href="#cb36-28" tabindex="-1"></a>      <span class="at">데이터 =</span>그리드,<span class="at">알파 =</span> <span class="fl">0.4</span>,,,<span class="at">보간 =</span> <span class="cn">진실</span></span>
<span id="cb36-29"><a aria-hidden="true" href="#cb36-29" tabindex="-1"></a>))<span class="sc">+</span></span>
<span id="cb36-30"><a aria-hidden="true" href="#cb36-30" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb36-31"><a aria-hidden="true" href="#cb36-31" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb36-32"><a aria-hidden="true" href="#cb36-32" tabindex="-1"></a>    <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb36-33"><a aria-hidden="true" href="#cb36-33" tabindex="-1"></a>    <span class="cf">만약에</span>(나<span class="sc">! =</span> <span class="fu">NCOL</span>(한 쌍))<span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span> <span class="st">"없음"</span>))</span>
<span id="cb36-34"><a aria-hidden="true" href="#cb36-34" tabindex="-1"></a>}) <span class="sc">|&gt;</span>(\(g)<span class="fu">Grid.arrange</span>(<span class="at">grobs =</span>g,<span class="at">NCOL =</span> <span class="dv">2</span>) ()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-qdamouse-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qdamouse-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="12-chap_files/figure-html/fig-qdamouse-1-1.png" title="Figure 12.10: QDA for the mouse cell data. Shown are all pairwise plots of the four features. In each plot, the other two features are set to the median."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-qdamouse-1-1.png" width="720"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qdamouse-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.10 : 마우스 셀 데이터의 QDA. 표시는 모두 네 가지 기능의 쌍별 플롯입니다. 각 플롯에서 다른 두 가지 기능은 중앙값으로 설정됩니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-qdamany">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.9</div>
</div>
<div class="callout-body-container callout-body">
<p>전화하면 어떻게됩니까?<code>LDA</code>또는<code>비</code>Hiiragi 데이터 세트에서 가장 많은 유전자가 처음 1000을 말합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-18-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-18-contents callout-collapse collapse" id="callout-18">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center" data-warning.known="variables are collinear">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="fu">LDA</span>(<span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스))[,<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>], x<span class="sc">$</span>배아 .day)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="fu">경고</span>()</span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a><span class="fu">비</span>(<span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스))[,<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>], x<span class="sc">$</span>배아 .day)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>QDA.Default (X, Grouping, ...)의 오류 : 일부 그룹은 'QDA'에 비해 너무 작습니다.</code></pre>
</div>
</div>
<p>그만큼<code>LDA</code>함수는 모델에 맞게 관리되지만 복제보다 변수가 더 많다는 사실에 대해 (경고와 함께) (경고와 함께) 변수가 선형 독립적이지 않으므로 서로 중복됩니다. 그만큼<code>비</code>기능이 많은 파라미터를 가진 QDA 모델은 사용 가능한 데이터에서 장착 할 수 없기 때문에 기능은 오류가 발생합니다 (적어도 정규화되지 않은 일종의 정규화와 같은 추가 가정 없이는).</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="12.4" id="machine-learning-vs-rote-learning">
<h2 class="anchored" data-anchor-id="machine-learning-vs-rote-learning" data-number="12.4"><span class="header-section-number">12.4</span>머신 러닝 대 Rote 학습</h2>
<p>컴퓨터는 사실을 암기하는 데 정말 능숙합니다. 최악의 경우 머신 러닝 알고리즘은이 작업을 수행하는 로터리 방법입니다.<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>. 그러나 통계 학습의 중심 목표는입니다<em>일반화 가능성</em>. 우리는 미래 데이터에 대한 좋은 예측을하기 위해 주어진 데이터에서 보간 및 외삽 할 수있는 알고리즘을 원합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>그다지 원형이 아닌 방식은 데이터베이스 기술입니다.</p></div></div><p>다음 예를 살펴 보겠습니다. 우리는 랜덤 데이터를 생성합니다 (<code>rnorm</code>) 을 위한<code>N</code>다른 수의 기능을 갖춘 객체 (<code>피</code>). 우리는이 데이터에 대해 LDA를 훈련시키고<strong>오 분류율</strong>, 즉, 예측의 비율이 잘못되었습니다 (<code>전에! 각각</code>).</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="variables are collinear">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" href="#cb40-1" tabindex="-1"></a>피<span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">21</span></span>
<span id="cb40-2"><a aria-hidden="true" href="#cb40-2" tabindex="-1"></a>N<span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb40-3"><a aria-hidden="true" href="#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a aria-hidden="true" href="#cb40-4" tabindex="-1"></a>MCL<span class="ot">=</span> <span class="fu">lapply</span>(피,<span class="cf">기능</span>(pp) {</span>
<span id="cb40-5"><a aria-hidden="true" href="#cb40-5" tabindex="-1"></a>  <span class="fu">뒤로 젖히다</span>(<span class="dv">100</span>, {</span>
<span id="cb40-6"><a aria-hidden="true" href="#cb40-6" tabindex="-1"></a>xmat<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span>pp),<span class="at">nrow =</span>N)</span>
<span id="cb40-7"><a aria-hidden="true" href="#cb40-7" tabindex="-1"></a>resp<span class="ot">=</span> <span class="fu">견본</span>(<span class="fu">기음</span>(<span class="st">"사과"</span>,,,<span class="st">"주황색"</span>), N,<span class="at">교체 =</span> <span class="cn">진실</span>))</span>
<span id="cb40-8"><a aria-hidden="true" href="#cb40-8" tabindex="-1"></a>맞다<span class="ot">=</span> <span class="fu">LDA</span>(xmat, resp)</span>
<span id="cb40-9"><a aria-hidden="true" href="#cb40-9" tabindex="-1"></a>~ 전에<span class="ot">=</span> <span class="fu">예측하다</span>(맞다)<span class="sc">$</span>수업</span>
<span id="cb40-10"><a aria-hidden="true" href="#cb40-10" tabindex="-1"></a>    <span class="fu">평균</span>(전에<span class="sc">! =</span>resp)</span>
<span id="cb40-11"><a aria-hidden="true" href="#cb40-11" tabindex="-1"></a>  }) <span class="sc">|&gt;</span> <span class="fu">평균</span>() <span class="sc">|&gt;</span>(\(엑스)<span class="fu">티블</span>(<span class="at">mcl =</span>엑스,<span class="at">p =</span>pp)) ()</span>
<span id="cb40-12"><a aria-hidden="true" href="#cb40-12" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a><span class="fu">ggplot</span>(MCL,<span class="fu">AES</span>(<span class="at">x =</span>피,<span class="at">y =</span>MCL))<span class="sc">+</span> </span>
<span id="cb41-2"><a aria-hidden="true" href="#cb41-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-3"><a aria-hidden="true" href="#cb41-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"오 분류율"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-learnbyheart-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-learnbyheart-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="12-chap_files/figure-html/fig-learnbyheart-1-1.png" title="Figure 12.11: Misclassification rate of LDA applied to random data. While the number of observations n is held constant (at 20), we are increasing the number of features p starting from 2 up to 21. The misclassification rate becomes almost zero as p approaches 20. The LDA model becomes so elaborate and over-parameterized that it manages to learn the random labels “by heart”. (As p becomes even larger, the “performance” degrades again somewhat, apparently due to numerical properties of the lda implementation used here.)"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-learnbyheart-1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-learnbyheart-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.11 : 랜덤 데이터에 적용되는 LDA의 오 분류 속도. 관찰 수<code>N</code>일정하게 유지되며 (20 세), 우리는 기능의 수를 늘리고 있습니다.<code>피</code>2에서 21까지 시작합니다. 오 분류율은 거의 0이됩니다.<code>피</code>LDA 모델은 너무 정교 해지고 가변화되어 임의의 라벨을“마음으로”배우도록 관리합니다. (처럼<code>피</code>더 커지면 "성능"은 다시 다소 저하됩니다.<code>LDA</code>여기에 사용 된 구현.)</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-replicate">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.10</div>
</div>
<div class="callout-body-container callout-body">
<p>의 목적은 무엇입니까<code>뒤로 젖히다</code>위 코드에서 루프? 생략하면 (또는 100을 1로 교체하면) 어떻게됩니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-20-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-20-contents callout-collapse collapse" id="callout-20">
<div class="callout-body-container callout-body">
<p>각 단일 복제에 대해 곡선은 소음이 많은 버전입니다.<a class="quarto-xref" href="#fig-learnbyheart-1">수치<span>12.11</span></a>. 측정 된 오 분류 속도를 평균 100 개 이상의 복제물을 통해 추정치를 더 안정적으로 만듭니다. 시뮬레이션 된 데이터로 작업하기 때문에이 작업을 수행 할 수 있습니다.</p>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-learnbyheart-1">수치<span>12.11</span></a>복잡한 모델에만 적합하면, 많은 매개 변수가있는 경우에만 랜덤 데이터에서 임의의 라벨을 완벽하게 예측할 수 있음을 암시하는 것 같습니다. 그러한 터무니없는 결론을 어떻게 극복 할 수 있습니까? 위의 코드의 문제점은 모델 성능이 교육 된 동일한 데이터에 대해 평가된다는 것입니다. 이것은 일반적 으로이 Crass 예에서 볼 수 있듯이 긍정적 인 편향으로 이어집니다. 이 문제를 어떻게 극복 할 수 있습니까? 핵심 아이디어는 모델이 훈련 된 것과 다른 데이터의 모델 성능을 평가하는 것입니다.</p>
<section class="level3 page-columns page-full" data-number="12.4.1" id="sec-supervised-xval">
<h3 class="anchored" data-anchor-id="sec-supervised-xval" data-number="12.4.1"><span class="header-section-number">12.4.1</span>교차 검증</h3>
<p>순진한 접근법은 데이터를 두 개의 반쪽으로 분할하고 학습에 전반전 (“훈련”)과 평가를 위해 하반기 (“테스트”)를 사용하는 것일 수 있습니다. 이것은 불필요하게 가변적이고 불필요하게 비효율적이라는 것이 밝혀졌습니다. 데이터를 한 번만 분할함으로써 분할이 떨어지는 방식에 의해 우리의 결과가 상당히 영향을받을 수 있기 때문에 불필요하게 가변적입니다. 분할을 여러 번, 평균화하는 것이 더 낫습니다. 이것은 우리에게 더 안정적인 결과를 줄 것입니다. 머신 러닝 알고리즘의 성능은 관찰 수에 따라 달라지고 데이터의 절반에서 측정 된 성능이 가능하기 때문에 불필요하게 비효율적입니다.<a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>모든 데이터보다 더 나쁘다. 이러한 이유로, 불평등 한 크기의 교육 및 테스트 데이터를 사용하는 것이 좋습니다. 극단적 인 경우, 우리는만큼 많이 사용할 것입니다<span class="math inline">\ (n-1 \)</span>훈련을위한 관찰 및 테스트를위한 나머지 관찰. 모든 관찰과 마찬가지로이 작업을 수행 한 후에는 성능 메트릭을 평균화 할 수 있습니다. 이것을 불립니다<strong>떠나는 교차 검증</strong>.</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>우리가 그처럼 과도한 데이터를 가지고 있지 않으면 문제가되지 않습니다.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="imgs/book_icon.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">챕터를 참조하십시오<em>모델 평가 및 선택</em>이 책에서<span class="citation" data-cites="HastieTibshiraniFriedman">Hastie, Tibshirani 및 Friedman (<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">2008</a>))</span>이러한 트레이드 오프에 대한 추가 논의.</span></div></div>
<p>대안은<strong><span class="math inline">\(케이\)</span>-교차 검증</strong>, 관찰이 주변의 크기의 훈련 세트로 반복적으로 분할되는 곳<span class="math inline">\ (n (k-1)/k \)</span>그리고 주변의 크기의 테스트 세트<span class="math inline">\ (n/k \)</span>. 두 대안 모두 장단제와 콘트라를 가지고 있으며 보편적으로 최선의 선택은 없습니다. 휴가의 장점은 교육에 사용되는 데이터의 양이 최대로 이용 가능한 데이터에 가깝다는 것입니다. 샘플 크기가 제한되고 알고리즘의“모든 작은 문제”가있는 경우 특히 중요합니다. 휴가의 단점은 훈련 세트가 모두 매우 유사하므로 새로운 데이터 세트가 등장하면 예상 할 샘플링의 종류를 충분히 잘 모델링하지 않을 수 있습니다. 큰 경우<span class="math inline">\(N\)</span>, 떠나는 교차 검증은 불필요하게 시간이 많이 걸릴 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="variables are collinear">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a>추정 _mcl_loocv<span class="ot">=</span> <span class="cf">기능</span>(x, resp) {</span>
<span id="cb42-2"><a aria-hidden="true" href="#cb42-2" tabindex="-1"></a>  <span class="fu">vapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(엑스)),<span class="cf">기능</span>(나) {</span>
<span id="cb42-3"><a aria-hidden="true" href="#cb42-3" tabindex="-1"></a>맞다<span class="ot">=</span> <span class="fu">LDA</span>(엑스[<span class="sc">-</span>i,], resp [<span class="sc">-</span>나])</span>
<span id="cb42-4"><a aria-hidden="true" href="#cb42-4" tabindex="-1"></a>ptrn<span class="ot">=</span> <span class="fu">예측하다</span>(맞다,<span class="at">NewData =</span>엑스[<span class="sc">-</span>나,,<span class="at">드롭 =</span> <span class="cn">거짓</span>])))<span class="sc">$</span>수업</span>
<span id="cb42-5"><a aria-hidden="true" href="#cb42-5" tabindex="-1"></a>PTST<span class="ot">=</span> <span class="fu">예측하다</span>(맞다,<span class="at">NewData =</span>x [i ,,<span class="at">드롭 =</span> <span class="cn">거짓</span>])))<span class="sc">$</span>수업</span>
<span id="cb42-6"><a aria-hidden="true" href="#cb42-6" tabindex="-1"></a>    <span class="fu">기음</span>(<span class="at">기차 =</span> <span class="fu">평균</span>(ptrn<span class="sc">! =</span>resp [<span class="sc">-</span>나]),<span class="at">테스트 =</span>(PTST<span class="sc">! =</span>resp [i]))</span>
<span id="cb42-7"><a aria-hidden="true" href="#cb42-7" tabindex="-1"></a>  }, <span class="at">fun.value =</span> <span class="fu">숫자</span>(<span class="dv">2</span>)))<span class="sc">|&gt;</span> <span class="fu">Rowmeans</span>() <span class="sc">|&gt;</span> <span class="fu">티</span>() <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb42-8"><a aria-hidden="true" href="#cb42-8" tabindex="-1"></a>}</span>
<span id="cb42-9"><a aria-hidden="true" href="#cb42-9" tabindex="-1"></a></span>
<span id="cb42-10"><a aria-hidden="true" href="#cb42-10" tabindex="-1"></a>xmat<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span> <span class="fu">마지막</span>(피)),<span class="at">nrow =</span>N)</span>
<span id="cb42-11"><a aria-hidden="true" href="#cb42-11" tabindex="-1"></a>resp<span class="ot">=</span> <span class="fu">견본</span>(<span class="fu">기음</span>(<span class="st">"사과"</span>,,,<span class="st">"주황색"</span>), N,<span class="at">교체 =</span> <span class="cn">진실</span>))</span>
<span id="cb42-12"><a aria-hidden="true" href="#cb42-12" tabindex="-1"></a></span>
<span id="cb42-13"><a aria-hidden="true" href="#cb42-13" tabindex="-1"></a>MCL<span class="ot">=</span> <span class="fu">lapply</span>(피,<span class="cf">기능</span>(k) {</span>
<span id="cb42-14"><a aria-hidden="true" href="#cb42-14" tabindex="-1"></a>  <span class="fu">추정 _mcl_loocv</span>(xmat [,<span class="dv">1</span><span class="sc">:</span>k], resp)</span>
<span id="cb42-15"><a aria-hidden="true" href="#cb42-15" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> <span class="fu">데이터. 프레임</span>(피)<span class="sc">|&gt;</span> <span class="fu">녹다</span>(<span class="at">id.var =</span> <span class="st">"피"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a><span class="fu">ggplot</span>(MCL,<span class="fu">AES</span>(<span class="at">x =</span>피,<span class="at">y =</span>값,<span class="at">col =</span>변하기 쉬운))<span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb43-2"><a aria-hidden="true" href="#cb43-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"오 분류율"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mclcv-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mclcv-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="12-chap_files/figure-html/fig-mclcv-1-1.png" title="Figure 12.12: Cross-validation: the misclassification rate of LDA applied to random data, when evaluated on test data that were not used for learning, hovers around 0.5 independent of p. The misclassification rate on the training data is also shown. It behaves similar to what we already saw in Figure fig-learnbyheart-1."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-mclcv-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mclcv-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.12 : 교차 검증 : 학습에 사용되지 않은 테스트 데이터에 대해 평가 될 때 무작위 데이터에 적용되는 LDA의 오 분류 속도는 약 0.5에 해당합니다.<code>피</code>. 훈련 데이터의 오 분류율도 표시됩니다. 그것은 우리가 이미 본 것과 비슷합니다<a class="quarto-xref" href="#fig-learnbyheart-1">수치<span>12.11</span></a>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-mclcv-1">수치<span>12.12</span></a>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-wiggly">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.11</div>
</div>
<div class="callout-body-container callout-body">
<p>왜 곡선이 들어 있습니까?<a class="quarto-xref" href="#fig-mclcv-1">수치<span>12.12</span></a>IN보다 더 가변 ( "Wiggly")<a class="quarto-xref" href="#fig-learnbyheart-1">수치<span>12.11</span></a>? 이것을 어떻게 극복 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-22-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-22-contents callout-collapse collapse" id="callout-22">
<div class="callout-body-container callout-body">
<p>하나의 데이터 세트 만<code>xmat</code>,,,<code>resp</code>)를 계산하는 데 사용되었습니다<a class="quarto-xref" href="#fig-mclcv-1">수치<span>12.12</span></a>, 그러나<a class="quarto-xref" href="#fig-learnbyheart-1">수치<span>12.11</span></a>, 우리는 a<code>뒤로 젖히다</code>고리. 위의 코드를 유사하게 확장하여 많은 복제 된 시뮬레이션 데이터 세트에서 오 분류 속도 곡선을 평균화 할 수 있습니다.</p>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="12.4.2" id="sec-supervised-curse">
<h3 class="anchored" data-anchor-id="sec-supervised-curse" data-number="12.4.2"><span class="header-section-number">12.4.2</span>치수의 저주</h3>
<p>~ 안에<a class="quarto-xref" href="#sec-supervised-xval"><span>섹션 12.4.1</span></a>우리는 임의의 데이터에 대한 과적과 적합성과 교차 검증을 보았지만 실제로 관련 클래스 분리가있는 경우 어떻게 보입니까?</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="variables are collinear">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a>피<span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a>MCL<span class="ot">=</span> <span class="fu">뒤로 젖히다</span>(<span class="dv">100</span>, {</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a>xmat<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span> <span class="fu">마지막</span>(피)),<span class="at">nrow =</span>N)</span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a>resp<span class="ot">=</span> <span class="fu">견본</span>(<span class="fu">기음</span>(<span class="st">"사과"</span>,,,<span class="st">"주황색"</span>), N,<span class="at">교체 =</span> <span class="cn">진실</span>))</span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a>xmat [,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]]<span class="ot">=</span>xmat [,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]]<span class="sc">+</span> <span class="fu">as.integer</span>(<span class="fu">요인</span>(resp))</span>
<span id="cb44-6"><a aria-hidden="true" href="#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a aria-hidden="true" href="#cb44-7" tabindex="-1"></a>  <span class="fu">lapply</span>(피,<span class="cf">기능</span>(k) {</span>
<span id="cb44-8"><a aria-hidden="true" href="#cb44-8" tabindex="-1"></a>    <span class="fu">추정 _mcl_loocv</span>(xmat [,<span class="dv">1</span><span class="sc">:</span>k], resp)</span>
<span id="cb44-9"><a aria-hidden="true" href="#cb44-9" tabindex="-1"></a>  }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> <span class="fu">cbind</span>(<span class="at">p =</span>피)<span class="sc">|&gt;</span> <span class="fu">녹다</span>(<span class="at">id.var =</span> <span class="st">"피"</span>))</span>
<span id="cb44-10"><a aria-hidden="true" href="#cb44-10" tabindex="-1"></a>}, <span class="at">단순화 =</span> <span class="cn">거짓</span>))<span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a>MCL<span class="ot">=</span> <span class="fu">Group_by</span>(MCL, P, 가변)<span class="sc">|&gt;</span> <span class="fu">요약</span>(<span class="at">값 =</span> <span class="fu">평균</span>(값))</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a><span class="fu">ggplot</span>(MCL,<span class="fu">AES</span>(<span class="at">x =</span>피,<span class="at">y =</span>값,<span class="at">col =</span>변하기 쉬운))<span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-4"><a aria-hidden="true" href="#cb45-4" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"오 분류율"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-curseofdim">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-curseofdim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="12-chap_files/figure-html/fig-curseofdim-1.png" title="Figure 12.13: As we increase the number of features included in the model, the misclassification rate initially improves; as we start including more and more irrelevant features, it increases again, as we are fitting noise."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-curseofdim-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-curseofdim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.13 : 모델에 포함 된 기능의 수를 늘리면 오 분류 속도가 처음 개선됩니다. 우리가 점점 더 관련이없는 기능을 포함시키기 시작함에 따라 소음에 맞아 다시 증가합니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-BiasVarianceTradeoff">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-BiasVarianceTradeoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="imgs/BiasVarianceTradeoff.png" title="Figure 12.14: Idealized version of Figure fig-curseofdim, from @HastieTibshiraniFriedman. A recurrent goal in machine learning is finding the sweet spot in the variance &lt;- bias trade-off."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BiasVarianceTradeoff.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-BiasVarianceTradeoff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.14 : 이상적인 버전<a class="quarto-xref" href="#fig-curseofdim">수치<span>12.13</span></a>, 에서<span class="citation" data-cites="HastieTibshiraniFriedman">Hastie, Tibshirani 및 Friedman (<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">2008</a>))</span>. 기계 학습의 반복 목표는 분산 &lt;- 바이어스 트레이드 오프에서 달콤한 지점을 찾는 것입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-curseofdim">수치<span>12.13</span></a>. 그룹 센터는 벡터입니다 (in<span class="math inline">\ (\ mathbb {r}^{20} \)</span>) 좌표에 의해 주어집니다<span class="math inline">\ ((1, 1, 1, 1, 1, 1, 1, 0, 0, 0, ...) \)</span>(사과) 및<span class="math inline">\ ((2, 2, 2, 2, 2, 2, 2, 0, 0, 0, ...) \)</span>(오렌지), 그리고 최적의 결정 경계는 그들 사이의 선에 직교하는 과면입니다. 을 위한<span class="math inline">\(피\)</span>보다 작습니다<span class="math inline">\ (6 \)</span>, 결정 규칙은이 과다면에 도달 할 수 없습니다. 편향되어 있습니다. 결과적으로, 오 분류율은 차선책이며<span class="math inline">\(피\)</span>. 그러나 무슨 일이 일어나는지<span class="math inline">\(피\)</span>보다 큽니다<span class="math inline">\ (6 \)</span>? 알고리즘은 원칙적으로 최적의 하이퍼 플레인을 모델링 할 수 있으며 추가 기능에 의해 산만 해지지 않아야합니다. 문제는 그것이 있다는 것입니다. 추가 기능이 많을수록 데이터 세트에 입력할수록 하나 이상의 데이터가 데이터 세트에 빠질 확률이 높아집니다.<em>보입니다</em>교육 데이터의 우수하고 차별적 인 기능 - 분류기를 오도하고 테스트 데이터에서 성능을 저하시키는 것만으로도. 곧이 문제를 제어하기 위해 처벌을 사용하는 방법을 볼 수 있습니다.</p>
<p>용어<strong>치수의 저주</strong>에 의해 만들어졌습니다<span class="citation" data-cites="Bellman:1961">벨만 (Bellman)<a href="16-chap.html#ref-Bellman:1961" role="doc-biblioref">1961</a>))</span>. 고차원 공간이 불가능하지는 않지만 철저히 샘플링하기가 매우 어렵다는 사실을 말합니다. 예를 들어, 측면 길이 1의 2 차원 제곱을 0.1 간격으로 덮으려면 필요합니다.<span class="math inline">\ (10^2 = 100 \)</span>전철기. 100 차원에서 우리는 필요합니다<span class="math inline">\ (10^{100} \)</span>- 그 이상입니다<a href="https://en.wikipedia.org/wiki/Eddington_number">우주의 양성자 수</a>. Genomics에서는 종종 수천 가지 기능을 갖춘 데이터에 모델을 맞추는 것을 목표로합니다. 또한 포인트 사이의 거리 또는 부피와 표면 사이의 관계에 대한 우리의 직관은 고차원 환경에서 분해됩니다. 다음 몇 가지 질문에서 고차원 공간의 이상한 점을 탐구 할 것입니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-hypercubesidelen">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.12</div>
</div>
<div class="callout-body-container callout-body">
<p>1,000 000 데이터 포인트가있는 데이터 세트가 있다고 가정합니다.<span class="math inline">\(피\)</span>치수. 데이터는 hybercube 장치에 균일하게 분포되어 있습니다 (즉, 모든 기능은 간격에 있습니다.<span class="math inline">\ ([0,1] \)</span>). 기능으로 10 점만 포함 할 수있는 하이버 큐브의 측면 길이는 무엇입니까?<span class="math inline">\(피\)</span>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-24-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-24-contents callout-collapse collapse" id="callout-24">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-cursedimans1-1">수치<span>12.15</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a>샛길<span class="ot">=</span> <span class="cf">기능</span>(피,<span class="at">PointDensity =</span> <span class="fl">1e6</span>,,,<span class="at">포인트 니드 =</span> <span class="dv">10</span>))</span>
<span id="cb46-2"><a aria-hidden="true" href="#cb46-2" tabindex="-1"></a>(포인트 니드<span class="sc">/</span>PointDensity)<span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span>피)</span>
<span id="cb46-3"><a aria-hidden="true" href="#cb46-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">p =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>,,,<span class="at">측면 길이 =</span> <span class="fu">샛길</span>(피)),</span>
<span id="cb46-4"><a aria-hidden="true" href="#cb46-4" tabindex="-1"></a>       <span class="fu">AES</span>(<span class="at">x =</span>피,<span class="at">y =</span>샛길))<span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">"빨간색"</span>))<span class="sc">+</span></span>
<span id="cb46-5"><a aria-hidden="true" href="#cb46-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">AES</span>(<span class="at">yintercept =</span> <span class="dv">1</span>),)<span class="at">lineType =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cursedimans1-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cursedimans1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="12-chap_files/figure-html/fig-cursedimans1-1-1.png" title="Figure 12.15: Side length of a p-dimensional hybercube expected to contain 10 points out of 1 million uniformly distributed ones, as a function of the p. While for p=1, this length is conveniently small, namely 10/10^6=10^{-5}, for larger p it approaches 1, i.,e., becomes the same as the range of each the features. This means that a “local neighborhood” of 10 points encompasses almost the same data range as the whole dataset."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-cursedimans1-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cursedimans1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.15 : a의 측면 길이<span class="math inline">\(피\)</span>-차원 하이버 큐브는<span class="math inline">\(피\)</span>. 동안<span class="math inline">\ (p = 1 \)</span>,이 길이는 편리하게 작습니다<span class="math inline">\ (10/10^6 = 10^{-5} \)</span>더 큰<span class="math inline">\(피\)</span>1, i., e.에 접근하면 각 기능의 범위와 동일하게됩니다. 이는 10 포인트의 "지역 이웃"이 전체 데이터 세트와 거의 동일한 데이터 범위를 포함한다는 것을 의미합니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>다음으로 기능 공간의 내부 영역과 경계 영역 사이의 관계를 살펴 보겠습니다. 일반적으로, 피처 공간의 경계에서의 예측은 보간보다는 추정을 포함하는 경향이 있기 때문에 내부보다 더 어렵다. 다음 질문에서는 기능 공간 차원으로 이러한 어려움이 어떻게 폭발하는지 알 수 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-hypercubevolfrac">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.13</div>
</div>
<div class="callout-body-container callout-body">
<p>단위 큐브의 총 부피의 어느 부분이 치수의 함수로서 표면에 0.01보다 가깝습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-26-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-26-contents callout-collapse collapse" id="callout-26">
<div class="callout-body-container callout-body">
<p>아래 코드를 참조하십시오<a class="quarto-xref" href="#fig-cursedimans2-1">수치<span>12.16</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" href="#cb47-1" tabindex="-1"></a><span class="fu">티블</span>(</span>
<span id="cb47-2"><a aria-hidden="true" href="#cb47-2" tabindex="-1"></a>  <span class="at">p =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>,,,</span>
<span id="cb47-3"><a aria-hidden="true" href="#cb47-3" tabindex="-1"></a>  <span class="at">VolouterCube =</span> <span class="dv">1</span> <span class="sc">^</span>피,</span>
<span id="cb47-4"><a aria-hidden="true" href="#cb47-4" tabindex="-1"></a>  <span class="at">VolinnerCube =</span> <span class="fl">0.98</span> <span class="sc">^</span>피,<span class="co"># 0.98 = 1-2 * 0.01</span></span>
<span id="cb47-5"><a aria-hidden="true" href="#cb47-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">v (쉘)</span><span class="st">`</span> <span class="ot">=</span>VolouterCube<span class="sc">-</span>VolinnerCube)<span class="sc">|&gt;</span></span>
<span id="cb47-6"><a aria-hidden="true" href="#cb47-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">x =</span>피,<span class="at">y =</span><span class="st">`</span><span class="at">v (쉘)</span><span class="st">`</span>)))<span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">"파란색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cursedimans2-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cursedimans2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="12-chap_files/figure-html/fig-cursedimans2-1-1.png" title="Figure 12.16: Fraction of a unit cube’s total volume that is in its “shell” (here operationalised as those points that are closer than 0.01 to its surface) as a function of the dimension p."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-cursedimans2-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cursedimans2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.16 : 차원의 함수로서 "쉘"(표면에 0.01보다 가까운 지점으로 작동 함)에있는 단위 큐브의 총 볼륨의 비율<span class="math inline">\(피\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-cv">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.14</div>
</div>
<div class="callout-body-container callout-body">
<p>차원의 함수로서 단위 하이퍼 큐브의 무작위로 선택된 두 지점 사이의 거리의 변동 계수 (평균에 대한 표준 편차의 비율)는 얼마입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-28-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-28-contents callout-collapse collapse" id="callout-28">
<div class="callout-body-container callout-body">
<p>우리는 이것을 시뮬레이션으로 해결합니다. 우리는 생성합니다<code>N</code>하이퍼 큐브의 임의 포인트 쌍 (<code>x1</code>,,,<code>x2</code>) 그리고 그들의 유클리드 거리를 계산하십시오. 보다<a class="quarto-xref" href="#fig-cursedimans3-1">수치<span>12.17</span></a>. 이 결과는 중심 한계 정리에서 예측할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>N<span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb48-2"><a aria-hidden="true" href="#cb48-2" tabindex="-1"></a>DF<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb48-3"><a aria-hidden="true" href="#cb48-3" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">둥근</span>(<span class="dv">10</span> <span class="sc">^</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">4</span>,,,<span class="at">by =</span> <span class="fl">0.25</span>)),</span>
<span id="cb48-4"><a aria-hidden="true" href="#cb48-4" tabindex="-1"></a>  <span class="at">CV =</span> <span class="fu">vapply</span>(피,<span class="cf">기능</span>(k) {</span>
<span id="cb48-5"><a aria-hidden="true" href="#cb48-5" tabindex="-1"></a>x1<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">runif</span>(케이<span class="sc">*</span>N),<span class="at">nrow =</span>N)</span>
<span id="cb48-6"><a aria-hidden="true" href="#cb48-6" tabindex="-1"></a>x2<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">runif</span>(케이<span class="sc">*</span>N),<span class="at">nrow =</span>N)</span>
<span id="cb48-7"><a aria-hidden="true" href="#cb48-7" tabindex="-1"></a>디<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">로우 섬</span>((x1<span class="sc">-</span>x2)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb48-8"><a aria-hidden="true" href="#cb48-8" tabindex="-1"></a>    <span class="fu">SD</span>(디)<span class="sc">/</span> <span class="fu">평균</span>(디)</span>
<span id="cb48-9"><a aria-hidden="true" href="#cb48-9" tabindex="-1"></a>  }, <span class="at">fun.value =</span> <span class="fu">숫자</span>(<span class="dv">1</span>))))</span>
<span id="cb48-10"><a aria-hidden="true" href="#cb48-10" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">AES</span>(<span class="at">x =</span> <span class="fu">log10</span>(피),<span class="at">y =</span>CV))<span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">"주황색"</span>))<span class="sc">+</span></span>
<span id="cb48-11"><a aria-hidden="true" href="#cb48-11" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cursedimans3-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cursedimans3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="12-chap_files/figure-html/fig-cursedimans3-1-1.png" title="Figure 12.17: Coefficient of variation (CV) of the distance between randomly picked points in the unit hypercube, as a function of the dimension. As the dimension increases, everybody is equally far away from everyone else: there is almost no variation in the distances any more."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-cursedimans3-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cursedimans3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.17 : 차원의 함수로서 단위 하이퍼 큐브에서 무작위로 선택된 지점 사이의 거리의 변동 계수 (CV). 차원이 증가함에 따라 모든 사람은 다른 사람들과 똑같이 멀리 떨어져 있습니다. 더 이상 거리의 차이가 거의 없습니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="12.5" id="sec-supervised-objective">
<h2 class="anchored" data-anchor-id="sec-supervised-objective" data-number="12.5"><span class="header-section-number">12.5</span>객관적인 기능</h2>
<p>우리는 이미 보았습니다<strong>오 분류율</strong>(MCR) 그림에서 분류 성능을 평가하는 데 사용되었습니다<a class="quarto-xref" href="#fig-learnbyheart-1"><span>12.11</span></a>-<a class="quarto-xref" href="#fig-curseofdim"><span>12.13</span></a>. 인구 버전은 다음과 같이 정의됩니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-sec" id="eq-sec-super-expmcl"><span class="math display">\ [
\ text {mcr} = \ text {e} \ left [𝟙 _ {\ hat {y} \ neq y} \ 오른쪽],
\ text {mcr} = \ text {e} \ left [𝟙 _ {\ hat {y} \ neq y} \ 오른쪽],
\ tag {12.1} \]</span></span></p>
<p>유한 한 샘플의 경우</p>
<p><span class="anchored-eq" data-anchor-id="eq-sec" id="eq-sec-super-obsmcl"><span class="math display">\ [
\ widehat {\ text {mcr}} = \ frac {1} {n} \ sum_ {i = 1}^n {\ hat {y_i} \ neq y_i}.
\ tag {12.2} \]</span></span></p>
<p>이것이 우리가 할 수있는 유일한 선택은 아닙니다. 아마도 우리는 사과의 오 분류에 대해 오렌지로서의 오 분류에 대해 더 신경을 쓸 것입니다.<a class="quarto-xref" href="#eq-sec-super-obsmcl">방정식<span class="anchored-eq" data-anchor-id="eq-sec">12.2</span></a>(또는 적분<a class="quarto-xref" href="#eq-sec-super-expmcl">방정식<span>12.1</span></a>). 두 개 이상의 수업이 있으면 더욱 정교해질 수 있습니다. 종종 우리는 전체를보고 싶어합니다<strong>혼란 테이블</strong>, 우리가 통해 얻을 수 있습니다</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a><span class="fu">테이블</span>(진실, 반응)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>중요한 특별 사례는 비대칭 비용을 가진 이진 분류입니다. 예를 들어 의료 테스트를 생각해보십시오. 여기,<strong>감광도</strong>(a.k.a.<strong>진정한 긍정적 비율</strong>또는<strong>상기하다</strong>)는 병에 걸린 건강의 잘못 분류와 관련이 있으며<strong>특성</strong>(또는<strong>진정한 부정적인 비율</strong>)는 건강한 병의 잘못 분류 가능성에 달려 있습니다. 종종, 위아래로 이동할 수있는 단일 매개 변수 (예 : 임계 값)가있어 감도와 특이성 (따라서 두 가지 유형의 오 분류 사이의 동등성) 사이의 절충이 가능합니다. 그러한 경우, 우리는 일반적으로 하나의 단일 선택 임계 값에서 분류기 성능을 알고있는 것에 만족하지 않지만 많은 (또는 모두). 이것은 이어집니다<strong>수신기 작동 특성</strong> (<strong>큰 괴조</strong>) 또는<strong>정밀 기록</strong>곡선.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-mcrspsp">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.15</div>
</div>
<div class="callout-body-container callout-body">
<p>클래스 당 오 분류율과 민감도와 특이성 사이의 정확한 관계는 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-30-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-30-contents callout-collapse collapse" id="callout-30">
<div class="callout-body-container callout-body">
<p>민감도 또는 진정한 긍정적 비율은입니다</p>
<p><span class="math display">\ [
\ text {tpr} = \ frac {\ text {tp}} {\ text {p}},
\]</span></p>
<p>어디<span class="math inline">\ (\ text {tp} \)</span>진정한 긍정적 인 수입니다<span class="math inline">\ (\ text {p} \)</span>모든 긍정적 인 수. 특이성 또는 진정한 부정적인 비율은 다음과 같습니다</p>
<p><span class="math display">\ [
\ text {spc} = \ frac {\ text {tn}} {\ text {n}},
\]</span></p>
<p>어디<span class="math inline">\ (\ text {tn} \)</span>진정한 부정적인 수입니다<span class="math inline">\ (\ text {n} \)</span>모든 부정적인 수. 참조하십시오<a class="uri" href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity">https://en.wikipedia.org/wiki/sensitivity_and_specificity</a></p>
</div>
</div>
</div>
<p>다른 비용 함수는 다음으로 계산할 수 있습니다<strong>자카르드 인덱스</strong>우리가 이미 본 것<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>.</p>
<p><span class="anchored-eq" data-anchor-id="eq-sec" id="eq-sec-super-jaccard"><span class="math display">\ [
j (a, b) = \ frac {| \, a \ cap b \, |} {| \, a \ cup b \, |},
\ tag {12.3} \]</span></span></p>
<p>어디<span class="math inline">\(에이\)</span>실제 클래스가 1 인 관찰 세트 (<span class="math inline">\ (a = \ {i \, | \, y_i = 1 \} \)</span>) 그리고<span class="math inline">\(비\)</span>예측 된 클래스가 1 인 관찰 세트입니다. 숫자<span class="math inline">\ (J \)</span>0과 1 사이이며 언제입니다<span class="math inline">\ (J \)</span>크고 두 세트의 높은 겹침을 나타냅니다. 주목하십시오<span class="math inline">\ (J \)</span>True 및 Predited Class가 0 인 관찰 수에 의존하지 않으므로 드문 이벤트를 찾는 방법의 성능을 측정하는 데 특히 적합합니다.</p>
<p>우리는 또한 형태로 제공되는 확률 계급 예측을 고려할 수 있습니다.<span class="math inline">\ (\ hat {p} (y \, | \, x) \)</span>. 이 경우, 실제 확률 분포와 추정 확률 분포 사이의 거리를 살펴보면 가능한 위험 기능이 얻을 수 있습니다. 두 클래스의 경우 유한 샘플 버전의<span class="math inline">\ (\ log \ text {loss} \)</span>~이다</p>
<p><span class="anchored-eq" data-anchor-id="eq-sec" id="eq-sec-super-logloss"><span class="math display">\ [
\ log \ text {loss} = - \ frac {1} {n} \ sum_ {i = 1}^n y_i \ log (\ hat {p} _i) + (1- y_i) \ log (1 - \ mat {p} _i),
\ tag {12.4} \]</span></span></p>
<p>어디<span class="math inline">\ (\ hat {p} _i \ in [0,1] \)</span>예측입니다<span class="math inline">\ (y_i \ in \ {0,1 \} \)</span>진실입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-21" href="imgs/devil.png" title="Note that the \log\text{loss} will be infinite if a prediction is totally confident (\hat{p}_i is exactly 0 or 1) but wrong."><img alt="Note that the \log\text{loss} will be infinite if a prediction is totally confident (\hat{p}_i is exactly 0 or 1) but wrong." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>주목하십시오<span class="math inline">\ (\ log \ text {loss} \)</span>예측이 완전히 자신감이있는 경우 무한합니다 (<span class="math inline">\ (\ hat {p} _i \)</span>정확히<span class="math inline">\ (0 \)</span>또는<span class="math inline">\ (1 \)</span>)하지만 틀렸다.</figcaption>
</figure>
</div>
</div></div></div>
<p>연속 연속 응답 변수 (회귀)의 경우 자연스러운 선택은 다음과 같습니다.<strong>평균 제곱 오류</strong> (<strong>MSE</strong>). 평균 제곱 오류입니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-sec" id="eq-sec-super-obsmse"><span class="math display">\ [
\ widehat {\ text {mse}} = \ frac {1} {n} \ sum_ {i = 1}^n (\ hat {y} _i -y_i)^2.
\ tag {12.5} \]</span></span></p>
<p>모집단 버전은 방정식에서와 같이 요약을 필수로 바꾸어 유사하게 정의됩니다.<a class="quarto-xref" href="#eq-sec-super-expmcl"><span class="anchored-eq" data-anchor-id="eq-sec">12.1</span></a>그리고<a class="quarto-xref" href="#eq-sec-super-obsmcl"><span>12.2</span></a>.</p>
<p>통계 학자 호출 함수는 방정식과 같은 기능입니다<a class="quarto-xref" href="#eq-sec-super-expmcl"><span class="anchored-eq" data-anchor-id="eq-sec">12.1</span></a>-<a class="quarto-xref" href="#eq-sec-super-obsmse"><span>12.5</span></a>다양하게 (그리고 맥락과 소인에 따라)<strong>위험 기능</strong>,,,<strong>비용 기능</strong>,,,<strong>객관적인 기능</strong><a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>통계 학습자의 평가에 전념하는 R 패키지도 있습니다.<strong><a href="https://cran.r-project.org/web/packages/metrics/">메트릭</a></strong>.</p></div></div></section>
<section class="level2 page-columns page-full" data-number="12.6" id="variancebias-trade-off">
<h2 class="anchored" data-anchor-id="variancebias-trade-off" data-number="12.6"><span class="header-section-number">12.6</span>분산-바이어스 트레이드 오프</h2>
<div class="cell page-columns page-full" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-supervised-bullseye">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-supervised-bullseye-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-supervised-bullseye" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-supervised-bullseye-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-supervised-bullseye-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-supervised-bullseye" href="imgs/TargetBias.png" title="Figure 12.18 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-supervised-bullseye" id="fig-supervised-bullseye-1" src="imgs/TargetBias.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-supervised-bullseye-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-supervised-bullseye" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-supervised-bullseye-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-supervised-bullseye-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-supervised-bullseye" href="imgs/TargetVariance.png" title="Figure 12.18 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-supervised-bullseye" id="fig-supervised-bullseye-2" src="imgs/TargetVariance.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-supervised-bullseye-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-supervised-bullseye-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.18 : 황소의 눈 (a)에서 추정치는 체계적으로 목표에서 벗어나지 만 매우 재현 가능한 방식입니다. 녹색 세그먼트는 편견을 나타냅니다. Bull 's Eye (B)에서는 올바른 장소에 중심을두고 있기 때문에 추정치가 편향되지는 않지만 분산이 높습니다. 많은 샷에서 결과를 볼 수 있으므로 두 가지 시나리오를 구별 할 수 있습니다. 우리가 한 번만 샷을하고 황소의 눈을 놓쳤다면, 그것이 바이어스 나 분산 때문인지 쉽게 알 수 없었습니다.</figcaption>
</figure>
</div>
</div>
<p>통계 학습 모델을 선택할 때 트레이드 오프를 이해하는 데 도움이되는 중요한 사실은 MSE가 두 용어의 합이라는 것입니다. 종종 우리가 선택할 수있는 선택은 다른 용어 중 하나가 아래로 내려가는 동안 다른 하나는 올라가는 것입니다. 바이어스는 모든 다른 추정치의 평균이 진실과 분산에서 얼마나 다른지를 측정합니다. 개인이 평균 값에서 얼마나 많이 흩어질 수 있는지 (<a class="quarto-xref" href="#fig-supervised-bullseye">수치<span>12.18</span></a>). 응용 프로그램에서, 우리는 종종 한 번의 샷 만 얻기 때문에 거의 목표물이되면 장기 평균이지만 오늘날 실제로는 이길 수 있습니다. 분해</p>
<p><span class="anchored-eq" data-anchor-id="eq-sec" id="eq-sec-super-biasvariancedecompose"><span class="math display">\ [
\ text {mse} = \ underbrace {\ text {var} (\ has {y})} _ {\ text {variance}}
+ \ underbrace {\ mathbb {e} [\ has {y} -y]^2} _ {\ text {bias}}
\ day {12.6} \]</span></span></p>
<p>간단한 대수로 따릅니다.</p>
<p>MSE를 최소화하려고 할 때, 때때로 우리는 작은 편견의 가격을 지불하여 분산을 크게 줄이고 전반적으로 MSE를 개선 할 수 있다는 것을 인식하는 것이 중요합니다. 우리는 이미 수축 추정을 만났습니다<a class="quarto-xref" href="08-chap.html"><span class="anchored-eq" data-anchor-id="eq-sec">8 장</span></a>. 분류에서 (즉, 범주 형 응답 변수가있을 때) MSE와는 다른 목적 함수가 사용되며 일반적으로<a class="quarto-xref" href="#eq-sec-super-biasvariancedecompose">방정식<span>12.6</span></a>. 좋은 소식은 일반적으로 분산에 대한 거래 편견에 대한 지속적인 대응의 경우보다 훨씬 더 나아갈 수 있다는 것입니다. 응답의 불연속성이 특정 편견을 흡수하기 때문입니다.<span class="citation" data-cites="friedmanbiasvariance01">(<a href="16-chap.html#ref-friedmanbiasvariance01" role="doc-biblioref">Friedman 1997</a>))</span>, 더 높은 바이어스 비용은 거의 0이지만, 우리는 여전히 더 나은 (더 작은) 분산의 이점을 얻습니다.</p>
<section class="level3 page-columns page-full" data-number="12.6.1" id="penalization">
<h3 class="anchored" data-anchor-id="penalization" data-number="12.6.1"><span class="header-section-number">12.6.1</span>처벌</h3>
<p>고차원 통계에서 우리는 끊임없이 분산에 시달리고 있습니다. 가능한 모든 매개 변수에 맞는 데이터가 충분하지 않습니다. 고차원 통계에서 가장 유익한 아이디어 중 하나는<strong>처벌</strong>: 분산 바이아스 트레이드 오프를 적극적으로 제어하고 이용하는 도구. 처벌은 안정적인 추정치를 보장하는 데 사용되는 더 큰 정규화 방법의 일부입니다.</p>
<p>LDA의 일반화로의 고차원 설정이 가능하지만 가능합니다<span class="citation" data-cites="clemmensen2012sparse witten2011penalized">(<a href="16-chap.html#ref-clemmensen2012sparse" role="doc-biblioref">Clemmensen et al. 2011</a>; <a href="16-chap.html#ref-witten2011penalized" role="doc-biblioref">Witten and Tibshirani 2011</a>))</span>, 로지스틱 회귀 분석은보다 일반적인 접근법이라는 것이 밝혀졌습니다.<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>따라서 이제<strong><a href="https://cran.r-project.org/web/packages/glmnet/">glmnet</a></strong>패키지.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>그것은 우리가 만난 일반화 된 선형 모델의 프레임 워크에 맞습니다.<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>.</p></div></div><p>다국적 또는 두 가지 클래스의 특별한 경우, 이항식 이론적 회귀 모델, 후방 로그 오드 사이<span class="math inline">\(케이\)</span>수업 및 양식으로 작성할 수 있습니다 (섹션 참조<em>로지스틱 회귀</em>이 책에서<span class="citation" data-cites="HastieTibshiraniFriedman">Hastie, Tibshirani 및 Friedman (<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">2008</a>))</span>보다 완전한 프리젠 테이션) :</p>
<p><span class="anchored-eq" data-anchor-id="eq-super" id="eq-super-deflogregress"><span class="math display">\ [
\ log \ frac {p (y = i \, | \, x = x)} {p (y = k \, | \, x = x)} = \ beta^0_i + \ beta_i x,
\ tag {12.7} \]</span></span></p>
<p>어디<span class="math inline" data-anchor-id="eq-super">\ (i = 1, ..., k-1 \)</span>다른 클래스와<span class="math inline">\(케이\)</span>-th 클래스는 참조로 선택됩니다. 데이터 매트릭스<span class="math inline">\(엑스\)</span>치수가 있습니다<span class="math inline">\ (n \ times p \)</span>, 어디<span class="math inline">\(N\)</span>관찰의 수입니다<span class="math inline">\(피\)</span>기능의 수. 그만큼<span class="math inline">\(피\)</span>-차원 벡터<span class="math inline">\ (\ beta_i \)</span>클래스의 분류 가능성을 결정합니다<span class="math inline">\(나\)</span>대 수업<span class="math inline">\(케이\)</span>의존합니다<span class="math inline">\(엑스\)</span>. 숫자<span class="math inline">\ (\ beta^0_i \)</span>클래스의 이전 확률에 따라 가로 채고 의존합니다. 로그 확률 대신<a class="quarto-xref" href="#eq-super-deflogregress"><span>12.7</span></a>(즉, 클래스 확률의 비율), 우리는 또한 클래스 확률 자체에 동등한 모델을 기록 할 수 있으며, 여기서 우리가 여기에서 사용했다는 사실을<span class="math inline">\(케이\)</span>-참조로서의 클래스는이 선택에 따라 모델 추정치가 동등하기 때문에 임의의 선택입니다.<span class="citation" data-cites="HastieTibshiraniFriedman">(<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">Hastie, Tibshirani 및 Friedman 2008</a>))</span>. 이 모델은 로그-원성을 최대화하여 적합합니다<span class="math inline">\ (\ (\ mathcal {l} (\ beta, \ beta^0; x) \)</span>, 어디<span class="math inline">\ (\ beta = (\ beta_1, ..., \ beta_ {k-1}) \) \)</span>그리고 유사하게<span class="math inline">\ (\ beta^0 \)</span>.</p>
<p>지금까지 너무 좋아. 그러나 AS<span class="math inline">\(피\)</span>더 커지면 데이터에서 임의의 샘플링이 발생하기 때문에 일부 추정치가 크게 떨어질 가능성이 높아집니다 (기억하십시오.<a class="quarto-xref" href="#fig-overfitting-1">수치<span>12.1</span></a>). 벡터의 각 개별 좌표에 대해서도 마찬가지입니다.<span class="math inline">\ (\ beta_i \)</span>, 오류 분포가 제한되어 있습니다 : 멀리 꼬리에있는 하나의 좌표가있는 확률은 더 많은 좌표가 증가할수록 더 클수록 더 클수록.<span class="math inline">\(피\)</span>이다.</p>
<p>관련 문제도 발생할 수 있습니다<a class="quarto-xref" href="#eq-super-deflogregress"><span>12.7</span></a>그러나 다른 비선형 모델에서는 모델 차원으로<span class="math inline">\(피\)</span>샘플 크기 동안 증가합니다<span class="math inline">\(N\)</span>최대 주위의 우도 환경이 점점 평평 해지고 모델 매개 변수의 최대 유명한 추정치가 점점 더 가변적이됩니다. 결국, 최대 값은 더 이상 점수가 아니라 하위 관리이며 최대 가능성 추정치는 알 수 없습니다. 이 두 가지 한계는 목표를 수정하여 극복 할 수 있습니다. Bare Log-Orcelihood를 최대화하는 대신 처벌 된 버전을 최대화합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-super" id="eq-super-penll"><span class="math display">\ [
\ hat {\ beta} = \ arg \ max_ \ beta \ mathcal {l} (\ beta, \ beta^0; x) + \ lambda \ OperatorName {pen} (\ beta),
\ tag {12.8} \]</span></span></p>
<p>어디<span class="math inline">\ (\ lambda \ ge0 \)</span>실수입니다<span class="math inline">\ (\ OperatorName {pen} \)</span>볼록 함수입니다<strong>페널티 기능</strong>. 인기있는 선택입니다<span class="math inline">\ (\ OperatorName {pen} (\ beta) = | \ beta |^2 \)</span> (<strong>릿지 회귀</strong>) 그리고<span class="math inline">\ (\ OperatorName {pen} (\ beta) = | \ beta |^1 \)</span> (<strong>올가미</strong>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-24" href="imgs/devil.png" title="Here, |\beta|^\nu=\sum_i\beta_i^\nu is the L_\nu-norm of the vector \beta. Variations are possible, for instead we could include in this summation only some but not all of the elements of \beta; or we could scale different elements differently, for instance based on some prior belief of their scale and importance."><img alt="Here, |\beta|^\nu=\sum_i\beta_i^\nu is the L_\nu-norm of the vector \beta. Variations are possible, for instead we could include in this summation only some but not all of the elements of \beta; or we could scale different elements differently, for instance based on some prior belief of their scale and importance." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>여기,<span class="math inline">\ (| \ beta |^\ now = \ sum_i \ beta_i^\ now \)</span>입니다<span class="math inline">\ (l_ \ no \)</span>-벡터의 Norm<span class="math inline">\(\베타\)</span>. 변형이 가능합니다. 대신에 우리는이 요약에 일부만 포함 할 수 있지만 모든 요소 만 포함 할 수 있습니다.<span class="math inline">\(\베타\)</span>; 또는 예를 들어, 규모와 중요성에 대한 사전 믿음에 따라 다른 요소를 다르게 확장 할 수 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>에서<strong>탄성 그물</strong>, Ridge와 Lasso는 페널티 기능을 사용하여 혼성화됩니다.<span class="math inline">\ (\ OperatorName {pen} (\ beta) = (1- \ alpha) | \ beta |^1+\ alpha | \ beta |^2 \)</span>몇 가지 더 매개 변수가 있습니다<span class="math inline">\ (\ alpha \ in [0,1] \)</span>. Crux는 물론 권리를 선택하는 방법입니다.<span class="math inline">\ (\ lambda \)</span>그리고 우리는 다음과 같이 논의 할 것입니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="12.6.2" id="example-predicting-colon-cancer-from-stool-microbiome-composition">
<h3 class="anchored" data-anchor-id="example-predicting-colon-cancer-from-stool-microbiome-composition" data-number="12.6.2"><span class="header-section-number">12.6.2</span>예 : 대변 미생물 군집 조성에서 결장암 예측</h3>
<p><span class="citation" data-cites="Zeller:MSB:2014">Zeller et al. (<a href="16-chap.html#ref-Zeller:MSB:2014" role="doc-biblioref">2014</a>))</span>결장 직장암 환자 및 종양이없는 대조군을 포함하는 156 명의 인간의 대변 샘플로부터의 메타고놈 시퀀싱 데이터를 연구했다. 그들의 목표는 그들이 조기 종양 검출에 도움이 될 수있는 바이오 마커 (특정 분류의 존재 또는 풍부함)를 식별 할 수 있는지 여부를 확인하는 것이었다. 데이터는 제공됩니다<a href="https://www.bioconductor.org">생체 전도체</a>그것을 통해<strong>실험용</strong>식별자 EH361에 따른 서비스.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ExperimentHub"</span>))</span>
<span id="cb50-2"><a aria-hidden="true" href="#cb50-2" tabindex="-1"></a>뭐라고<span class="ot">=</span> <span class="fu">실험용</span>()</span>
<span id="cb50-3"><a aria-hidden="true" href="#cb50-3" tabindex="-1"></a>젤러<span class="ot">=</span>뭐라고[[<span class="st">"EH361"</span>]]]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a><span class="fu">테이블</span>(Zeller<span class="sc">$</span>질병)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>암 큰 _adenoma n small_adenoma 
           53 15 61 27</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-ehexplore">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.16</div>
</div>
<div class="callout-body-container callout-body">
<p>탐구하십시오<code>뭐라고</code>다른 데이터 세트가 무엇인지 확인하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-32-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-32-contents callout-collapse collapse" id="callout-32">
<div class="callout-body-container callout-body">
<p>유형<code>뭐라고</code>R 프롬프트에 들어가 출력을 연구하십시오.</p>
</div>
</div>
</div>
<p>다음에 대해서는 정상 및 암 샘플에 초점을 맞추고 선종을 제쳐두고 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" href="#cb53-1" tabindex="-1"></a>셀<span class="ot">=</span>Zeller [, Zeller<span class="sc">$</span>질병<span class="sc">%안에%</span> <span class="fu">기음</span>(<span class="st">"N"</span>,,,<span class="st">"암"</span>))]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>모델 피팅에 뛰어 들기 전에 항상 데이터를 탐색하는 것이 좋습니다. 먼저 샘플 주석을 살펴 보겠습니다. 다음 코드는 무작위로 선택된 3 개의 샘플에서 데이터를 인쇄합니다. (첫 번째 것만보고 R 기능으로 말하십시오.<code>머리</code>, 또한 옵션이지만 전체 데이터 세트를 대표하지 않을 수 있습니다).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a><span class="fu">PDATA</span>(Zellernc) [<span class="fu">견본</span>(<span class="fu">NCOL</span>(Zellernc),<span class="dv">3</span>),]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>주제 연령대 성별 BMI 국가 ​​질병 TNM_STAGE
CCIS50148151st-4-0 FR-503 87 여성 15 프랑스 암 T2N1m0
CCIS16383318st-4-0 FR-139 61 여성 24 프랑스 N &lt;na&gt;
CCIS95097901st-4-0 FR-696 52 남성 24 프랑스 N &lt;na&gt;
                   AJCC_STAGE 현지화 FOBT WIF-1_GENE_METHYLATION_TEST
CCIS50148151st-4-0 III RC 음성 음성
CCIS16383318ST-4-0 &lt;NA&gt; &lt;NA&gt; 네거티브 네거티브
CCIS95097901st-4-0 &lt;NA&gt; &lt;NA&gt; 음성 음성
                     그룹 바디 사이트 민족 번호 _READS
CCIS50148151st-4-0 CRC 대변 화이트 54709150
CCIS16383318st-4-0 제어 대변 흰색 78085760
CCIS95097901st-4-0 컨트롤 대변 화이트 51567166</code></pre>
</div>
</div>
<p>다음으로 기능 이름을 살펴 보겠습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-25" href="imgs/devil.png" title="We define the helper function formatfn to line wrap these long character strings for the available space here."><img alt="We define the helper function formatfn to line wrap these long character strings for the available space here." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>우리는 도우미 기능을 정의합니다<code>formatfn</code>이용 가능한 공간을 위해이 긴 캐릭터 문자열을 감싸십시오.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a>formatfn<span class="ot">=</span> <span class="cf">기능</span>(엑스)</span>
<span id="cb56-2"><a aria-hidden="true" href="#cb56-2" tabindex="-1"></a>   <span class="fu">GSUB</span>(<span class="st">"|"</span>,,,<span class="st">"|"</span>, x,<span class="at">고정 =</span> <span class="cn">진실</span>))<span class="sc">|&gt;</span> <span class="fu">lapply</span>(strwrap)</span>
<span id="cb56-3"><a aria-hidden="true" href="#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a aria-hidden="true" href="#cb56-4" tabindex="-1"></a><span class="fu">Rownames</span>(Zellernc) [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "k__bacteria" "K__viruses"                  
[3] "K__BACTERIA | P__FIRMICUTES" "K__BACTERIA | P__BACTEROIDETES"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a><span class="fu">Rownames</span>(Zellernc) [<span class="fu">nrow</span>(Zellernc)<span class="sc">+</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">0</span>))]]<span class="sc">|&gt;</span> <span class="fu">formatfn</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "k__bacteria | p__proteobacteria | c_deltaproteobacteria |"         
[2] "O__DESULFOVIBRIONALES | F__DESULFOVIBRIONACEAE | G__DESULFOVIBIO |"
[3] "S__DESULFOVIBRIO_TERMITIDIS"                                     

[[2]]
[1] "k__viruses | p__viruses_noname | c__viruses_noname | o__viruses_noname |"
[2] "f__baculoviridae | g__alphabaculovirus |"                              
[3] "S__BOMBYX_MORI_NUCLEOPOLYHEDROVIRUS |"                                
[4] "T__BOMBYX_MORI_NUCLEOPOLYHEDROVIRUS_UNCLASSIFIED"                    

[[3]]
[1] "k__bacteria | p__proteobacteria | c_deltaproteobacteria |"         
[2] "O__DESULFOVIBRIONALES | F__DESULFOVIBRIONACEAE | G__DESULFOVIBIO |"
[3] "S__DESULFOVIBRIO_TERMITIDIS | T__GCF_000504305"</code></pre>
</div>
</div>
<p>보시다시피, 특징은 다른 분류 학적 수준에서 풍부한 정량화의 혼합입니다.<em>케이</em>ingdom over<em>피</em>hylum to<em>에스</em>페시. 우리는 이것들 중 일부만 선택할 수 있지만 여기서는 모두 계속해서 그들 모두를 선택할 수 있습니다. 다음으로 일부 기능의 분포를 살펴 보겠습니다. 여기서, 우리는 2 개의 번호 510 및 527의 임의의 선택을 보여줍니다. 실제로, 그러한 많은 플롯을 빠르게 스크롤하여 인상을 얻는 것이 도움이됩니다 (<a class="quarto-xref" href="#fig-zellerHist-1">수치<span>12.19</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" href="#cb60-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">녹다</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(Zellernc) [<span class="fu">기음</span>(<span class="dv">510</span>,,,<span class="dv">527</span>),]),<span class="fu">AES</span>(<span class="at">x =</span>값))<span class="sc">+</span></span>
<span id="cb60-2"><a aria-hidden="true" href="#cb60-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb60-3"><a aria-hidden="true" href="#cb60-3" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span>var1,<span class="at">NCOL =</span> <span class="dv">1</span>,,,<span class="at">스케일 =</span> <span class="st">"무료"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-zellerHist-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zellerHist-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-26" href="12-chap_files/figure-html/fig-zellerHist-1-1.png" title="Figure 12.19: Histograms of the distributions for two randomly selected features. The distributions are highly skewed, with many zero values and a thin, long tail of non-zero values."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-zellerHist-1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zellerHist-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.19 : 무작위로 선택된 두 가지 특징에 대한 분포의 히스토그램. 분포는 매우 비뚤어지고 0 값이 많고 0이 아닌 값의 얇고 긴 꼬리가 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>가장 간단한 경우, 우리는 모델에 맞습니다<a class="quarto-xref" href="#eq-super-deflogregress"><span>12.7</span></a>다음과 같이.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a aria-hidden="true" href="#cb61-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"glmnet"</span>))</span>
<span id="cb61-2"><a aria-hidden="true" href="#cb61-2" tabindex="-1"></a>glmfite<span class="ot">=</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(Zellernc)),</span>
<span id="cb61-3"><a aria-hidden="true" href="#cb61-3" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">요인</span>(셀턴<span class="sc">$</span>질병),</span>
<span id="cb61-4"><a aria-hidden="true" href="#cb61-4" tabindex="-1"></a>                <span class="at">가족 =</span> <span class="st">"이항식"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>의 놀라운 특징<code>glmnet</code>기능은 그것이 적합하다는 것입니다<a class="quarto-xref" href="#eq-super-deflogregress"><span>12.7</span></a>하나의 선택뿐만 아니라<span class="math inline">\ (\ lambda \)</span>그러나 가능한 모든 것에<span class="math inline">\ (\ lambda \)</span>한 번에 s. 지금은 예측 성능을 살펴 보겠습니다.<span class="math inline">\ (\ lambda = 0.04 \)</span>. 함수 매개 변수의 이름은 다음과 같습니다<code>에스</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a>프레드스트프트<span class="ot">=</span> <span class="fu">예측하다</span>(GLMFIT,<span class="at">NEWX =</span> <span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(Zellernc)),</span>
<span id="cb62-2"><a aria-hidden="true" href="#cb62-2" tabindex="-1"></a>                   <span class="at">유형 =</span> <span class="st">"수업"</span>,,,<span class="at">s =</span> <span class="fl">0.04</span>))</span>
<span id="cb62-3"><a aria-hidden="true" href="#cb62-3" tabindex="-1"></a><span class="fu">테이블</span>(Predtrsf, Zellernc<span class="sc">$</span>질병)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predtrsf cancer n
  암 51 0
  n 2 61</code></pre>
</div>
</div>
<p>나쁘지는 않지만 이것은 교차 검증없이 훈련 데이터에 있다는 것을 기억하십시오. 자세히 살펴 보겠습니다<code>glmfite</code>. 그만큼<strong><a href="https://cran.r-project.org/web/packages/glmnet/">glmnet</a></strong>패키지는 볼 가치가있는 진단 플롯을 제공합니다 (<a class="quarto-xref" href="#fig-plotglmfit-1">수치<span>12.20</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a><span class="fu">구성</span>(GLMFIT,<span class="at">col =</span>rcolorbrewer<span class="sc">::</span><span class="fu">브루어</span>(<span class="dv">8</span>,,,<span class="st">"Dark2"</span>),)<span class="at">lwd =</span> <span class="fu">sqrt</span>(<span class="dv">3</span>),)<span class="at">뭉치</span> <span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotglmfit-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotglmfit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-27" href="12-chap_files/figure-html/fig-plotglmfit-1-1.png" title="Figure 12.20: Regularization paths for glmfit."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-plotglmfit-1-1.png" width="288"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotglmfit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.20 : 정규화 경로<code>glmfite</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-plotglmfit">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.17</div>
</div>
<div class="callout-body-container callout-body">
<p>무엇입니까<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-축<a class="quarto-xref" href="#fig-plotglmfit-1">수치<span>12.20</span></a>? 다른 줄은 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-34-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-34-contents callout-collapse collapse" id="callout-34">
<div class="callout-body-container callout-body">
<p>함수의 매뉴얼 페이지를 참조하십시오<code>plot.glmnet</code>에서<strong><a href="https://cran.r-project.org/web/packages/glmnet/">glmnet</a></strong>패키지.</p>
</div>
</div>
</div>
<p>매개 변수를 선택하는 방법에 대한 질문으로 돌아가 봅시다.<span class="math inline">\ (\ lambda \)</span>. 우리는 다양한 선택과 가능한 모든 선택을 시도 할 수 있습니다.<span class="math inline">\ (\ lambda \)</span>, 교차 검증을 사용하여 각각의 경우 분류 성능을 평가 한 다음 최고를 선택하십시오.<span class="math inline">\ (\ lambda \)</span>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-28" href="imgs/devil.png" title="You’ll already realize from the description of this strategy that if we optimize \lambda in this way, the resulting apparent classification performance will likely be exaggerated. We need a truly independent dataset, or at least another, outer cross-validation loop to get a more realistic impression of the generalizability. We will get back to this question at the end of the chapter."><img alt="You’ll already realize from the description of this strategy that if we optimize \lambda in this way, the resulting apparent classification performance will likely be exaggerated. We need a truly independent dataset, or at least another, outer cross-validation loop to get a more realistic impression of the generalizability. We will get back to this question at the end of the chapter." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>이 전략에 대한 설명에서 이미 최적화하는 경우<span class="math inline">\ (\ lambda \)</span>이러한 방식으로, 그 결과 명백한 분류 성능이 과장 될 것입니다. 일반화에 대한보다 현실적인 인상을 얻으려면 진정으로 독립적 인 데이터 세트 또는 최소한 외부 교차 검증 루프가 필요합니다. 우리는이 챕터의 끝 에서이 질문으로 돌아갈 것입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는 우리가했던 것처럼 루프를 작성하여 그렇게 할 수 있습니다.<code>추정 _mcl_loocv</code>기능<a class="quarto-xref" href="#sec-supervised-xval"><span>섹션 12.4.1</span></a>. 그것은 그게 밝혀졌습니다<strong><a href="https://cran.r-project.org/web/packages/glmnet/">glmnet</a></strong>패키지는 이미 기능에 따라 내장 기능이 있습니다.<code>cv.glmnet</code>대신 사용할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a>CVGLMFIT<span class="ot">=</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> <span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(Zellernc)),</span>
<span id="cb65-2"><a aria-hidden="true" href="#cb65-2" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">요인</span>(셀턴<span class="sc">$</span>질병),</span>
<span id="cb65-3"><a aria-hidden="true" href="#cb65-3" tabindex="-1"></a>                     <span class="at">가족 =</span> <span class="st">"이항식"</span>))</span>
<span id="cb65-4"><a aria-hidden="true" href="#cb65-4" tabindex="-1"></a><span class="fu">구성</span>(cvglmfit)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-colonCV-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-colonCV-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="12-chap_files/figure-html/fig-colonCV-1-1.png" title="Figure 12.21: Diagnostic plot for cv.glmnet: shown is a measure of cross-validated prediction performance, the deviance, as a function of \lambda. The dashed vertical lines show lambda.min and lambda.1se."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-colonCV-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-colonCV-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.21 : 진단 플롯<code>cv.glmnet</code>: 표시는<span class="math inline">\ (\ lambda \)</span>. 점선 수직선이 표시됩니다<code>lambda.min</code>그리고<code>람다 .1SE</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>진단 플롯이 표시됩니다<a class="quarto-xref" href="#fig-colonCV-1">수치<span>12.21</span></a>. 최적의 값에 액세스 할 수 있습니다</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" href="#cb66-1" tabindex="-1"></a>CVGLMFIT<span class="sc">$</span>lambda.min</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0529391</code></pre>
</div>
</div>
<p>이 값은 추정 곡선에서 최소값을 찾아서 발생하기 때문에 종종 너무 작습니다. 즉, 묵시적 형벌이 너무 약하다는 것이 밝혀졌습니다. 저자가 권장하는 휴리스틱<strong><a href="https://cran.r-project.org/web/packages/glmnet/">glmnet</a></strong>패키지는 대신 다소 큰 값, 즉 가장 큰 값을 사용하는 것입니다.<span class="math inline">\ (\ lambda \)</span>성능 측정은 최소의 표준 오차 내에 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" href="#cb68-1" tabindex="-1"></a>CVGLMFIT<span class="sc">$</span>람다<span class="fl">.1</span>~와 함께</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08830775</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-confusion">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.18</div>
</div>
<div class="callout-body-container callout-body">
<p>혼란 테이블은 어떻게 생겼습니까?<span class="math inline">\ (\ lambda = \; \)</span><code>람다 .1SE</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-36-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-36-contents callout-collapse collapse" id="callout-36">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" href="#cb70-1" tabindex="-1"></a>S0<span class="ot">=</span>CVGLMFIT<span class="sc">$</span>람다<span class="fl">.1</span>~와 함께</span>
<span id="cb70-2"><a aria-hidden="true" href="#cb70-2" tabindex="-1"></a><span class="fu">예측하다</span>(GLMFIT,<span class="at">NEWX =</span> <span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(Zellernc)),<span class="at">유형 =</span> <span class="st">"수업"</span>,,,<span class="at">s =</span>S0)<span class="sc">|&gt;</span></span>
<span id="cb70-3"><a aria-hidden="true" href="#cb70-3" tabindex="-1"></a>    <span class="fu">테이블</span>(셀턴<span class="sc">$</span>질병)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>암 n
  암 38 5
  n 15 56</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-drivingfeatures">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.19</div>
</div>
<div class="callout-body-container callout-body">
<p>분류를 유발하는 기능은 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-38-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-38-contents callout-collapse collapse" id="callout-38">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a>코프<span class="ot">=</span> <span class="fu">코프</span>(glmfit) [,<span class="fu">어느 쪽</span>(<span class="fu">ABS</span>(GLMFIT<span class="sc">$</span>람다<span class="sc">-</span>S0)))</span>
<span id="cb72-2"><a aria-hidden="true" href="#cb72-2" tabindex="-1"></a>맨 위<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">ABS</span>(코프),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]</span>
<span id="cb72-3"><a aria-hidden="true" href="#cb72-3" tabindex="-1"></a><span class="fu">as.vector</span>(Coefs [Topthree])</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -71.471393 -8.770704 -1.465249</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a><span class="fu">formatfn</span>(<span class="fu">이름</span>(Coefs) [Topthree])</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "K__BACTERIA | P__CANDIDATUS_SACCHARIBACTERIA |"      
[2] "C__CANDIDATUS_SACCHARIBACTERIA_NONAME |"            
[3] "O__CANDIDATUS_SACCHARIBACTERIA_NONAME |"            
[4] "F__CANDIDATUS_SACCHARIBACTERIA_NONAME |"            
[5] "g__candidatus_saccharibacteria_noname |"            
[6] "S__CANDIDATE_DIVISION_TM7_SILLE_CELLATE_TM7B"

[[2]]
[1] "k__bacteria | p__firmicutes | c__clostridia | o__clostridiation |"        
[2] "f__ruminococcaceae | g__subdoligranulum | s__subdoligranulum_variabile"

[[3]]
[1] "k__bacteria | p__firmicutes | c__clostridia | o__clostridiation |"
[2] "f__lachnospiraceae | g__alachnospiraceae_noname |"              
[3] "S__LACHNOSPIRACEAE_BACTERIUM_7_1_58FAA"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-asinh">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.20</div>
</div>
<div class="callout-body-container callout-body">
<p>데이터를 변환하면 결과가 어떻게 변경됩니까?<code>asinh</code>우리가 본 것처럼 변형<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-40-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-40-contents callout-collapse collapse" id="callout-40">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-colonCVTrsf-1">수치<span>12.22</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a><span class="fu">cv.glmnet</span>(<span class="at">x =</span> <span class="fu">티</span>(<span class="fu">asinh</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(Zellernc)),</span>
<span id="cb76-2"><a aria-hidden="true" href="#cb76-2" tabindex="-1"></a>          <span class="at">y =</span> <span class="fu">요인</span>(셀턴<span class="sc">$</span>질병),</span>
<span id="cb76-3"><a aria-hidden="true" href="#cb76-3" tabindex="-1"></a>          <span class="at">가족 =</span> <span class="st">"이항식"</span>))<span class="sc">|&gt;</span> <span class="fu">구성</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-colonCVTrsf-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-colonCVTrsf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="12-chap_files/figure-html/fig-colonCVTrsf-1-1.png" title="Figure 12.22: like Figure fig-colonCV-1, but using an \text{asinh} transformation of the data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-colonCVTrsf-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-colonCVTrsf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.22 : 좋아요<a class="quarto-xref" href="#fig-colonCV-1">수치<span>12.21</span></a>, 그러나 사용<span class="math inline">\ (\ text {asinh} \)</span>데이터 변환.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-ready">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.21</div>
</div>
<div class="callout-body-container callout-body">
<p>이 데이터에 대한 좋은 분류 성능 이이 분석법이 선별 및 조기 암 탐지 준비가되었음을 의미합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-42-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-42-contents callout-collapse collapse" id="callout-42">
<div class="callout-body-container callout-body">
<p>아니요. 여기서의 성능은 케이스가 대조군과 유사한 유병률을 갖는 일련의 샘플에서 측정됩니다. 이것은 생물학을 탐구하기에 충분합니다. 그러나 실제 응용 프로그램에서는 사례가 훨씬 덜 빈번합니다. 실제로 유용하기 위해, 분석은 특이성이 훨씬 높아야합니다. 특이성을 확립하려면 훨씬 더 큰 정상 샘플 세트를 테스트해야합니다.</p>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="12.6.3" id="sec-supervised-classifymousecells">
<h3 class="anchored" data-anchor-id="sec-supervised-classifymousecells" data-number="12.6.3"><span class="header-section-number">12.6.3</span>예 : 발현 프로파일에서 마우스 세포를 분류합니다</h3>
<p>인물<a class="quarto-xref" href="#fig-colonCV-1"><span>12.21</span></a>그리고<a class="quarto-xref" href="#fig-colonCVTrsf-1"><span>12.22</span></a>(교차 검증 된) 분류 성능과 모델 복잡성의 의존성을 기대하는 방법에 대한 교과서 예입니다.<span class="math inline">\ (\ lambda \)</span>) 봐. 이제 마우스 배아 세포 데이터로 돌아 갑시다. 우리는 배아의 날부터 세포를 분류하려고 노력할 것입니다<code>E3.25</code>그들의 유전자형과 관련하여.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a>SX<span class="ot">=</span>x [, x<span class="sc">$</span>배아<span class="sc">==</span> <span class="st">"e3.25"</span>]]</span>
<span id="cb77-2"><a aria-hidden="true" href="#cb77-2" tabindex="-1"></a>배아 분류기<span class="ot">=</span> <span class="fu">cv.glmnet</span>(<span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(SX)), SX<span class="sc">$</span>유전자형,</span>
<span id="cb77-3"><a aria-hidden="true" href="#cb77-3" tabindex="-1"></a>                <span class="at">가족 =</span> <span class="st">"이항식"</span>,,,<span class="at">type.measure =</span> <span class="st">"수업"</span>))</span>
<span id="cb77-4"><a aria-hidden="true" href="#cb77-4" tabindex="-1"></a><span class="fu">구성</span>(Embryocellsclassifier)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mousecvglmfit-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mousecvglmfit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="12-chap_files/figure-html/fig-mousecvglmfit-1-1.png" title="Figure 12.23: Cross-validated misclassification error versus penalty parameter for the mouse cells data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-mousecvglmfit-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mousecvglmfit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.23 : 마우스 셀 데이터에 대한 교차 검증 된 오 분류 오류 대 페널티 매개 변수.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="#fig-mousecvglmfit-1">수치<span>12.23</span></a>우리는 오 분류 오류가 (본질적으로) 단조롭게 증가하고 있음을 알 수 있습니다.<span class="math inline">\ (\ lambda \)</span>, 가장 작습니다<span class="math inline">\ (\ lambda \ to 0 \)</span>, 즉, 우리가 전혀 처벌을 전혀 적용하지 않는 경우.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-mousewhatsgoingon">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.22</div>
</div>
<div class="callout-body-container callout-body">
<p>이 데이터는 무슨 일이 일어나고 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-44-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-44-contents callout-collapse collapse" id="callout-44">
<div class="callout-body-container callout-body">
<p>더 많은 기능을 포함하고 모든 기능을 포함시키는 것은 분류 성능에 해를 끼치 지 않는 것으로 보입니다. 어떤면 에서이 데이터는 "너무 쉽습니다". 하자<span class="math inline">\(티\)</span>-모든 기능에 대한 테스트 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a>마우스 _de<span class="ot">=</span> <span class="fu">Rowttests</span>(SX,<span class="st">"유전자형"</span>))</span>
<span id="cb78-2"><a aria-hidden="true" href="#cb78-2" tabindex="-1"></a><span class="fu">ggplot</span>(Mouse_de,<span class="fu">AES</span>(<span class="at">x =</span>p.Value))<span class="sc">+</span></span>
<span id="cb78-3"><a aria-hidden="true" href="#cb78-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">경계 =</span> <span class="dv">0</span>,,,<span class="at">breaks =</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="at">by =</span> <span class="fl">0.01</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mousecellsrowttst-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mousecellsrowttst-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-32" href="12-chap_files/figure-html/fig-mousecellsrowttst-1-1.png" title="Figure 12.24: Histogram of p-values for the per-feature t-tests between genotypes in the E3.25 cells."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-mousecellsrowttst-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mousecellsrowttst-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.24 : 기능 당 p- 값의 히스토그램<span class="math inline">\(티\)</span>-E3.25 세포의 유전자형 사이의 검정.</figcaption>
</figure>
</div>
</div>
</div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-mousecellsrowttst-1">수치<span>12.24</span></a>, 많은 수의 유전자가 차별적으로 발현되므로 클래스 구분에 대한 정보가 있음을 보여줍니다. 또한 모든 기능을 사용하여 모든 셀 간의 쌍별 거리를 계산할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a>Dists<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">규모</span>(<span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)))))</span>
<span id="cb79-2"><a aria-hidden="true" href="#cb79-2" tabindex="-1"></a><span class="fu">일관성</span>(Dists)<span class="ot">=</span> <span class="sc">+</span><span class="cn">inf</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>그런 다음 각 셀에 대해 가장 가까운 이웃의 클래스를 결정합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a>NN<span class="ot">=</span> <span class="fu">Sapply</span>(<span class="fu">seq_len</span>(<span class="fu">NCOL</span>(dists),<span class="cf">기능</span>(나)<span class="fu">어느 쪽</span>(dists [, i]))</span>
<span id="cb80-2"><a aria-hidden="true" href="#cb80-2" tabindex="-1"></a><span class="fu">테이블</span>(엑스<span class="sc">$</span>샘플 그룹, x<span class="sc">$</span>샘플 그룹 [NN])<span class="sc">|&gt;</span> <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="cn">널</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3] [, 4] [, 5] [, 6] [, 7] [, 8]
  E3.25 33 0 0 3 0 0 0
  E3.25 (FGF4-KO) 1 15 0 1 0 0 0 0
  E3.5 (EPI) 2 0 3 0 6 0 0 0
  E3.5 (FGF4-KO) 0 0 8 0 0 0 0
  E3.5 (PE) 0 0 0 11 0 0 0
  E4.5 (EPI) 0 0 0 0 2 2 0 0 0
  E4.5 (FGF4-KO) 1 0 0 0 9 0
  E4.5 (PE) 0 0 0 0 2 0 0 2</code></pre>
</div>
</div>
<p>모든 기능을 사용하면 E3.25 WildType vs FGF4-KO 차이를 포함하여 거의 모든 경우에서 가장 가까운 1 개의 이웃 분류기가 정확합니다. 이는 이러한 데이터의 경우 정규화 또는 기능 선택에 명백한 이점이 없음을 의미합니다. 모든 기능을 사용하는 한계는 진정으로 새로운 데이터를 통해 명백해질 수 있지만, 이는 교차 검증에 도달 할 수 없습니다.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="12.7" id="sec:ML:caret">
<h2 class="anchored" data-anchor-id="sec:ML:caret" data-number="12.7"><span class="header-section-number">12.7</span>다양한 방법</h2>
<p>우리는 이제 세 가지 분류 방법을 보았습니다 : 선형 판별 분석 (<code>LDA</code>), 2 차 판별 분석 (<code>비</code>) 및 탄성 순 처벌을 사용한 로지스틱 회귀 (<code>glmnet</code>). 실제로 수백 가지의 다른 학습 알고리즘이 있습니다<a class="footnote-ref" href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a>R 및 애드온 패키지로 제공됩니다. Cran Task View에서 개요를 얻을 수 있습니다.<a href="https://cran.r-project.org/web/views/MachineLearning.html">기계 학습 및 통계 학습</a>. 몇 가지 예는 다음과 같습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>R을 사용하고 많은 예와 연습을 제공하는 주제에 대한 소개를 위해서는 권장합니다.<span class="citation" data-cites="James:2013">(<a href="16-chap.html#ref-James:2013" role="doc-biblioref">제임스 et al. 2013</a>))</span>.</p></div></div><ul>
<li><p>지원 벡터 머신 : 기능<code>SVM</code>패키지에서<strong><a href="https://cran.r-project.org/web/packages/e1071/">E1071</a></strong>; <code>XVM</code>~에<strong><a href="https://cran.r-project.org/web/packages/kernlab/">kernlab</a></strong></p></li>
<li><p>패키지의 트리 기반 방법<strong><a href="https://cran.r-project.org/web/packages/rpart/">rpart</a></strong>,,,<strong><a href="https://cran.r-project.org/web/packages/tree/">나무</a></strong>,,,<strong><a href="https://cran.r-project.org/web/packages/randomForest/">랜덤 포스트</a></strong></p></li>
<li><p>부스팅 방법 : 기능<code>Glmbolost</code>그리고<code>gamboost</code>패키지로<strong><a href="https://cran.r-project.org/web/packages/mboost/">mboost</a></strong></p></li>
<li><p><code>페널리화된다</code>패키지에서<strong><a href="https://cran.r-project.org/web/packages/PenalizedLDA/">페널리화된다</a></strong>,,,<code>dudi.discr</code>그리고<code>dist.pcaiv</code>~에<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>).</p></li>
</ul>
<p>각 패키지 각각의 학습 전략, 조정 매개 변수 및 평가 기준의 복잡성과 이질성은 혼란 스러울 수 있습니다. 당신은 이미<code>LDA</code>,,,<code>비</code>그리고<code>glmnet</code>함수, 즉 입력 데이터가 제시되는 방법과 반환 내용. 다른 모든 패키지와 기능에 따라 훨씬 더 많은 다양성이 있습니다. 동시에, 교차 검증, 매개 변수 튜닝 및 성능 평가와 같은 일반적인 작업이 어떤 특정 방법을 사용하든 상관없이 다소 동일합니다. 예를 들어 보았 듯이<code>추정 _mcl_loocv</code>기능, 반복 및 데이터 셔플 링은 오히려 오히려 코드로 이어졌습니다.</p>
<p>그렇다면 다른 학습 알고리즘을 시도하고 탐색하고 싶다면 어떻게해야합니까? 다행스럽게도 R의 다양한 기계 학습 인터페이스에 통합 인터페이스를 제공하는 몇 가지 프로젝트가 있으며 매개 변수 튜닝 및 성능 평가와 같은 일반적인 작업의 "모범 사례"구현을 제공하려고합니다. 가장 잘 알려진 두 가지는 패키지입니다<strong><a href="https://cran.r-project.org/web/packages/caret/">탈자 부호</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/mlr/">MLR</a></strong>. 여기에 살펴 보았습니다<strong><a href="https://cran.r-project.org/web/packages/caret/">탈자 부호</a></strong>. 지원하는 방법 목록을 통해<code>getModelInfo</code>기능. 꽤 많은 것이 있습니다. 여기에 우리는 처음 8을 보여줍니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"탈자 부호"</span>))</span>
<span id="cb82-2"><a aria-hidden="true" href="#cb82-2" tabindex="-1"></a>CARETMETHODS<span class="ot">=</span> <span class="fu">이름</span>(<span class="fu">getModelInfo</span>())</span>
<span id="cb82-3"><a aria-hidden="true" href="#cb82-3" tabindex="-1"></a><span class="fu">머리</span>(CARETMETODS,<span class="dv">8</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adabag" "Adaboost.m1" "Adaboost" "Amdai"      
[6] "avnnet" "awnb"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a aria-hidden="true" href="#cb84-1" tabindex="-1"></a><span class="fu">길이</span>(Caretmethods)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 239</code></pre>
</div>
</div>
<p>우리는 신경망 방법을 확인할 것입니다<code>어머니</code>시조 패키지에서 기능. 그만큼<code>매개 변수</code>슬롯은 사용 가능한 튜닝 매개 변수를 알려줍니다<a class="footnote-ref" href="#fn10" id="fnref10" role="doc-noteref"><sup>10</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>그것들은 매뉴얼에 설명되어 있습니다<code>어머니</code>기능.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" href="#cb86-1" tabindex="-1"></a><span class="fu">getModelInfo</span>(<span class="st">"어머니"</span>,,,<span class="at">Regex =</span> <span class="cn">거짓</span>) [[<span class="dv">1</span>]]]]<span class="sc">$</span>매개 변수</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>매개 변수 클래스 레이블
1 크기의 숫자 #Hidden 유닛
2 붕괴 숫자 무게 붕괴</code></pre>
</div>
</div>
<p>시도해 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a aria-hidden="true" href="#cb88-1" tabindex="-1"></a>trnctrl<span class="ot">=</span> <span class="fu">Traincontrol</span>(</span>
<span id="cb88-2"><a aria-hidden="true" href="#cb88-2" tabindex="-1"></a>  <span class="at">방법 =</span> <span class="st">"반복된다"</span>,,,</span>
<span id="cb88-3"><a aria-hidden="true" href="#cb88-3" tabindex="-1"></a>  <span class="at">반복 =</span> <span class="dv">3</span>,,,</span>
<span id="cb88-4"><a aria-hidden="true" href="#cb88-4" tabindex="-1"></a>  <span class="at">classProbs =</span> <span class="cn">진실</span>))</span>
<span id="cb88-5"><a aria-hidden="true" href="#cb88-5" tabindex="-1"></a>TuneGrid<span class="ot">=</span> <span class="fu">확장 .grid</span>(</span>
<span id="cb88-6"><a aria-hidden="true" href="#cb88-6" tabindex="-1"></a>  <span class="at">크기 =</span> <span class="fu">기음</span>(<span class="dv">2</span>,,,<span class="dv">4</span>,,,<span class="dv">8</span>),)</span>
<span id="cb88-7"><a aria-hidden="true" href="#cb88-7" tabindex="-1"></a>  <span class="at">붕괴 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="fl">1e-2</span>,,,<span class="fl">1E-1</span>)))</span>
<span id="cb88-8"><a aria-hidden="true" href="#cb88-8" tabindex="-1"></a>nnfit<span class="ot">=</span> <span class="fu">기차</span>(</span>
<span id="cb88-9"><a aria-hidden="true" href="#cb88-9" tabindex="-1"></a>배아<span class="sc">~</span>FN1<span class="sc">+</span>TIMD2<span class="sc">+</span>Gata4<span class="sc">+</span>sox7,</span>
<span id="cb88-10"><a aria-hidden="true" href="#cb88-10" tabindex="-1"></a>  <span class="at">데이터 =</span>배아 셀,</span>
<span id="cb88-11"><a aria-hidden="true" href="#cb88-11" tabindex="-1"></a>  <span class="at">방법 =</span> <span class="st">"어머니"</span>,,,</span>
<span id="cb88-12"><a aria-hidden="true" href="#cb88-12" tabindex="-1"></a>  <span class="at">TuneGrid =</span>Tunegrid,</span>
<span id="cb88-13"><a aria-hidden="true" href="#cb88-13" tabindex="-1"></a>  <span class="at">trcontrol =</span>trnctrl,</span>
<span id="cb88-14"><a aria-hidden="true" href="#cb88-14" tabindex="-1"></a>  <span class="at">메트릭 =</span> <span class="st">"정확성"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>그것은 꽤 입이지만 좋은 점은이 구문이 표준화되어 여러 다른 방법에 적용된다는 것입니다. 방법의 이름과 튜닝 매개 변수의 그리드를<code>TuneGrid</code>논쟁.</p>
<p>이제 우리는 출력을 볼 수 있습니다 (<a class="quarto-xref" href="#fig-ML-nnfit">수치<span>12.25</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a aria-hidden="true" href="#cb89-1" tabindex="-1"></a>nnfit</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>신경망 

66 샘플
 4 예측 변수
 3 개의 클래스 : 'e3.25', 'e3.5', 'e4.5' 

사전 처리가 없습니다
리 샘플링 : 교차 검증 (10 배, 3 번 반복) 
샘플 크기 요약 : 60, 59, 60, 60, 59, 59, ... 
튜닝 매개 변수의 결과 리 샘플링 :

  크기 붕괴 정확도 카파    
  2 0.00 0.7083333 0.4279755
  2 0.01 0.7676587 0.5858922
  2 0.10 0.7681349 0.5767463
  4 0.00 0.7515476 0.5638426
  4 0.01 0.8004762 0.6486256
  4 0.10 0.7638889 0.5676798
  8 0.00 0.7385714 0.5393148
  8 0.01 0.7348016 0.5281220
  8 0.10 0.7532540 0.5525435

정확도는 가장 큰 값을 사용하여 최적 모델을 선택하는 데 사용되었습니다.
모델에 사용 된 최종 값은 크기 = 4이고 붕괴 = 0.01입니다.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a aria-hidden="true" href="#cb91-1" tabindex="-1"></a><span class="fu">구성</span>(NNFIT)</span>
<span id="cb91-2"><a aria-hidden="true" href="#cb91-2" tabindex="-1"></a><span class="fu">예측하다</span>(NNFIT)<span class="sc">|&gt;</span> <span class="fu">머리</span>(<span class="dv">10</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] E3.25 E3.25 E3.25 E3.25 E3.25 E3.25 E3.25 E3.25 E3.25 E3.25 E3.25
레벨 : E3.25 E3.5 E4.5</code></pre>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ML-nnfit">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ML-nnfit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-33" href="12-chap_files/figure-html/fig-ML-nnfit-1.png" title="Figure 12.25: Parameter tuning of the neural net by cross-validation."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="12-chap_files/figure-html/fig-ML-nnfit-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ML-nnfit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 12.25 : 교차 검증에 의한 신경 그물의 파라미터 튜닝.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-supervised-generalize">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 12.23</div>
</div>
<div class="callout-body-container callout-body">
<p>최적의 튜닝 매개 변수에 대해 위에서 얻은 정확도가 새로운 데이터 세트로 일반화됩니까? 그것을 해결하기 위해 무엇을 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-46-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-46-contents callout-collapse collapse" id="callout-46">
<div class="callout-body-container callout-body">
<p>아니요, 우리가 최적을 선택 했으므로 너무 낙관적 일 수 있습니다. 일반화시 예측 성능의 다소 현실적인 추정치를 얻으려면 모든 데이터 전처리 선택 및 위 매개 변수 튜닝 절차를 (컴퓨터 코드로) 공식화하고 다른 외부 교차 검증 루프에 포함시킬 수 있습니다.<span class="citation" data-cites="ambroise2002selection">(<a href="16-chap.html#ref-ambroise2002selection" role="doc-biblioref">Ambroise 및 McLachlan 2002</a>))</span>. 그러나 다음 섹션에서 논의 할 때 이것은 여전히 ​​충분하지 않을 수 있습니다.</p>
</div>
</div>
</div>
<section class="level3" data-number="12.7.1" id="method-hacking">
<h3 class="anchored" data-anchor-id="method-hacking" data-number="12.7.1"><span class="header-section-number">12.7.1</span>방법 해킹</h3>
<p>~ 안에<a class="quarto-xref" href="06-chap.html"><span>6 장</span></a>우리는 만났다<em>P- 값 해킹</em>. 통계 학습에서도 비슷한 현상이 존재합니다. 데이터 세트가 주어지면, 우리는 다양한 전처리 방법 (예 : 정규화, 이상치 감지, 변환, 기능 선택)을 탐색하고, 다른 기계 학습 알고리즘을 시험해보고, 결과에 만족할 때까지 매개 변수를 조정합니다. 측정 된 정확도는 너무 낙관적 일 수 있습니다. 즉, 새로운 데이터 세트로 일반화되지 않습니다. 우리의 체계적인 선택을 계산 형식에 포함시키고 외부 교차 검증 루프를 갖는 (파라미터 튜닝을 수행하는 내부 루프와 혼동되지 않음) 문제가 개선됩니다. 그러나 우리의 모든 선택이 공식화 될 수있는 것은 아니기 때문에 완전히 해결하지는 못할 것입니다.</p>
<p>금 표준은 진정으로 보이지 않는 데이터에 대한 검증으로 남아 있습니다. 또한 분류기가 블랙 박스가 아니라 도메인 지식으로 해석 될 수 있다면 결코 나쁜 일이 아닙니다. 마지막으로, 오 분류 속도와 같은 요약 통계뿐만 아니라 완전한 계산 워크 플로우를 열어서 미래의 자아를 포함하여 모든 사람이 결과의 견고성 또는 전처리, 모델 선택 및 조정 선택의 영향을 확신시킬 수 있도록하십시오.<span class="citation" data-cites="Holmes2017">(<a href="16-chap.html#ref-Holmes2017" role="doc-biblioref">홈즈 2018</a>))</span>.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="12.8" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="12.8"><span class="header-section-number">12.8</span>이 장의 요약</h2>
<p>우리는 기계 학습 응용 프로그램의 예를 보았습니다. 우리는 범주 형 변수 (당뇨병 유형 또는 세포 클래스와 같은)를 예측하는 데 중점을 두었습니다. 지속적인 결과를 예측하는 것도 기계 학습의 일부이지만 여기서는 고려하지 않았습니다. 사이에는 많은 유사점과 겹침이 있습니다<em>기계 학습</em>그리고<em>통계적 회귀</em>(우리가 공부 한<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>). 기계 학습에서는 각각 동일한 활동에 대한 두 가지 다른 이름을 고려할 수 있습니다. 기계 학습에서는 결과 변수의 예측에 중점을 두는 반면, 회귀에서 우리는 종종 공변량의 역할에 대해 종종 관심을 갖고 있습니다. 결과에 영향을 미치는 것은 무엇이며, 이러한 영향의 특성은 무엇입니까? 다시 말해, 우리는 예측을 원할뿐만 아니라 그것들을 이해하고 싶습니다.</p>
<p>우리는 선형 및 2 차 판별 분석, 2 차원 데이터 평면 (또는<span class="math inline">\(피\)</span>-선형 또는 2 차 분리 라인 (또는 초 저조 공간)을 사용하여 영역으로의 차원 공간). 우리는 또한 로지스틱 회귀 분석을 보았는데, 이는 약간 다른 접근 방식을 취하지 만 더 높은 차원에서 작동하고 정규화하는 데 더 적합합니다.</p>
<p>기계 학습의 주요 도전에 직면했습니다. 우리는 소위 차원의 저주와 관련하여 과인이 왜 발생하는지 탐구했으며, 정규화를 사용하여 어떻게 극복 될 수 있는지 배웠습니다.</p>
<p>다시 말해, 가능한 입력 및 출력의 전체 공간을 대표하는 무한한 양의 데이터가 있으면 머신 러닝이 쉬울 것입니다.<a class="footnote-ref" href="#fn11" id="fnref11" role="doc-noteref"><sup>11</sup></a>. 도전은 유한 한 양의 교육 데이터를 최대한 활용하고이를 새롭고 보이지 않는 입력으로 일반화하는 것입니다. 교육 데이터의 금액, 해결 및 적용 범위와 모델의 복잡성 사이에는 활발한 트레이드 오프가 있습니다. 많은 모델에는 복잡성이나 정규화의 강점을 "조정"할 수있는 연속 매개 변수가 있습니다. 교차 검증은 만병 통치약이 아니지만 우리가 보았 듯이 경고가 적용되지만 그러한 튜닝에 도움이 될 수 있습니다.<a class="quarto-xref" href="#sec-supervised-classifymousecells"><span>섹션 12.6.3</span></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>"그냥"엄청난 데이터베이스 / 데이터 관리 문제가 될 것입니다.</p></div></div></section>
<section class="level2" data-number="12.9" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="12.9"><span class="header-section-number">12.9</span>추가 독서</h2>
<ul>
<li><p>많은 구체적인 데이터 예제를 사용하고 작은 수학적 형식을 사용하는 통계 학습 소개<span class="citation" data-cites="James:2013">제임스 et al. (<a href="16-chap.html#ref-James:2013" role="doc-biblioref">2013</a>))</span>. 더 많은 수학적 배경을 가진 확장은 교과서입니다.<span class="citation" data-cites="HastieTibshiraniFriedman">Hastie, Tibshirani 및 Friedman (<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">2008</a>))</span>.</p></li>
<li><p>그만큼<a href="https://cran.r-project.org/web/views/MachineLearning.html">머신 러닝에서 CRAN 작업보기</a>R의 머신 러닝 소프트웨어에 대한 개요를 제공합니다.</p></li>
<li><p><a href="https://tensorflow.rstudio.com/keras">"딥 러닝"플랫폼 Keras 및 Tensorflow 용 Rstudio의 API</a>그리고 관련 교육 자료와 데모는이 분야의 최근 개발 중 일부를 시험해 볼 수있는 좋은 장소입니다.</p></li>
</ul>
</section>
<section class="level2" data-number="12.10" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="12.10"><span class="header-section-number">12.10</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-supervised-kernelsvm">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 12.1</div>
</div>
<div class="callout-body-container callout-body">
<p>a<em>커널 지원 벡터 머신</em>,<strong><a href="https://cran.r-project.org/web/packages/kernlab/">kernlab</a></strong>패키지,<code>젤러</code>미생물 데이터. 어떤 커널 기능이 잘 작동합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-supervised-glmnet">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 12.2</div>
</div>
<div class="callout-body-container callout-body">
<p>사용<code>glmnet</code>a<em>연속 변수의 예측</em>, 즉, 회귀를 위해. 3 장의 전립선 암 데이터를 사용하십시오<span class="citation" data-cites="HastieTibshiraniFriedman">(<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">Hastie, Tibshirani 및 Friedman 2008</a>))</span>. 데이터는 CRAN 패키지에서 사용할 수 있습니다<strong><a href="https://cran.r-project.org/web/packages/ElemStatLearn/">elemstatLearn</a></strong>. Ridge와 Lasso 페널티 사용의 효과를 탐색하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-supervised-smoothing">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 12.3</div>
</div>
<div class="callout-body-container callout-body">
<p>고려하다<em>회귀 및 모델 선택 문제로서의 스무딩</em>(기억하다<a class="quarto-xref" href="#fig-overfitting-1">수치<span class="anchored-eq" data-anchor-id="eq-super">12.1</span></a>). 처벌 매개 변수와 동등한 수량은 얼마입니까?<span class="math inline">\ (\ lambda \)</span>~에<a class="quarto-xref" href="#eq-super-penll">방정식<span>12.8</span></a>? 어떻게 선택합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-50-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-50-contents callout-collapse collapse" id="callout-50">
<div class="callout-body-container callout-body">
<p>우리는 5 장을 참조합니다<span class="citation" data-cites="HastieTibshiraniFriedman">(<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">Hastie, Tibshirani 및 Friedman 2008</a>))</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-supervised-scale">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 12.4</div>
</div>
<div class="callout-body-container callout-body">
<p><em>스케일 불변</em>. (일반화 된) 선형 모델의 기능 중 하나의 저장을 고려하십시오.<a class="quarto-xref" href="#eq-super-deflogregress"><span class="anchored-eq" data-anchor-id="eq-super">12.7</span></a>. 예를 들어<span class="math inline">\(\아니다\)</span>-TH 열<span class="math inline">\(엑스\)</span>~에 의해<span class="math inline">\ (x _ {\ cdot \ nu} \)</span>그리고 그것을 가정합니다<span class="math inline">\ (p \ ge2 \)</span>그리고 우리는 우리를 재조정합니다<span class="math inline">\ (x _ {\ cdot \ nu} \ mapsto s \, x _ {\ cdot \ nu} \)</span>숫자로<span class="math inline">\ (s \ neq0 \)</span>. 추정치는 어떻게 될 것입니다<span class="math inline">\ (\ hat {\ beta} \)</span>~에서<a class="quarto-xref" href="#eq-super-penll">방정식<span>12.8</span></a>(a)에서 제외되지 않은 사건 (<span class="math inline">\ (\ lambda = 0 \)</span>) 및 (b) 처벌 된 사건 (<span class="math inline">\ (\ lambda&gt; 0 \)</span>)?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-52-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-52-contents callout-collapse collapse" id="callout-52">
<div class="callout-body-container callout-body">
<p>원조되지 않은 경우 추정치는<span class="math inline">\ (1/s \)</span>결과 모델은 사실상 동일합니다. 처벌 된 사건에서<span class="math inline">\(\아니다\)</span>-TH 구성 요소<span class="math inline">\(\베타\)</span>다를 것입니다. 만약에<span class="math inline">\ (| s |&gt; 1 \)</span>기능의 진폭이 더 작습니다<span class="math inline">\(\베타\)</span>-대기업은 예측에 동일한 효과를 갖기 위해 필요하므로 기능은 다른 기능의 비용에 대해 0이 아닌 및/또는 더 큰 추정치를받을 가능성이 더 높습니다. 반대로<span class="math inline">\ (| s | &lt;1 \)</span>. 규칙적인 선형 회귀는 규모 불변 인 반면, 벌칙적 인 회귀는 규모에 따라 다릅니다. 페널티 된 모델에 맞는 해석 할 때 이것을 기억하는 것이 중요합니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-supervised-quip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 12.5</div>
</div>
<div class="callout-body-container callout-body">
<p>모든 분류 방법은 단지 개선 된 것입니다.<em>두 가지 전형적인 아이디어</em>: 판별 분석 및<span class="math inline">\(케이\)</span>가장 가까운 이웃. 어떤 의미에서 그것이 유용한 분류 일 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-54-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-54-contents callout-collapse collapse" id="callout-54">
<div class="callout-body-container callout-body">
<p>선형 판별 분석에서 우리는 우리의 객체를 요소로 간주합니다.<span class="math inline">\ (\ mathbb {r}^p \)</span>학습 과제는이 공간의 영역을 정의하는 것입니다. 또는 새로운 개체의 클래스 멤버십을 예측하는 데 사용하는 이들 사이의 경계 초대가 있습니다. 이것은 원형입니다<em>파티션 별 분류</em>. 선형 판별 분석의 일반화는보다 일반적인 공간과 더 일반적인 경계 형태를 허용합니다.</p>
<p>~ 안에<span class="math inline">\(케이\)</span>가장 가까운 이웃은 좌표 공간에 포함되지 않지만 대신 각 쌍의 쌍 사이에 계산할 수있는 거리 (또는 비 유사성) 측정이 필요하며 새로운 객체에 대한 분류 결정은 훈련 대상 및 클래스와의 거리에 따라 다릅니다. 이것은 원형입니다<em>커널 기반</em>행동 양식.</p>
</div>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-ambroise2002selection" role="listitem">Ambroise, Christophe 및 Geoffrey J. McLachlan. 2002.<span>"<span>에스</span>마이크로 어레이 유전자 표현 데이터에 기초한 유전자 추출의 선거 편향.”</span> <em>PNA</em>99 (10) : 6562–66.</div>
<div class="csl-entry" id="ref-Bellman:1961" role="listitem">벨만, 리차드 어니스트 1961.<em>적응 형 제어 프로세스 : 가이드 투어</em>. 프린스턴 대학 출판부.</div>
<div class="csl-entry" id="ref-clemmensen2012sparse" role="listitem">Clemmensen, Line, Trevor Hastie, Daniela Witten 및 Bjarne Ersbøll. 2011.<span>"스파스 판별 분석."</span> <em>기술계</em>53 : 406–13.</div>
<div class="csl-entry" id="ref-friedmanbiasvariance01" role="listitem">Friedman, Jerome H. 1997.<span>"편견, 분산, 0/1 — Loss 및 차원 저주."</span> <em>데이터 마이닝 및 지식 발견</em>1 : 55–77.</div>
<div class="csl-entry" id="ref-HastieTibshiraniFriedman" role="listitem">Hastie, Trevor, Robert Tibshirani 및 Jerome Friedman. 2008.<em>통계 학습의 요소</em>. 2^{\ text {nd}} ed. 뛰는 것.</div>
<div class="csl-entry" id="ref-Holmes2017" role="listitem">홈즈, 수잔 2018.<span>"통계적 증거? 부적절한 문제의 문제."</span> <em>AMS의 게시판</em>55 (1) : 31–55.</div>
<div class="csl-entry" id="ref-James:2013" role="listitem">James, Gareth, Daniela Witten, Trevor Hastie 및 Robert Tibshirani. 2013.<em>통계 학습 소개</em>. 뛰는 것.</div>
<div class="csl-entry" id="ref-Neumann:2010" role="listitem">Neumann, B., T. Walter, J. K. Heriche, J. Bulkescher, H. Erfle, C. Conrad, P. Rogers 등. 2010 년.<span>"<span class="nocase"><span>피</span>시간 경과 현미경에 의한 인간 게놈의 Henotypic 프로파일 링은 세포 분열 유전자를 나타냅니다.</span>.”</span> <em>자연</em>464 (7289) : 721–27.</div>
<div class="csl-entry" id="ref-Ohnishi2014" role="listitem">Ohnishhi, Y., W. Huber, A. Tour, M. Kang, P. Xenopolos, K. Curioto, A. K. Oles 등. 2014.<span>"셀-세포 발현 변동성에 이어 신호 강화가 점차 초기 마우스 계보를 분리합니다."</span> <em>자연 세포 생물학</em>16 (1) : 27–37.</div>
<div class="csl-entry" id="ref-diabetes" role="listitem">Reaven, GM 및 RG Miller. 1979.<span>"다차원 분석을 사용하여 화학 당뇨병의 특성을 정의하려는 시도."</span> <em>당뇨병</em>16 (1) : 17–24.</div>
<div class="csl-entry" id="ref-witten2011penalized" role="listitem">Witten, Daniela M 및 Robert Tibshirani. 2011.<span>“페널리화 된 분류 사용<span>에프</span>Isher의 선형 판별제.”</span> <em>JRSSB</em>73 (5) : 753–72.</div>
<div class="csl-entry" id="ref-Zeller:MSB:2014" role="listitem">Zeller, Georg, Julien Tap, Anita 및 Voice, Sunnagawa Shinichi는 Roat Cultima, Paul I Country, Amiot 's Amels 등입니다. 2014.<span>"<span>피</span>결장 직장암의 초기 단계 검출을위한 대변 미생물 총의 전위.”</span> <em>분자 시스템 생물학</em>10 (11) : 766.<a href="https://doi.org/10.15252/msb.20145645">https://doi.org/10.15252/msb.20145645</a>.
</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
