<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>9  Multivariate methods for heterogeneous data – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="9  Multivariate methods for heterogeneous data – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/Brighton_West_Pier_20090214_sunset.jpg" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="9  Multivariate methods for heterogeneous data – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/Brighton_West_Pier_20090214_sunset.jpg" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">9.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#sec-hetero-multidimensionalscalingandordination" href="#sec-hetero-multidimensionalscalingandordination" id="toc-sec-hetero-multidimensionalscalingandordination"><span class="header-section-number">9.2</span>다차원 스케일링 및 안수</a></li>
<li><a class="nav-link" data-scroll-target="#contiguous-or-supplementary-information" href="#contiguous-or-supplementary-information" id="toc-contiguous-or-supplementary-information"><span class="header-section-number">9.3</span>연속 또는 보충 정보</a></li>
<li><a class="nav-link" data-scroll-target="#sec-hetero-CA" href="#sec-hetero-CA" id="toc-sec-hetero-CA"><span class="header-section-number">9.4</span>우발 테이블에 대한 서신 분석</a></li>
<li><a class="nav-link" data-scroll-target="#sec-hetero-findingtime" href="#sec-hetero-findingtime" id="toc-sec-hetero-findingtime"><span class="header-section-number">9.5</span>시간 및 기타 중요한 그라디언트 찾기.</a></li>
<li><a class="nav-link" data-scroll-target="#multitable-techniques" href="#multitable-techniques" id="toc-multitable-techniques"><span class="header-section-number">9.6</span>다중 기술</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">9.7</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">9.8</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">9.9</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-hetero"><span class="chapter-number">9</span>  <span class="chapter-title">이종 데이터를위한 다변량 방법</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/Brighton_West_Pier_20090214_sunset.jpg"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Brighton_West_Pier_20090214_sunset.jpg"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">실제 상황에는 종종 포인트 구름, 그라디언트, 그래프, 어트랙션 포인트, 소음 및 다른 공간 환경이 포함됩니다.</span></div></div>
<p>~ 안에<a class="quarto-xref" href="07-chap.html"><span>7 장</span></a>, 우리는 열이 연속 변수 인 직사각형 행렬을 요약하는 방법을 보았다. 우리가 만든지도는 가장 중요한 분리를 목표로하는 주요 구성 요소 분석과 같은 감독되지 않은 치수 감소 기술을 사용했습니다.<em>신호</em>매트릭스의 구성 요소<span class="math inline">\(엑스\)</span>모든 열에 의미있는 차이가있을 때.</p>
<p>여기서 우리는 이러한 아이디어를 연속 및 범주 형 변수를 결합하는보다 복잡한 이기종 데이터로 확장합니다. 실제로, 때때로, 우리의 관찰은 개별 변수 또는 좌표 세트로 쉽게 설명 할 수 없지만, 그들 사이의 거리 또는 (DIS) 유사성을 결정하거나 그래프 나 트리를 사용하여 그들 사이의 관계를 설명하는 것이 가능합니다. 예는 종 나무 또는 생물학적 서열의 종을 포함한다. 생물학 이외의 예제에는 텍스트 문서 나 영화 파일이 포함되어 있으며, 여기서는 유사성을 결정하는 합리적인 방법이 있지만 명백한 변수 나 좌표는 없습니다.</p>
<p>이 장에는 더 많은 고급 기술이 포함되어 있으며,이 기술은 종종 기술적 인 세부 사항을 생략합니다. 지금까지 와서 예제와 광범위한 참조에 대한 실습 경험을 제공함으로써 비선형 다변량 분석에서 더 많은 '최첨단'기술을 이해하고 사용할 수 있기를 바랍니다.</p>
<section class="level2" data-number="9.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="9.1"><span class="header-section-number">9.1</span>이 장의 목표</h2>
<p>이 장에서는 다음과 같습니다.</p>
<ul>
<li><p>선형 치수 감소 방법을 관찰 거리가 가능한 경우,<strong>중</strong>ulti<strong>디</strong>Imensional<strong>에스</strong>Caling (MDS) 또는 주요 좌표 분석.</p></li>
<li><p>비선형적이고 특이 치가 강력한 MD의 수정을 찾으십시오.</p></li>
<li><p>범주 형 데이터와 연속 데이터뿐만 아니라 소위 '보충'정보의 조합을 인코딩합니다. 우리는 이것이 우리가 다루는 데 도움이된다는 것을 알 것입니다<em>배치 효과</em>.</p></li>
<li><p>카이-제곱 거리를 사용하십시오<strong>기음</strong>응답<strong>에이</strong>Nalysis (Ca)는 범주 형 데이터 (우발 테이블)에 주목할만한 종속성이 포함 된 위치를 확인합니다.</p></li>
<li><p>범주 형이 아닌 잠재 변수를 발견 할 수있는 클러스터링 방법을 일반화하십시오. 이를 통해 우리는 데이터에서 "Pseudotime"및 숨겨진 비선형 효과를 감지 할 수 있습니다.</p></li>
<li><p>여러 다른 데이터 영역의 데이터 테이블 연구에 대한 분산 및 공분산 개념을 일반화하십시오.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="9.2" id="sec-hetero-multidimensionalscalingandordination">
<h2 class="anchored" data-anchor-id="sec-hetero-multidimensionalscalingandordination" data-number="9.2"><span class="header-section-number">9.2</span>다차원 스케일링 및 안수</h2>
<p>때로는 데이터가 있습니다<em>~ 아니다</em>기능 공간의 점으로 표시됩니다. 이것은 우리가 약물, 이미지, 나무 또는 기타 복잡한 물체와 같은 물체 사이에 (dis) 유사성 행렬을 제공 할 때 발생할 수 있습니다.<span class="math inline">\ ({\ mathbb r}^n \)</span>.</p>
<p>~ 안에<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>우리는 생산 방법을 보았습니다<em>클러스터</em>거리에서. 여기서 우리의 목표는 PCA의 처음 몇 가지 주요 축에서 만든 것들을 연상시키는 저 차원 공간 (예 : 평면)의 맵에서 데이터를 시각화하는 것입니다.</p>
<p>우리는 지리 데이터를 사용하는 직관적 인 예로 시작합니다. ~ 안에<a class="quarto-xref" href="#fig-HeatDists">수치<span>9.1</span></a>, 우크라이나의 도시와 장소 사이의 거리의 열도 및 클러스터링<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>표시됩니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>이 데이터의 출처는 데이터 폴더의 스크립트 우크라이나-디스트 (Script Ukraine-Dists.r)에 설명되어 있습니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"pheatmap"</span>))</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"우크라이나 _dists"</span>,,,<span class="at">패키지 =</span> <span class="st">"MSMB"</span>))</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a><span class="fu">as.matrix</span>(우크라이나 _dists) [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kyiv Odesa Sevastopol Chernihiv
KYIV 0.0000 441.2548 687.7551 128.1287
ODESA 441.2548 0.0000 301.7482 558.6483
Sevastopol 687.7551 301.7482 0.0000 783.6561
Chernihiv 128.1287 558.6483 783.6561 0.0000</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">as.matrix</span>(우크라이나 _dists),</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a>  <span class="at">색상 =</span> <span class="fu">colormppalette</span>(<span class="fu">기음</span>(<span class="st">"#0057B7"</span>,,,<span class="st">"#ffd700"</span>)) (<span class="dv">50</span>),)</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="fu">맥스</span>(우크라이나 _dists)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),)<span class="at">length.out =</span> <span class="dv">51</span>))<span class="sc">^</span><span class="dv">2</span>,,,</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a>  <span class="at">treeheight_row =</span> <span class="dv">10</span>,,,<span class="at">treeheight_col =</span> <span class="dv">10</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HeatDists">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HeatDists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="09-chap_files/figure-html/fig-HeatDists-1.png" title="Figure 9.1: A heatmap of the ukraine_dists distance matrix. Distances are measured in kilometres. The function has re-arranged the order of the cities, and grouped the closest ones."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-HeatDists-1.png" width="552"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HeatDists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.1 : 히트 맵<code>우크라이나 _dists</code>거리 매트릭스. 거리는 킬로미터로 측정됩니다. 이 기능은 도시의 순서를 다시 정렬하고 가장 가까운 도시로 그룹화했습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>게다가<code>우크라이나 _dists</code>쌍별 거리가 포함 된, 위에서로드 한 RDATA 파일에는 데이터 프레임도 포함되어 있습니다.<code>우크라이나 _coords</code>경도와 위도로; 우리는 이것을 나중에 근거 진실로 사용할 것입니다. 거리가 주어지면 다차원 스케일링 (MDS)은 상대 위치의 "맵"을 제공합니다. 2D 평면에서의 유클리드 거리가 주어진 거리 매트릭스를 정확하게 재현하도록 도시를 마련하는 것은 불가능합니다. 도시는 비행기가 아닌 지구의 곡선 표면에 놓여 있습니다. 그럼에도 불구하고, 우리는 데이터를 잘 나타내는 2 차원 임베딩을 찾을 수 있습니다. 생물학적 데이터를 사용하면 2D 임베딩이 훨씬 덜 명확해질 수 있습니다. 우리는 다음과 같이 기능을 호출합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a>우크라이나 _mds<span class="ot">=</span> <span class="fu">cmdscale</span>(우크라이나 _dists,<span class="at">eig =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는이 장에서 여러 번 재사용 할 기능을합니다.<code>cmdscale</code>기능:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3" tabindex="-1"></a>플로트 크리<span class="ot">=</span> <span class="cf">기능</span>(엑스,<span class="at">m =</span> <span class="fu">길이</span>(엑스<span class="sc">$</span>eig)) {</span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">eig =</span>엑스<span class="sc">$</span>eig [<span class="fu">seq_len</span>(중)],<span class="at">k =</span> <span class="fu">서열</span>(<span class="at">함께 =</span>eig)),</span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5" tabindex="-1"></a>    <span class="fu">AES</span>(<span class="at">x =</span>케이,<span class="at">y =</span>EIG))<span class="sc">+</span> <span class="fu">테마_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="st">"케이"</span>,,,<span class="at">한계 =</span> <span class="fu">AS.Factor</span>(<span class="fu">seq_len</span>(중)))<span class="sc">+</span> </span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">통계 =</span> <span class="st">"신원"</span>,,,<span class="at">너비 =</span> <span class="fl">0.5</span>,,,<span class="at">fill =</span> <span class="st">"#ffd700"</span>,,,<span class="at">col =</span> <span class="st">"#0057B7"</span>))</span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8" tabindex="-1"></a>}</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a><span class="fu">플로트 크리</span>(우크라이나 _mds,<span class="at">m =</span> <span class="dv">4</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotscreeeig">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotscreeeig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="09-chap_files/figure-html/fig-plotscreeeig-1.png" title="Figure 9.2: Screeplot of the first four eigenvalues. There is a pronounced drop after the first two eigenvalues, which indicates that the data are well described by a two-dimensional embedding."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-plotscreeeig-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotscreeeig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.2 : 처음 4 개의 고유 값의 screeplot. 처음 두 고유 값 후에 뚜렷한 낙하가 있으며, 이는 데이터가 2 차원 임베딩으로 잘 설명되어 있음을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-barplotEurope">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.1</div>
</div>
<div class="callout-body-container callout-body">
<p>the의 모든 고유 값을보십시오<code>cmdscale</code>기능 : 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-2-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-2-contents callout-collapse collapse" id="callout-2">
<div class="callout-body-container callout-body">
<p>실행하는 경우 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a>우크라이나 _mds<span class="sc">$</span>eig<span class="sc">|&gt;</span> <span class="fu">의미가 있습니다</span>(<span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.91E+06 1.08E+06 3.42E+02 4.84E-01 2.13E-01 3.83E-05 5.90E-06
 [8] 5.82E-07 8.79E-08 4.94E-08 6.52E-10 2.84E-10 1.84E-10 5.22E-11
[15] 4.89E-11 4.57E-11 -3.26E-12 -2.55E-11 -5.90E-11 -6.55E-11 -1.40E-10
[22] -1
[29] -2.51E -04 -1.41E -02 -1.19E -01 -3.58E+02 -8.85E+02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="fu">플로트 크리</span>(우크라이나 _mds)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotscreeeigall">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotscreeeigall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="09-chap_files/figure-html/fig-plotscreeeigall-1.png" title="Figure 9.3: Screeplot of all the eigenvalues."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-plotscreeeigall-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotscreeeigall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.3 : 모든 고유 값의 screeplot.</figcaption>
</figure>
</div>
</div>
</div>
<p>PCA와 달리 부정적인 고유 값이 있습니다. 이들은 길 때문입니다<code>cmdscale</code>공장.</p>
</div>
</div>
</div>
<p>메인 출력<code>cmdscale</code>기능은 우리가 보여주는 2 차원 임베딩의 좌표입니다.<a class="quarto-xref" href="#fig-ukrainemds1">수치<span>9.4</span></a>(다음 섹션에서 알고리즘이 어떻게 작동하는지 논의 할 것입니다).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a>우크라이나 _mds_df<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb10-2"><a aria-hidden="true" href="#cb10-2" tabindex="-1"></a>  <span class="at">PCO1 =</span>우크라이나 _mds<span class="sc">$</span>전철기[,<span class="dv">1</span>],,</span>
<span id="cb10-3"><a aria-hidden="true" href="#cb10-3" tabindex="-1"></a>  <span class="at">pco2 =</span>우크라이나 _mds<span class="sc">$</span>전철기[,<span class="dv">2</span>],,</span>
<span id="cb10-4"><a aria-hidden="true" href="#cb10-4" tabindex="-1"></a>  <span class="at">실험실 =</span> <span class="fu">Rownames</span>(우크라이나 _mds<span class="sc">$</span>전철기)</span>
<span id="cb10-5"><a aria-hidden="true" href="#cb10-5" tabindex="-1"></a>))</span>
<span id="cb10-6"><a aria-hidden="true" href="#cb10-6" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggrepel"</span>))</span>
<span id="cb10-7"><a aria-hidden="true" href="#cb10-7" tabindex="-1"></a>g<span class="ot">=</span> <span class="fu">ggplot</span>(우크라이나 _mds_df,<span class="fu">AES</span>(<span class="at">x =</span>PCO1,<span class="at">y =</span>PCO2,<span class="at">레이블 =</span>실험실))<span class="sc">+</span></span>
<span id="cb10-8"><a aria-hidden="true" href="#cb10-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>(<span class="at">col =</span> <span class="st">"#0057B7"</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>() </span>
<span id="cb10-9"><a aria-hidden="true" href="#cb10-9" tabindex="-1"></a>g</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ukrainemds1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ukrainemds1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="09-chap_files/figure-html/fig-ukrainemds1-1.png" title="Figure 9.4: MDS map based on the distances."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ukrainemds1-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ukrainemds1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.4 : 거리에 따른 MDS 맵.</figcaption>
</figure>
</div>
</div></div></div>
<p>상대적 위치는 정확하지만지도의 방향은 전통적이지 않습니다. 크리미아는 맨 위에 있습니다. 이것은 거리에서 평면 임베딩을 재구성하는 방법을 가진 일반적인 현상입니다. 포인트 사이의 거리는 회전 및 반사 (Axis Flips) 하에서 변하지 않기 때문에 모든 솔루션은 회전 또는 반사를 통해 이와 관련된 다른 솔루션만큼 좋습니다. 기능과 같은 기능<code>cmdscale</code>똑같이 최적의 솔루션 중 하나를 선택하며 특정 선택은 데이터의 미세한 세부 사항 또는 사용중인 컴퓨팅 플랫폼에 따라 다를 수 있습니다. 여기서 우리는 우리의 결과를<span class="math inline">\(와이\)</span>-중심선. 우리는지도를 다시 그립니다<a class="quarto-xref" href="#fig-ukrainemds2">수치<span>9.5</span></a>이것을<code>우크라이나 _coords</code>데이터 프레임 (<a class="quarto-xref" href="#fig-ukrainecoord1">수치<span>9.6</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a>g<span class="sc">%+%</span> <span class="fu">돌연변이</span>(우크라이나 _mds_df,<span class="at">PCO1 =</span>PCO1,<span class="at">pco2 =</span> <span class="sc">-</span>PCO2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ukrainemds2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ukrainemds2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="09-chap_files/figure-html/fig-ukrainemds2-1.png" title="Figure 9.5: Same as Figure fig-ukrainemds1, but with y-axis flipped."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ukrainemds2-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ukrainemds2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.5 : 동일합니다<a class="quarto-xref" href="#fig-ukrainemds1">수치<span>9.4</span></a>그러나 y 축이 뒤집힌 상태에서.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"우크라이나 _coords"</span>,,,<span class="at">패키지 =</span> <span class="st">"MSMB"</span>))</span>
<span id="cb12-2"><a aria-hidden="true" href="#cb12-2" tabindex="-1"></a><span class="fu">print.data.frame</span>(우크라이나 _coords [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,,,<span class="fu">기음</span>(<span class="st">"도시"</span>,,,<span class="st">"LAT"</span>,,,<span class="st">"론"</span>))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>City Lat Lon
1 KYIV 50.45003 30.52414
2 ODESA 46.48430 30.73229
3 Sevastopol 44.60544 33.52208
4 Chernihiv 51.49410 31.29433</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(우크라이나 _coords,<span class="fu">AES</span>(<span class="at">x =</span>론,<span class="at">y =</span>LAT,<span class="at">레이블 =</span>도시))<span class="sc">+</span></span>
<span id="cb14-2"><a aria-hidden="true" href="#cb14-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>(<span class="at">col =</span> <span class="st">"#0057B7"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ukrainecoord1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ukrainecoord1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="09-chap_files/figure-html/fig-ukrainecoord1-1.png" title="Figure 9.6: True latitudes and longitudes, taken from the ukraine_coords dataframe."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ukrainecoord1-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ukrainecoord1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.6 : 진정한 위도와 종단,에서 가져온<code>우크라이나 _coords</code>데이터 프레임.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-mdsflip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.2</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 오른쪽 패널에서 종단과 위도를 그렸습니다.<a class="quarto-xref" href="#fig-ukrainecoord1">수치<span>9.6</span></a>종횡비에주의없이. 이 플롯의 올바른 종횡비는 얼마입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-4-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-4-contents callout-collapse collapse" id="callout-4">
<div class="callout-body-container callout-body">
<p>경도의 1도 변화와 위도의 1도 변화에 해당하는 거리 사이에는 단순한 관계가 없으므로 선택하기가 어렵습니다. 우리 지구가 구형이고 반경이 6371km라는 단순화 된 가정 하에도 복잡합니다. 위도의 1도 항상 111km 거리에 해당합니다 (<span class="math inline">\ (6371 \ times2 \ pi/360 \)</span>), 적도의 경도도 1도. 그러나 적도에서 멀어지면 경도 정도는 거리가 짧고 짧은 거리에 해당하며 (극에서는 거리가 전혀 없음). 실용적으로, IN과 같은 디스플레이<a class="quarto-xref" href="#fig-ukrainecoord1">수치<span>9.6</span></a>, 우리는 북부와 남부의 중간에있는 종횡비에 대한 값을 48 도의 코사인으로 선택할 수 있습니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-ukrainemap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.3</div>
</div>
<div class="callout-body-container callout-body">
<p>Rivers와 같은 국제 경계 및 지리적 특징을 추가하십시오.<a class="quarto-xref" href="#fig-ukrainecoord1">수치<span>9.6</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-6-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-6-contents callout-collapse collapse" id="callout-6">
<div class="callout-body-container callout-body">
<p>시작점은 아래 코드에 의해 제공되며 국제 경계를 다각형으로 추가합니다 (<a class="quarto-xref" href="#fig-ukrainewithborders">수치<span>9.7</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"지도"</span>))</span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a>UA_BORDERS<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">필터</span>(<span class="fu">MAP_DATA</span>(<span class="st">"세계"</span>), 지역<span class="sc">==</span> <span class="st">"우크라이나"</span>))</span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a><span class="fu">ggplot</span>(우크라이나 _coords,<span class="fu">AES</span>(<span class="at">x =</span>론,<span class="at">y =</span>LAT))<span class="sc">+</span> </span>
<span id="cb15-4"><a aria-hidden="true" href="#cb15-4" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">데이터 =</span>UA_BORDERS,<span class="fu">AES</span>(<span class="at">x =</span>긴,<span class="at">y =</span>LAT,<span class="at">그룹 =</span>하위 지역),<span class="at">fill =</span> <span class="st">"#ffd700"</span>,,,<span class="at">색상 =</span> <span class="st">"#0057B7"</span>))<span class="sc">+</span></span>
<span id="cb15-5"><a aria-hidden="true" href="#cb15-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-6"><a aria-hidden="true" href="#cb15-6" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span>도시))<span class="sc">+</span></span>
<span id="cb15-7"><a aria-hidden="true" href="#cb15-7" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">코사인</span>(<span class="dv">48</span><span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>많은 것이 있습니다<a href="https://cran.r-project.org/web/views/Spatial.html">지리 공간 데이터의 경우 R에서 사용할 수있는 추가 인프라</a>벡터 및 래스터 데이터 유형을 포함한</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ukrainewithborders">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ukrainewithborders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="09-chap_files/figure-html/fig-ukrainewithborders-1.png" title="Figure 9.7: International borders added to Figure fig-ukrainecoord1."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ukrainewithborders-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ukrainewithborders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.7 : 국제 국경이 추가되었습니다<a class="quarto-xref" href="#fig-ukrainecoord1">수치<span>9.6</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>메모:</strong>MDS는 PCA와 유사한 출력을 생성하지만 데이터 (샘플 포인트)에 하나의 '차원'만 있습니다. '듀얼'치수가없고, 이브 플로트가없고 로딩 벡터가 없습니다. 이것은지도를 해석 할 때의 단점입니다. 극단적 인 요점과 그 차이를주의 깊게 조사함으로써 해석을 촉진 할 수 있습니다.</p>
<section class="level3 page-columns page-full" data-number="9.2.1" id="how-does-the-method-work">
<h3 class="anchored" data-anchor-id="how-does-the-method-work" data-number="9.2.1"><span class="header-section-number">9.2.1</span>방법은 어떻게 작동합니까?</h3>
<div class="page-columns page-full"><p>좌표가 알려진 포인트로 시작하면 어떻게 될지 살펴 보겠습니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>. 우리는이 좌표를 포인트만큼 많은 행으로 매트릭스의 두 열에 넣었습니다. 이제 우리는이 좌표를 기반으로 점 사이의 거리를 계산합니다. 좌표에서 이동합니다<span class="math inline">\(엑스\)</span>거리에 우리는 글을 씁니다<span class="math display">\ [d^2_ {i, j} = (x_i^1 -x_j^1)^2 + \ dots + (x_i^p -x_j^p)^2. \]</span>우리는 제곱 거리의 매트릭스를 호출 할 것입니다<code>점</code>R과<span class="math inline">\ (D \ Bullet D \)</span>텍스트에서. 우리는 그들의 거리의 제곱이 가능한 한 가깝게<span class="math inline">\ (D \ Bullet D \)</span>관찰되었습니다.<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a></p><div class="no-row-height column-margin column-container"><span class="margin-aside">이것은 다릅니다<span class="math inline">\ (dd \)</span>또는<span class="math inline">\ (d^2 \)</span>, 매트릭스 다소 클레이션<span class="math inline">\(디\)</span>그 자체로.</span><div id="fn3"><p><sup>3</sup>여기서 우리는 도시의 종단과 위도를 직교 좌표로 사용하여 구체와 같은 표면의 곡선 좌표라는 사실을 무시함으로써 약간의 '남용'을 약속합니다.</p></div></div></div>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>여기서 우리는 도시의 경도와 경도를 직교 좌표로 사용하고 지구 표면의 곡률을 무시함으로써 약간의 '남용'을 저지 릅니다. Haversine Formula에 대한 정보는 인터넷을 확인하십시오.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a>엑스<span class="ot">=</span> <span class="fu">~와 함께</span>(우크라이나 _coords,<span class="fu">cbind</span>(론, 년<span class="sc">*</span> <span class="fu">코사인</span>(<span class="dv">48</span>))))</span>
<span id="cb16-2"><a aria-hidden="true" href="#cb16-2" tabindex="-1"></a>점<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(엑스)<span class="sc">^</span><span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>상대 거리는 데이터의 원점에 의존하지 않습니다. 우리는 센터링 매트릭스를 사용하여 데이터를 중심으로합니다<span class="math inline">\(시간\)</span>정의<span class="math inline">\ (h = i- \ frac {1} {n} {\ mathbf {11}}^t \)</span>. 확인해 봅시다<em>센터링</em>속성<span class="math inline">\(시간\)</span>사용 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a>N<span class="ot">=</span> <span class="fu">nrow</span>(엑스)</span>
<span id="cb17-2"><a aria-hidden="true" href="#cb17-2" tabindex="-1"></a>시간<span class="ot">=</span> <span class="fu">일관성</span>(<span class="fu">대표</span>(<span class="dv">1</span>,N))<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>N)<span class="sc">*</span> <span class="fu">행렬</span>(<span class="dv">1</span>,,,<span class="at">nrow =</span>N,<span class="at">NCOL =</span>N)</span>
<span id="cb17-3"><a aria-hidden="true" href="#cb17-3" tabindex="-1"></a>XC<span class="ot">=</span> <span class="fu">스위프</span>(엑스,<span class="dv">2</span>,,,<span class="fu">적용하다</span>(엑스,<span class="dv">2</span>,평균))</span>
<span id="cb17-4"><a aria-hidden="true" href="#cb17-4" tabindex="-1"></a>xc [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>론          
[1,] -1722946 -1.184705
[2,] -0.9641429 1.353935</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a>hx<span class="ot">=</span>시간<span class="sc">%*%</span>엑스</span>
<span id="cb19-2"><a aria-hidden="true" href="#cb19-2" tabindex="-1"></a>hx [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>론          
[1,] -1722946 -1.184705
[2,] -0.9641429 1.353935</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a><span class="fu">적용하다</span>(hx,<span class="dv">2</span>, 평균)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>론               
-1.618057E-15 1.747077E-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-centering">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.4</div>
</div>
<div class="callout-body-container callout-body">
<p>부르다<code>B0</code>중앙 행렬을 오른쪽과 왼쪽에 적용하여 얻은 행렬<code>점</code>주어진 원점을 중심으로 한 점을 고려하십시오.<span class="math inline">\ (hx \)</span>매트릭스와 크로스 제품을 계산하면이를 호출합니다<code>B2</code>. 당신은 무엇을해야합니까?<code>B0</code>그것을 동등하게 만들기 위해<code>B2</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-8-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-8-contents callout-collapse collapse" id="callout-8">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a>B0<span class="ot">=</span>시간<span class="sc">%*%</span>점<span class="sc">%*%</span>시간</span>
<span id="cb23-2"><a aria-hidden="true" href="#cb23-2" tabindex="-1"></a>B2<span class="ot">=</span>hx<span class="sc">%*%</span> <span class="fu">티</span>(HX)</span>
<span id="cb23-3"><a aria-hidden="true" href="#cb23-3" tabindex="-1"></a>B2 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]<span class="sc">/</span>B0 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3]
[1,] -0.5 -0.5 -0.5
[2,] -0.5 -0.5 -0.5
[3,] -0.5 -0.5 -0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a><span class="fu">맥스</span>(<span class="fu">ABS</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span>B0<span class="sc">-</span>B2))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.237056E-14</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>따라서 행 사이의 제곱 거리를 감안할 때 (<span class="math inline">\ (D \ Bullet D \)</span>)) 및 중앙 매트릭스의 교차 산물<span class="math inline">\ (b = (hx) (hx)^t \)</span>, 우리는 다음을 보여 주었다 :</p>
<p><span class="anchored-eq" data-anchor-id="eq-91" id="eq-91"><span class="math display">\ [
-\ frac {1} {2} h (d \ Bullet d) h = b
\ tag {9.1} \]</span></span></p>
<p>이것은 항상 사실이며, 우리는 그것을 사용하여 리버스 엔지니어링합니다.<span class="math inline" data-anchor-id="eq-91">\(엑스\)</span>만족합니다<a class="quarto-xref" href="#eq-91">방정식<span>9.1</span></a>우리가 주어질 때<span class="math inline">\ (D \ Bullet D \)</span>시작합니다.</p>
<section class="level4 unnumbered page-columns page-full" id="from-dbullet-d-to-x-using-singular-vectors.">
<h4 class="unnumbered anchored" data-anchor-id="from-dbullet-d-to-x-using-singular-vectors.">에서<span class="math inline">\ (D \ Bullet D \)</span>에게<span class="math inline">\(엑스\)</span>단일 벡터 사용.</h4>
<p>우리는 매트릭스에서 뒤로 갈 수 있습니다<span class="math inline" data-anchor-id="eq-91">\ (D \ Bullet D \)</span>에게<span class="math inline">\(엑스\)</span>Eigen-Decomcomposition을 취함으로써<span class="math inline">\(비\)</span>정의 된대로<a class="quarto-xref" href="#eq-91">방정식<span>9.1</span></a>. 이것은 또한 우리가 몇 개의 좌표 또는 열을 선택할 수있게합니다.<span class="math inline">\(엑스\)</span>행렬. 이것은 PCA가 최고의 순위를 제공하는 방법과 매우 유사합니다.<span class="math inline">\(아르 자형\)</span>근사.<br/>
<strong>메모</strong>: PCA에서와 같이, 우리는 단일 가치 분해를 사용하여 이것을 쓸 수 있습니다.<span class="math inline">\ (hx \)</span>(또는 고유 분해<span class="math inline">\ (hx (hx)^t \)</span>) : :</p>
<p><span class="math display">\ [
hx^{(r)} = us^{(r)} v^t \ mbox {with}
s^{(r)} \ mbox {첫 번째} r \ mbox {singular values}의 대각선 행렬,
\]</span></p>
<div class="page-columns page-full"><p>이것은 유클리드의 치수 공간에서 가장 대략적인 표현을 제공합니다.<span class="math inline">\(아르 자형\)</span>.  알고리즘은 우리에게<span class="math inline">\(디\)</span>행렬.</p><div class="no-row-height column-margin column-container"><span class="margin-aside"><span class="math display">\ [s^{(r)} =
\ 시작 {pmatrix}
S_1 &amp; 0 &amp; 0 &amp; 0 &amp; ... \\
0 &amp; s_2 &amp; 0 &amp; 0 &amp; ... \\
0 &amp; 0 &amp; ... &amp; ... &amp; ... \\
0 &amp; 0 &amp; ... &amp; s_r &amp; ... \\
... &amp; ... &amp; ... &amp; 0 &amp; 0 \\
\ end {pmatrix} \]</span></span><span class="margin-aside">이 방법을 종종 주요 좌표 분석 또는 PCA와의 연결을 강조하는 PCOA라고합니다.</span></div></div>
</section>
<section class="level4 unnumbered" id="classical-mds-algorithm.">
<h4 class="unnumbered anchored" data-anchor-id="classical-mds-algorithm.">고전적인 MDS 알고리즘.</h4>
<p>요약하면<span class="math inline">\ (n \ times n \)</span>제곱 지점 간 거리의 매트릭스<span class="math inline">\ (D \ Bullet D \)</span>, 우리는 포인트와 좌표를 찾을 수 있습니다<span class="math inline">\ (\ tilde {x} \)</span>다음 작업에 의해 :</p>
<ol type="1">
<li><p>지점 간 거리를 이중으로 제곱하고 곱하십시오.<span class="math inline">\ (-\ frac {1} {2} \)</span>:<br/>
<span class="math inline">\ (b = -\ frac {1} {2} H D \ Bullet D H \)</span>.</p></li>
<li><p>대각 화<span class="math inline">\(비\)</span>: <span class="math inline">\ (\ Quad B = u \ lambda u^t \)</span>.</p></li>
<li><p>발췌<span class="math inline">\ (\ tilde {x} \)</span>: <span class="math inline">\ (\ quad \ tilde {x} = u \ lambda^{1/2} \)</span>.</p></li>
</ol>
</section>
<section class="level4 unnumbered page-columns page-full" id="finding-the-right-underlying-dimensionality.">
<h4 class="unnumbered anchored" data-anchor-id="finding-the-right-underlying-dimensionality.">올바른 기본 차원을 찾습니다.</h4>
<p>예를 들어, 우리가 유사성을 가지고 있지만 (거리에 대한 초대화), 자연스러운 기본 유클리드 공간이없는 물건을 가져 가겠습니다.</p>
<p>1950 년대의 심리학 실험에서<span class="citation" data-cites="Ekman:1954">에크 만 (Ekman)<a href="16-chap.html#ref-Ekman:1954" role="doc-biblioref">1954</a>))</span>31 명의 피험자에게 14 가지 색상의 유사성을 평가하도록 요청했습니다. 그의 목표는 색 인식의 기본 차원을 이해하는 것이 었습니다. 유사성 또는 혼란 매트릭스는 0과 1 사이의 값을 갖도록 조정되었습니다. 종종 혼란 스러웠던 색상은 1에 가까운 유사성을 가졌습니다. 우리는 1에서 값을 빼서 데이터를 비 유사성으로 변환했습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a>Ekm<span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"../data/ekman.txt"</span>,,,<span class="at">헤더 =</span><span class="cn">진실</span>))</span>
<span id="cb27-2"><a aria-hidden="true" href="#cb27-2" tabindex="-1"></a><span class="fu">Rownames</span>(EKM)<span class="ot">=</span> <span class="fu">colnames</span>(EKM)</span>
<span id="cb27-3"><a aria-hidden="true" href="#cb27-3" tabindex="-1"></a>불안<span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span>Ekm<span class="sc">-</span> <span class="fu">일관성</span>(<span class="dv">1</span>,,,<span class="fu">NCOL</span>(EKM))</span>
<span id="cb27-4"><a aria-hidden="true" href="#cb27-4" tabindex="-1"></a>불만<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>W434 W445 W465 W472 W490
W434 0.00 0.14 0.58 0.58 0.82
W445 0.14 0.00 0.50 0.56 0.78
W465 0.58 0.50 0.00 0.19 0.53
W472 0.58 0.56 0.19 0.00 0.46
W490 0.82 0.78 0.53 0.46 0.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a>불안<span class="ot">=</span> <span class="fu">as.dist</span>(disekm)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>MDS 좌표 및 고유 값을 계산합니다. 우리는 표시된 screeplot의 고유 값을 결합합니다<a class="quarto-xref" href="#fig-ekmanMDSeig">수치<span>9.8</span></a>:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a>mdsekm<span class="ot">=</span> <span class="fu">cmdscale</span>(Disekm,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb30-2"><a aria-hidden="true" href="#cb30-2" tabindex="-1"></a><span class="fu">플로트 크리</span>(mdsekm)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ekmanMDSeig">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ekmanMDSeig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="09-chap_files/figure-html/fig-ekmanMDSeig-1.png" title="Figure 9.8: The screeplot shows us that the phenomenon is largely two dimensional."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ekmanMDSeig-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ekmanMDSeig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.8 : ScreePlot은 현상이 크게 2 차원임을 보여줍니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는 다음과 같이 처음 두 주요 좌표를 사용하여 다른 색상을 그려줍니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a>dfekm<span class="ot">=</span>mdsekm<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="sc">|&gt;</span></span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a>  <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="fu">페이스트0</span>(<span class="st">"MDS"</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))<span class="sc">|&gt;</span></span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a aria-hidden="true" href="#cb31-4" tabindex="-1"></a>  <span class="fu">돌연변이</span>(</span>
<span id="cb31-5"><a aria-hidden="true" href="#cb31-5" tabindex="-1"></a>    <span class="at">이름 =</span> <span class="fu">Rownames</span>(ekm),</span>
<span id="cb31-6"><a aria-hidden="true" href="#cb31-6" tabindex="-1"></a>    <span class="at">RGB =</span>광 생물학<span class="sc">::</span><span class="fu">W_LENGTH2RGB</span>(<span class="fu">as.numeric</span>(<span class="fu">보결</span>(<span class="st">"W"</span>,,,<span class="st">"" "</span>, 이름))))</span>
<span id="cb31-7"><a aria-hidden="true" href="#cb31-7" tabindex="-1"></a><span class="fu">ggplot</span>(dfekm,<span class="fu">AES</span>(<span class="at">x =</span>MDS1,<span class="at">y =</span>MDS2))<span class="sc">+</span></span>
<span id="cb31-8"><a aria-hidden="true" href="#cb31-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col =</span>dfekm<span class="sc">$</span>RGB,<span class="at">크기 =</span> <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb31-9"><a aria-hidden="true" href="#cb31-9" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span>이름))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ekmanMDS-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ekmanMDS-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="09-chap_files/figure-html/fig-ekmanMDS-1-1.png" title="Figure 9.9: The layout of the scatterpoints in the first two dimensions has a horseshoe shape. The labels and colors show that the arch corresponds to the wavelengths."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ekmanMDS-1-1.png" width="368"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ekmanMDS-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.9 : 처음 2 차원에서 산란 점의 레이아웃에는 말굽 모양이 있습니다. 레이블과 색상은 아치가 파장에 해당한다는 것을 보여줍니다.</figcaption>
</figure>
</div>
</div></div></div>
<p><a class="quarto-xref" href="#fig-ekmanMDS-1">수치<span>9.9</span></a>새로운 좌표로 Ekman 데이터를 보여줍니다. 설명을 요구하는 놀라운 패턴이 있습니다. 포인트 의이 말굽 또는 아치 구조는 종종 데이터의 순차적 잠재 순서 또는 그라디언트의 지표입니다.<span class="citation" data-cites="Goel:2007aa">(<a href="16-chap.html#ref-Goel:2007aa" role="doc-biblioref">Diaconis, Goel 및 Holmes 2008</a>))</span>. 우리는 이것을 다시 방문 할 것입니다<a class="quarto-xref" href="#sec-hetero-findingtime"><span>섹션 9.5</span></a>.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="9.2.2" id="robust-versions-of-mds">
<h3 class="anchored" data-anchor-id="robust-versions-of-mds" data-number="9.2.2"><span class="header-section-number">9.2.2</span>강력한 버전의 MD</h3>
<div class="page-columns page-full"><p>다차원 스케일링은 제곱 거리의 차이를 최소화하는 것을 목표로합니다.<span class="math inline">\ (D \ Bullet D \)</span>그리고 새로운 좌표로 포인트 사이의 제곱 거리. 불행하게도,이 목표는 특이 치에 민감한 경향이 있습니다. 다른 모든 사람들과 먼 거리를 가진 하나의 단일 데이터 포인트가 전체 분석을 지배 할 수 있습니다. 종종 우리는 더 강력한 것을 사용하는 것을 좋아하며,이를 달성하는 한 가지 방법은 거리의 실제 값을 무시하고 원본과 새로운 거리의 상대 순위가 가능한 한 비슷하다고 묻는 것입니다. 이러한 순위 기반 접근법은 강력합니다. 이상치에 대한 민감도가 줄어 듭니다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>견고성 :</strong>방법은 몇 가지 이상치의 영향을받지 않으면 강력합니다. 예를 들어, 세트의 중앙값입니다<span class="math inline">\(N\)</span>우리가 20 개를 임의로 많은 양으로 변경하더라도 숫자는 많이 변하지 않습니다. 중앙값을 크게 바꾸려면 숫자의 절반 이상을 변경해야합니다. 대조적으로, 우리는 숫자 중 하나를 조작하여 평균을 대량으로 변경할 수 있습니다. 우리는 그렇게 말합니다<em>고장 지점</em>중앙값 중 1/2이고 평균의 것만<span class="math inline">\ (1/n \)</span>. 평균과 중앙값은 모두의 추정치입니다<em>위치</em>분포 중 (즉, 숫자의 "일반적인"값은) 중앙값은 더 강력합니다. 중앙값은 순위를 기준으로합니다. 보다 일반적으로, 순위를 기반으로하는 방법은 종종 실제 값을 기반으로하는 방법보다 더 강력합니다. 많은 비모수 적 테스트는 데이터의 순위 감소를 기반으로합니다.</span></div></div>
<p>우리는 Ekman 데이터를 사용하여 측정의 '스케일'에 대해 확실하지 않은 경우 강력한 방법이 얼마나 유용한지를 보여줄 것입니다. 비 메트릭 다차원 스케일링 (짧은 NMD)이라고하는 강력한 안수<strong>주문하다</strong>새 맵의 재구성 된 거리의 원래 거리 매트릭스의 순서와 동일합니다.</p>
<p>비 메트릭 MDS는 변환을 찾습니다<span class="math inline">\(에프\)</span>매트릭스에서 주어진 비 유사성 중<span class="math inline">\(디\)</span>저 차원 공간에서 일련의 좌표 세트 (<em>지도</em>)이 새로운지도의 거리는<span class="math inline">\ (\ tilde {d} \)</span>그리고<span class="math inline">\ (f (d) \ tickApprox \ tilde {d} \)</span>. 근사치의 품질은 표준화 된 잔류 합의 제곱에 의해 측정 될 수있다.<span class="smallcaps">스트레스</span>) 기능:</p>
<p><span class="math display">\ [
\ text {응력}^2 = \ frac {\ sum (f (d)-\ tilde {d})^2} {\ sum d^2}.
\]</span></p>
<p>NMD는 처음에 기본 치수를 지정해야한다는 점에서 순차적이지 않으며 해당 숫자에 따라 거리의 재구성을 최대화하기 위해 최적화가 실행됩니다. PCA에 제공된 개별 축에 의해 설명 된 변동의 백분율 개념은 없습니다. 그러나 우리는 모든 연속적인 값에 대한 프로그램을 실행하여 Simili-ScreePlot을 만들 수 있습니다.<span class="math inline">\(케이\)</span> (<span class="math inline">\ (k = 1, 2, 3, ... \)</span>) 그리고 얼마나 잘보 고<span class="smallcaps">스트레스</span>액. 다음은 이러한 연속적인 근사치와 적합성을 살펴 보는 예입니다. 클러스터링에 대한 진단의 경우, 축 수를 취합니다.<strong>~ 후에</strong>그만큼<span class="smallcaps">스트레스</span>가파른 드롭이 있습니다.</p>
<p>NMDS 결과의 각 계산에는 무작위로 그리고 의존하는 새로운 최적화가 필요하기 때문에<span class="math inline">\(케이\)</span>값, 우리는 클러스터링을 위해했던 것과 비슷한 절차를 사용합니다.<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>. 우리는<code>메타 트</code>예를 들어, 4 가지 가능한 값 각각에 대해 100 배<span class="math inline">\(케이\)</span>그리고 기록<span class="smallcaps">스트레스</span>값.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"비건 채식"</span>))</span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a>nmds.stress<span class="ot">=</span> <span class="cf">기능</span>(엑스,<span class="at">SIM =</span> <span class="dv">100</span>,,,<span class="at">kmax =</span> <span class="dv">4</span>) {</span>
<span id="cb32-3"><a aria-hidden="true" href="#cb32-3" tabindex="-1"></a>  <span class="fu">Sapply</span>(<span class="fu">seq_len</span>(kmax),<span class="cf">기능</span>(케이)</span>
<span id="cb32-4"><a aria-hidden="true" href="#cb32-4" tabindex="-1"></a>    <span class="fu">뒤로 젖히다</span>(심,<span class="fu">메타 트</span>(엑스,<span class="at">k =</span>케이,<span class="at">AutoTransform =</span> <span class="cn">거짓</span>))<span class="sc">$</span>스트레스))</span>
<span id="cb32-5"><a aria-hidden="true" href="#cb32-5" tabindex="-1"></a>}</span>
<span id="cb32-6"><a aria-hidden="true" href="#cb32-6" tabindex="-1"></a>스트레스<span class="ot">=</span> <span class="fu">nmds.stress</span>(Disekm,<span class="at">SIM =</span> <span class="dv">100</span>))</span>
<span id="cb32-7"><a aria-hidden="true" href="#cb32-7" tabindex="-1"></a><span class="fu">어둑한</span>(스트레스)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>결과의 박스 플롯을 살펴 보겠습니다. 이것은 선택에 유용한 진단 플롯이 될 수 있습니다<span class="math inline">\(케이\)</span> (<a class="quarto-xref" href="#fig-NMDSscreeplot-1">수치<span>9.10</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a>DFSTR<span class="ot">=</span>reshape2<span class="sc">::</span><span class="fu">녹다</span>(스트레스,<span class="at">varnames =</span> <span class="fu">기음</span>(<span class="st">"뒤로 젖히다"</span>,,,<span class="st">"치수"</span>)))</span>
<span id="cb33-2"><a aria-hidden="true" href="#cb33-2" tabindex="-1"></a><span class="fu">ggplot</span>(DFSTR,<span class="fu">AES</span>(<span class="at">y =</span>값,<span class="at">x =</span>치수,<span class="at">그룹 =</span>치수))<span class="sc">+</span></span>
<span id="cb33-3"><a aria-hidden="true" href="#cb33-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-NMDSscreeplot-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-NMDSscreeplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="09-chap_files/figure-html/fig-NMDSscreeplot-1-1.png" title="Figure 9.10: Several replicates at each dimension were run to evaluate the stability of the stress. We see that the stress drops dramatically with two or more dimensions, thus indicating that a two dimensional solution is appropriate here."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-NMDSscreeplot-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-NMDSscreeplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.10 : 각 차원에서의 여러 복제물을 실행하여 안정성을 평가했습니다.<span class="smallcaps">스트레스</span>. 우리는 그것을 봅니다<span class="smallcaps">스트레스</span>두 개 이상의 치수로 극적으로 떨어지므로 여기서는 2 차원 솔루션이 적절하다는 것을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>또한 셰퍼드 플롯으로 알려진 거리와 근사치를 비교할 수 있습니다.<span class="math inline">\ (k = 2 \)</span>예를 들어, 계산 된 다음과 같습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a>NMDSK2<span class="ot">=</span> <span class="fu">메타 트</span>(Disekm,<span class="at">k =</span> <span class="dv">2</span>,,,<span class="at">AutoTransform =</span> <span class="cn">거짓</span>))</span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a><span class="fu">스트레스 플롯</span>(NMDSK2,<span class="at">pch =</span> <span class="dv">20</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Shepardsplot-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Shepardsplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="09-chap_files/figure-html/fig-Shepardsplot-1-1.png" title="Figure 9.11: The Shepard’s plot compares the original distances or dissimilarities (along the horizonal axis) to the reconstructed distances, in this case for k=2 (vertical axis)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-Shepardsplot-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Shepardsplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.11 : 셰퍼드의 줄거리는 원래 거리 또는 비교 (수평 축을 따르는)를 재구성 된 거리와 비교합니다.<span class="math inline">\ (k = 2 \)</span>(수직 축).</figcaption>
</figure>
</div>
</div></div></div>
<p>셰퍼드의 음모가 모두 들어 있습니다<a class="quarto-xref" href="#fig-Shepardsplot-1">수치<span>9.11</span></a>그리고 Screeplot<a class="quarto-xref" href="#fig-NMDSscreeplot-1">수치<span>9.10</span></a>Ekman의 컬러 혼란 연구를위한 2 차원 솔루션을 가리 키십시오. 두 개의 서로 다른 MDS 프로그램의 출력, 클래식 메트릭 최소 제곱 근사 및 비금속 근사 방법을 비교해 봅시다. 오른쪽 패널<a class="quarto-xref" href="#fig-ekmannonMDS-1">수치<span>9.12</span></a>비상금 근사 근사에서 결과를 보여주고 왼쪽 패널은 다음과 같습니다.<a class="quarto-xref" href="#fig-ekmanMDS-1">수치<span>9.9</span></a>. 예측은 두 경우 모두 거의 동일합니다. 이 데이터의 경우 유클리드 또는 비금속 다차원 스케일링 방법을 사용하든 관계없이 거의 차이가 없습니다.</p>
<div class="cell" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>NMDSK2<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a>  <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="fu">페이스트0</span>(<span class="st">"nmmds"</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))<span class="sc">|&gt;</span></span>
<span id="cb35-3"><a aria-hidden="true" href="#cb35-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a aria-hidden="true" href="#cb35-4" tabindex="-1"></a>  <span class="fu">bind_cols</span>(dplyr<span class="sc">::</span><span class="fu">선택하다</span>(dfekm, rgb, name))))<span class="sc">|&gt;</span></span>
<span id="cb35-5"><a aria-hidden="true" href="#cb35-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">x =</span>nmmds1,<span class="at">y =</span>NMMD2))<span class="sc">+</span></span>
<span id="cb35-6"><a aria-hidden="true" href="#cb35-6" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">col =</span>dfekm<span class="sc">$</span>RGB,<span class="at">크기 =</span> <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb35-7"><a aria-hidden="true" href="#cb35-7" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span>이름))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-ekmannonMDS-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ekmannonMDS-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ekmannonMDS-1" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ekmannonMDS-1-1" width="368">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ekmannonMDS-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-ekmannonMDS-1" href="09-chap_files/figure-html/fig-ekmannonMDS-1-1.png" title="Figure 9.12 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-ekmannonMDS-1" id="fig-ekmannonMDS-1-1" src="09-chap_files/figure-html/fig-ekmannonMDS-1-1.png" width="368"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ekmannonMDS-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ekmannonMDS-1" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ekmannonMDS-1-2" width="368">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ekmannonMDS-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-ekmannonMDS-1" href="09-chap_files/figure-html/fig-ekmannonMDS-1-2.png" title="Figure 9.12 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-ekmannonMDS-1" id="fig-ekmannonMDS-1-2" src="09-chap_files/figure-html/fig-ekmannonMDS-1-2.png" width="368"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ekmannonMDS-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ekmannonMDS-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.12 : (a) 고전적인 다차원 스케일링의 출력 비교 (<a class="quarto-xref" href="#fig-ekmanMDS-1">수치<span>9.9</span></a>) 및 (b) 비금속 버전.</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="9.3" id="contiguous-or-supplementary-information">
<h2 class="anchored" data-anchor-id="contiguous-or-supplementary-information" data-number="9.3"><span class="header-section-number">9.3</span>연속 또는 보충 정보</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="imgs/devil.png" title="Metadata: Many programs and workflows for biological sequence analysis or assays separate the environmental and contextual information, which they call metadata, from the assay data or sequence reads. We discourage such practice as the exact connections between the samples and covariates are important. A lost connection between the assays and covariates makes later analyses impossible. Covariates such as clinical history, time, batch or location are important and should be considered components of the data."><img alt="Metadata: Many programs and workflows for biological sequence analysis or assays separate the environmental and contextual information, which they call metadata, from the assay data or sequence reads. We discourage such practice as the exact connections between the samples and covariates are important. A lost connection between the assays and covariates makes later analyses impossible. Covariates such as clinical history, time, batch or location are important and should be considered components of the data." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption><strong>메타 데이터 :</strong>생물학적 서열 분석 또는 분석을위한 많은 프로그램 및 워크 플로우가<strong>메타 데이터</strong>, 분석 데이터 또는 서열 읽기에서. 우리는 샘플과 공변량 사이의 정확한 연결과 같은 연습이 중요합니다. 분석과 공변량 사이의 연결 손실은 나중에 분석을 불가능하게 만듭니다. 임상 병력, 시간, 배치 또는 위치와 같은 공변량은 중요하며 데이터 구성 요소로 간주되어야합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="03-chap.html"><span>3 장</span></a>우리는 r을 소개했다<em>데이터. 프레임</em>이기종 데이터 유형을 결합 할 수있는 클래스 : 범주 적 요인, 텍스트 및 연속 값. 데이터 프레임의 각 행은 객체 또는 레코드에 해당하며 열은 다른 변수 또는 기능입니다.</p>
<p>샘플 배치, 측정 날짜, 다른 프로토콜에 대한 추가 정보는 종종<em>메타 데이터</em>; 메타 데이터가 어떻게 든 중요하다는 것을 암시한다면 이것은 잘못된 이름이 될 수 있습니다. 그러한 정보는 다음과 같습니다<em>실제 데이터</em>이는 분석에 통합되어야합니다. 우리는 일반적으로 그것을 a에 저장합니다<em>데이터. 프레임</em>또는 유사한 r 클래스와 1 차 분석 데이터에 단단히 연결합니다.</p>
<section class="level3 page-columns page-full" data-number="9.3.1" id="known-batches-in-data">
<h3 class="anchored" data-anchor-id="known-batches-in-data" data-number="9.3.1"><span class="header-section-number">9.3.1</span>데이터에서 알려진 배치</h3>
<p>여기서 우리는 다음과 같이 수행 한 분석의 예를 보여줍니다.<span class="citation" data-cites="holmes2011psb">Holmes et al. (<a href="16-chap.html#ref-holmes2011psb" role="doc-biblioref">2011</a>))</span>박테리아 풍부 데이터에서<em>Phylochip</em> <span class="citation" data-cites="Brodie:2006">(<a href="16-chap.html#ref-Brodie:2006" role="doc-biblioref">Brodie et al. 2006</a>))</span>마이크로 어레이. 이 실험은 건강한 쥐 그룹과 과민성 대장 질환이있는 그룹 간의 차이를 감지하도록 설계되었습니다.<span class="citation" data-cites="Nelson:2011">(<a href="16-chap.html#ref-Nelson:2011" role="doc-biblioref">Nelson et al. 2010 년</a>))</span>. 이 예는 실험 데이터 분석에서 성가신 배치 효과가 명백 해지는 경우를 보여줍니다. 데이터 분석의 모범 사례가 순차적이며 실험 설계에서 심각한 문제를 조정하도록 수집 될 때 데이터를 분석하는 것이 더 좋습니다.<em>그들이 일어날 때</em>, 그들을 다루는 대신<em>포스트 박격포</em><a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>피셔의 용어, 참조<a class="quarto-xref" href="13-chap.html"><span>13 장</span></a>.</p></div></div><p>이 프로젝트에서 데이터 수집이 시작되면 1 일과 2 일이 전달되었고 우리는<a class="quarto-xref" href="#fig-rankthreshPCA">수치<span>9.14</span></a>. 이것은 확실한 것을 보여주었습니다<em>낮</em>효과. 이 효과의 출처를 조사 할 때 프로토콜과 배열이 모두 1 일과 2 일에 다르다는 것을 발견했습니다. 이로 인해 변형 원의 불확실성이 발생합니다.<strong>혼란</strong>효과의.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="imgs/devil.png" title="Bioconductor container: These data are an example of an awkward way of combining batch information with the actual data. The day information has been combined with the array data and encoded as a number and could be confused with a continuous variable. We will see in the next section a better practice for storing and manipulating heterogeneous data using a Bioconductor container called SummarizedExperiment."><img alt="Bioconductor container: These data are an example of an awkward way of combining batch information with the actual data. The day information has been combined with the array data and encoded as a number and could be confused with a continuous variable. We will see in the next section a better practice for storing and manipulating heterogeneous data using a Bioconductor container called SummarizedExperiment." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption><strong>바이오 컨덕터 컨테이너 :</strong>이 데이터는 배치 정보를 실제 데이터와 결합하는 어색한 방법의 예입니다. 그만큼<code>낮</code>정보는 배열 데이터와 결합되어 숫자로 인코딩되었으며 연속 변수와 혼동 될 수 있습니다. 다음 섹션에서는 바이오 컨덕턴<em>요약 경험</em>.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 섹션에서 사용하는 데이터와 패키지를로드합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a>IBDCHIP<span class="ot">=</span> <span class="fu">readrds</span>(<span class="st">"../data/vsn28exprd.rds"</span>))</span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ADE4"</span>))</span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"팩트라"</span>))</span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"SVA"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-matrixIBDchip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.5</div>
</div>
<div class="callout-body-container callout-body">
<p>어떤 수업이<code>IBDCHIP</code>? 매트릭스의 마지막 줄을보세요. 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-10-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-10-contents callout-collapse collapse" id="callout-10">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="fu">수업</span>(IBDCHIP)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "매트릭스" "배열"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" href="#cb39-1" tabindex="-1"></a><span class="fu">어둑한</span>(IBDCHIP)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8635 28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a><span class="fu">꼬리</span>(ibdchip [,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20cf 20df 20mf
BM-026.1.SIG_ST 7.299308 7.275802 7.383103
BM-125.1.SIG_ST 8.538857 8.998562 9.296096
bru.tab.d.hiii.con32.sig_st 6.802736 6.777566 6.859950
bru.tab.d.hiii.con323.sig_st 6.463604 6.501139 6.611851
bru.tab.d.hiii.con5.sig_st 5.739235 5.666060 5.831079
2.000000 2.000000 2.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a><span class="fu">테이블</span>(ibdchip [<span class="fu">nrow</span>(ibdchip),]))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 
 8 16 4</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>데이터는 28 개의 샘플에서 측정 된 8634 분류의 정규화 된 풍부 측정입니다. 우리는 순위 임계 값 변환을 사용하여 3000에서 1까지 3000 개의 가장 풍부한 분류 점수를 제공하고 나머지 (낮은 풍부한) 점수는 모두 1의 점수를 갖도록합니다. 또한 적절한 분석 데이터를 (어색하게 배치 된) 일간 변수와 분리하여 요인으로 간주되어야합니다.<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>:</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>아래에서는 이러한 데이터를 생체 전도체로 정리하는 방법을 보여줍니다.<code>요약 경험</code>, 이는 그러한 데이터를 저장하는 훨씬 더 세대한 방법입니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a>assayibd<span class="ot">=</span>IBDCHIP [<span class="sc">-</span><span class="fu">nrow</span>(ibdchip),]</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a>낮<span class="ot">=</span> <span class="fu">요인</span>(ibdchip [<span class="fu">nrow</span>(ibdchip),]))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>연속적이고 정규화 된 데이터를 사용하는 대신 값을 해당 순위별로 대체하는 강력한 분석을 사용합니다. 더 낮은 값은 존재하는 것으로 생각되는 예상 분류의 수를 반영하기 위해 선택된 임계 값으로 인코딩 된 유대로 간주됩니다.</p>
<!-- TODO: these plots aren't shown online? -->
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a>RANKTHRESHPCA<span class="ot">=</span> <span class="cf">기능</span>(엑스,<span class="at">임계 값 =</span> <span class="dv">3000</span>) {</span>
<span id="cb46-2"><a aria-hidden="true" href="#cb46-2" tabindex="-1"></a>RANKSM<span class="ot">=</span> <span class="fu">적용하다</span>(엑스,<span class="dv">2</span>, 랭크)</span>
<span id="cb46-3"><a aria-hidden="true" href="#cb46-3" tabindex="-1"></a>RANKSM [RANKSM<span class="sc">&lt;</span>한계점]<span class="ot">=</span>한계점</span>
<span id="cb46-4"><a aria-hidden="true" href="#cb46-4" tabindex="-1"></a>RANKSM<span class="ot">=</span>한계점<span class="sc">-</span>RANKSM</span>
<span id="cb46-5"><a aria-hidden="true" href="#cb46-5" tabindex="-1"></a>  <span class="fu">dudi.pca</span>(<span class="fu">티</span>(Ranksm),<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">2</span>))</span>
<span id="cb46-6"><a aria-hidden="true" href="#cb46-6" tabindex="-1"></a>}</span>
<span id="cb46-7"><a aria-hidden="true" href="#cb46-7" tabindex="-1"></a>PCADAY12<span class="ot">=</span> <span class="fu">RANKTHRESHPCA</span>(Assayibd [, day<span class="sc">! =</span> <span class="dv">3</span>])))</span>
<span id="cb46-8"><a aria-hidden="true" href="#cb46-8" tabindex="-1"></a><span class="fu">fviz_eig</span>(pcaday12,<span class="at">bar_width =</span> <span class="fl">0.6</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-screepc12">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-screepc12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="09-chap_files/figure-html/fig-screepc12-1.png" title="Figure 9.13: The screeplot shows us that the samples can be usefully represented in a two dimensional embedding."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-screepc12-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-screepc12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.13 : ScreePlot은 샘플이 2 차원 임베딩으로 유용하게 표현 될 수 있음을 보여줍니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" href="#cb47-1" tabindex="-1"></a>12 일<span class="ot">=</span>하루 [하루<span class="sc">! =</span><span class="dv">3</span>]]</span>
<span id="cb47-2"><a aria-hidden="true" href="#cb47-2" tabindex="-1"></a>RTPCA1<span class="ot">=</span> <span class="fu">fviz</span>(pcaday12,<span class="at">요소 =</span> <span class="st">"ind"</span>,,,<span class="at">축 =</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>),)<span class="at">geom =</span> <span class="fu">기음</span>(<span class="st">"가리키다"</span>,,,<span class="st">"텍스트"</span>),)</span>
<span id="cb47-3"><a aria-hidden="true" href="#cb47-3" tabindex="-1"></a>  <span class="at">드레싱 =</span>Day12,<span class="at">repel =</span> <span class="cn">진실</span>,,,<span class="at">팔레트 =</span> <span class="st">"Dark2"</span>,,,</span>
<span id="cb47-4"><a aria-hidden="true" href="#cb47-4" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">진실</span>,,,<span class="at">elipse.type =</span> <span class="st">"볼록한"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span></span>
<span id="cb47-5"><a aria-hidden="true" href="#cb47-5" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb47-6"><a aria-hidden="true" href="#cb47-6" tabindex="-1"></a>RTPCA1</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-rankthreshPCA">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rankthreshPCA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="09-chap_files/figure-html/fig-rankthreshPCA-1.png" title="Figure 9.14: We have used colors to identify the different days and have kept the sample labels as well. We have also added convex hulls for each day. The group mean is identified as the point with the larger symbol (circle, triangle or square)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-rankthreshPCA-1.png" width="416"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rankthreshPCA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.14 : 색상을 사용하여 다른 날을 식별하고 샘플 레이블도 유지했습니다. 우리는 또한 매일 볼록한 선체를 추가했습니다. 그룹 평균은 더 큰 기호 (원, 삼각형 또는 정사각형)의 점으로 식별됩니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-rankthreshold">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.6</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 왜 순위에 임계 값을 사용합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-12-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-12-contents callout-collapse collapse" id="callout-12">
<div class="callout-body-container callout-body">
<p>소음 수준에서 낮은 풍부는 실제로 존재하지 않는 종에 대해 발생하며, 그 중 절반 이상이 있습니다. 이러한 관찰에 대한 큰 순위는 의미있는 이유없이 쉽게 발생할 수 있습니다. 따라서 우리는 낮은 풍요 로움을위한 많은 유대를 만듭니다.</p>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-rankthreshPCA">수치<span>9.14</span></a>샘플이 샘플의 날에 따라 샘플이 자연스럽게 두 개의 다른 그룹으로 배열됨을 보여줍니다. 이 효과를 발견 한 후, 우리는 이러한 뚜렷한 클러스터를 설명 할 수있는 차이점을 탐구했습니다. 사용 된 두 가지 프로토콜이 사용되었습니다 (1 일의 프로토콜 1, 2 일의 프로토콜 2)<em>그리고</em>불행히도 이틀에 사용 된 배열에 대한 두 가지 다른 출처 (1 일의 배열 1, 2 일의 배열 2).</p>
<p>4 개의 샘플의 세 번째 데이터 세트는 혼란스러운 효과를 제거하기 위해 수집되어야했다. 배열 2는 3 일째 프로토콜 2와 함께 사용되었습니다.<a class="quarto-xref" href="#fig-Threesetspca123">수치<span>9.15</span></a>다음에 의해 생성 된 모든 샘플과 함께 새로운 PCA 플롯을 보여줍니다.</p>
<div class="cell" data-layout-align="center" data-warning.known="unlabeled data points">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>PCADAY123<span class="ot">=</span> <span class="fu">RANKTHRESHPCA</span>(Assayibd)</span>
<span id="cb48-2"><a aria-hidden="true" href="#cb48-2" tabindex="-1"></a><span class="fu">fviz</span>(PCADAY123,<span class="at">요소 =</span> <span class="st">"ind"</span>,,,<span class="at">축 =</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>),)<span class="at">geom =</span> <span class="fu">기음</span>(<span class="st">"가리키다"</span>,,,<span class="st">"텍스트"</span>),)</span>
<span id="cb48-3"><a aria-hidden="true" href="#cb48-3" tabindex="-1"></a>  <span class="at">드레싱 =</span>낮,<span class="at">repel =</span> <span class="cn">진실</span>,,,<span class="at">팔레트 =</span> <span class="st">"Dark2"</span>,,,</span>
<span id="cb48-4"><a aria-hidden="true" href="#cb48-4" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">진실</span>,,,<span class="at">elipse.type =</span> <span class="st">"볼록한"</span>))<span class="sc">+</span> </span>
<span id="cb48-5"><a aria-hidden="true" href="#cb48-5" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1" data-warning.known="unlabeled data points">
<div class="quarto-layout-panel page-columns page-full" id="fig-Threesetspca123">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-Threesetspca123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-Threesetspca123" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Threesetspca123-1" width="360">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-Threesetspca123-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-Threesetspca123" href="09-chap_files/figure-html/fig-Threesetspca123-1.png" title="Figure 9.15 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-Threesetspca123" id="fig-Threesetspca123-1" src="09-chap_files/figure-html/fig-Threesetspca123-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-Threesetspca123-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-Threesetspca123" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Threesetspca123-2" width="360">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-Threesetspca123-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-Threesetspca123" href="09-chap_files/figure-html/fig-Threesetspca123-2.png" title="Figure 9.15 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-Threesetspca123" id="fig-Threesetspca123-2" src="09-chap_files/figure-html/fig-Threesetspca123-2.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-Threesetspca123-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-Threesetspca123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.15 : 3 일간의 분석을 처음 이틀의 분석과 비교할 때, 우리는 두 번째 축의 좌표에서 징후의 반전을 알 수 있습니다. 이것은 생물학적 관련성이 없습니다. 중요한 결과는 그룹 3이 그룹 1과 크게 겹치며 2 일째의 프로토콜 변경임을 나타내는 것이 변동성을 생성한다는 것입니다.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-ellipseIBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.7</div>
</div>
<div class="callout-body-container callout-body">
<p>어떤 상황에서 그룹 주변의 타원을 다음 코드를 사용하는 것을 의미합니까?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(PCADAY123,<span class="at">드레싱 =</span>낮,<span class="at">labelsize =</span> <span class="dv">3</span>,,,</span>
<span id="cb49-2"><a aria-hidden="true" href="#cb49-2" tabindex="-1"></a>  <span class="at">팔레트 =</span> <span class="st">"Dark2"</span>,,,<span class="at">addEllipses =</span> <span class="cn">진실</span>,,,<span class="at">Ellipse.level =</span> <span class="fl">0.69</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-screepc123">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-screepc123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-21" href="09-chap_files/figure-html/fig-screepc123-1.png" title="Figure 9.16: The eigenvalue screeplot the case of 3 groups is extremely similar to that with two groups shown in Figure fig-screepc12."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-screepc123-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-screepc123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.16 : EigenValue screeplot 3 그룹의 경우는 두 그룹의 경우와 매우 유사합니다.<a class="quarto-xref" href="#fig-screepc12">수치<span>9.13</span></a>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>이 시각화를 통해 우리는 원래 실험 설계에서 결함을 발견 할 수있었습니다. 녹색과 갈색으로 표시된 처음 두 배치는 IBS 및 건강한 쥐와 관련하여 균형을 잡았습니다. 그것들은 매우 다른 수준의 가변성과 전체 다변량 좌표를 보여줍니다. 사실, 두 가지가 있습니다<strong>혼란</strong>효과. 배열과 프로토콜은 모두 이틀 동안 달랐습니다. 우리는 Purple으로 표현 된 3 일째에 세 번째 실험을 실행해야했으며, 1 일째 부터이 사용 된 프로토콜과 2 일째부터 배열을 사용했습니다. 세 번째 그룹은 Batch 1과 충실하게 겹치며 프로토콜의 변화가 변동에 대한 책임이 있음을 알려줍니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="9.3.2" id="removing-batch-effects">
<h3 class="anchored" data-anchor-id="removing-batch-effects" data-number="9.3.2"><span class="header-section-number">9.3.2</span>배치 효과 제거</h3>
<p>연속 측정의 조합을 통해<code>assayibd</code>그리고<strong>보충</strong>배치 번호 요소 인 PCA 맵은 귀중한 조사 도구를 제공했습니다. 이것은 사용의 좋은 예입니다<strong>보충 포인트</strong><a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>. 평균-바리 센터 포인트는 세 그룹 각각의 그룹-평균 포인트를 사용하여 생성되며 플롯에서 추가 마커 역할을합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>새로운 관찰점이 행렬 분해에 사용되지 않기 때문에이를 보충 지점이라고합니다.</p></div></div><p>우리는 모든 배치가 원점에 중심을 갖도록 그룹 수단을 빼서 세 그룹을 다시 정렬하기로 결정할 수 있습니다. 약간 더 효과적인 방법은<code>전투</code>기능을 사용할 수 있습니다<strong><a href="https://bioconductor.org/packages/sva/">SVA</a></strong>패키지. 이 기능은 비슷하지만 약간 더 정교한 방법을 사용합니다 (경험적 베이 어스 혼합물 접근<span class="citation" data-cites="Leek:2010:batch">(<a href="16-chap.html#ref-Leek:2010:batch" role="doc-biblioref">Leek et al. 2010 년</a>))</span>). 우리는 강력한 PCA를 다시 만들어 데이터에 미치는 영향을 볼 수 있습니다 (결과 참조.<a class="quarto-xref" href="#fig-CombatIBD">수치<span>9.17</span></a>) : :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a>Model0<span class="ot">=</span> <span class="fu">model.matrix</span>(<span class="sc">~</span><span class="dv">1</span>, 낮)</span>
<span id="cb50-2"><a aria-hidden="true" href="#cb50-2" tabindex="-1"></a>Combatibd<span class="ot">=</span> <span class="fu">전투</span>(<span class="at">그 =</span>assayibd,<span class="at">배치 =</span>낮,<span class="at">mod =</span>Model0)</span>
<span id="cb50-3"><a aria-hidden="true" href="#cb50-3" tabindex="-1"></a>pcadaybatrm<span class="ot">=</span> <span class="fu">RANKTHRESHPCA</span>(Combatibd)</span>
<span id="cb50-4"><a aria-hidden="true" href="#cb50-4" tabindex="-1"></a><span class="fu">fviz</span>(pcadaybatrm,<span class="at">요소 =</span> <span class="st">"ind"</span>,,,<span class="at">geom =</span> <span class="fu">기음</span>(<span class="st">"가리키다"</span>,,,<span class="st">"텍스트"</span>),)</span>
<span id="cb50-5"><a aria-hidden="true" href="#cb50-5" tabindex="-1"></a>  <span class="at">드레싱 =</span>낮,<span class="at">repel =</span><span class="cn">진실</span>,,,<span class="at">팔레트 =</span> <span class="st">"Dark2"</span>,,,<span class="at">addEllipses =</span> <span class="cn">진실</span>,,,</span>
<span id="cb50-6"><a aria-hidden="true" href="#cb50-6" tabindex="-1"></a>  <span class="at">elipse.type =</span> <span class="st">"볼록한"</span>,,,<span class="at">축 =</span><span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>)))<span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CombatIBD">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CombatIBD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-22" href="09-chap_files/figure-html/fig-CombatIBD-1.png" title="Figure 9.17: The modified data with the batch effects removed now show three batch-groups heavily overlapping and centered almost at the origin."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-CombatIBD-1.png" width="416"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CombatIBD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.17 : 배치 효과가 제거 된 수정 된 데이터는 이제 3 개의 배치 그룹이 크게 겹치고 거의 원점을 중심으로합니다.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level3 page-columns page-full" data-number="9.3.3" id="hybrid-data-and-bioconductor-containers">
<h3 class="anchored" data-anchor-id="hybrid-data-and-bioconductor-containers" data-number="9.3.3"><span class="header-section-number">9.3.3</span>하이브리드 데이터 및 바이오 컨덕터 컨테이너</h3>
<p>배치 및 처리 정보를 복합 객체의 구획으로 결합하는보다 합리적인 방법은<em>요약 경험</em>수업. 특별한 포함<em>슬롯</em>행이 관심의 특징 (예를 들어, 유전자, 전 사체, 엑손 등)을 나타내고 컬럼을 나타내는 분석의 경우. 기능에 대한 보충 정보는<em>데이터 프레임</em>기능을 사용하여 액세스 할 수있는 객체<code>RowData</code>. 각 줄<em>데이터 프레임</em>해당 행의 기능에 대한 정보를 제공합니다.<em>요약 경험</em>물체.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-23" href="imgs/devil.png" title="A confusing notational similarity occurs here, in the SummarizedExperiment framework a DataFrame is not the same as a data.frame."><img alt="A confusing notational similarity occurs here, in the SummarizedExperiment framework a DataFrame is not the same as a data.frame." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>혼란스러운 표기법 유사성은 요약 실험 프레임 워크에서 발생합니다.<code>데이터 프레임</code>a와 동일하지 않습니다<em>데이터. 프레임.</em></figcaption>
</figure>
</div>
</div></div></div>
<p>여기서 우리는 두 공변량의 날과 치료를<code>충돌</code>객체 및 해당 분석 데이터와 결합하십시오.<em>요약 경험</em>물체.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"요약 실험"</span>))</span>
<span id="cb51-2"><a aria-hidden="true" href="#cb51-2" tabindex="-1"></a>치료<span class="ot">=</span> <span class="fu">요인</span>(<span class="fu">ifelse</span>(<span class="fu">포도</span>(<span class="st">"cntr |^c"</span>,,,<span class="fu">colnames</span>(IBDCHIP),<span class="st">"CTL"</span>,,,<span class="st">"IBS"</span>)))</span>
<span id="cb51-3"><a aria-hidden="true" href="#cb51-3" tabindex="-1"></a>샘플드타<span class="ot">=</span> <span class="fu">데이터 프레임</span>(<span class="at">day =</span>낮,<span class="at">치료 =</span>치료)</span>
<span id="cb51-4"><a aria-hidden="true" href="#cb51-4" tabindex="-1"></a>칩스<span class="ot">=</span> <span class="fu">요약 경험</span>(<span class="at">분석 =</span> <span class="fu">목록</span>(<span class="at">풍부 =</span>assayibd),</span>
<span id="cb51-5"><a aria-hidden="true" href="#cb51-5" tabindex="-1"></a>                              <span class="at">collta =</span>샘플러다타)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이것은 모든 관련 데이터를 함께 유지하는 가장 좋은 방법이며 모든 정보를 올바르게 정렬하면서 데이터를 신속하게 필터링 할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-24" href="imgs/devil.png" title="You can explore composite objects using the Environment pane in RStudio. You will see that in chipse, some of the slots are empty."><img alt="You can explore composite objects using the Environment pane in RStudio. You will see that in chipse, some of the slots are empty." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>Rstudio의 환경 창을 사용하여 복합 물체를 탐색 할 수 있습니다. 당신은 그것을 볼 것입니다<code>칩스</code>슬롯 중 일부는 비어 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-SEfilter">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.8</div>
</div>
<div class="callout-body-container callout-body">
<p>새로운 것을 만드십시오<em>요약 경험</em>2 일째에 생성 된 샘플의 서브 세트를 선택하여 물체.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-15-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-15-contents callout-collapse collapse" id="callout-15">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a>Chipse [, Day<span class="sc">==</span> <span class="dv">2</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>클래스 : 요약 경험 
희미한 : 8634 16 
메타 데이터 (0) :
분석 (1) : 풍부
Rownames (8634) : 01010101000000.2104_GPM_GC 01010101000000.2141_GPM_GC
  ... bru.tab.d.hiii.con323.sig_st bru.tab.d.hiii.con5.sig_st
RowData 이름 (0) :
colnames (16) : 20cf 20df ... ibsm ibsp
Coldata 이름 (2) : 당일 치료</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>의 열<em>데이터 프레임</em>예를 들어 유전자 또는 전사 ID 등의 관심 특징에 대한 다양한 속성을 나타냅니다. 단일 셀 실험의 하이브리드 데이터 컨테이너의 예는 다음과 같습니다 (Bioconductor Workflow 참조<span class="citation" data-cites="Perraudeau:2017">Perralideau와 Al. (<a href="16-chap.html#ref-Perraudeau:2017" role="doc-biblioref">2017</a>))</span>자세한 내용은).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a>코어<span class="ot">=</span> <span class="fu">readrds</span>(<span class="st">"../data/normse.rds"</span>))</span>
<span id="cb54-2"><a aria-hidden="true" href="#cb54-2" tabindex="-1"></a>표준<span class="ot">=</span> <span class="fu">분석</span>(코레즈)<span class="sc">$</span>정규화 된 values</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>워크 플로에 처방 된 사전 처리 및 정규화 단계 후, 우리는 747 세포에서 측정 된 1000 개의 가장 가변 유전자를 유지합니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-coldatacore">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.9</div>
</div>
<div class="callout-body-container callout-body">
<p>세포는 몇 개의 다른 배치에 속합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-17-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-17-contents callout-collapse collapse" id="callout-17">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a><span class="fu">길이</span>(<span class="fu">고유한</span>(<span class="fu">충돌</span>(코레즈)<span class="sc">$</span>일괄))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>정규화 된 값의 PCA를보고 배치 효과가 제거되었는지 그래픽으로 확인할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a>respca<span class="ot">=</span> <span class="fu">dudi.pca</span>(<span class="fu">티</span>(표준),<span class="at">nf =</span> <span class="dv">3</span>,,,<span class="at">scannf =</span> <span class="cn">거짓</span>))</span>
<span id="cb57-2"><a aria-hidden="true" href="#cb57-2" tabindex="-1"></a><span class="fu">플로트 크리</span>(respca,<span class="dv">15</span>))</span>
<span id="cb57-3"><a aria-hidden="true" href="#cb57-3" tabindex="-1"></a>PC<span class="ot">=</span>respca<span class="sc">$</span>li [,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-screeplotnorm">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-screeplotnorm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-25" href="09-chap_files/figure-html/fig-screeplotnorm-1.png" title="Figure 9.18: Screeplot of the PCA of the normalized data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-screeplotnorm-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-screeplotnorm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.18 : 정규화 된 데이터의 PCA의 screeplot.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-26" href="imgs/devil.png" title="We have set up colors for the clusters as in the workflow, (the code is not shown here)."><img alt="We have set up colors for the clusters as in the workflow, (the code is not shown here)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>워크 플로에서와 같이 클러스터의 색상을 설정했습니다 (코드는 여기에 표시되지 않음).</figcaption>
</figure>
</div>
</div></div></div>
<p>Screeplot 이후<a class="quarto-xref" href="#fig-screeplotnorm">수치<span>9.18</span></a>우리는 축 2와 3을 분리해서는 안된다는 것을 보여줍니다.<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>패키지. 우리는 다음 대화식 코드를 사용합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rgl"</span>))</span>
<span id="cb58-2"><a aria-hidden="true" href="#cb58-2" tabindex="-1"></a>일괄<span class="ot">=</span> <span class="fu">충돌</span>(코레즈)<span class="sc">$</span>일괄</span>
<span id="cb58-3"><a aria-hidden="true" href="#cb58-3" tabindex="-1"></a><span class="fu">Plot3d</span>(PCS,<span class="at">측면 =</span><span class="fu">sqrt</span>(<span class="fu">기음</span>(<span class="dv">84</span>,,,<span class="dv">24</span>,,,<span class="dv">20</span>)),<span class="at">col =</span>col_clus [batch])</span>
<span id="cb58-4"><a aria-hidden="true" href="#cb58-4" tabindex="-1"></a><span class="fu">Plot3d</span>(PCS,<span class="at">측면 =</span><span class="fu">sqrt</span>(<span class="fu">기음</span>(<span class="dv">84</span>,,,<span class="dv">24</span>,,,<span class="dv">20</span>)),</span>
<span id="cb58-5"><a aria-hidden="true" href="#cb58-5" tabindex="-1"></a><span class="at">col =</span>col_clus [<span class="fu">AS.CHARACTER</span>(출판사)]))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-3dplotsnorm">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-3dplotsnorm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-3dplotsnorm" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-3dplotsnorm-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-3dplotsnorm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-3dplotsnorm" href="imgs/plotnormpcabatch1.png" title="Figure 9.19 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-3dplotsnorm" id="fig-3dplotsnorm-1" src="imgs/plotnormpcabatch1.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-3dplotsnorm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-3dplotsnorm" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-3dplotsnorm-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-3dplotsnorm-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-3dplotsnorm" href="imgs/plotnormpclust1.png" title="Figure 9.19 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-3dplotsnorm" id="fig-3dplotsnorm-2" src="imgs/plotnormpclust1.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-3dplotsnorm-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-3dplotsnorm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.19 : 3 차원의 2 차원 스크린 샷<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>음모. 포인트는 (a)의 배치 번호와 (b)의 원래 클러스터링에 따라 채색됩니다. 우리는 배치 효과가 효과적으로 제거되었고 셀이 원래 클러스터링을 나타내는 것을 알 수 있습니다.</figcaption>
</figure>
</div>
</div>
<p><strong>메모:</strong>물론, 책 매체는 여기에서 제한하고 있습니다. 우리는 대화식 다이내믹 플롯이<code>Plot3d</code>기능. 우리는 독자가 이러한 대화식 패키지 및 기타 대화식 패키지를 광범위하게 실험 할 것을 권장하며 데이터에 대한 훨씬 직관적 인 경험을 제공합니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="9.4" id="sec-hetero-CA">
<h2 class="anchored" data-anchor-id="sec-hetero-CA" data-number="9.4"><span class="header-section-number">9.4</span>우발 테이블에 대한 서신 분석</h2>
<section class="level3 page-columns page-full" data-number="9.4.1" id="cross-tabulation-and-contingency-tables">
<h3 class="anchored" data-anchor-id="cross-tabulation-and-contingency-tables" data-number="9.4.1"><span class="header-section-number">9.4.1</span>교차 위반 및 비상 테이블</h3>
<p>생물학적 환경에서 범주 형 데이터 : 서열 상태 (CPG/비 CPG), 표현형, 분류군은 종종 2 장에서 본 요인으로 코딩됩니다. 그러한 변수의 교차 테이블은<strong>비상 테이블</strong>; 두 가지 표현형의 동시 발생을 계산 한 결과 (성별 및 색맹이 그러한 예 였음). 우리는 첫 번째 단계는 두 범주 형 변수의 독립성을 보는 것임을 알았습니다. 독립성의 표준 통계적 측정은 다음을 사용합니다<strong>Chisquare 거리</strong>. 이 수량은 연속 측정에 사용한 분산을 대체합니다.</p>
<p>테이블의 열과 행은 '상태'가 동일하며 감독/회귀 유형 설정이 동일하지 않습니다. 우리는 샘플/가변 분할을 볼 수 없습니다. 결과적으로 행과 열은 동일한 상태를 가지며 행과 열을 '중심'합니다. 이 대칭은 또한 우리의 사용에서 번역됩니다<strong>이하</strong>동일한 플롯에 두 차원이 나타납니다.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-tbl-cap-location="top">
<div class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center" data-tbl-cap-location="top" id="tbl-HIV">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-HIV-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">표 9.1 : 돌연변이 매트릭스에 의한 샘플.</figcaption>
<div aria-describedby="tbl-HIV-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left;">인내심 있는</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">mut1</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">mut2</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">mut3</th>
<th data-quarto-table-cell-role="th" style="text-align: left;">...</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AHX112</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AHX717</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">AHX543</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div></div></div>
</figure>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="transforming-the-data-to-tabular-form.">
<h4 class="unnumbered anchored" data-anchor-id="transforming-the-data-to-tabular-form.">데이터를 표 형식으로 변환합니다.</h4>
<p>데이터가 범주 형 변수의 수준과 관련된 각 대상 (또는 샘플)과 함께 긴 목록으로 수집되면 우발 테이블로 변환 할 수 있습니다. 여기 예입니다. ~ 안에<a class="quarto-xref" href="#tbl-HIV">테이블<span>9.1</span></a>HIV 돌연변이는 지표 (0/1) 이진 변수로 표로되어 있습니다. 이 데이터는 a로 변환됩니다<strong>돌연변이 동시 발생 매트릭스</strong>표시<a class="quarto-xref" href="#tbl-crossHIV">테이블<span>9.2</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-tbl-cap-location="top">
<div class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center" data-tbl-cap-location="top" id="tbl-crossHIV">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-crossHIV-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">표 9.2 : 양방향 동시 발생을 나타내는 HIV 돌연변이의 교차 표현.</figcaption>
<div aria-describedby="tbl-crossHIV-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left;">인내심 있는</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">mut1</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">mut2</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">mut3</th>
<th data-quarto-table-cell-role="th" style="text-align: left;">...</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mut1</td>
<td style="text-align: right;">853</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">mut2</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">853</td>
<td style="text-align: right;">52</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mut3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">853</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div></div></div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-suffHIV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.10</div>
</div>
<div class="callout-body-container callout-body">
<p>이 교차 위반에서 어떤 정보가 손실됩니까?<br/>이건 언제 문제가 될까요?</p>
</div>
</div>
<p>다음은 HIV 데이터베이스의 동시 발생 데이터입니다<span class="citation" data-cites="HIVdb">(<a href="16-chap.html#ref-HIVdb" role="doc-biblioref">Rhee et al. 2003</a>))</span>. 이들 돌연변이 중 일부는 동시에 발생하는 경향이있다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-IndHIV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.11</div>
</div>
<div class="callout-body-container callout-body">
<p>돌연변이의 독립성 가설을 테스트하십시오.</p>
</div>
</div>
<p>서신 분석의 작동 방식에 대한 세부 사항을 설명하기 전에 많은 서신 분석 기능 중 하나의 출력을 살펴 보겠습니다. 우리는 사용합니다<code>Dudi</code>에서<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>낮은 차원 투영에서 돌연변이를 플로팅하는 패키지; 이 절차는 PCA에 대해 우리가 한 일을 따릅니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a>COOC<span class="ot">=</span> <span class="fu">read.delim2</span>(<span class="st">"../data/coccurhiv.txt"</span>,,,<span class="at">헤더 =</span> <span class="cn">진실</span>,,,<span class="at">sep =</span> <span class="st">","</span>))</span>
<span id="cb59-2"><a aria-hidden="true" href="#cb59-2" tabindex="-1"></a>COOC [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X4S X6D X6K X11R X20R X21I X35I X35L X35M X35T X39A
4S 0 28 8 0 99 0 22 5 15 3 45
6d 26 0 34 131 0 108 4 30 13 84
6K 7 0 6 45 0 5 13 38 35 12
11r 0 35 7 0 127 12 60 17 15 6 42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a aria-hidden="true" href="#cb61-1" tabindex="-1"></a>Hivka<span class="ot">=</span> <span class="fu">Dudi</span>(COOC,<span class="at">nf =</span> <span class="dv">4</span>,,,<span class="at">scannf =</span> <span class="cn">거짓</span>))</span>
<span id="cb61-2"><a aria-hidden="true" href="#cb61-2" tabindex="-1"></a><span class="fu">fviz_eig</span>(Hivca,<span class="at">geom =</span> <span class="st">"술집"</span>,,,<span class="at">bar_width =</span> <span class="fl">0.6</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HIVnnrti">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HIVnnrti-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="09-chap_files/figure-html/fig-HIVnnrti-1.png" title="Figure 9.20: The dependencies between HIV mutations is clearly a three dimensional phenomenon, the three first eigenvalues show a clear signal in the data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-HIVnnrti-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HIVnnrti-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.20 : HIV 돌연변이 사이의 의존성은 분명히 3 차원 현상이며, 3 개의 첫 번째 고유 값은 데이터에서 명확한 신호를 보여줍니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HIV3d">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HIV3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="imgs/scatter3d-HIV.png" title="Figure 9.21: A screenshot of the output from an interactive 3d plotting function (plot3d)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/scatter3d-HIV.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HIV3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.21 : 대화식 3D 플로팅 기능의 출력 스크린 샷 (<code>Plot3d</code>).
</figcaption>
</figure>
</div>
</div></div></div>
<p>screeplot을 살펴본 후, 우리는 기본 변동의 차원이 확실히 3 차원이라는 것을 알 수 있습니다. 이상적으로 이것은 패키지를 통해 제공되는 것과 같은 대화식 3 차원 플로팅 기능으로 수행됩니다.<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>표시된대로<a class="quarto-xref" href="#fig-HIV3d">수치<span>9.21</span></a>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-3DonHIV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.12</div>
</div>
<div class="callout-body-container callout-body">
<p>사용<strong><a href="https://cran.r-project.org/web/packages/car/">자동차</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>패키지는 3D ScatterPlot과 비슷합니다<a class="quarto-xref" href="#fig-HIV3d">수치<span>9.21</span></a>.<br/>plot3d 함수에서 측면 = false를 사용하여 얻은 플롯과 비교하십시오.<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>.<br/>포인트의 구름을 회전시켜 어떤 구조를 주시합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-21-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-21-contents callout-collapse collapse" id="callout-21">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rgl"</span>))</span>
<span id="cb62-2"><a aria-hidden="true" href="#cb62-2" tabindex="-1"></a>CA1<span class="ot">=</span>Hivka<span class="sc">$</span>li [,<span class="dv">1</span>]; CA2<span class="ot">=</span>Hivka<span class="sc">$</span>li [,<span class="dv">2</span>];<span class="ot">=</span>Hivka<span class="sc">$</span>li [,<span class="dv">3</span>]]</span>
<span id="cb62-3"><a aria-hidden="true" href="#cb62-3" tabindex="-1"></a><span class="fu">Plot3d</span>(CA1, CA2, CA3,<span class="at">측면 =</span><span class="cn">거짓</span>,,,<span class="at">col =</span><span class="st">"보라"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a aria-hidden="true" href="#cb63-1" tabindex="-1"></a><span class="fu">fviz_ca_row</span>(Hivca,<span class="at">축 =</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>),)<span class="at">geom =</span><span class="st">"텍스트"</span>,,,<span class="at">col.row =</span><span class="st">"보라"</span>,,,</span>
<span id="cb63-2"><a aria-hidden="true" href="#cb63-2" tabindex="-1"></a>  <span class="at">labelsize =</span><span class="dv">3</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.55</span>,,,<span class="fl">1.7</span>))<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="sc">-</span><span class="fl">0.53</span>,,,<span class="fl">1.1</span>))<span class="sc">+</span></span>
<span id="cb63-3"><a aria-hidden="true" href="#cb63-3" tabindex="-1"></a>  <span class="fu">테마_BW</span>() <span class="sc">+</span>  <span class="fu">coord_fixed</span>()</span>
<span id="cb63-4"><a aria-hidden="true" href="#cb63-4" tabindex="-1"></a><span class="fu">fviz_ca_row</span>(Hivca,<span class="at">축 =</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>),)<span class="at">geom =</span><span class="st">"텍스트"</span>,,,<span class="at">col.row =</span><span class="st">"보라"</span>,,,</span>
<span id="cb63-5"><a aria-hidden="true" href="#cb63-5" tabindex="-1"></a>    <span class="at">labelsize =</span><span class="dv">3</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.55</span>,,,<span class="fl">1.7</span>))<span class="sc">+</span><span class="fu">맨 위</span>(<span class="sc">-</span><span class="fl">0.5</span>,,,<span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb63-6"><a aria-hidden="true" href="#cb63-6" tabindex="-1"></a>    <span class="fu">테마_BW</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-HIVca">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-HIVca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HIVca" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HIVca-1" width="360">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-HIVca-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-HIVca" href="09-chap_files/figure-html/fig-HIVca-1.png" title="Figure 9.22 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-HIVca" id="fig-HIVca-1" src="09-chap_files/figure-html/fig-HIVca-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HIVca-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-HIVca" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HIVca-2" width="360">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-HIVca-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-HIVca" href="09-chap_files/figure-html/fig-HIVca-2.png" title="Figure 9.22 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-HIVca" id="fig-HIVca-2" src="09-chap_files/figure-html/fig-HIVca-2.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-HIVca-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-HIVca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">도 9.22 : CA의 첫 번째 고유 벡터에 해당하는 수평 축으로 정의 된 돌연변이의 2 개의 평면 맵과 수직 축은 (a)의 두 번째 축이고 (b)의 세 번째 축; 높이의 차이를 주목하십시오.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-plane13">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.13</div>
</div>
<div class="callout-body-container callout-body">
<p>하단 그림에 표시된 바와 같이 수직 축의 스케일링과 관련하여 대응 분석의 축 1 및 3으로 정의 된 평면을 플로팅하기위한 코드를 표시합니다.<a class="quarto-xref" href="#fig-HIVca">수치<span>9.22</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-23-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-23-contents callout-collapse collapse" id="callout-23">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a><span class="fu">fviz_ca_row</span>(Hivca,<span class="at">축 =</span><span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>),)<span class="at">geom =</span><span class="st">"텍스트"</span>,,,<span class="at">col.row =</span><span class="st">"보라"</span>,,,<span class="at">labelsize =</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb64-2"><a aria-hidden="true" href="#cb64-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">테마_minimal</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>이 첫 번째 예는 PCA가 연속 변수를 투사하는 방식과 유사한 방식으로 하나의 범주 형 변수 (돌연변이)의 모든 다른 수준을 매핑하는 방법을 보여주었습니다. 이제 이것이 두 개 이상의 범주 형 변수로 어떻게 확장 될 수 있는지 탐구합니다.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="9.4.2" id="hair-color-eye-color-and-phenotype-co-occurrence">
<h3 class="anchored" data-anchor-id="hair-color-eye-color-and-phenotype-co-occurrence" data-number="9.4.2"><span class="header-section-number">9.4.2</span>헤어 컬러, 눈 색깔 및 표현형 동시 발생</h3>
<p>우리는 작은 테이블을 고려하여 분석을 자세히 따라갈 수 있습니다. 데이터는 다음과 같이 학생들의 모발 색과 눈 색깔 표현형의 동시 발생의 비상 테이블입니다.<a class="quarto-xref" href="#tbl-HairEye">테이블<span>9.3</span></a>. ~ 안에<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>, 우리는 a를 사용했습니다<span class="math inline">\ (\ chi^2 \)</span>가능한 종속성을 감지하기 위해 테스트하십시오.</p>
<div class="cell" data-layout-align="center" data-warning.known="approximation may be incorrect">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a>이발<span class="ot">=</span>Haireyecolor [,,,<span class="dv">2</span>]]</span>
<span id="cb65-2"><a aria-hidden="true" href="#cb65-2" tabindex="-1"></a><span class="fu">chisq.test</span>(헤어 컬러)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>피어슨의 카이 제곱 테스트

데이터 : 이발
x-squared = 106.66, df = 9, p- 값 &lt;2.2e-16</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center" data-tbl-cap-location="top">
<div class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center" data-tbl-cap-location="top" id="tbl-HairEye">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-HairEye-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">표 9.3 : 학생의 머리카락과 눈 색깔의 교차 표.</figcaption>
<div aria-describedby="tbl-HairEye-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right;">갈색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">파란색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">엷은 갈색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">녹색</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">검은색</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">갈색</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">빨간색</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">금발</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div></div></div>
</figure>
</div>
</div>
<p>그러나 진술<em>비 독립성</em>머리카락과 눈 색깔 사이는 충분하지 않습니다. 의존성이 발생하는 위치에 대한 자세한 설명이 필요합니다. 녹색 눈으로 어떤 머리 색깔이 더 자주 발생합니까? 변수 레벨 중 일부는 독립적입니까? 실제로 우리는 특별한 가중 버전의 SVD를 사용하여 독립에서 벗어나는 것을 연구 할 수 있습니다. 이 방법은 우발 테이블로의 PCA 및 MD의 간단한 확장으로 이해 될 수 있습니다.</p>
<section class="level4 unnumbered page-columns page-full" id="independence-computationally-and-visually.">
<h4 class="unnumbered anchored" data-anchor-id="independence-computationally-and-visually.">독립성 : 계산 및 시각적.</h4>
<p>우리는 행과 열 합계를 계산하는 것으로 시작합니다. 우리는 이것을 사용하여 두 표현형이 독립적 인 경우 예상되는 테이블을 구축합니다. 우리는이 예상 테이블을 호출합니다<code>HCEXP</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a aria-hidden="true" href="#cb67-1" tabindex="-1"></a>로우 섬<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">적용하다</span>(이발자,<span class="dv">1</span>, sum))</span>
<span id="cb67-2"><a aria-hidden="true" href="#cb67-2" tabindex="-1"></a>로우 섬</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1]
블랙 52
브라운 143
빨간 37
금발 81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a aria-hidden="true" href="#cb69-1" tabindex="-1"></a>Colsums<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">적용하다</span>(이발자,<span class="dv">2</span>, sum))</span>
<span id="cb69-2"><a aria-hidden="true" href="#cb69-2" tabindex="-1"></a><span class="fu">티</span>(colsums)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>브라운 블루 헤이즐 그린
[1,] 122 114 46 31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a aria-hidden="true" href="#cb71-1" tabindex="-1"></a>HCEXP<span class="ot">=</span>로우 섬<span class="sc">%*%</span><span class="fu">티</span>(colsums)<span class="sc">/</span> <span class="fu">합집합</span>(colsums)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell" data-layout-align="center">
</div></div><p>이제 우리는 계산합니다<span class="math inline">\ (\ chi^2 \)</span>(Chi-Squared) 통계, 이것은 표의 각 셀에 대한 스케일링 잔차의 합입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a><span class="fu">합집합</span>((이발<span class="sc">-</span>HCEXP)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>HCEXP)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 106.6637</code></pre>
</div>
</div>
<p>우리는 예상 테이블 에서이 잔차를 연구 할 수 있습니다.<a class="quarto-xref" href="#fig-MosaicHair">수치<span>9.23</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a><span class="fu">둥근</span>(<span class="fu">티</span>(이발<span class="sc">-</span>HCEXP)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>머리카락
눈 검은 갈색 붉은 금발
  브라운 16 10 2 -28
  블루 -10-18-6 34
  헤이젤 -3 8 2 -7
  녹색 -3 0 3 0</code></pre>
</div>
<div class="sourceCode cell-code" data-cap-location="margin" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"VCD"</span>))</span>
<span id="cb76-2"><a aria-hidden="true" href="#cb76-2" tabindex="-1"></a><span class="fu">모자이크</span>(이발자,<span class="at">그늘 =</span><span class="cn">진실</span>,,,<span class="at">las =</span><span class="dv">1</span>,,,<span class="at">유형 =</span><span class="st">"피어슨"</span>,,,<span class="at">cex.axis =</span><span class="fl">0.7</span>,,,<span class="at">메인 =</span><span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-MosaicHair">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-MosaicHair-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-33" href="09-chap_files/figure-html/fig-MosaicHair-1.png" title="Figure 9.23: Visualization of the departure from independence. Now, the boxes are proportional in size to the actual observed counts and we no longer have a ‘rectangular’ property. The departure from independence is measured in Chisquared distance for each of the boxes and colored according to whether the residuals are large and positive. Dark blue indicates a positive association, for instance between blue eyes and blonde hair, red indicates a negative association such as in the case of blond hair and brown eyes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-MosaicHair-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-MosaicHair-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.23 : 독립에서 벗어난 시각화. 이제 상자의 크기는 실제 관찰 된 카운트에 비례하며 더 이상 '직사각형'속성이 없습니다. 독립성에서 벗어나는 것은 각 상자에 대한 퀴즈 거리로 측정되며 잔차가 크고 양수인지 여부에 따라 채색됩니다. 진한 파란색은 푸른 눈과 금발 머리 사이의 긍정적 인 연관성을 나타냅니다. 빨간색은 금발 머리와 갈색 눈의 경우와 같이 부정적인 연관성을 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section class="level4 unnumbered page-columns page-full" id="mathematical-formulation.">
<h4 class="unnumbered anchored" data-anchor-id="mathematical-formulation.">수학적 공식.</h4>
<p>다음은 방금 R에서보다 수학적 형태로 수행 한 계산입니다. 일반적인 비상 테이블 용<span class="math inline">\ ({\ mathbf n} \)</span>~와 함께<span class="math inline">\(나\)</span>줄과<span class="math inline">\ (J \)</span>열 및 총 샘플 크기<span class="math inline">\ (n = \ sum_ {i = 1}^i \ sum_ {j = 1}^j n_ {ij} = n _ {\ cdot \ cdot} \)</span>. 두 범주 형 변수가 독립적이면 각 셀 주파수는 거의</p>
<p><span class="math display">\ [
n_ {ij} = \ frac {n_ {i \ cdot}} {n} \ frac {n _ {\ cdot j}} {n} \ times n
\]</span></p>
<p>또한 작성할 수 있습니다.</p>
<p><span class="math display">\ [
{\ mathbf n} = {\ mathbf c r '} \ times n, \ qquad
\ mbox {where} c = \ frac {1} {n} {{\ mathbf n}} {\ mathbb 1} _m
\; \ mbox {and} \; r '= \ frac {1} {n} {\ mathbf n}'{\ mathbb 1} _p
\]</span></p>
<p>독립에서 벗어난 것은 다음으로 측정됩니다<span class="math inline">\ (\ chi^2 \)</span>통계량</p>
<p><span class="math display">\ [
{\ cal x}^2 = \ sum_ {i, j}
\ frac {\ left (n_ {ij}-\ frac {n_ {i \ cdot}} {n} \ frac {n _ {\ cdot j}} {n} n \ right)^2}
{\ frac {n_ {i \ cdot} n _ {\ cdot j}} {n^2} n}
\]</span></p>
<div class="page-columns page-full"><p>두 변수가 독립적이지 않음을 확인한 후에는 가중 다차원 스케일링을 사용합니다.<span class="math inline">\ (\ chi^2 \)</span>연관성을 시각화하는 거리.</p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>CeptionEce 분석 기능</strong> <code>CCA</code>~에<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>,,,<code>CA</code>~에<strong><a href="https://cran.r-project.org/web/packages/FactoMineR/">사실상</a></strong>,,,<code>ordinate</code>~에<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong>,,,<code>Dudi</code>~에<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>.</span></div></div>
<p>이 방법이 호출됩니다<strong>서신 분석 (CA)</strong>또는<strong>이중 스케일링</strong>그리고 그것을 구현하는 여러 개의 R 패키지가 있습니다.</p>
<p>여기서 우리는 머리카락과 눈 색깔의 간단한 이형을 만듭니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a>HC<span class="ot">=</span> <span class="fu">as.data.frame.matrix</span>(헤어 컬러)</span>
<span id="cb77-2"><a aria-hidden="true" href="#cb77-2" tabindex="-1"></a>CoAHC<span class="ot">=</span> <span class="fu">Dudi</span>(HC,<span class="at">scannf =</span><span class="cn">거짓</span>,,,<span class="at">nf =</span><span class="dv">2</span>))</span>
<span id="cb77-3"><a aria-hidden="true" href="#cb77-3" tabindex="-1"></a><span class="fu">둥근</span>(COAHC<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]<span class="sc">/</span><span class="fu">합집합</span>(COAHC<span class="sc">$</span>EIG)<span class="sc">*</span><span class="dv">100</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>[1] 89 10 2</code></pre>
</div>
<div class="sourceCode cell-code" data-cap-location="margin" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(CoAHC,<span class="at">repel =</span><span class="cn">진실</span>,,,<span class="at">col.col =</span><span class="st">"갈색"</span>,,,<span class="at">col.row =</span><span class="st">"보라"</span>))<span class="sc">+</span></span>
<span id="cb79-2"><a aria-hidden="true" href="#cb79-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="sc">-</span><span class="fl">0.5</span>,,,<span class="fl">0.5</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-HCscatter">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-HCscatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-34" href="09-chap_files/figure-html/fig-HCscatter-1.png" title="Figure 9.24: The CA plot gives a representation of a large proportion of the chisquare distance between the data and the values expected under independence. The first axis shows a contrast between black haired and blonde haired students, mirrored by the brown eye, blue eye opposition. In CA the two categories play symmetric roles and we can interpret the proximity of Blue eyes and Blond hair has meaning that there is strong co-occurence of these categories."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-HCscatter-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-HCscatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.24 : CA 플롯은 데이터와 독립 상태에서 예상되는 값 사이의 많은 비율의 카이 스카 거리를 나타냅니다. 첫 번째 축은 검은 머리와 금발 머리 학생들 사이의 대조를 보여줍니다. CA에서 두 범주는 대칭 역할을 수행하며 파란 눈의 근접성을 해석 할 수 있으며 금발 머리는 이러한 범주의 강한 공동성이 있음을 의미합니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-percentagechi">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.14</div>
</div>
<div class="callout-body-container callout-body">
<p>화격 통계의 몇 퍼센트는 서신 분석의 처음 두 축으로 설명됩니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-compareCCA">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.15</div>
</div>
<div class="callout-body-container callout-body">
<p>결과를 사용하여 얻은 결과와 비교하십시오<code>CCA</code>에서<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>적절한 값을 가진 패키지<code>스케일링</code>매개 변수.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-26-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-26-contents callout-collapse collapse" id="callout-26">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"비건 채식"</span>))</span>
<span id="cb80-2"><a aria-hidden="true" href="#cb80-2" tabindex="-1"></a>res.ca<span class="ot">=</span>비건 채식<span class="sc">::</span><span class="fu">CCA</span>(헤어 컬러)</span>
<span id="cb80-3"><a aria-hidden="true" href="#cb80-3" tabindex="-1"></a><span class="fu">구성</span>(res.ca,<span class="at">스케일링 =</span><span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section class="level4 unnumbered" id="interpreting-the-biplots">
<h4 class="unnumbered anchored" data-anchor-id="interpreting-the-biplots">이브 플롯 해석</h4>
<p>CA는 특수한 바리 중심 속성을 가지고 있습니다. 이브 플롯 스케일링이 선택되어 행 지점이 각각의 가중치로 열 레벨의 무게 중심에 배치됩니다. 예를 들어, 파란 눈 컬럼 포인트는 (9, 34, 7, 64)에 비례하는 무게를 가진 (검은 색, 갈색, 빨간색, 금발)의 중심 중심에 있습니다. 금발 행 지점은 매우 무게가 높아서 이것이 이유입니다.<a class="quarto-xref" href="#fig-HCscatter">수치<span>9.24</span></a>금발과 파란색이 서로 가깝게 보여줍니다.</p>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="9.5" id="sec-hetero-findingtime">
<h2 class="anchored" data-anchor-id="sec-hetero-findingtime" data-number="9.5"><span class="header-section-number">9.5</span>시간 및 기타 중요한 그라디언트 찾기.</h2>
<p>마지막 섹션에서 우리가 연구 한 모든 방법은 일반적으로<strong>안수</strong>행동 양식. 같은 방식으로<strong>클러스터링</strong>숨겨진 요소/범주 형 변수를 감지하고 해석 할 수 있었을 때, 안수를 통해 데이터의 숨겨진 순서, 그라디언트 또는 잠재 변수를 감지하고 해석 할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-35" href="imgs/ProustProxy.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/ProustProxy.png"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p>생태 학자들은 서신 분석의 관찰 지점과 주요 구성 요소에서 생태 학적 그라디언트로 형성된 아치를 오랜 역사를 가지고 있습니다.<span class="citation" data-cites="Prentice:1977">(<a href="16-chap.html#ref-Prentice:1977" role="doc-biblioref">Prentice 1977</a>))</span>. 서신 분석을 수행하는 매우 간단한 데이터 세트로 먼저 설명해 봅시다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">망사 또는 연대기 탐지의 첫 번째 예는 Archaelogical Artifacts의 예입니다.<span class="citation" data-cites="Kendall:1969">켄달 (Kendall) (<a href="16-chap.html#ref-Kendall:1969" role="doc-biblioref">1969</a>))</span>, 도자기의 기능의 존재/부재를 도자기에 데이트로 사용했습니다. 이러한 소위 혈청 방법은 오늘날에도 단일 셀 데이터의 발달 궤적을 따를 때 여전히 관련이 있습니다.</span></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a aria-hidden="true" href="#cb81-1" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/lakes.rdata"</span>))</span>
<span id="cb81-2"><a aria-hidden="true" href="#cb81-2" tabindex="-1"></a>Celk ...- 감사합니다 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Plant1 Plant2 Plant3 Plant4 Plant6 Plant7 Plant8
Loc1 6 4 0 3 0 0 0
LOC2 4 5 5 3 4 2 0 0
loc3 3 4 7 4 5 2 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a aria-hidden="true" href="#cb83-1" tabindex="-1"></a>재판매<span class="ot">=</span><span class="fu">Dudi</span>(레이,<span class="at">scannf =</span><span class="cn">거짓</span>,,,<span class="at">nf =</span><span class="dv">2</span>))</span>
<span id="cb83-2"><a aria-hidden="true" href="#cb83-2" tabindex="-1"></a><span class="fu">둥근</span>(재판장<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]]<span class="sc">/</span><span class="fu">합집합</span>(재판장<span class="sc">$</span>eig),<span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.56 0.25 0.09 0.03 0.03 0.01 0.00</code></pre>
</div>
</div>
<p>우리는 두 행용 지점을 모두 플로팅합니다 (<a class="quarto-xref" href="#fig-LakeCAr">수치<span>9.25</span></a>(a)) 및 하부의 위치와 식물 종의 2 개가<a class="quarto-xref" href="#fig-LakeCAr">수치<span>9.25</span></a>(비); 이 음모는 다음과 같이 만들어졌습니다.</p>
<div class="cell" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a aria-hidden="true" href="#cb85-1" tabindex="-1"></a><span class="fu">fviz_ca_row</span>(재판장,<span class="at">repel =</span><span class="cn">진실</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span><span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="sc">-</span><span class="fl">0.55</span>,,,<span class="fl">1.7</span>)))</span>
<span id="cb85-2"><a aria-hidden="true" href="#cb85-2" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(재판장,<span class="at">repel =</span><span class="cn">진실</span>))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span><span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="sc">-</span><span class="fl">0.55</span>,,,<span class="fl">1.7</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-LakeCAr">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-LakeCAr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-LakeCAr" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-LakeCAr-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-LakeCAr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-LakeCAr" href="09-chap_files/figure-html/fig-LakeCAr-1.png" title="Figure 9.25 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-LakeCAr" id="fig-LakeCAr-1" src="09-chap_files/figure-html/fig-LakeCAr-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-LakeCAr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-LakeCAr" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-LakeCAr-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-LakeCAr-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-LakeCAr" href="09-chap_files/figure-html/fig-LakeCAr-2.png" title="Figure 9.25 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-LakeCAr" id="fig-LakeCAr-2" src="09-chap_files/figure-html/fig-LakeCAr-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-LakeCAr-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LakeCAr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.25 : 호수 근처의 위치는 (a)와 같이 아치를 따라 주문됩니다. Biplot (b)에서, 우리는 파란색 점에 가장 가까운 붉은 삼각형을 보면서 어떤 장소가 가장 빈번한 지 알 수 있습니다.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-matrixpattern">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.16</div>
</div>
<div class="callout-body-container callout-body">
<p>원시 매트릭스를 되돌아보십시오<code>호수</code>알다시피, 항목에 패턴이 보입니까?<br/>식물이 실제 분류군 이름으로 주문 된 경우 어떻게됩니까?</p>
</div>
</div>
<section class="level3 page-columns page-full" data-number="9.5.1" id="sec-hetero-celldynamics">
<h3 class="anchored" data-anchor-id="sec-hetero-celldynamics" data-number="9.5.1"><span class="header-section-number">9.5.1</span>세포 발달의 역학</h3>
<p>이제 게시 한 더 흥미로운 데이터 세트를 분석합니다.<span class="citation" data-cites="Moignard:2015">Moignard et al. (<a href="16-chap.html#ref-Moignard:2015" role="doc-biblioref">2015</a>))</span>. 이 논문은 혈액 세포 발달의 역학에 대해 설명합니다. 데이터는 배아 일 E7.0과 E8.25 사이의 5 개 집단으로부터 혈액을 갖는 3,934 세포의 단일 세포 유전자 발현 측정이다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CellTree">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CellTree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-38" href="imgs/CellTree.png" title="Figure 9.26: The four cell populations studied here are representative of three sequential states (PS,NP,HF) and two possible final branches (4SG and 4SFG^{-})."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/CellTree.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CellTree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.26 : 여기에서 연구 된 4 개의 세포 집단은 3 개의 순차적 상태 (PS, NP, HF)와 2 개의 가능한 최종 분기 (4SG 및 4SFG를 나타냅니다.<span class="math inline">\ (^{-} \)</span>).
</figcaption>
</figure>
</div>
</div></div></div>
<p>기억하십시오<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>세포를 비교하기 위해 여러 가지 거리가 있습니다. 여기서 우리는 둘 다 컴퓨팅으로 시작합니다<span class="math inline">\ (l_2 \)</span>거리와<span class="math inline">\ (\ ell_1 \)</span>3,934 세포 사이의 거리.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" href="#cb86-1" tabindex="-1"></a>Moignard<span class="ot">=</span> <span class="fu">readrds</span>(<span class="st">"../data/moignard.rds"</span>))</span>
<span id="cb86-2"><a aria-hidden="true" href="#cb86-2" tabindex="-1"></a>셀<span class="ot">=</span> <span class="fu">RowData</span>(Moignard)<span class="sc">$</span>Cellypes</span>
<span id="cb86-3"><a aria-hidden="true" href="#cb86-3" tabindex="-1"></a>콜스<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"빨간색"</span>,,,<span class="st">"보라"</span>,,,<span class="st">"주황색"</span>,,,<span class="st">"녹색"</span>,,,<span class="st">"파란색"</span>))</span>
<span id="cb86-4"><a aria-hidden="true" href="#cb86-4" tabindex="-1"></a>블롬<span class="ot">=</span> <span class="fu">시험</span>(Moignard)</span>
<span id="cb86-5"><a aria-hidden="true" href="#cb86-5" tabindex="-1"></a>dist2n.euclid<span class="ot">=</span> <span class="fu">dist</span>(Blom)</span>
<span id="cb86-6"><a aria-hidden="true" href="#cb86-6" tabindex="-1"></a>dist1n.l1<span class="ot">=</span> <span class="fu">dist</span>(Blom,<span class="st">"맨해튼"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이 두 거리 행렬의 고전적인 다차원 스케일링은 다음을 사용하여 수행 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a aria-hidden="true" href="#cb87-1" tabindex="-1"></a>CE1MDS<span class="ot">=</span> <span class="fu">cmdscale</span>(dista1n.l1,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb87-2"><a aria-hidden="true" href="#cb87-2" tabindex="-1"></a>CE2MDS<span class="ot">=</span> <span class="fu">cmdscale</span>(dist2n.euclid,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb87-3"><a aria-hidden="true" href="#cb87-3" tabindex="-1"></a>PERC1<span class="ot">=</span> <span class="fu">둥근</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">합집합</span>(CE1MDS<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="sc">/</span><span class="fu">합집합</span>(CE1MDS<span class="sc">$</span>EIG))</span>
<span id="cb87-4"><a aria-hidden="true" href="#cb87-4" tabindex="-1"></a>PERC2<span class="ot">=</span> <span class="fu">둥근</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">합집합</span>(CE2MDS<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="sc">/</span><span class="fu">합집합</span>(CE2MDS<span class="sc">$</span>EIG))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 기본 치수를보고<a class="quarto-xref" href="#fig-CMDSplotscree">수치<span>9.27</span></a>이 두 차원은 분산의 상당 부분을 제공 할 수 있습니다.</p>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a aria-hidden="true" href="#cb88-1" tabindex="-1"></a><span class="fu">플로트 크리</span>(CE1MDS,<span class="at">m =</span> <span class="dv">4</span>))</span>
<span id="cb88-2"><a aria-hidden="true" href="#cb88-2" tabindex="-1"></a><span class="fu">플로트 크리</span>(CE2MDS,<span class="at">m =</span> <span class="dv">4</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-CMDSplotscree">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-CMDSplotscree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-CMDSplotscree" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CMDSplotscree-1" width="200">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-CMDSplotscree-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-CMDSplotscree" href="09-chap_files/figure-html/fig-CMDSplotscree-1.png" title="Figure 9.27 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-CMDSplotscree" id="fig-CMDSplotscree-1" src="09-chap_files/figure-html/fig-CMDSplotscree-1.png" width="200"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CMDSplotscree-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-CMDSplotscree" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CMDSplotscree-2" width="200">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-CMDSplotscree-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-CMDSplotscree" href="09-chap_files/figure-html/fig-CMDSplotscree-2.png" title="Figure 9.27 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-CMDSplotscree" id="fig-CMDSplotscree-2" src="09-chap_files/figure-html/fig-CMDSplotscree-2.png" width="200"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CMDSplotscree-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CMDSplotscree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.27 : MDS의 ScreePlots<span class="math inline">\ (\ ell_1 \)</span>(a) 및<span class="math inline">\ (l_2 \)</span>(b) 거리. 우리는 고유 값이 매우 유사하고 둘 다<span class="math inline">\ (2 \)</span>치수 현상.</figcaption>
</figure>
</div>
<p>처음 2 개의 좌표는<span class="math inline">\ (\ ell_1 \)</span>거리는 세포 사이에서, 그리고 57%는<span class="math inline">\ (l^2 \)</span>거리가 사용됩니다. 우리는<a class="quarto-xref" href="#fig-CMDSplotL2-1">수치<span>9.28 (a)</span></a>MDS의 첫 번째 평면<span class="math inline">\ (\ ell_1 \)</span>세포 사이의 거리 :</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a aria-hidden="true" href="#cb89-1" tabindex="-1"></a>C1MDS<span class="ot">=</span>CE1MDS<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="sc">|&gt;</span></span>
<span id="cb89-2"><a aria-hidden="true" href="#cb89-2" tabindex="-1"></a>        <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="fu">페이스트0</span>(<span class="st">"L1_PCO"</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))<span class="sc">|&gt;</span></span>
<span id="cb89-3"><a aria-hidden="true" href="#cb89-3" tabindex="-1"></a>        <span class="fu">as_tibble</span>()</span>
<span id="cb89-4"><a aria-hidden="true" href="#cb89-4" tabindex="-1"></a><span class="fu">ggplot</span>(C1MDS,<span class="fu">AES</span>(<span class="at">x =</span>l1_pco1,<span class="at">y =</span>l1_pco2,<span class="at">색상 =</span>셀)<span class="sc">+</span></span>
<span id="cb89-5"><a aria-hidden="true" href="#cb89-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>셀),<span class="at">알파 =</span> <span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb89-6"><a aria-hidden="true" href="#cb89-6" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">값 =</span>콜스)<span class="sc">+</span> <span class="fu">가이드</span>(<span class="at">색상 =</span> <span class="st">"없음"</span>))</span>
<span id="cb89-7"><a aria-hidden="true" href="#cb89-7" tabindex="-1"></a>C2MD<span class="ot">=</span>CE2MDS<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="sc">|&gt;</span></span>
<span id="cb89-8"><a aria-hidden="true" href="#cb89-8" tabindex="-1"></a>        <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="fu">페이스트0</span>(<span class="st">"L2_PCO"</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))<span class="sc">|&gt;</span></span>
<span id="cb89-9"><a aria-hidden="true" href="#cb89-9" tabindex="-1"></a>        <span class="fu">as_tibble</span>()</span>
<span id="cb89-10"><a aria-hidden="true" href="#cb89-10" tabindex="-1"></a><span class="fu">ggplot</span>(C2MDS,<span class="fu">AES</span>(<span class="at">x =</span>l2_pco1,<span class="at">y =</span>l2_pco2,<span class="at">색상 =</span>셀)<span class="sc">+</span></span>
<span id="cb89-11"><a aria-hidden="true" href="#cb89-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>셀),<span class="at">알파 =</span> <span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb89-12"><a aria-hidden="true" href="#cb89-12" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="at">값 =</span>콜스)<span class="sc">+</span> <span class="fu">가이드</span>(<span class="at">색상 =</span> <span class="st">"없음"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-CMDSplotL2">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-CMDSplotL2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-CMDSplotL2" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CMDSplotL2-1" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-CMDSplotL2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-CMDSplotL2" href="09-chap_files/figure-html/fig-CMDSplotL2-1.png" title="Figure 9.28 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-CMDSplotL2" id="fig-CMDSplotL2-1" src="09-chap_files/figure-html/fig-CMDSplotL2-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CMDSplotL2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-CMDSplotL2" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CMDSplotL2-2" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-CMDSplotL2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-CMDSplotL2" href="09-chap_files/figure-html/fig-CMDSplotL2-2.png" title="Figure 9.28 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-CMDSplotL2" id="fig-CMDSplotL2-2" src="09-chap_files/figure-html/fig-CMDSplotL2-2.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CMDSplotL2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-CMDSplotL2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.28 : 셀 유형에 따라 채색 된 Moignard Cell 데이터 (파란색 : PS, 녹색 : NP : HF, HF : Red : 4SG, Purple : 4SFG<span class="math inline">\ (^-\)</span>) 2 차원 MDS 플롯에서 생성되었습니다. (a) 사용<span class="math inline">\ (\ ell_1 \)</span>L2 거리를 사용하는 거리 및 (b).</figcaption>
</figure>
</div>
</div>
<!-- TODO: this isn't showing in the book online? 

::: {.cell .column-margin layout-align="center"}
::: {.cell-output-display}
![](09-chap_files/figure-html/colorlegend-1.png){fig-align='center' width=160}
:::
:::

-->
<p><a class="quarto-xref" href="#fig-CMDSplotL2-2">수치<span>9.28 (b)</span></a>같은 방식으로 생성되며 L2 거리에서 MD를 사용하여 생성 된 2 차원 투영을 보여줍니다.</p>
<p><a class="quarto-xref" href="#fig-CMDSplotL2">수치<span>9.28</span></a>두 거리 (L1 및 L2)는 기본 구배와 셀과 매우 유사한 표현을 갖는 MD에 대해 동일한 첫 번째 평면을 제공한다는 것을 보여준다.</p>
<p>우리는 볼 수 있습니다<a class="quarto-xref" href="#fig-CMDSplotL2">수치<span>9.28</span></a>셀이 우리가보고있는 더 낮은 차원에서 균일하게 분포되지 않기 때문에 우리는 점의 명확한 구성을 볼 수 있습니다. 타입 4SG의 모든 셀은 빨간색으로 표현 된 다른 세포 유형과 훨씬 덜 혼합 된 길쭉한 클러스터를 형성합니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="9.5.2" id="local-nonlinear-methods">
<h3 class="anchored" data-anchor-id="local-nonlinear-methods" data-number="9.5.2"><span class="header-section-number">9.5.2</span>국부적, 비선형 방법</h3>
<p>다차원 스케일링 및 비 메트릭 다차원 스케일링은<strong>모두</strong>가능한 한 정확하게 거리와 멀리 떨어진 지점 사이의 먼 거리는 표현을 왜곡시킵니다. 그라디언트 또는 저 차원 매니 폴드를 찾을 때 함께 가까운 점의 근사치로 제한 할 때 유리할 수 있습니다. 이것은 로컬 (작은) 거리를 잘 나타내려고 노력하고 너무 많은 정확도로 먼 지점 사이의 거리를 근사화하려고 시도하지 않는 방법을 요구합니다.</p>
<p>최근 몇 년 동안 그러한 방법에서 상당한 진전이있었습니다. 사용<strong>커널</strong>계산 된 지점 간 거리를 사용하여 계산하면 멀리 떨어진 점의 중요성을 줄일 수 있습니다. 방사형 기본 커널은 형태입니다</p>
<p><span class="math display">\ [
1- \ exp \ left (-\ frac {d (x, y)^2} {\ sigma^2} \ 오른쪽),
\ quad \ mbox {where} \ sigma^2 \ mbox {고정되어 있습니다.}
\]</span></p>
<p>그것은 먼 거리를 크게 할인하는 효과가 있습니다. 이것은 지점 간 거리의 정밀도가 더 작은 범위에서 종종 더 좋기 때문에 매우 유용 할 수 있습니다. 이러한 방법의 몇 가지 예는 다루어집니다<a class="quarto-xref" href="#imp-hetero-KernelMethods">운동<span>9.6</span></a>이 장의 끝에서.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-exp">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.17</div>
</div>
<div class="callout-body-container callout-body">
<p>왜 우리는 1과 지수의 차이를 취하는 이유는 무엇입니까?<br/>사이의 거리가 발생하면 어떻게됩니까?<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>매우 큽니까?</p>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="t-sne.">
<h4 class="unnumbered anchored" data-anchor-id="t-sne.">t-me.</h4>
<p>이 널리 사용되는이 방법은 위에서 정의 된 커널에 유연성을 추가하고 허용합니다.<span class="math inline">\ (\ sigma^2 \)</span>로컬로 변하는 매개 변수 (평균으로 정규화 단계가 있습니다). T-SNE 방법은 높은 차원 공간의 점의 위치에서 시작하여 확률이 점의 근접성 또는 유사성에 비례 할 수 있도록 포인트 쌍에 대한 확률 분포를 도출합니다. 그런 다음이 분포를 사용하여 데이터 세트의 표현을 낮은 차원으로 구성합니다. 이 방법은 강력하지 않으며 포인트 클러스터를 인위적으로 분리하는 특성을 가지고 있습니다. 그러나이 속성은 복잡한 상황을 명확히하는 데 도움이 될 수 있습니다. 그래프 (또는 네트워크) 레이아웃 알고리즘과 유사한 방법으로 생각할 수 있습니다. 그들은 매우 가까운 (네트워크 : 연결된) 지점 사이의 관계를 명확히하기 위해 데이터를 확장하지만, 더 먼 (네트워크 : 연결되지 않은) 지점 사이의 거리는 플롯의 다른 영역에서 동일한 척도에있는 것으로 해석 될 수 없습니다. 특히이 거리는 지역 포인트 밀도에 따라 다릅니다.에스. 다음은 셀 데이터에서 T-SNE의 출력 예입니다.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a aria-hidden="true" href="#cb90-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rtsne"</span>))</span>
<span id="cb90-2"><a aria-hidden="true" href="#cb90-2" tabindex="-1"></a>RESTNE<span class="ot">=</span> <span class="fu">rtsne</span>(Blom,<span class="at">희미한 =</span> <span class="dv">2</span>,,,<span class="at">당황 =</span> <span class="dv">30</span>,,,<span class="at">verbose =</span> <span class="cn">거짓</span>,,,</span>
<span id="cb90-3"><a aria-hidden="true" href="#cb90-3" tabindex="-1"></a>                <span class="at">max_iter =</span> <span class="dv">900</span>))</span>
<span id="cb90-4"><a aria-hidden="true" href="#cb90-4" tabindex="-1"></a>dftsne<span class="ot">=</span>RESTNE<span class="sc">$</span>와이[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="sc">|&gt;</span></span>
<span id="cb90-5"><a aria-hidden="true" href="#cb90-5" tabindex="-1"></a>         <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="fu">페이스트0</span>(<span class="st">"중심선"</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))<span class="sc">|&gt;</span></span>
<span id="cb90-6"><a aria-hidden="true" href="#cb90-6" tabindex="-1"></a>         <span class="fu">as_tibble</span>()</span>
<span id="cb90-7"><a aria-hidden="true" href="#cb90-7" tabindex="-1"></a><span class="fu">ggplot</span>(dftsne,<span class="fu">AES</span>(<span class="at">x =</span>axis1,<span class="at">y =</span>axis2,<span class="at">색상 =</span>셀)<span class="sc">+</span></span>
<span id="cb90-8"><a aria-hidden="true" href="#cb90-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>셀),<span class="at">알파 =</span> <span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb90-9"><a aria-hidden="true" href="#cb90-9" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">값 =</span>콜스)<span class="sc">+</span> <span class="fu">가이드</span>(<span class="at">색상 =</span> <span class="st">"없음"</span>))</span>
<span id="cb90-10"><a aria-hidden="true" href="#cb90-10" tabindex="-1"></a>restsne3<span class="ot">=</span> <span class="fu">rtsne</span>(Blom,<span class="at">희미한 =</span> <span class="dv">3</span>,,,<span class="at">당황 =</span> <span class="dv">30</span>,,,<span class="at">verbose =</span> <span class="cn">거짓</span>,,,</span>
<span id="cb90-11"><a aria-hidden="true" href="#cb90-11" tabindex="-1"></a>                 <span class="at">max_iter =</span> <span class="dv">900</span>))</span>
<span id="cb90-12"><a aria-hidden="true" href="#cb90-12" tabindex="-1"></a>DFTSNE3<span class="ot">=</span>restsne3<span class="sc">$</span>와이[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]]<span class="sc">|&gt;</span></span>
<span id="cb90-13"><a aria-hidden="true" href="#cb90-13" tabindex="-1"></a>          <span class="st">`</span><span class="at">colnames &lt;-</span><span class="st">`</span>(<span class="fu">페이스트0</span>(<span class="st">"중심선"</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)))<span class="sc">|&gt;</span> </span>
<span id="cb90-14"><a aria-hidden="true" href="#cb90-14" tabindex="-1"></a>          <span class="fu">as_tibble</span>()</span>
<span id="cb90-15"><a aria-hidden="true" href="#cb90-15" tabindex="-1"></a><span class="fu">ggplot</span>(dftsne3,<span class="fu">AES</span>(<span class="at">x =</span>axis3,<span class="at">y =</span>axis2,<span class="at">그룹 =</span>셀)<span class="sc">+</span></span>
<span id="cb90-16"><a aria-hidden="true" href="#cb90-16" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>셀),<span class="at">알파 =</span> <span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb90-17"><a aria-hidden="true" href="#cb90-17" tabindex="-1"></a>      <span class="fu">scale_colour_manual</span>(<span class="at">값 =</span>콜스)<span class="sc">+</span> <span class="fu">가이드</span>(<span class="at">색상 =</span> <span class="st">"없음"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-tsnecells">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tsnecells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tsnecells" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-tsnecells-1" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tsnecells-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-tsnecells" href="09-chap_files/figure-html/fig-tsnecells-1.jpeg" title="Figure 9.29 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-tsnecells" id="fig-tsnecells-1" src="09-chap_files/figure-html/fig-tsnecells-1.jpeg" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tsnecells-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tsnecells" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-tsnecells-2" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tsnecells-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-tsnecells" href="09-chap_files/figure-html/fig-tsnecells-2.jpeg" title="Figure 9.29 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-tsnecells" id="fig-tsnecells-2" src="09-chap_files/figure-html/fig-tsnecells-2.jpeg" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tsnecells-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-tsnecells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.29 : 여기에서 연구 된 4 개의 세포 집단은 3 개의 순차적 상태 (PS, NP, HF)와 2 개의 가능한 최종 분기 (4SG 및 4SFG를 나타냅니다.<span class="math inline">\ (^{-} \)</span>). 왼쪽의 플롯은 30의 당황에서 t-sne에 대해 2 차원을 선택하여 얻어졌습니다. 하부 플롯은 3 차원을 선택하여 얻어졌으며,이 세 번째 t-SNE 축이 여기서 수평 축으로 표시됨을 알 수 있습니다.</figcaption>
</figure>
</div>
</div>
<p>이 경우 MDS와 T-SNE의 미묘한 차이를보기 위해서는 실제로 3D 플롯을 사용해야합니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>사용하십시오<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>패키지 3 개의 t-sne 치수를보고 디스플레이에 올바른 셀 유형 색상을 추가하십시오.</p>
</div>
</div>
<p>이 3D 스냅 샷 중 두 개가 표시됩니다<a class="quarto-xref" href="#fig-tsne3d">수치<span>9.30</span></a>, 우리는 MDS 플롯보다 보라색 점의 훨씬 더 강력한 그룹을 볼 수 있습니다.</p>
<p><strong>메모:</strong>복잡성에 대한 t-sne 방법의 민감도에 대해 더 감사하기 위해 방문 할 가치가있는 사이트<span class="math inline">\ (\ sigma \)</span>매개 변수는 찾을 수 있습니다<a class="uri" href="http://distill.pub/2016/misread-tsne">http://distill.pub/2016/misread-tsne</a>.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-tsne3d">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tsne3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tsne3d" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-tsne3d-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tsne3d-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-tsne3d" href="imgs/tsnemoignard3scrop.png" title="Figure 9.30 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-tsne3d" id="fig-tsne3d-1" src="imgs/tsnemoignard3scrop.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tsne3d-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tsne3d" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-tsne3d-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tsne3d-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-tsne3d" href="imgs/tsnemoignard3crop.png" title="Figure 9.30 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-tsne3d" id="fig-tsne3d-2" src="imgs/tsnemoignard3crop.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tsne3d-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-tsne3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.30 : 셀 유형에 따라 채색 된 Moignard Cell 데이터 (파란색 : PS, 녹색 : NP : HF, HF, Red : Purple : 4SFG<span class="math inline">\ (^-\)</span>) 3 차원 T-SNE 레이아웃에서. 우리는 자주색 세포 (4SFG<span class="math inline">\ (^-\)</span>) 포인트 구름 상단의 외부 쉘을 분리하십시오.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-ukrainetsne">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.18</div>
</div>
<div class="callout-body-container callout-body">
<p>우크라이나 거리의 2 차원 T-SNE 임베딩을 시각화<a class="quarto-xref" href="#sec-hetero-multidimensionalscalingandordination"><span>섹션 9.2</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-31-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-31-contents callout-collapse collapse" id="callout-31">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a aria-hidden="true" href="#cb91-1" tabindex="-1"></a>우크라이나 _tsne<span class="ot">=</span> <span class="fu">rtsne</span>(우크라이나 _dists,<span class="at">is_distance =</span> <span class="cn">진실</span>,,,<span class="at">당황 =</span> <span class="dv">8</span>))</span>
<span id="cb91-2"><a aria-hidden="true" href="#cb91-2" tabindex="-1"></a>우크라이나 _TSNE_DF<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb91-3"><a aria-hidden="true" href="#cb91-3" tabindex="-1"></a>  <span class="at">PCO1 =</span>우크라이나 _tsne<span class="sc">$</span>와이[,<span class="dv">1</span>],,</span>
<span id="cb91-4"><a aria-hidden="true" href="#cb91-4" tabindex="-1"></a>  <span class="at">pco2 =</span>우크라이나 _tsne<span class="sc">$</span>와이[,<span class="dv">2</span>],,</span>
<span id="cb91-5"><a aria-hidden="true" href="#cb91-5" tabindex="-1"></a>  <span class="at">실험실 =</span> <span class="fu">att</span>(우크라이나 _dists,<span class="st">"라벨"</span>))</span>
<span id="cb91-6"><a aria-hidden="true" href="#cb91-6" tabindex="-1"></a>))</span>
<span id="cb91-7"><a aria-hidden="true" href="#cb91-7" tabindex="-1"></a><span class="fu">ggplot</span>(우크라이나 _tsne_df,<span class="fu">AES</span>(<span class="at">x =</span>PCO1,<span class="at">y =</span>PCO2,<span class="at">레이블 =</span>실험실))<span class="sc">+</span></span>
<span id="cb91-8"><a aria-hidden="true" href="#cb91-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>(<span class="at">col =</span> <span class="st">"#0057B7"</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>() </span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ukrainetsne">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ukrainetsne-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-47" href="09-chap_files/figure-html/fig-ukrainetsne-1.png" title="Figure 9.31: t-SNE map based of Ukraine."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ukrainetsne-1.png" style="width:70.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ukrainetsne-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.31 : 우크라이나를 기반으로 한 T-SNE 맵.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>비선형 궤적을 추정하고 관련 상태 공간에 포인트를 추정하기위한 몇 가지 다른 비선형 방법이 있습니다. 다음은 몇 가지 예입니다.</p>
<p><strong><a href="https://cran.r-project.org/web/packages/RDRToolbox/">rdrtoolbox</a></strong>로컬 선형 임베딩 (<strong>lle</strong>) 그리고<strong>ISOMAP</strong></p>
<p><strong><a href="https://cran.r-project.org/web/packages/diffusionMap/">확산 맵</a></strong>이 패키지는 Markovian 커널로서 포인트 간의 연결을 모델링합니다.</p>
<p><strong><a href="https://cran.r-project.org/web/packages/kernlab/">kernlab</a></strong>커널 방법</p>
<p><strong><a href="https://cran.r-project.org/web/packages/LPCM-package/">LPCM-Package</a></strong>지역 주요 곡선</p>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="9.6" id="multitable-techniques">
<h2 class="anchored" data-anchor-id="multitable-techniques" data-number="9.6"><span class="header-section-number">9.6</span>다중 기술</h2>
<p>현재의 연구는 종종 다른 실험 조건에서 미생물, 게놈 및 대사 측정의 변화를 정량화하려고 시도합니다. 결과적으로, 동일한 생물학적 샘플에서 다중 분석을 수행하고 예를 들어 미생물, 유전자 또는 대사 산물과 같은 특징이 다른 샘플 조건과 관련이 있는지 물어 보는 것이 일반적입니다. 이러한 질문에 접근하는 방법에는 여러 가지가 있습니다. 적용되는 것은 연구의 초점에 따라 다릅니다.</p>
<section class="level3 page-columns page-full" data-number="9.6.1" id="co-variation-inertia-co-inertia-and-the-rv-coefficient">
<h3 class="anchored" data-anchor-id="co-variation-inertia-co-inertia-and-the-rv-coefficient" data-number="9.6.1"><span class="header-section-number">9.6.1</span>공동 변성, 관성, 공동 소개 및 RV 계수</h3>
<div class="page-columns page-full"><p>물리학과 마찬가지로 관성을 '가중치'지점의 거리의 합으로 정의합니다. 이것은 우리가 관찰 된 주파수와 예상 주파수 사이의 거리 정사각형 (Chisquare 통계에서와 같이)의 가중치 합계로서 우발 사태 테이블에서 수의 관성을 계산할 수있게한다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">분산 초기의 또 다른 일반화는 유용한 계통 발생 학적 다양성 지수입니다. (나무를 통해 분류의 하위 집합 사이의 거리의 합계를 계산). 다른 유용한 일반화로는 표준 공간 통계에서 가져온 그래프에서 점의 변동성을 사용하는 것이 포함됩니다.</span></div></div>
<p>동일한 10 개 위치에서 측정 한 두 가지 표준화 된 변수를 연구하려면<strong>공분산</strong>. 만약에<span class="math inline">\(엑스\)</span>표준화 된 pH를 나타냅니다<span class="math inline">\(와이\)</span>표준화 된 습도는 평균을 사용하여 공변량을 측정합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-npkuhvloxdzr" id="eq-npkuhvloxdzr"><span class="math display">\ [
\ text {cov} (x, y) = \ text {mean} (x1*y1 + x2*y2 + x3*y3 + \ cdots + x10*y10).
\ tag {9.2} \]</span></span></p>
<p>만약에<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>같은 방향으로 바리가 커질 것입니다. 우리는 우리가 정의한 상관 계수가 얼마나 유용한 지 보았습니다.<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>다변량 분석에있었습니다. 다중 유물 일반화도 유용 할 것입니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="9.6.2" id="mantel-coefficient-and-a-test-of-distance-correlation">
<h3 class="anchored" data-anchor-id="mantel-coefficient-and-a-test-of-distance-correlation" data-number="9.6.2"><span class="header-section-number">9.6.2</span>벽난로 계수 및 거리 상관 테스트</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-48" href="imgs/devil.png" title="There are some precautions to be taken when using the Mantel coefficient, see a critical review in @Guillot:2013."><img alt="There are some precautions to be taken when using the Mantel coefficient, see a critical review in Guillot and Rousset (2013)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>벽난로 계수를 사용할 때 취해야 할 몇 가지 예방 조치가 있습니다. 비판적 검토를 참조하십시오.<span class="citation" data-cites="Guillot:2013">단 길로 및 루스 세트 (<a href="16-chap.html#ref-Guillot:2013" role="doc-biblioref">2013</a>))</span>.</figcaption>
</figure>
</div>
</div></div></div>
<p>최초의 협회 측정 버전 중 하나 인 Mantel Coefficient는 아마도 현재 생태학에서 가장 인기가있을 것입니다.<span class="citation" data-cites="Josse:2016">(<a href="16-chap.html#ref-Josse:2016" role="doc-biblioref">Josse and Holmes 2016</a>))</span>. 두 가지 비 유사성 행렬이 주어졌습니다<span class="math inline">\ (d^x \)</span>그리고<span class="math inline">\ (d^y \)</span>관련<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>,이 매트릭스를 R의 방식대로 벡터로 만듭니다.<code>dist</code>함수는 선형 상관 관계를 계산합니다. 예를 들어 프로토 타입 응용 프로그램은 계산하는 것입니다<span class="math inline">\ (d^x \)</span>17 개의 다른 위치의 토양 화학에서<span class="math inline">\ (d^y \)</span>동일한 17 위치 사이의 Jaccard 지수에 의해 측정 된 식물 발생의 비 유사성을 나타냅니다. 벽난로 계수는 수학적으로 다음과 같이 정의됩니다.</p>
<p><span class="math display">\ [
r_m (x, y) = \ frac {
   \ sum_ {i \ neq J}
    \ left (d_ {ij}^x - \ bar {d}^x \ right)
    \ left (d_ {ij}^y - \ bar {d}^y \ right)
   }
   {
   \ sqrt {
     \ left (\ sum_ {i \ neq j} \ left (d_ {ij}^x - \ bar {d}^x \ right)^2 \ right)
     \ left (\ sum_ {i \ neq j} \ left (d_ {ij}^y - \ bar {d}^y \ right)^2 \ right)
   }
},
\]</span></p>
<p>~와 함께<span class="math inline">\ (\ bar {d}^x \)</span>(resp.<span class="math inline">\ (\ bar {d}^y \)</span>) 이와 관련된 비 유사성 매트릭스의 상부 대각선 요소의 평균<span class="math inline">\ (d^x \)</span>(resp. to<span class="math inline">\ (d^y \)</span>). Mantel 계수와 RV 또는 DCOV와 같은 다른 계수의 주요 차이점은 이중 센터링이 없다는 것입니다. 거리 매트릭스 내의 의존성으로 인해 Mantel 상관 관계의 무효 분포와 통계적 유의성은 단순히 일반 상관 CCoefficients에 대해 평가할 수 없습니다. 대신, 일반적으로 순열 테스트를 통해 평가됩니다. 보다<span class="citation" data-cites="Josse:2016">요스와 홈즈 (<a href="16-chap.html#ref-Josse:2016" role="doc-biblioref">2016</a>))</span>역사적 배경과 현대 화신에 대한 검토. 계수 및 관련 테스트는 다음과 같은 여러 R 패키지로 구현됩니다.<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong> <span class="citation" data-cites="ade4">(<a href="16-chap.html#ref-ade4" role="doc-biblioref">Chessel, Dufour 및 Thioulouse 2004</a>))</span>,,,<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/ecodist/">에코 디스트</a></strong> <span class="citation" data-cites="Goslee:2007">(<a href="16-chap.html#ref-Goslee:2007" role="doc-biblioref">Goslee, Urban, et al. 2007</a>))</span>.</p>
</section>
<section class="level3" data-number="9.6.3" id="the-rv-coefficient">
<h3 class="anchored" data-anchor-id="the-rv-coefficient" data-number="9.6.3"><span class="header-section-number">9.6.3</span>RV 계수</h3>
<p>두 개의 벡터가 아닌 두 개의 데이터 테이블의 유사성 측정은 RV 계수를 제공하는 테이블 사이의 내부 제품에 의해 제공되는 공분산의 일반화에 의해 수행 될 수 있습니다.</p>
<p><span class="math display">\ [
rv (a, b) = \ frac {tr (a'bab ')} {\ sqrt {tr (a'a)} \ sqrt {tr (b'b)}}
\]</span></p>
<p>패키지에는 사용할 수있는 여러 가지 매트릭스 상관 측정이 있습니다.<strong><a href="https://cran.r-project.org/web/packages/MatrixCorrelation/">매트릭스 상관</a></strong>.</p>
<p>두 행렬 사이의 링크를 확인하는 경우 해당 링크를 이해하는 방법을 찾아야합니다. 그러한 방법 중 하나는 다음 섹션에 설명되어 있습니다.</p>
</section>
<section class="level3" data-number="9.6.4" id="canonical-correlation-analysis-cca">
<h3 class="anchored" data-anchor-id="canonical-correlation-analysis-cca" data-number="9.6.4"><span class="header-section-number">9.6.4</span>표준 상관 분석 (CCA)</h3>
<p>CCA<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>. 목표는 제 2 변수 세트의 선형 투영과 최대로 상관되는 첫 번째 변수 세트의 선형 투영을 찾는 것입니다.</p>
<p>표현 별 세부 사항 (노이즈)을 폐기함으로써 동일한 현상의 두 관점에서 상관 관계 (공변량)를 찾는 것은 상관 관계를 담당하는 기본 숨겨져 있지만 영향력있는 요소를 드러 낼 것으로 예상됩니다.</p>
<p>두 가지 행렬을 고려해 봅시다.</p>
<ul>
<li>그만큼<span class="math inline">\ (n \ times p \)</span>행렬<span class="math inline">\(엑스\)</span>, 그리고</li>
<li>그만큼<span class="math inline">\ (n \ times p \)</span>행렬<span class="math inline">\(와이\)</span>.</li>
</ul>
<p>그만큼<span class="math inline">\(피\)</span>의 열<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(큐\)</span>의 열<span class="math inline">\(와이\)</span>변수에 해당하고 행은 동일합니다.<span class="math inline">\(N\)</span>실험 단위. 우리는<span class="math inline">\ (J \)</span>-매트릭스의 열<span class="math inline">\(엑스\)</span>~에 의해<span class="math inline">\ (x_j \)</span>마찬가지로<span class="math inline">\(케이\)</span>-TH 열<span class="math inline">\(와이\)</span>~에 의해<span class="math inline">\ (y_k \)</span>. 일반성의 상실없이<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>표준화됩니다 (평균 0 및 분산 1).</p>
<!--  .... does not seem necessary: ........
We denote by $S_{XX}$ and $S_{YY}$ the sample covariance matrices for variable sets $X$ and $Y$ respectively, and by $S_{XY} = S_{YX}^t$ the sample cross-covariance matrix between $X$ and $Y$ .
-->
<p>고전적인 CCA는 그것을 가정합니다<span class="math inline">\ (p \ leq n \)</span>그리고<span class="math inline">\ (q \ leq n \)</span>그리고 매트릭스<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>전체 열 순위입니다<span class="math inline">\(피\)</span>그리고<span class="math inline">\(큐\)</span>각기. 다음에서 CCA는 반복 알고리즘을 통해 해결 된 문제로 제시됩니다. CCA의 첫 번째 단계는 두 벡터를 찾는 것으로 구성됩니다.<span class="math inline">\ (a = (a_1, ..., a_p)^t \)</span>그리고<span class="math inline">\ (b = (b_1, ..., b_q)^t \)</span>선형 조합 사이의 상관 관계를 최대화합니다<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>정의</p>
<p><span class="math display">\ [
\ begin {aligned}
u = xa &amp; = &amp; a_1 x_1 +a_2 x_2 +\ cdots a_p x_p \\
v = yb &amp; = &amp; b_1 y_1 +b_2 y_2 +\ cdots a_q y_q
\ end {aligned}
\]</span></p>
<p>그리고 벡터를 가정합니다<span class="math inline">\(에이\)</span>그리고<span class="math inline">\(비\)</span>정규화되어 있습니다<span class="math inline">\ (\ text {was} (u) = \ text {way} (v) = 1 \)</span>. 다시 말해, 문제는 찾기로 구성됩니다<span class="math inline">\(에이\)</span>그리고<span class="math inline">\(비\)</span>그렇게</p>
<p><span class="anchored-eq" data-anchor-id="eq-hwdsxrvnmzkg" id="eq-hwdsxrvnmzkg"><span class="math display">\ [
\ rho_1 = \ text {cor} (u, v) = \ max_ {a, b} \ text {cor} (xa, yb) \ quad
\ text {대상} \ quad \ text {var} (xa) = \ text {var} (yb) = 1.
\ tag {9.3} \]</span></span></p>
<p>결과 변수<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>최초의 표준 변형이라고합니다<span class="math inline">\ (\ rho_1 \)</span>최초의 표준 상관 관계라고합니다.</p>
<p><strong>메모:</strong>고차 표준 변동과 표준 상관 관계는 단계적 문제로 발견 될 수 있습니다. 을 위한<span class="math inline">\ (s = 1, ..., p \)</span>, 우리는 긍정적 인 상관 관계를 연속적으로 찾을 수 있습니다<span class="math inline">\ (\ rho_1 \ geq \ rho_2 \ geq ... \ geq \ rho_p \)</span>해당 벡터로<span class="math inline">\ ((a^1, b^1), ..., (a^p, b^p) \)</span>최대화함으로써</p>
<p><span class="anchored-eq" data-anchor-id="eq-kgarhpstjydq" id="eq-kgarhpstjydq"><span class="math display">\ [
\ rho_s = \ text {cor} (u^s, v^s) = \ max_ {a^s, b^s} \ text {cor} (xa^s, yb^s) \ quad
\ text {대상} \ quad \ text {var} (xa^s) = \ text {var} (yb^s) = 1
\ tag {9.4} \]</span></span></p>
<p>추가 제한에 따라</p>
<p><span class="anchored-eq" data-anchor-id="eq-fvtikozmsagl" id="eq-fvtikozmsagl"><span class="math display">\ [
\ text {cor} (u^s, u^t) = \ text {cor} (v^s, v^t) = 0 \ quad \ text {for} \ quad
1 \ leq t &lt;s \ leq p.
\ tag {9.5} \]</span></span></p>
<p>우리는 CCA를 PCA의 일반화로 생각할 수 있으며, 우리가 최대화하는 차이는 두 행렬 사이의 '공분산'입니다 (<span class="citation" data-cites="frenchway">홈즈 (Holmes) (<a href="16-chap.html#ref-frenchway" role="doc-biblioref">2006</a>))</span>자세한 내용은).</p>
</section>
<section class="level3 page-columns page-full" data-number="9.6.5" id="sparse-canonical-correlation-analysis-scca">
<h3 class="anchored" data-anchor-id="sparse-canonical-correlation-analysis-scca" data-number="9.6.5"><span class="header-section-number">9.6.5</span>희소 한 표준 상관 분석 (SCCA)</h3>
<p>각 테이블의 변수 수가 매우 큰 경우 두 개의 매우 상관 관계가있는 벡터가 너무 쉽고 불안정 할 수 있습니다. 우리는 너무 많은 자유도를 가지고 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-49" href="imgs/devil.png" title="We will see many examples of regularization and danger of overfitting in sec-supervised."><img alt="We will see many examples of regularization and danger of overfitting in sec-supervised." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>우리는 정규화와 과적에 적합한 위험의 많은 예를 볼 것입니다.<a class="quarto-xref" href="12-chap.html"><span>12 장</span></a>.</figcaption>
</figure>
</div>
</div></div></div>
<p>그런 다음 페널티를 추가하는 것이 유리합니다. 0이 아닌 계수 수를 최소로 유지하는 것이 좋습니다. 이 접근법은 샘플 간의 탐색 적 비교와 흥미로운 특징의 식별에 적합한 방법 인 Sparse Canonical Correlation Analysis (Sparse CCA 또는 SCCA)라고합니다.<strong>공동</strong>변화. 우리는에서 구현을 사용할 것입니다<strong><a href="https://cran.r-project.org/web/packages/PMA/">PMA</a></strong>패키지.</p>
<p>여기서 우리는 수집 한 데이터 세트를 연구합니다<span class="citation" data-cites="Kashyap:2013">Kashyap et al. (<a href="16-chap.html#ref-Kashyap:2013" role="doc-biblioref">2013</a>))</span>두 테이블로. 하나는 박테리아 풍부의 비상 테이블이고 다른 하나는 대사 산물의 풍부 테이블입니다. 12 개의 샘플이 있습니다<span class="math inline">\ (n = 12 \)</span>. 대사 산물 테이블은 측정됩니다<span class="math inline">\ (p = 637 \)</span>기능과 박테리아 풍부는 총 $ q = 20,609 $ otus를 가졌으며, 이는 약 200로 감소 할 것입니다. 우리는 데이터를로드하여 시작합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a aria-hidden="true" href="#cb92-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Genefilter"</span>))</span>
<span id="cb92-2"><a aria-hidden="true" href="#cb92-2" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/microbe.rda"</span>))</span>
<span id="cb92-3"><a aria-hidden="true" href="#cb92-3" tabindex="-1"></a>대사<span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../data/metabolites.csv"</span>,,,<span class="at">row.names =</span> <span class="dv">1</span>))<span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 먼저 많은 샘플에서 0 인 것을 제거하고 큰 값에 50의 상위 임계 값을 제공하는 박테리아와 관심있는 대사 산물로 걸러냅니다. 우리는 무거운 꼬리를 약화시키기 위해 데이터를 변환합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a aria-hidden="true" href="#cb93-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Phyloseq"</span>))</span>
<span id="cb93-2"><a aria-hidden="true" href="#cb93-2" tabindex="-1"></a>대사<span class="ot">=</span>대체 [<span class="fu">로우 섬</span>(대사<span class="sc">==</span> <span class="dv">0</span>))<span class="sc">&lt;=</span> <span class="dv">3</span>,]</span>
<span id="cb93-3"><a aria-hidden="true" href="#cb93-3" tabindex="-1"></a>미생물<span class="ot">=</span> <span class="fu">plum_taxa</span>(<span class="fu">taxa_sums</span>(미생물)<span class="sc">&gt;</span> <span class="dv">4</span>, 미생물)</span>
<span id="cb93-4"><a aria-hidden="true" href="#cb93-4" tabindex="-1"></a>미생물<span class="ot">=</span> <span class="fu">filter_taxa</span>(미생물,<span class="fu">필터 펀</span>(<span class="fu">커버</span>(<span class="dv">3</span>,,,<span class="dv">2</span>)), <span class="cn">진실</span>))</span>
<span id="cb93-5"><a aria-hidden="true" href="#cb93-5" tabindex="-1"></a>대사<span class="ot">=</span> <span class="fu">통나무</span>(<span class="dv">1</span> <span class="sc">+</span>탑재<span class="at">베이스 =</span> <span class="dv">10</span>))</span>
<span id="cb93-6"><a aria-hidden="true" href="#cb93-6" tabindex="-1"></a>엑스<span class="ot">=</span> <span class="fu">통나무</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">as.matrix</span>(<span class="fu">One_table</span>(미생물)),<span class="at">베이스 =</span> <span class="dv">10</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>예비 분석의 두 번째 단계는<code>Rv.Test</code>에서<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>패키지:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a aria-hidden="true" href="#cb94-1" tabindex="-1"></a><span class="fu">colnames</span>(대사)<span class="ot">=</span> <span class="fu">colnames</span>(엑스)</span>
<span id="cb94-2"><a aria-hidden="true" href="#cb94-2" tabindex="-1"></a>PCA1<span class="ot">=</span> <span class="fu">dudi.pca</span>(<span class="fu">티</span>(대사),<span class="at">scal =</span> <span class="cn">진실</span>,,,<span class="at">필름 =</span> <span class="cn">거짓</span>))</span>
<span id="cb94-3"><a aria-hidden="true" href="#cb94-3" tabindex="-1"></a>PCA2<span class="ot">=</span> <span class="fu">dudi.pca</span>(<span class="fu">티</span>(엑스),<span class="at">scal =</span> <span class="cn">진실</span>,,,<span class="at">필름 =</span> <span class="cn">거짓</span>))</span>
<span id="cb94-4"><a aria-hidden="true" href="#cb94-4" tabindex="-1"></a>RV1<span class="ot">=</span> <span class="fu">Rv.rtest</span>(PCA1<span class="sc">$</span>탭, PCA2<span class="sc">$</span>꼬리표,<span class="dv">999</span>))</span>
<span id="cb94-5"><a aria-hidden="true" href="#cb94-5" tabindex="-1"></a>RV1</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Monte-Carlo 테스트
전화 : RV.RTEST (DF1 = PCA1 $ 탭, DF2 = PCA2 $ 탭, NREPET = 999)

관찰 : 0.8400429 

999 복제를 기반으로합니다
시뮬레이션 된 p- 값 : 0.002 
대안 가설 : 더 큰 

    std.obs 기대 분산 
6.231661953 0.314166070 0.007121318</code></pre>
</div>
</div>
<p>이제 드문 CCA를 적용 할 수 있습니다. 이 방법은 샘플보다 더 많은 측정 기능이있을 수있는 고차원 데이터 테이블의 기능 세트를 비교합니다. 이 과정에서 가장 공분산을 캡처하는 사용 가능한 기능 중 일부를 선택합니다.이 기능은 여러 테이블에 존재하는 신호를 반영하는 기능입니다. 그런 다음이 선택한 기능의 서브 세트에 PCA를 적용합니다. 이런 의미에서, 우리는 Sparse CCA를 안수 방법보다는 스크리닝 절차로 사용합니다.</p>
<p>구현은 다음과 같습니다. 매개 변수<code>페널티 X</code>그리고<code>페널티 츠</code>희소성 처벌입니다. 작은 값<code>페널티 X</code>유사하게 선택된 미생물이 줄어 듭니다<code>페널티 츠</code>선택된 대사 산물의 수를 조절합니다. 후속 해석을 용이하게하기 위해 수동으로 조정합니다. 일반적으로 기본 매개 변수가 제공하는 것보다 더 많은 희소성을 선호합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a aria-hidden="true" href="#cb96-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"PMA"</span>))</span>
<span id="cb96-2"><a aria-hidden="true" href="#cb96-2" tabindex="-1"></a>ccares<span class="ot">=</span> <span class="fu">CCA</span>(<span class="fu">티</span>(엑스),<span class="fu">티</span>(대사),<span class="at">penalttx =</span> <span class="fl">0.15</span>,,,<span class="at">penalttz =</span> <span class="fl">0.15</span>,,,</span>
<span id="cb96-3"><a aria-hidden="true" href="#cb96-3" tabindex="-1"></a>             <span class="at">typex =</span> <span class="st">"기준"</span>,,,<span class="at">typez =</span> <span class="st">"기준"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>123456789</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a aria-hidden="true" href="#cb98-1" tabindex="-1"></a>ccares</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>전화 : CCA (x = t (x), z = t (metab), typex = "Standard", typez = "Standard", 
    penaltyx = 0.15, penaltyz = 0.15)


Num nonzeros u : 5 
NUM 비제르 V : 16 
X 유형 : 표준 
Z 유형 : 표준 
X : L1 바운드에 대한 페널티는 0.15입니다 
Z : L1 바운드에 대한 페널티는 0.15입니다 
COR (XU, ZV) : 0.9904707</code></pre>
</div>
</div>
<p>이 파라미터를 사용하면 테이블 사이의 공변량을 설명하는 능력에 따라 5 개의 박테리아와 16 개의 대사 산물이 선택되었습니다. 또한, 이러한 특징은 두 테이블 사이에서 0.99의 상관 관계를 초래합니다. 우리는 이것을 미생물 및 대사 데이터가 유사한 기본 신호를 반영하고 이러한 신호가 선택된 특징에 의해 근사화 될 수 있음을 의미한다고 해석합니다. 그러나 점수는 일반적인 이변 량 정상 클라우드와는 거리가 멀기 때문에 상관 관계 값에주의하십시오. 또한 다른 기능 하위 집합이 데이터를 설명 할 수 있음을 알 수 있습니다. Sparse CCA는 기능에 대한 중복성을 최소화했지만 어떤 의미에서는 "진정한"기능임을 보장하지 않습니다.</p>
<p>그럼에도 불구하고, 우리는 여전히이 21 가지 기능을 사용하여 많은 손실없이 두 테이블의 정보를 압축 할 수 있습니다. 회수 된 대사 산물 및 OTU를 측정 한 샘플의 특성과 관련시키기 위해, 우리는이를 일반 PCA에 입력으로 사용합니다. 우리는 그림을 생성하는 데 사용한 코드를 생략했습니다.<a class="quarto-xref" href="#fig-multitableinterpretpca"><span>9.32</span></a>, 우리는 독자에게 책이나 함께 출판 된 워크 플로와 함께 온라인 자료를 참조합니다.<span class="citation" data-cites="Callahan2016Bioc">Callahan et al. (<a href="16-chap.html#ref-Callahan2016Bioc" role="doc-biblioref">2016</a>))</span>.</p>
<p><a class="quarto-xref" href="#fig-multitableinterpretpca">수치<span>9.32</span></a>PCA를 표시합니다<em>삼중 로트</em>, 여기서 우리는 다양한 유형의 샘플과 다중 도메인 특징 (대사 산물 및 OTU)을 보여줍니다. 이를 통해 측정 된 샘플 (녹아웃의 삼각형 및 야생형의 원형)을 비교할 수 있으며 텍스트 레이블이있는 다이아몬드의 영향을 특징으로합니다. 예를 들어, 데이터의 주요 변화는 PD 및 ST 샘플에 걸쳐 다른식이에 해당합니다. 또한, 15 개의 기능 중 큰 값은 ST 상태와 관련이 있고, 그 중 5 개 값은 PD 상태를 나타냅니다.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="unlabeled data points">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-multitableinterpretpca">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-multitableinterpretpca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-50" href="09-chap_files/figure-html/fig-multitableinterpretpca-1.png" title="Figure 9.32: A PCA triplot produced from the CCA selected features from muliple data types (metabolites and OTUs)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-multitableinterpretpca-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-multitableinterpretpca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.32 : Muliple Data 유형 (대사 산물 및 OTU)에서 CCA 선택된 기능에서 생성 된 PCA 삼중 플롯.</figcaption>
</figure>
</div>
</div>
</div>
<p>희소 CCA 스크리닝의 장점은 이제 명확 해졌습니다. 비교적 간단한 플롯을 사용하여 샘플의 대부분의 변형을 표시 할 수 있으며 모든 기능을 표시하는 데 필요한 수백 가지 추가 점을 플롯하지 않을 수 있습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="9.6.6" id="canonical-or-constrained-correspondence-analysis-ccpna">
<h3 class="anchored" data-anchor-id="canonical-or-constrained-correspondence-analysis-ccpna" data-number="9.6.6"><span class="header-section-number">9.6.6</span>표준 (또는 제한된) 서신 분석 (CCPNA)</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-51" href="imgs/devil.png" title="Notational overload for CCA: Originally invented by @terBraak:1985 and called Canonical Correspondence analysis, we will call this method Constrained Correspondence Analysis and abbreviate it CCpnA to avoid confusion with Canonical Correlation Analysis (CCA). However several R packages, such as ade4 and vegan use the name cca for their correspondence analyses function."><img alt="Notational overload for CCA: Originally invented by Braak (1985) and called Canonical Correspondence analysis, we will call this method Constrained Correspondence Analysis and abbreviate it CCpnA to avoid confusion with Canonical Correlation Analysis (CCA). However several R packages, such as ade4 and vegan use the name cca for their correspondence analyses function." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption><strong>CCA의 표기법 과부하</strong>: 원래 발명했습니다<span class="citation" data-cites="terBraak:1985">브라크 (Braak)<a href="16-chap.html#ref-terBraak:1985" role="doc-biblioref">1985</a>))</span>그리고 표준 통신 분석이라고 불리는 우리는이 방법을 제한된 통신 분석이라고 부르고 CCPNA와의 혼동을 피하기 위해 IT CCPNA를 축약 할 것입니다. 그러나 다음과 같은 여러 R 패키지<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>이름을 사용하십시오<code>CCA</code>해당 분석 기능.</figcaption>
</figure>
</div>
</div></div></div>
<p>제한된 통신 분석이라는 용어는이 방법이 제한된 회귀와 유사하다는 사실을 변환합니다. 이 방법은 잠재 변수가 '설명'으로 제공되는 환경 변수와 관련이 있도록 강요하려고 시도합니다.</p>
<p>CCPNA는 샘플의 위치가 종 시그니처 및 환경 특성의 유사성에 의해 결정되는 이브 플롯을 생성합니다. 대조적으로, 주요 구성 요소 분석 또는 대응 분석은 종 시그니처 만 살펴 봅니다. 보다 공식적으로, 결과 CCPNA 방향이 환경 변수의 범위에 있도록합니다. 철저한 설명은 참조하십시오<span class="citation" data-cites="terBraak:1985 greenacre2007">브라크 (Braak)<a href="16-chap.html#ref-terBraak:1985" role="doc-biblioref">1985</a>; <a href="16-chap.html#ref-greenacre2007" role="doc-biblioref">Greenacre 2007</a>))</span>.</p>
<p>이 방법은 함수를 사용하여 실행할 수 있습니다<code>ordinate</code>~에<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong>. 샘플 데이터의 공변량을 사용하기 위해 고려해야 할 기능 중 어느 것을 지정하는 추가 인수를 제공합니다.</p>
<p>여기서 우리는 우리가 사용하지 않은 데이터를 사용합니다<strong><a href="https://bioconductor.org/packages/dada2/">dada2</a></strong>~에<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>. 우리는 만들기에 대한 자세한 내용을 볼 것입니다<em>Phyloseq</em>객체에<a class="quarto-xref" href="10-chap.html"><span>10 장</span></a>. 당분간 우리는 다음을 사용합니다<code>One_table</code>다른 분류군에 대한 우발성 테이블을 포함하는 구성 요소. 연령과 가족 관계에 의한 분류 풍부를 설명하는 제한된 서신 분석을 계산하고 싶습니다 (두 변수 모두에 포함되어 있습니다.<code>Sample_Data</code>의 슬롯<code>PS1</code>물체).</p>
<p>우리는 가장 풍부한 4 개의 분류군을 사용하여 만 보여주는 2 차원 플롯을 만들고 싶습니다 (2 분포를 읽기 쉽게 만들 수 있음).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a aria-hidden="true" href="#cb100-1" tabindex="-1"></a>PS1<span class="ot">=</span><span class="fu">readrds</span>(<span class="st">"../data/ps1.rds"</span>))</span>
<span id="cb100-2"><a aria-hidden="true" href="#cb100-2" tabindex="-1"></a>PS1p<span class="ot">=</span><span class="fu">filter_taxa</span>(PS1,<span class="cf">기능</span>(엑스)<span class="fu">합집합</span>(엑스)<span class="sc">&gt;</span> <span class="dv">0</span>,,,<span class="cn">진실</span>))</span>
<span id="cb100-3"><a aria-hidden="true" href="#cb100-3" tabindex="-1"></a>PSCCPNA<span class="ot">=</span> <span class="fu">ordinate</span>(PS1P,<span class="st">"CCA"</span>,,,</span>
<span id="cb100-4"><a aria-hidden="true" href="#cb100-4" tabindex="-1"></a>                 <span class="at">공식 =</span>PS1p<span class="sc">~</span>Agebin<span class="sc">+</span>family_relationship)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>2 분포의 위치에 액세스하려면<code>점수</code>기능<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>. 또한, 그림 주석을 용이하게하기 위해, 우리는 또한 환경 데이터와 함께 현장 점수에 가입합니다.<code>Sample_Data</code>슬롯. 23 개의 총 분류 학적 명령 중에서, 우리는 가장 풍부한 네 가지에 명시 적으로 주석을달라고 말합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="unlabeled data points">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a aria-hidden="true" href="#cb101-1" tabindex="-1"></a>EvalProp<span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span>PSCCPNA<span class="sc">$</span>CCA<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="sc">/</span> <span class="fu">합집합</span>(PSCCPNA<span class="sc">$</span>CA<span class="sc">$</span>EIG)</span>
<span id="cb101-2"><a aria-hidden="true" href="#cb101-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb101-3"><a aria-hidden="true" href="#cb101-3" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">데이터 =</span>사이트,<span class="fu">AES</span>(<span class="at">x =</span>CCA2,<span class="at">y =</span>CCA1),<span class="at">모양 =</span><span class="dv">2</span>,,,<span class="at">알파 =</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb101-4"><a aria-hidden="true" href="#cb101-4" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">데이터 =</span>종,<span class="fu">AES</span>(<span class="at">x =</span>CCA2,<span class="at">y =</span>CCA1,<span class="at">col =</span>주문하다),<span class="at">크기 =</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb101-5"><a aria-hidden="true" href="#cb101-5" tabindex="-1"></a> <span class="fu">geom_text_repel</span>(<span class="at">데이터 =</span>dplyr<span class="sc">::</span><span class="fu">필터</span>(종, CCA2<span class="sc">&lt;</span> (<span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb101-6"><a aria-hidden="true" href="#cb101-6" tabindex="-1"></a>                   <span class="fu">AES</span>(<span class="at">x =</span>CCA2,<span class="at">y =</span>CCA1,<span class="at">레이블 =</span>One_id),</span>
<span id="cb101-7"><a aria-hidden="true" href="#cb101-7" tabindex="-1"></a>                   <span class="at">크기 =</span> <span class="dv">2</span>,,,<span class="at">segment.size =</span> <span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb101-8"><a aria-hidden="true" href="#cb101-8" tabindex="-1"></a> <span class="fu">facet_grid</span>(. <span class="sc">~</span>Agebin)<span class="sc">+</span></span>
<span id="cb101-9"><a aria-hidden="true" href="#cb101-9" tabindex="-1"></a> <span class="fu">가이드</span>(<span class="at">col =</span> <span class="fu">가이드 _legend</span>(<span class="at">재정의 .aes =</span> <span class="fu">목록</span>(<span class="at">크기 =</span> <span class="dv">2</span>))))<span class="sc">+</span></span>
<span id="cb101-10"><a aria-hidden="true" href="#cb101-10" tabindex="-1"></a> <span class="fu">실험실</span>(<span class="at">x =</span> <span class="fu">Sprintf</span>(<span class="st">"Axis2 [%s %% 분산]"</span>,,,<span class="fu">둥근</span>(EvalProp [<span class="dv">2</span>])),</span>
<span id="cb101-11"><a aria-hidden="true" href="#cb101-11" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">Sprintf</span>(<span class="st">"axis1 [%s %% 분산]" "</span>,,,<span class="fu">둥근</span>(EvalProp [<span class="dv">1</span>]))) <span class="sc">+</span></span>
<span id="cb101-12"><a aria-hidden="true" href="#cb101-12" tabindex="-1"></a> <span class="fu">scale_color_brewer</span>(<span class="at">팔레트 =</span> <span class="st">"set1"</span>))<span class="sc">+</span> <span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span><span class="st">"맨 아래"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ccpnaplotage">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccpnaplotage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-52" href="09-chap_files/figure-html/fig-ccpnaplotage-1.png" title="Figure 9.33: The mouse and taxa scores generated by CCpnA. The sites (mice samples) are triangles; species are circles, respectively. The separate panels indicate different age groups."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ccpnaplotage-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccpnaplotage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.33 : CCPNA에 의해 생성 된 마우스 및 분류 점수. 부위 (마우스 샘플)는 삼각형입니다. 종은 각각 원입니다. 별도의 패널은 다른 연령대를 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-hetero-ccaplotage">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 9.19</div>
</div>
<div class="callout-body-container callout-body">
<p>생성을위한 추가 코드를 찾으십시오<code>세</code>그리고<code>종</code>책과 함께 온라인 리소스의 객체. 그런 다음의 아날로그를 만듭니다<a class="quarto-xref" href="#fig-ccpnaplotage">수치<span>9.33</span></a>그러나 Faceting 변수로 쓰레기를 사용합니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-33-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-33-contents callout-collapse collapse" id="callout-33">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center" data-warning.known="unlabeled data points">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ccpnaplotlitter">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccpnaplotlitter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-53" href="09-chap_files/figure-html/fig-ccpnaplotlitter-1.png" title="Figure 9.34: The analogue to Figure fig-ccpnaplotage, faceting by litter membership rather than age bin."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ccpnaplotlitter-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccpnaplotlitter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.34 : 아날로그<a class="quarto-xref" href="#fig-ccpnaplotage">수치<span>9.33</span></a>, 나이 빈보다는 쓰레기 멤버십에 의한 바지.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>인물<a class="quarto-xref" href="#fig-ccpnaplotage"><span>9.33</span></a>그리고<a class="quarto-xref" href="#fig-ccpnaplotlitter"><span>9.34</span></a>이 주석이 달린 점수의 플롯을 보여주고, 각각 시대 빈과 쓰레기 멤버십으로 사이트를 분할하십시오. 측면이있을 때 적절한 종횡비를 유지하기 위해 수직 축을 최초의 표준 구성 요소로 가져갔습니다. 우리는 두 번째 CCPNA 방향을 따라 특이 치인 개별 박테리아를 분류했습니다.</p>
<p>분명히, 첫 번째 CCPNA 방향은 두 주요 연령 빈에서 마우스를 구별합니다. 이브 플롯의 왼쪽과 오른쪽에있는 원은 각각 젊고 오래된 생쥐의 특징 인 박테리아를 나타냅니다. 두 번째 CCPNA 방향은 가장 오래된 연령 그룹에서 소수의 마우스를 분리합니다. 또한 두 쓰레기를 부분적으로 구별합니다. 두 번째 CCPNA 방향에서 낮은 샘플은 다른 샘플보다 더 이상적 박테리아를 가지고 있습니다.</p>
<p>이 CCPNA 분석은 다른 마우스의 미생물 군집 커뮤니티 사이의 주요 차이가 연령 축을 따라 있다는 결론을 뒷받침합니다. 그러나 환경 변수의 영향이 그렇게 강하지 않은 상황에서는 CCA가 그러한 연관성을 감지하는 데 더 많은 힘을 가질 수 있습니다. 일반적으로 보충 데이터를 통합하는 것이 바람직 할 때마다 적용 할 수 있지만 (1) 감독 된 방법보다 공격적이지 않고 (2) 한 번에 여러 환경 변수를 사용할 수있는 방식으로 적용 할 수 있습니다.</p>
</section>
</section>
<section class="level2" data-number="9.7" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="9.7"><span class="header-section-number">9.7</span>이 장의 요약</h2>
<p><strong>이기종 데이터</strong>PCA에 보충 정보로 범주 형 변수를 추가하여 많은 연속 및 몇 가지 범주 형 변수의 혼합을 처리 할 수 ​​있습니다. 이것은 그룹의 모든 지점의 평균을지도에 투사하여 수행됩니다.</p>
<p><strong>거리 사용</strong>데이터 객체 간의 관계는 종종 지점 간 거리 (나무, 이미지, 그래프 또는 기타 복잡한 객체 사이의 거리)로 요약 될 수 있습니다.</p>
<p><strong>안수</strong>이러한 거리의 유용한 표현은 PCOA (Principal Coordinate Analysis)라고도하는 다차원 스케일링 (MDS)이라는 PCA와 유사한 방법을 통해 이용 가능합니다. 이러한 분석의 결과를 잠재 변수를 발견하지 못한 것으로 생각하는 것이 도움이 될 수 있습니다. 클러스터링의 경우 잠재 변수는 범주 적이며 안수에서는 시간과 같은 잠재 변수 또는 물까지의 거리와 같은 환경 구배입니다. 이것이 이러한 방법을 종종 안수라고하는 이유입니다.</p>
<p><strong>강력한 버전</strong>지점 간 거리가 크게 다를 때 사용할 수 있습니다. NMD (비금속 다차원 스케일링)는 지점 간 거리의 순서가 가능한 한 밀접하게 존중되도록 좌표를 생성하는 것을 목표로합니다.</p>
<p><strong>서신 분석</strong>: 범주 형 데이터의 종속성을 설명하는 저 차원 예측을 계산하는 방법. 그것은 PCA가 분산을 분해하는 것과 거의 같은 방식으로 큐어지 거리를 분해합니다. 서신 분석은 일반적으로 중요한 카일 쿼리 테스트에서 후속 조치를 취하는 가장 좋은 방법입니다. 다른 수준의 카테고리 사이에 상당한 의존성이 있음을 확인한 후에는이를 매핑하고 플롯과 이브 플롯을 사용 하여이 맵의 근접성을 해석 할 수 있습니다.</p>
<p><strong>거리에 대한 순열 테스트</strong>동일한 지점 사이의 두 가지 거리 세트가 주어지면 Mantel 순열 테스트를 사용하여 관련이 있는지 측정 할 수 있습니다.</p>
<p><strong>분산 및 공분산의 일반화</strong>동일한 데이터에 대해 둘 이상의 측정 매트릭스를 처리 할 때 공분산의 개념과 공동 소개의 벡터 측정과의 상관 관계를 일반화 할 수 있습니다.</p>
<p><strong>표준 상관 관계</strong>가능한 한 상관 관계가있는 각 테이블에서 변수의 선형 조합을 찾는 방법입니다. 많은 수의 변수가있는 행렬 에서이 방법을 사용할 때, 우리는 0이 아닌 계수 수를 줄이는 L1 페널티가있는 정규화 된 버전을 사용합니다.</p>
</section>
<section class="level2" data-number="9.8" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="9.8"><span class="header-section-number">9.8</span>추가 독서</h2>
<p>PCOA 맵 및 비선형 임베드의 해석은 보충 지점의 일반화를 사용하여 PCA에 대한 방식을 향상시킬 수 있습니다.<span class="citation" data-cites="Trosset2008">트로셋과 프리 베 (Priebe) (<a href="16-chap.html#ref-Trosset2008" role="doc-biblioref">2008</a>))</span>또는<span class="citation" data-cites="Bengio2004">Bengio et al. (<a href="16-chap.html#ref-Bengio2004" role="doc-biblioref">2004</a>))</span>. 우리는 봤습니다<a class="quarto-xref" href="07-chap.html"><span>7 장</span></a>하나의 범주 형 변수를 PCA에 투사하는 방법. 대응 분석 프레임 워크를 통해 실제로 여러 범주 형 변수를 여러 연속 변수와 혼합 할 수 있습니다. 이는 다중 통신 분석 (MCA)이라는 확장을 통해 수행되므로 다수의 이진 범주 형 변수에 대해 동일한 분석을 수행하고 유용한 맵을 얻을 수 있습니다. 여기서 비결은 연속 변수를 먼저 범주 형 변수로 바꾸는 것입니다. R을 사용하는 광범위한 예는 예를 들어 책을 참조하십시오.<span class="citation" data-cites="Pages:2016">농부 (농부)<a href="16-chap.html#ref-Pages:2016" role="doc-biblioref">2016</a>))</span>.</p>
<p>PCA에 대한 간단한 확장<strong>비선형</strong>고유 벡터에 의해 정의 된 주요 방향 대신 주요 곡선 추정치가 제안되었습니다.<span class="citation" data-cites="Hastie1989">Hastie와 Stuetzle (<a href="16-chap.html#ref-Hastie1989" role="doc-biblioref">1989</a>))</span>패키지에서 사용할 수 있습니다<strong><a href="https://cran.r-project.org/web/packages/princurve/">왕자</a></strong>.</p>
<p>치수보다 높은 밀도 데이터를 포함하는 곡선 구분을 찾는 것<span class="math inline">\ (1 \)</span>이제 Manifold Embedding이라고하며 Laplacian Eigenmaps를 통해 수행 할 수 있습니다.<span class="citation" data-cites="Belkin2003">(<a href="16-chap.html#ref-Belkin2003" role="doc-biblioref">인사와 20033</a>))</span>, 로컬 선형 임베딩<span class="citation" data-cites="Roweis2000">Roweis와 Saul (<a href="16-chap.html#ref-Roweis2000" role="doc-biblioref">2000</a>))</span>또는 ISOMAP 방법을 사용합니다<span class="citation" data-cites="Tenenbaum2000">(<a href="16-chap.html#ref-Tenenbaum2000" role="doc-biblioref">Tenenbaum, de Silva 및 Langford 2000</a>))</span>. 비 감독되지 않은 학습 방법을 다루는 교과서의 경우 참조하십시오<span class="citation" data-cites="HastieTibshiraniFriedman">Hastie, Tibshirani 및 Friedman (<a href="16-chap.html#ref-HastieTibshiraniFriedman" role="doc-biblioref">2008, 챕터. 14</a>))</span>또는<span class="citation" data-cites="Izenman2008">이젠 만 (Izenman)<a href="16-chap.html#ref-Izenman2008" role="doc-biblioref">2008</a>))</span>.</p>
<p>많은 다중 정보 상관 계수에 대한 검토와 응용 프로그램 분석은<span class="citation" data-cites="Josse:2016">요스와 홈즈 (<a href="16-chap.html#ref-Josse:2016" role="doc-biblioref">2016</a>))</span>.</p>
</section>
<section class="level2 page-columns page-full" data-number="9.9" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="9.9"><span class="header-section-number">9.9</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-phylochip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.1</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 Phylochip 데이터를 다시 살펴보고 원래 표현식 값을 존재/부재로 대체 할 것입니다. 우리는 최소 8 개의 샘플에서 최소 8.633의 값을 가진 데이터 만 유지하기 위해 데이터를 임계합니다.<a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a aria-hidden="true" href="#cb102-1" tabindex="-1"></a>IBD.PRES<span class="ot">=</span> <span class="fu">ifelse</span>(Assayibd [,<span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>]]<span class="sc">&gt;</span> <span class="fl">8.633</span>,,,<span class="dv">1</span>,,,<span class="dv">0</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이 바이너리 데이터에 대한 서신 분석을 수행하고 얻은 플롯을 우리가 본 것과 비교하십시오.<a class="quarto-xref" href="#fig-Threesetspca123">수치<span>9.15</span></a>.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>이 값은 이전 임계 값과 유사한 약 3,000 개의 분류군을 유지하기 위해 선택되었습니다.</p></div></div><div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-35-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-35-contents callout-collapse collapse" id="callout-35">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-Threesetscoa">수치<span>9.35</span></a>.</p>
<div class="cell" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a aria-hidden="true" href="#cb103-1" tabindex="-1"></a>IBDCA<span class="ot">=</span> <span class="fu">Dudi</span>(IBD.PRES,<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">4</span>))</span>
<span id="cb103-2"><a aria-hidden="true" href="#cb103-2" tabindex="-1"></a><span class="fu">fviz_eig</span>(IBDCA,<span class="at">geom =</span> <span class="st">"술집"</span>,,,<span class="at">bar_width =</span> <span class="fl">0.7</span>))<span class="sc">+</span></span>
<span id="cb103-3"><a aria-hidden="true" href="#cb103-3" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Chisquare의 비율"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span>
<span id="cb103-4"><a aria-hidden="true" href="#cb103-4" tabindex="-1"></a><span class="fu">fviz</span>(IBDCA,<span class="at">요소 =</span> <span class="st">"안부"</span>,,,<span class="at">축 =</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>),)<span class="at">geom =</span> <span class="st">"가리키다"</span>,,,</span>
<span id="cb103-5"><a aria-hidden="true" href="#cb103-5" tabindex="-1"></a>     <span class="at">드레싱 =</span>낮,<span class="at">팔레트 =</span> <span class="st">"Dark2"</span>,,,<span class="at">addEllipses =</span> <span class="cn">진실</span>,,,<span class="at">색상 =</span>낮,</span>
<span id="cb103-6"><a aria-hidden="true" href="#cb103-6" tabindex="-1"></a>     <span class="at">elipse.type =</span> <span class="st">"볼록한"</span>,,,<span class="at">알파 =</span> <span class="dv">1</span>,,,<span class="at">col.row.sup =</span>  <span class="st">"파란색"</span>,,,</span>
<span id="cb103-7"><a aria-hidden="true" href="#cb103-7" tabindex="-1"></a>     <span class="at">선택 =</span> <span class="fu">목록</span>(<span class="at">이름 =</span> <span class="cn">널</span>,,,<span class="at">cos2 =</span> <span class="cn">널</span>,,,<span class="at">contrib =</span> <span class="cn">널</span>),)</span>
<span id="cb103-8"><a aria-hidden="true" href="#cb103-8" tabindex="-1"></a>     <span class="at">repel =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-Threesetscoa">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Threesetscoa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-Threesetscoa" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Threesetscoa-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-Threesetscoa-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-Threesetscoa" href="09-chap_files/figure-html/fig-Threesetscoa-1.png" title="Figure 9.35 (a): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-Threesetscoa" src="09-chap_files/figure-html/fig-Threesetscoa-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-Threesetscoa-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-Threesetscoa" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Threesetscoa-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-Threesetscoa-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-Threesetscoa" href="09-chap_files/figure-html/fig-Threesetscoa-2.png" title="Figure 9.35 (b): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-Threesetscoa" src="09-chap_files/figure-html/fig-Threesetscoa-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-Threesetscoa-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Threesetscoa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.35 : 이진 데이터에 대한 통신 분석.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-ColorTable">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.2</div>
</div>
<div class="callout-body-container callout-body">
<p>컬러 연관성 테이블에 대한 서신 분석 :<br/>다음은 단어 쌍의 쿼리로 인한 Google 히트 수를 살펴보면 수집 된 데이터의 예입니다. 숫자<a class="quarto-xref" href="#tbl-colors">테이블<span>9.4</span></a>예를 들어, "조용한"과 "파란색"이라는 단어의 조합은 2,150,000 명을 히트로 곱합니다.</p>
<div class="cell" data-layout-align="center" data-tbl-cap-location="top">
<div class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center" data-tbl-cap-location="top" id="tbl-colors">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-colors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">표 9.4 : 검색 엔진 결과에서 동시 발생 항의 비상 테이블.</figcaption>
<div aria-describedby="tbl-colors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right;">검은색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">파란색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">녹색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">회색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">주황색</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">보라</th>
<th data-quarto-table-cell-role="th" style="text-align: right;">하얀색</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">조용한</td>
<td style="text-align: right;">2770</td>
<td style="text-align: right;">2150</td>
<td style="text-align: right;">2140</td>
<td style="text-align: right;">875</td>
<td style="text-align: right;">1220</td>
<td style="text-align: right;">821</td>
<td style="text-align: right;">2510</td>
</tr>
<tr class="even">
<td style="text-align: left;">화난</td>
<td style="text-align: right;">2970</td>
<td style="text-align: right;">1530</td>
<td style="text-align: right;">1740</td>
<td style="text-align: right;">752</td>
<td style="text-align: right;">1040</td>
<td style="text-align: right;">710</td>
<td style="text-align: right;">1730</td>
</tr>
<tr class="odd">
<td style="text-align: left;">영리한</td>
<td style="text-align: right;">1650</td>
<td style="text-align: right;">1270</td>
<td style="text-align: right;">1320</td>
<td style="text-align: right;">495</td>
<td style="text-align: right;">693</td>
<td style="text-align: right;">416</td>
<td style="text-align: right;">1420</td>
</tr>
<tr class="even">
<td style="text-align: left;">우울한</td>
<td style="text-align: right;">1480</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">983</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">1270</td>
</tr>
<tr class="odd">
<td style="text-align: left;">행복하다</td>
<td style="text-align: right;">19300</td>
<td style="text-align: right;">8310</td>
<td style="text-align: right;">8730</td>
<td style="text-align: right;">1920</td>
<td style="text-align: right;">4220</td>
<td style="text-align: right;">2610</td>
<td style="text-align: right;">9150</td>
</tr>
<tr class="even">
<td style="text-align: left;">기운찬</td>
<td style="text-align: right;">1840</td>
<td style="text-align: right;">1250</td>
<td style="text-align: right;">1350</td>
<td style="text-align: right;">659</td>
<td style="text-align: right;">621</td>
<td style="text-align: right;">488</td>
<td style="text-align: right;">1480</td>
</tr>
<tr class="odd">
<td style="text-align: left;">난처한</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="even">
<td style="text-align: left;">덕 있는</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">165</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>이 데이터의 서신 분석을 수행하십시오. 2 차원 이역을 볼 때 무엇을 알 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-37-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-37-contents callout-collapse collapse" id="callout-37">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-ColorBiplot-1">수치<span>9.36</span></a>. 코드는 여기에서 렌더링되지 않지만 문서의 소스 파일에 표시됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ColorBiplot-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ColorBiplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-56" href="09-chap_files/figure-html/fig-ColorBiplot-1-1.png" title="Figure 9.36: Correspondence Analysis allows for a symmetrical graphical representation of two categorical variables, in this case colors and emotions for a contingency table of co-occurrences such as Table tbl-colors."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="09-chap_files/figure-html/fig-ColorBiplot-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ColorBiplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.36 : 대응 분석은 두 가지 범주 형 변수의 대칭 그래픽 표현을 허용합니다.<a class="quarto-xref" href="#tbl-colors">테이블<span>9.4</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-57" href="imgs/PlatoTableImage.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/PlatoTableImage.png" style="width:50.0%"/></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-PlatoSentence">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.3</div>
</div>
<div class="callout-body-container callout-body">
<p>플라톤의 날짜는 그의 다양한 책을 썼다. 우리는 문장 결말을 취하고 해당 패턴 주파수를 데이터로 사용합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a aria-hidden="true" href="#cb104-1" tabindex="-1"></a>플래프<span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"../data/platof.txt"</span>,,,<span class="at">헤더 =</span> <span class="cn">진실</span>))</span>
<span id="cb104-2"><a aria-hidden="true" href="#cb104-2" tabindex="-1"></a>플라 토프 [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>담당자 법 치명타 수영장 소프 팀
Weu Point 42 31 5 24 24
-SU35 3 27 33 19 33
U-IUU 64 3 20 20 24 46
UU-UK 72 3 25 25 20 24.</code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a aria-hidden="true" href="#cb106-1" tabindex="-1"></a>나는 빛납니다<span class="ot">=</span> <span class="fu">Dudi</span>(Platof,<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">2</span>))</span>
<span id="cb106-2"><a aria-hidden="true" href="#cb106-2" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(나는 빛나고<span class="at">축 =</span><span class="fu">기음</span>(<span class="dv">2</span>,,,<span class="dv">1</span>)))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span>
<span id="cb106-3"><a aria-hidden="true" href="#cb106-3" tabindex="-1"></a><span class="fu">fviz_eig</span>(나는 빛나고<span class="at">geom =</span> <span class="st">"술집"</span>,,,<span class="at">너비 =</span> <span class="fl">0.6</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-platoca">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-platoca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
</div>
<div class="quarto-layout-row">
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-platoca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.37 : 플라톤 문장 결말의 이분기.</figcaption>
</figure>
</div>
<ol type="a">
<li><p>이브 플롯에서<a class="quarto-xref" href="#fig-platoca">수치<span>9.37</span></a>플라톤 작품의 연대순 순서를 추측 할 수 있습니까?<br/>힌트 : 첫 번째 (가장 빠른)은 알려져 있습니다<em>공화국</em>. 마지막 (최신)은 알려져 있습니다<em>법률</em>.</p></li>
<li><p>플라톤이 그의 인생 초반에 더 자주 사용했던 문장은 무엇입니까?</p></li>
<li><p>관성의 몇 퍼센트 (<span class="math inline">\ (\ chi^2 \)</span>-Distance)는지도에 의해 설명됩니다<a class="quarto-xref" href="#fig-platoca">수치<span>9.37</span></a>?</p></li>
</ol>
</div>
</div><div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell callout-margin-content" data-ref-parent="fig-platoca" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-platoca-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-platoca-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-platoca" href="09-chap_files/figure-html/fig-platoca-1.png" title="Figure 9.37 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-platoca" id="fig-platoca-1" src="09-chap_files/figure-html/fig-platoca-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-platoca-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell callout-margin-content" data-ref-parent="fig-platoca" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-platoca-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-platoca-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-platoca" href="09-chap_files/figure-html/fig-platoca-2.png" title="Figure 9.37 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-platoca" id="fig-platoca-2" src="09-chap_files/figure-html/fig-platoca-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-platoca-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-39-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-39-contents callout-collapse collapse" id="callout-39">
<div class="callout-body-container callout-body">
<p>처음 두 축으로 설명 된 관성 백분율을 계산하기 위해 값 2에서 고유 값의 누적 합을 취합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a aria-hidden="true" href="#cb107-1" tabindex="-1"></a><span class="fu">이름</span>(Slaught)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "탭" "CW" "LW" "eig" "Rank" "NF" "C1" "Li" "CO" "L1"  
[11] "전화" "N"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a aria-hidden="true" href="#cb109-1" tabindex="-1"></a><span class="fu">합집합</span>(나는 빛납니다<span class="sc">$</span>EIG)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.132618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a aria-hidden="true" href="#cb111-1" tabindex="-1"></a>백분율 유학<span class="ot">=</span><span class="fu">둥근</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">CUMSUM</span>(나는 빛납니다<span class="sc">$</span>EIG)<span class="sc">/</span><span class="fu">합집합</span>(나는 빛납니다<span class="sc">$</span>EIG))</span>
<span id="cb111-2"><a aria-hidden="true" href="#cb111-2" tabindex="-1"></a>백분율 유학</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69 85 92 96 98 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a aria-hidden="true" href="#cb113-1" tabindex="-1"></a>백분율 유학 [<span class="dv">2</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-ComparisonCA">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.4</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 두 개의 데이터 세트를 살펴볼 것입니다. 하나는 다른 데이터 세트의 혼란스러운 버전이며, 둘 다 생태 학적 데이터에서 자주 볼 수 있듯이 그라디언트를 제시합니다. 두 종 수의 매트릭스에서 읽으십시오<code>Honowance</code>그리고<code>Lakeelikeh</code>, 이는 물체로 저장됩니다<code>호수 .rdata</code>. 두 데이터 세트 각각에 대한 대응 분석 및 주요 구성 요소 분석의 출력을 비교합니다. 두 차원을 제한하십시오. 음모와 고유 값에서 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-41-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-41-contents callout-collapse collapse" id="callout-41">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a aria-hidden="true" href="#cb115-1" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/lakes.rdata"</span>))</span>
<span id="cb115-2"><a aria-hidden="true" href="#cb115-2" tabindex="-1"></a>Celk ...- 감사합니다 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Plant1 Plant2 Plant3 Plant4 Plant6 Plant7 Plant8
Loc1 6 4 0 3 0 0 0
LOC2 4 5 5 3 4 2 0 0
loc3 3 4 7 4 5 2 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a aria-hidden="true" href="#cb117-1" tabindex="-1"></a>Lakeelikeh [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Plant1 Plant2 Plant3 Plant4 Plant6 Plant7 Plant8
Loc1 6 4 0 3 0 0 0
LOC2 4 5 5 3 4 2 0 0
loc3 3 4 7 4 5 2 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a aria-hidden="true" href="#cb119-1" tabindex="-1"></a>E_COA<span class="ot">=</span> <span class="fu">Dudi</span>(레이,<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">2</span>))</span>
<span id="cb119-2"><a aria-hidden="true" href="#cb119-2" tabindex="-1"></a>E_PCA<span class="ot">=</span> <span class="fu">dudi.pca</span>(레이,<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">2</span>))</span>
<span id="cb119-3"><a aria-hidden="true" href="#cb119-3" tabindex="-1"></a>EH_COA<span class="ot">=</span> <span class="fu">Dudi</span>(Lakelikeh,<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">2</span>))</span>
<span id="cb119-4"><a aria-hidden="true" href="#cb119-4" tabindex="-1"></a>EH_PCA<span class="ot">=</span> <span class="fu">dudi.pca</span>(Lakelikeh,<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>비교 (출력은 표시되지 않음) :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a aria-hidden="true" href="#cb120-1" tabindex="-1"></a><span class="fu">소수</span>(E_PCA)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a aria-hidden="true" href="#cb121-1" tabindex="-1"></a><span class="fu">소수</span>(E_COA)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a aria-hidden="true" href="#cb122-1" tabindex="-1"></a><span class="fu">s.label</span>(E_PCA<span class="sc">$</span>리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a aria-hidden="true" href="#cb123-1" tabindex="-1"></a><span class="fu">s.label</span>(E_COA<span class="sc">$</span>리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a aria-hidden="true" href="#cb124-1" tabindex="-1"></a><span class="fu">s.label</span>(EH_PCA<span class="sc">$</span>공동)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a aria-hidden="true" href="#cb125-1" tabindex="-1"></a><span class="fu">s.label</span>(EH_PCA<span class="sc">$</span>리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a aria-hidden="true" href="#cb126-1" tabindex="-1"></a><span class="fu">s.label</span>(EH_COA<span class="sc">$</span>리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a aria-hidden="true" href="#cb127-1" tabindex="-1"></a><span class="fu">s.label</span>(EH_COA<span class="sc">$</span>공동)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-RawMoignard">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.5</div>
</div>
<div class="callout-body-container callout-body">
<p>정규화 된 Moignard 데이터를 분석했습니다<a class="quarto-xref" href="#sec-hetero-celldynamics"><span>섹션 9.5.1</span></a>. 이제 분석을 다시 실행하십시오<em>날것의</em>데이터 (파일로<em>NBT.3154-S3-Raw.CSV</em>) 그리고 정규화 된 값을 사용하여 얻은 출력과 출력을 비교하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-43-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-43-contents callout-collapse collapse" id="callout-43">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a aria-hidden="true" href="#cb128-1" tabindex="-1"></a>moignard_raw<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"../data/nbt.3154-S3-Raw.csv"</span>,,,<span class="at">row.names =</span> <span class="dv">1</span>)))</span>
<span id="cb128-2"><a aria-hidden="true" href="#cb128-2" tabindex="-1"></a>dist2r.euclid<span class="ot">=</span> <span class="fu">dist</span>(Moignard_raw)</span>
<span id="cb128-3"><a aria-hidden="true" href="#cb128-3" tabindex="-1"></a>disst1r.l1<span class="ot">=</span> <span class="fu">dist</span>(Moignard_raw,<span class="st">"맨해튼"</span>))</span>
<span id="cb128-4"><a aria-hidden="true" href="#cb128-4" tabindex="-1"></a>세포 1.cmds<span class="ot">=</span> <span class="fu">cmdscale</span>(dist1r.l1,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb128-5"><a aria-hidden="true" href="#cb128-5" tabindex="-1"></a>cells2.cmds<span class="ot">=</span> <span class="fu">cmdscale</span>(dist2r.euclid,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb128-6"><a aria-hidden="true" href="#cb128-6" tabindex="-1"></a><span class="fu">합집합</span>(cells1.cmds<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="sc">/</span> <span class="fu">합집합</span>(cells1.cmds<span class="sc">$</span>EIG)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.776075</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a aria-hidden="true" href="#cb130-1" tabindex="-1"></a><span class="fu">합집합</span>(cells2.cmds<span class="sc">$</span>eig [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="sc">/</span> <span class="fu">합집합</span>(cells2.cmds<span class="sc">$</span>EIG)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6297133</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-KernelMethods">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.6</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 커널 방법의 사용을 탐색 할 것입니다.</p>
<ol type="a">
<li><p>kernelized 거리를 사용하여<strong><a href="https://cran.r-project.org/web/packages/kernlab/">kernlab</a></strong>커널 정의에서 Sigma Tuning 매개 변수에 다양한 값을 사용하는 Moignard 데이터의 경우. 그런 다음이 커널이있는 거리에서 MD를 수행하십시오. 커널 다차원 스케일링의 처음 네 가지 구성 요소에 의해 설명 된 변동성에는 어떤 차이가 있습니까?</p></li>
<li><p>구성 요소의 대화식 3 차원 표현을 만드십시오. 자주색 지점의 분기를 볼 수있는 투영이 있습니까?</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-45-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-45-contents callout-collapse collapse" id="callout-45">
<div class="callout-body-container callout-body">
<ol type="a">
<li>커널이있는 거리</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a aria-hidden="true" href="#cb132-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"kernlab"</span>))</span>
<span id="cb132-2"><a aria-hidden="true" href="#cb132-2" tabindex="-1"></a>laplacedot1<span class="ot">=</span> <span class="fu">Laplacedot</span>(<span class="at">시그마 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3934</span>))</span>
<span id="cb132-3"><a aria-hidden="true" href="#cb132-3" tabindex="-1"></a>RBFDOT1<span class="ot">=</span> <span class="fu">RBFDOT</span>(<span class="at">시그마 =</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3934</span>))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb132-4"><a aria-hidden="true" href="#cb132-4" tabindex="-1"></a>flapping_cellsn<span class="ot">=</span> <span class="fu">kernelmatrix</span>(laplacedot1, blom)</span>
<span id="cb132-5"><a aria-hidden="true" href="#cb132-5" tabindex="-1"></a>KGAUSS_CELLSN<span class="ot">=</span> <span class="fu">kernelmatrix</span>(rbfdot1, blom)</span>
<span id="cb132-6"><a aria-hidden="true" href="#cb132-6" tabindex="-1"></a>Klaplace_Rawcells<span class="ot">=</span> <span class="fu">kernelmatrix</span>(laplacedot1, moignard_raw)</span>
<span id="cb132-7"><a aria-hidden="true" href="#cb132-7" tabindex="-1"></a>KGAUSS_RAWCELLS<span class="ot">=</span> <span class="fu">kernelmatrix</span>(RBFDOT1, MOIGNARD_RAW)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>커널 화 된 거리를 사용하여 특이 치를 방지하고 비선형 구성 요소를 발견 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a aria-hidden="true" href="#cb133-1" tabindex="-1"></a>dyst1kr<span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span>Klaplace_Rawcells</span>
<span id="cb133-2"><a aria-hidden="true" href="#cb133-2" tabindex="-1"></a>dist2kr<span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span>KGAUSS_RAWCELLS</span>
<span id="cb133-3"><a aria-hidden="true" href="#cb133-3" tabindex="-1"></a>dist1kn<span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span>flapping_cellsn</span>
<span id="cb133-4"><a aria-hidden="true" href="#cb133-4" tabindex="-1"></a>dist2kn<span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span>KGAUSS_CELLSN</span>
<span id="cb133-5"><a aria-hidden="true" href="#cb133-5" tabindex="-1"></a></span>
<span id="cb133-6"><a aria-hidden="true" href="#cb133-6" tabindex="-1"></a>세포 1.kcmds<span class="ot">=</span> <span class="fu">cmdscale</span>(dist1kr,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb133-7"><a aria-hidden="true" href="#cb133-7" tabindex="-1"></a>cells.2.kcmds<span class="ot">=</span> <span class="fu">cmdscale</span>(dist2kr,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb133-8"><a aria-hidden="true" href="#cb133-8" tabindex="-1"></a></span>
<span id="cb133-9"><a aria-hidden="true" href="#cb133-9" tabindex="-1"></a>백분율<span class="ot">=</span> <span class="cf">기능</span>(엑스,<span class="at">n =</span> <span class="dv">4</span>))<span class="fu">둥근</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">합집합</span>(엑스[<span class="fu">seq_len</span>(N)])<span class="sc">/</span> <span class="fu">합집합</span>(더블 엑스<span class="sc">&gt;</span><span class="dv">0</span>])))</span>
<span id="cb133-10"><a aria-hidden="true" href="#cb133-10" tabindex="-1"></a>StoreC1<span class="ot">=</span> <span class="fu">백분율</span>(cells1.kcmds<span class="sc">$</span>EIG)</span>
<span id="cb133-11"><a aria-hidden="true" href="#cb133-11" tabindex="-1"></a>Storec2<span class="ot">=</span> <span class="fu">백분율</span>(Cells.2.kcmds<span class="sc">$</span>EIG)</span>
<span id="cb133-12"><a aria-hidden="true" href="#cb133-12" tabindex="-1"></a></span>
<span id="cb133-13"><a aria-hidden="true" href="#cb133-13" tabindex="-1"></a>cellsn1.kcmds<span class="ot">=</span> <span class="fu">cmdscale</span>(dist1kn,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span>
<span id="cb133-14"><a aria-hidden="true" href="#cb133-14" tabindex="-1"></a>cellsn2.kcmds<span class="ot">=</span> <span class="fu">cmdscale</span>(dist2kn,<span class="at">k =</span> <span class="dv">20</span>,,,<span class="at">eig =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>대화식으로 3D ScatterPlot 사용 :</li>
</ol>
<div class="cell" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a aria-hidden="true" href="#cb134-1" tabindex="-1"></a>콜크<span class="ot">=</span> <span class="fu">RowData</span>(Moignard)<span class="sc">$</span>셀콜</span>
<span id="cb134-2"><a aria-hidden="true" href="#cb134-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"scatterplot3d"</span>))</span>
<span id="cb134-3"><a aria-hidden="true" href="#cb134-3" tabindex="-1"></a><span class="fu">ScatterPlot3d</span>(Cellsn2.kcmds<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],,<span class="at">색상 =</span>콜크,<span class="at">pch =</span> <span class="dv">20</span>,,,</span>
<span id="cb134-4"><a aria-hidden="true" href="#cb134-4" tabindex="-1"></a>   <span class="at">xlab =</span> <span class="st">"축 K1"</span>,,,<span class="at">뭉치</span> <span class="st">"축 K2"</span>,,,<span class="at">TIL</span> <span class="st">"축 K3"</span>,,,<span class="at">각도 =</span><span class="dv">15</span>))</span>
<span id="cb134-5"><a aria-hidden="true" href="#cb134-5" tabindex="-1"></a><span class="fu">ScatterPlot3d</span>(Cellsn2.kcmds<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],,<span class="at">색상 =</span>콜크,<span class="at">pch =</span> <span class="dv">20</span>,,,</span>
<span id="cb134-6"><a aria-hidden="true" href="#cb134-6" tabindex="-1"></a>   <span class="at">xlab =</span> <span class="st">"축 K1"</span>,,,<span class="at">뭉치</span> <span class="st">"축 K2"</span>,,,<span class="at">TIL</span> <span class="st">"축 K3"</span>,,,<span class="at">각도 =</span> <span class="sc">-</span><span class="dv">70</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-KernelMDSplots">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-KernelMDSplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-KernelMDSplots" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-KernelMDSplots-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-KernelMDSplots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-KernelMDSplots" href="09-chap_files/figure-html/fig-KernelMDSplots-1.png" title="Figure 9.38 (a): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-KernelMDSplots" src="09-chap_files/figure-html/fig-KernelMDSplots-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-KernelMDSplots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-KernelMDSplots" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-KernelMDSplots-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-KernelMDSplots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-KernelMDSplots" href="09-chap_files/figure-html/fig-KernelMDSplots-2.png" title="Figure 9.38 (b): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-KernelMDSplots" src="09-chap_files/figure-html/fig-KernelMDSplots-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-KernelMDSplots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-KernelMDSplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.38 : 커널 다차원 스케일링.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-celldatahigh">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.7</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>세포 데이터에 대한 고해상도 연구.</strong><br/>원래 표현식 데이터를 가져옵니다<code>블롬</code>우리는 생성했습니다<a class="quarto-xref" href="#sec-hetero-celldynamics"><span>섹션 9.5.1</span></a>. 상위 10 개의 가장 가변 유전자 각각의 발현 강도를 확산 매핑으로 만든 3D 플롯에 매핑하십시오. 어떤 차원 또는 주요 좌표 중 하나 (1,2,3,4)가<strong>4SG</strong>(빨간색)가 가장 중요합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-47-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-47-contents callout-collapse collapse" id="callout-47">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a aria-hidden="true" href="#cb135-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rgl"</span>))</span>
<span id="cb135-2"><a aria-hidden="true" href="#cb135-2" tabindex="-1"></a><span class="fu">Plot3d</span>(Cellsn2.kcmds<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],,<span class="at">col =</span>콜크,<span class="at">크기 =</span> <span class="dv">3</span>,,,</span>
<span id="cb135-3"><a aria-hidden="true" href="#cb135-3" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"axis1"</span>,,,<span class="at">뭉치</span> <span class="st">"Axis2"</span>,,,<span class="at">TIL</span> <span class="st">"axis3"</span>))</span>
<span id="cb135-4"><a aria-hidden="true" href="#cb135-4" tabindex="-1"></a><span class="fu">Plot3d</span>(Cellsn2.kcmds<span class="sc">$</span>전철기[,<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>,,,<span class="dv">4</span>)], <span class="at">col =</span>콜크,<span class="at">크기 =</span> <span class="dv">3</span>,,,</span>
<span id="cb135-5"><a aria-hidden="true" href="#cb135-5" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"axis1"</span>,,,<span class="at">뭉치</span> <span class="st">"Axis2"</span>,,,<span class="at">TIL</span> <span class="st">"Axis4"</span>))</span>
<span id="cb135-6"><a aria-hidden="true" href="#cb135-6" tabindex="-1"></a><span class="co"># 대신 L1 거리를 사용합니다.</span></span>
<span id="cb135-7"><a aria-hidden="true" href="#cb135-7" tabindex="-1"></a><span class="fu">Plot3d</span>(cellsn1.kcmds<span class="sc">$</span>전철기[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],,<span class="at">col =</span>콜크,<span class="at">크기 =</span> <span class="dv">3</span>,,,</span>
<span id="cb135-8"><a aria-hidden="true" href="#cb135-8" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"axis1"</span>,,,<span class="at">뭉치</span> <span class="st">"Axis2"</span>,,,<span class="at">TIL</span> <span class="st">"axis3"</span>))</span>
<span id="cb135-9"><a aria-hidden="true" href="#cb135-9" tabindex="-1"></a><span class="fu">Plot3d</span>(cellsn1.kcmds<span class="sc">$</span>전철기[,<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>,,,<span class="dv">4</span>)], <span class="at">col =</span>콜크,<span class="at">크기 =</span> <span class="dv">3</span>,,,</span>
<span id="cb135-10"><a aria-hidden="true" href="#cb135-10" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"axis1"</span>,,,<span class="at">뭉치</span> <span class="st">"Axis2"</span>,,,<span class="at">TIL</span> <span class="st">"Axis4"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>패키지의 구현<strong><a href="https://cran.r-project.org/web/packages/LPCM/">LPCM</a></strong>기능을 제공합니다<code>LPC</code>주요 곡선을 추정합니다. 여기서 우리는 확산 맵의 출력에서 ​​선택한 3 가지 차원으로 제한하고 매끄러운 곡선을 만듭니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a aria-hidden="true" href="#cb136-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"LPCM"</span>))</span>
<span id="cb136-2"><a aria-hidden="true" href="#cb136-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"확산 맵"</span>))</span>
<span id="cb136-3"><a aria-hidden="true" href="#cb136-3" tabindex="-1"></a>DMAP1<span class="ot">=</span> <span class="fu">퍼지다</span>(dista1n.l1,<span class="at">틸트 =</span> <span class="dv">10</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Eigendecomposition 수행
컴퓨팅 확산 좌표
경과 시간 : 5.014 초</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a aria-hidden="true" href="#cb138-1" tabindex="-1"></a>빗<span class="ot">=</span> <span class="fu">콤브</span>(<span class="dv">4</span>,,,<span class="dv">3</span>))</span>
<span id="cb138-2"><a aria-hidden="true" href="#cb138-2" tabindex="-1"></a>lpcplots<span class="ot">=</span> <span class="fu">적용하다</span>(빗,<span class="dv">2</span>,,,<span class="cf">기능</span>(J)<span class="fu">LPC</span>(DMAP1<span class="sc">$</span>x [, J],<span class="at">스케일 =</span> <span class="cn">거짓</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>Smoothed Data가 우리에게 보여준 것에 대한 느낌을 얻으려면 기능을 사용하여 대화식 그래픽을 살펴 봅니다.<code>Plot3d</code>그들로부터<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>패키지.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a aria-hidden="true" href="#cb139-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rgl"</span>))</span>
<span id="cb139-2"><a aria-hidden="true" href="#cb139-2" tabindex="-1"></a><span class="cf">~을 위한</span>(나<span class="cf">~에</span> <span class="fu">seq_along</span>(LPCPlots))</span>
<span id="cb139-3"><a aria-hidden="true" href="#cb139-3" tabindex="-1"></a>  <span class="fu">구성</span>(lpcplots [[i]],<span class="at">유형 =</span> <span class="st">"엘"</span>,,,<span class="at">lwd =</span> <span class="dv">3</span>,,,</span>
<span id="cb139-4"><a aria-hidden="true" href="#cb139-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">반죽</span>(<span class="st">"중심선"</span>, 빗 [<span class="dv">1</span>, 나]),</span>
<span id="cb139-5"><a aria-hidden="true" href="#cb139-5" tabindex="-1"></a>  <span class="at">뭉치</span> <span class="fu">반죽</span>(<span class="st">"중심선"</span>, 빗 [<span class="dv">2</span>, 나]),</span>
<span id="cb139-6"><a aria-hidden="true" href="#cb139-6" tabindex="-1"></a>  <span class="at">TIL</span> <span class="fu">반죽</span>(<span class="st">"중심선"</span>, 빗 [<span class="dv">3</span>, 나]))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>스무딩 라인과 데이터 포인트를 모두 플롯하는 한 가지 방법은<code>Plot3d</code>기능.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a aria-hidden="true" href="#cb140-1" tabindex="-1"></a>Outlpce134<span class="ot">=</span> <span class="fu">LPC</span>(DMAP1<span class="sc">$</span>엑스[,<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">4</span>)], <span class="at">스케일 =</span><span class="cn">거짓</span>,,,<span class="at">h =</span><span class="fl">0.5</span>))</span>
<span id="cb140-2"><a aria-hidden="true" href="#cb140-2" tabindex="-1"></a><span class="fu">Plot3d</span>(DMAP1<span class="sc">$</span>엑스[,<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">4</span>)], <span class="at">col =</span>콜크,<span class="at">pch =</span><span class="dv">20</span>,,,</span>
<span id="cb140-3"><a aria-hidden="true" href="#cb140-3" tabindex="-1"></a>       <span class="at">xlab =</span><span class="st">"axis1"</span>,,,<span class="at">뭉치</span><span class="st">"axis3"</span>,,,<span class="at">TIL</span><span class="st">"Axis4"</span>))</span>
<span id="cb140-4"><a aria-hidden="true" href="#cb140-4" tabindex="-1"></a><span class="fu">Plot3d</span>(Outlpce134<span class="sc">$</span>LPC,<span class="at">유형 =</span><span class="st">"엘"</span>,,,<span class="at">lwd =</span><span class="dv">7</span>,,,<span class="at">추가 =</span><span class="cn">진실</span>))</span>
<span id="cb140-5"><a aria-hidden="true" href="#cb140-5" tabindex="-1"></a></span>
<span id="cb140-6"><a aria-hidden="true" href="#cb140-6" tabindex="-1"></a>Outlpce134<span class="ot">=</span> <span class="fu">LPC</span>(DMAP1<span class="sc">$</span>엑스[,<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">4</span>)], <span class="at">스케일 =</span><span class="cn">거짓</span>,,,<span class="at">h =</span><span class="fl">0.7</span>))</span>
<span id="cb140-7"><a aria-hidden="true" href="#cb140-7" tabindex="-1"></a><span class="fu">Plot3d</span>(Outlpce134<span class="sc">$</span>LPC,<span class="at">유형 =</span><span class="st">"엘"</span>,,,<span class="at">lwd =</span><span class="dv">7</span>,,,</span>
<span id="cb140-8"><a aria-hidden="true" href="#cb140-8" tabindex="-1"></a>       <span class="at">xlab =</span><span class="st">"axis1"</span>,,,<span class="at">뭉치</span><span class="st">"axis3"</span>,,,<span class="at">TIL</span><span class="st">"Axis4"</span>))</span>
<span id="cb140-9"><a aria-hidden="true" href="#cb140-9" tabindex="-1"></a><span class="fu">Plot3d</span>(DMAP1<span class="sc">$</span>엑스[,<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">4</span>)], <span class="at">col =</span>콜크,</span>
<span id="cb140-10"><a aria-hidden="true" href="#cb140-10" tabindex="-1"></a>       <span class="at">xlab =</span><span class="st">"" "</span>,,,<span class="at">뭉치</span><span class="st">"" "</span>,,,<span class="at">TIL</span><span class="st">"" "</span>,,,<span class="at">추가 =</span><span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell quarto-layout-panel callout-47-contents callout-collapse collapse callout-margin-content" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-diffusionmap3-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diffusionmap3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-62" href="imgs/TripleArm.png" title="Figure 9.39: Diffusion map projection for Axes 1, 3 and 4. The lower figure shows the smoothed path followed by the cells in their development."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/TripleArm.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diffusionmap3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.39 : 축 1, 3 및 4에 대한 확산 맵 투영. 하부 그림은 부드러운 경로와 발달의 셀을 보여줍니다.</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-diffusionmap3-2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diffusionmap3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-63" href="imgs/SmoothLineP134h7.png" title="Figure 9.40: Diffusion map projection for Axes 1, 3 and 4. The lower figure shows the smoothed path followed by the cells in their development."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SmoothLineP134h7.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diffusionmap3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.40 : 축 1, 3 및 4에 대한 확산 맵 투영. 하부 그림은 부드러운 경로와 발달의 셀을 보여줍니다.</figcaption>
</figure>
</div>
</div>
</div>
</div></div><div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-hetero-moredistancescell">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 9.8</div>
</div>
<div class="callout-body-container callout-body">
<p>여기서 우리는 세포 발달 궤적을 보여줄 수있는 더 세련된 거리와 확산 맵을 탐색합니다.<a class="quarto-xref" href="#fig-dmap134">수치<span>9.41</span></a>.</p>
<div class="cell" data-layout-align="center">
</div>
<p>확산 맵 방법은 로컬 포인트로의 거리 추정을 제한하므로, 종종 국소 거리 만 정확하게 표현되어야하며 점점 더 멀어지면 동일한 '참조'로 측정되지 않는다는 아이디어를 더 추구합니다. 이 방법은 또한 거리를 입력으로 사용하지만 유사성의 지표로 국소 확률 적 전이를 생성하며, 이들은 고유 값과 고유 벡터가 표준 MDS에서도 많이 계산되는 친화력 매트릭스로 결합된다.</p>
<p>출력을 비교하십시오<code>퍼지다</code>기능<strong><a href="https://cran.r-project.org/web/packages/diffusionMap/">확산 맵</a></strong>L1 및 L2 거리 모두에서 이용 가능한 셀 사이에서 계산 된 패키지<code>dist2n.euclid</code>그리고<code>dist1n.l1</code>객체<a class="quarto-xref" href="#sec-hetero-celldynamics"><span>섹션 9.5.1</span></a>.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display callout-margin-content">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-dmap134">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dmap134-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-64" href="imgs/dmap134.png" title="Figure 9.41: Ouput from a three-dimensional diffusion map projection."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/dmap134.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dmap134-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 9.41 : 3 차원 확산 맵 투영에서 나온 OUPUT.</figcaption>
</figure>
</div>
</div></div><div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-49-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-49-contents callout-collapse collapse" id="callout-49">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a aria-hidden="true" href="#cb141-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"확산 맵"</span>))</span>
<span id="cb141-2"><a aria-hidden="true" href="#cb141-2" tabindex="-1"></a>DMAP2<span class="ot">=</span> <span class="fu">퍼지다</span>(dist2n.euclid,<span class="at">틸트 =</span> <span class="dv">11</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Eigendecomposition 수행
컴퓨팅 확산 좌표
경과 시간 : 7.243 초</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a aria-hidden="true" href="#cb143-1" tabindex="-1"></a>DMAP1<span class="ot">=</span> <span class="fu">퍼지다</span>(dista1n.l1,<span class="at">틸트 =</span> <span class="dv">11</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Eigendecomposition 수행
컴퓨팅 확산 좌표
경과 시간 : 4.849 초</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a aria-hidden="true" href="#cb145-1" tabindex="-1"></a><span class="fu">구성</span>(DMAP2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>바닐라는 a<em>DMAP</em>객체는 색상을 사용할 수 없습니다. 세포 발달에 대한 이해에 필수적으로, 우리는 색상을 손으로 추가합니다. 물론 여기에서는 정적 3D 플롯을 사용하지만 코드에서 제공하는 Plot3D 예제에 의해 보완되어야합니다.</p>
<p>맞춤형 래퍼 기능을 사용합니다<code>SCP3D</code>, 관련 매개 변수를 쉽게 삽입 할 수 있도록 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a aria-hidden="true" href="#cb146-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"scatterplot3d"</span>))</span>
<span id="cb146-2"><a aria-hidden="true" href="#cb146-2" tabindex="-1"></a>SCP3D<span class="ot">=</span> <span class="cf">기능</span>(<span class="at">axestop =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="at">dmapres =</span>DMAP1,<span class="at">색상 =</span>콜크,</span>
<span id="cb146-3"><a aria-hidden="true" href="#cb146-3" tabindex="-1"></a>           <span class="at">Anglea =</span> <span class="dv">20</span>,,,<span class="at">pch =</span> <span class="dv">20</span>))</span>
<span id="cb146-4"><a aria-hidden="true" href="#cb146-4" tabindex="-1"></a><span class="fu">ScatterPlot3d</span>(dmapres<span class="sc">$</span>x [, axestop],<span class="at">색상 =</span>콜크,</span>
<span id="cb146-5"><a aria-hidden="true" href="#cb146-5" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="fu">반죽</span>(<span class="st">"중심선"</span>, axestop [<span class="dv">1</span>]), <span class="at">뭉치</span> <span class="fu">반죽</span>(<span class="st">"중심선"</span>, axestop [<span class="dv">2</span>]),</span>
<span id="cb146-6"><a aria-hidden="true" href="#cb146-6" tabindex="-1"></a>    <span class="at">TIL</span> <span class="fu">반죽</span>(<span class="st">"중심선"</span>, axestop [<span class="dv">3</span>]), <span class="at">pch =</span>PCH,<span class="at">각도 =</span>앵글리아)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a aria-hidden="true" href="#cb147-1" tabindex="-1"></a><span class="fu">SCP3D</span>()</span>
<span id="cb147-2"><a aria-hidden="true" href="#cb147-2" tabindex="-1"></a><span class="fu">SCP3D</span>(<span class="at">Anglea =</span><span class="dv">310</span>))</span>
<span id="cb147-3"><a aria-hidden="true" href="#cb147-3" tabindex="-1"></a><span class="fu">SCP3D</span>(<span class="at">Anglea =</span><span class="dv">210</span>))</span>
<span id="cb147-4"><a aria-hidden="true" href="#cb147-4" tabindex="-1"></a><span class="fu">SCP3D</span>(<span class="at">Anglea =</span><span class="dv">150</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>데이터를 시각화하는 가장 좋은 방법은<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>패키지.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a aria-hidden="true" href="#cb148-1" tabindex="-1"></a><span class="co"># 대화식 플롯</span></span>
<span id="cb148-2"><a aria-hidden="true" href="#cb148-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rgl"</span>))</span>
<span id="cb148-3"><a aria-hidden="true" href="#cb148-3" tabindex="-1"></a><span class="fu">Plot3d</span>(DMAP1<span class="sc">$</span>엑스[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],,<span class="at">col =</span>콜크,<span class="at">크기 =</span><span class="dv">3</span>))</span>
<span id="cb148-4"><a aria-hidden="true" href="#cb148-4" tabindex="-1"></a><span class="fu">Plot3d</span>(DMAP1<span class="sc">$</span>엑스[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],,<span class="at">col =</span>콜크,<span class="at">크기 =</span><span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Belkin2003" role="listitem">Belkin, Mikhail 및 Partha Niyogi. 2003.<span>"치수 감소 및 데이터 표현을위한 라플라시안 고유 맵."</span> <em>신경 계산</em>15 (6) : 1373–96.</div>
<div class="csl-entry" id="ref-Bengio2004" role="listitem">Bengio, Yoshua, Jean-François 지불, Pascal Vincent, Olivier Delalleau, Nicolas Le Roux 및 Marie Ouimet. 2004.<span>“샘플 외부 확장<span>lle</span>, ISOMAP,<span>MDS</span>, 고유 맵 및 스펙트럼 클러스터링.”</span> <em>신경 정보 처리 시스템의 발전</em>16 : 177–84.</div>
<div class="csl-entry" id="ref-terBraak:1985" role="listitem">Braak, Cajo Ter. 1985.<span>"발생률 및 풍부한 데이터의 서신 분석 : 단단한 부활의 관점에서 속성."</span> <em>생체 인식</em>41 (1 월).</div>
<div class="csl-entry" id="ref-Brodie:2006" role="listitem">Brodie, Eoin L, Todd Z Desantis, Dominique C Joyner, Seung M Baek, Joern T Larsen, Gary L Andersen, Terry C Hazen 등. 2006.<span>"우라늄 감소 및 재산 화 중에 박테리아 집단 역학을 연구하기위한 고밀도 올리고 뉴클레오티드 마이크로 어레이 접근법의 적용."</span> <em>적용 및 환경 미생물학</em>72 (9) : 6288–98.</div>
<div class="csl-entry" id="ref-Callahan2016Bioc" role="listitem">Callahan, Ben J, Kris Sankaran, Julia A Fukuyama, Paul J McMurdie 및 Susan P Holmes. 2016.<span>"마이크로 바이 옴 데이터 분석을위한 바이오 컨덕터 워크 플로 : RAW 판독에서 커뮤니티 분석에 이르기까지."</span> <em>F1000Research</em>5.</div>
<div class="csl-entry" id="ref-ade4" role="listitem">Chessel, Daniel, Anne Dufour 및 Jean Thioulouse. 2004.<span>"그만큼<span class="nocase">적절한</span>패키지 -I : 하나의 테이블 방법.”</span> <em>R 뉴스</em>4 (1) : 5–10.<a href="http://CRAN.R-project.org/doc/Rnews/">http://cran.r-project.org/doc/rnews/</a>.
</div>
<div class="csl-entry" id="ref-Goel:2007aa" role="listitem">Diaconists, Persi, Sharad Goel 및 Susan Holmes. 2008.<span>"다차원 스케일링 및 커널 방법의 말굽."</span> <em>응용 통계의 연대기</em>2 : 777.<a href="https://doi.org/DOI:10.1214/08-AOAS165">https://doi.org/doi:10.1214/08-aoas165</a>.
</div>
<div class="csl-entry" id="ref-Ekman:1954" role="listitem">Ekman, Gosta. 1954.<span>"컬러 비전의 치수."</span> <em>심리학 저널</em>38 (2) : 467–74.</div>
<div class="csl-entry" id="ref-Goslee:2007" role="listitem">Goslee, Sarah C, Dean L Urban 등. 2007.<span>"생태 데이터의 비 유사성 기반 분석을위한 Ecodist 패키지."</span> <em>통계 소프트웨어 저널</em>22 (7) : 1–19.</div>
<div class="csl-entry" id="ref-greenacre2007" role="listitem">Greenacre, Michael J. 2007.<em>실제로 서신 분석</em>. 채프먼 &amp; 홀.</div>
<div class="csl-entry" id="ref-Guillot:2013" role="listitem">Guillot, Gilles 및 François Rousset. 2013.<span>"Mantel 테스트 해체."</span> <em>생태와 진화의 방법</em>4 (4) : 336–44.</div>
<div class="csl-entry" id="ref-Hastie1989" role="listitem">Hastie, Trevor 및 Werner Stuetzle. 1989.<span>"주요 곡선."</span> <em>미국 통계 협회 저널</em>84 (406) : 502–16.</div>
<div class="csl-entry" id="ref-HastieTibshiraniFriedman" role="listitem">Hastie, Trevor, Robert Tibshirani 및 Jerome Friedman. 2008.<em>통계 학습의 요소</em>. 2^{\ text {nd}} ed. 뛰는 것.</div>
<div class="csl-entry" id="ref-frenchway" role="listitem">홈즈, 수잔 2006.<span>“다변량 분석 :<span class="nocase">프랑스 방식</span>.”</span>~ 안에<em>확률 및 통계 : David a를 기리는 에세이. 자유민</em>, D. Nolan 및 T. P. Speed에 의해 편집. vol. 56. IMS 강의 노트 - 노조 시리즈. Beachwood, OH : IMS.<a href="http://www.imstat.org/publications/lecnotes.htm">http://www.imstat.org/publications/lecnotes.htm</a>.
</div>
<div class="csl-entry" id="ref-holmes2011psb" role="listitem">Holmes, Susan, Alexander v Alekseyenko, Alden Timme, Tyrrell Nelson, Pankaj Jay Pasricha 및 Alfred Spoonnn. 2011.<span>"Phylochip 데이터에 대한 R 패키지를 사용하여 미생물 커뮤니티의 시각화 및 통계적 비교."</span>~ 안에<em>바이오 컴퓨팅에 관한 태평양 심포지엄</em>, 142–53. 세계 과학.</div>
<div class="csl-entry" id="ref-Izenman2008" role="listitem">Izenman, Alan Julian. 2008.<span>"비선형 차원 감소 및 매니 폴드 학습."</span>~ 안에<em>현대의 다변량 통계 기술 : 회귀, 분류 및 매니 폴드 학습</em>, 597–632. 뉴욕, 뉴욕 : Springer New York.</div>
<div class="csl-entry" id="ref-Josse:2016" role="listitem">Josse, Julie 및 Susan Holmes. 2016.<span>"다변량 협회 및 그 너머의 측정."</span> <em>통계 조사</em>10 : 132–67.</div>
<div class="csl-entry" id="ref-Kashyap:2013" role="listitem">Kashyap, Purena C, Marcobal, Luke Smiel, 같은 Smith, Eriana Dnoneburg, Elizbeth Kos Three, Studven. 2013.<span>"숙주 점액 탄수화물 조경의 유전자 적으로 지시 된 변화는 장 미생물 총에식이 의존적 영향을 미칩니다."</span> <em>PNA</em>110 (42) : 17059–64.</div>
<div class="csl-entry" id="ref-Kendall:1969" role="listitem">켄달, 데이비드. 1969.<span>"고고학의 발병 매트릭스, 간격 그래프 및 망성."</span> <em>Pacific Journal of Mathematics</em>28 (3) : 565–70.</div>
<div class="csl-entry" id="ref-Leek:2010:batch" role="listitem">Leek, Jeffrey T, Robert B Scharpf, Héctor Corrade Bravo, David Simcha, Benjamin Langmead, W Evan Johnson, Donald Geman, Keith Baggerly 및 Rafael A Irizarry. 2010 년.<span>"고 처리량 데이터에서 배치 효과의 광범위하고 중요한 영향을 해결합니다."</span> <em>자연은 유전학을 검토합니다</em>11 (10) : 733–39.</div>
<div class="csl-entry" id="ref-Moignard:2015" role="listitem">Moignard, Victoria, Steven Woodhouse, Laleh Hadhverdi, Andrew J Lilly, Yusuke Tanaka, Adam C Wilkinson, Floriian Buettner 등. 2015.<span>"단일 세포 유전자 발현 측정에서 조기 혈액 발달의 조절 네트워크를 디코딩합니다."</span> <em>자연 생명 공학</em>.
</div>
<div class="csl-entry" id="ref-Nelson:2011" role="listitem">Nelson, Tyrell A, Susan Holmes, Alexander Alekseyenko, Masha Shenoy, Todd Desantis, Cindy Wu, Gary Andersen 등. 2010 년.<span>"<span>Phylochip</span>마이크로 어레이 분석은 결장 과민증의 쥐 모델에서 변경된 위장 미생물 군집을 보여줍니다.”</span> <em>신경 대변학 및 운동성</em>.
</div>
<div class="csl-entry" id="ref-Pages:2016" role="listitem">Pagès, Jérôme. 2016.<em>예제 사용에 의한 다중 요소 분석<span>아르 자형</span></em>. CRC 프레스.</div>
<div class="csl-entry" id="ref-Perraudeau:2017" role="listitem">Perraudeau, Fanny, Davide Risso, Kelly Street, Elizabeth Pardom 및 Sandrine Dudit. 2017.<span>“단일 셀의 생체 전도체 워크 플로우<span>RNA</span>시퀀싱 : 정규화, 치수 감소, 클러스터링 및 계보 추론.”</span> <em>F1000Research</em>6.</div>
<div class="csl-entry" id="ref-Prentice:1977" role="listitem">프렌 티스, IC. 1977.<span>"생태학의 비 금수 안수 방법."</span> <em>생태학 저널</em>, 85–94.</div>
<div class="csl-entry" id="ref-HIVdb" role="listitem">Rhee, Soo-Yon, Matthew J Gonzales, Rami Kantor, Bradley J Betts, Jaideep Ravela 및 Robert W Shafer. 2003.<span>"인간 면역 결핍 바이러스 역전사 효소 및 프로테아제 서열 데이터베이스."</span> <em>핵산 연구</em>31 (1) : 298–303.</div>
<div class="csl-entry" id="ref-Roweis2000" role="listitem">Roweis, Sam T 및 Lawrence K Saul. 2000.<span>"국부 선형 임베딩에 의한 비선형 차원 감소."</span> <em>과학</em>290 (5500) : 2323–26.</div>
<div class="csl-entry" id="ref-Tenenbaum2000" role="listitem">Tenenbaum, Joshua B, Vin de Silva 및 John C Lanford. 2000.<span>"비선형 차원 감소를위한 글로벌 기하학적 프레임 워크."</span> <em>과학</em>290 (5500) : 2319–23.</div>
<div class="csl-entry" id="ref-Trosset2008" role="listitem">Trosset, Michael W 및 Carey E Priebe. 2008.<span>"고전적인 다차원 스케일링의 샘플 외 문제."</span> <em>계산 통계 및 데이터 분석</em>52 (10) : 4635–42.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
