<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>4  Mixture Models – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="4  Mixture Models – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="4  Mixture Models – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">4.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#finite-mixtures" href="#finite-mixtures" id="toc-finite-mixtures"><span class="header-section-number">4.2</span>유한 혼합물</a></li>
<li><a class="nav-link" data-scroll-target="#empirical-distributions-and-the-nonparametric-bootstrap" href="#empirical-distributions-and-the-nonparametric-bootstrap" id="toc-empirical-distributions-and-the-nonparametric-bootstrap"><span class="header-section-number">4.3</span>경험적 분포 및 비모수 적 부트 스트랩</a></li>
<li><a class="nav-link" data-scroll-target="#infinite-mixtures" href="#infinite-mixtures" id="toc-infinite-mixtures"><span class="header-section-number">4.4</span>무한 혼합물</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">4.5</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">4.6</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">4.7</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-mixtures"><span class="chapter-number">4</span>  <span class="chapter-title">혼합 모델</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/t_distribution.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/t_distribution.png"/></a></p>
</figure>
</div>
</div></div></div>
<p>생물학적 데이터 분석의 주요 과제 중 하나는 이질성을 다루는 것입니다. 우리가 관심있는 수량은 종종 단순하고 단단한 "교과서 배포"를 보여주지 않습니다. 예를 들어, 마지막 부분에서<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>우리는 시퀀스의 히스토그램이 어떻게 점수를 얻었는지 보았다<a class="quarto-xref" href="02-chap.html#fig-ScoreMixture-1">수치<span>2.27</span></a>CPG-Islands와 하나는 ISLANDS를위한 두 개의 개별 모드가있었습니다. 데이터를 몇 가지 (이 경우 : 2) 구성 요소의 간단한 혼합으로 볼 수 있습니다. 우리는 이것을 부릅니다<em>유한 혼합물</em>. 다른 혼합물은 관찰 한 것만 큼 많은 구성 요소를 포함 할 수 있습니다. 이것들은 우리가 부릅니다<em>무한 혼합물</em><a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>우리는 많은 모델링 선택에 관해서는 혼합물의 올바른 복잡성이 보는 사람의 시선에 있으며 종종 우리가 달성하고자하는 데이터의 양과 분해능과 부드러움에 달려 있음을 알 수 있습니다.</p></div></div><p>~ 안에<a class="quarto-xref" href="01-chap.html"><span>1 장</span></a>우리는 포아송 분포가있는 간단한 생성 모델이 어떻게 우리가 에피토프 검출에 유용한 추론을 이끌어 냈는지 보았습니다. 불행히도, 이러한 간단한 모델로 실제 데이터에 만족스러운 것은 종종 손이 닿지 않습니다. 그러나 정상 또는 포아송 분포와 같은 간단한 모델은이 장에서 다루는 믹싱 프레임 워크를 사용하여보다 현실적인 모델의 빌딩 블록 역할을 할 수 있습니다. 혼합물은 유세포 분석 데이터, 생체 측정 측정, RNA-Seq, Chip-seq, Microbiome 및 현대 생명 공학을 사용하여 수집 된 많은 다른 유형의 데이터에 대해 자연적으로 발생합니다. 이 장에서는 간단한 예에서 혼합물을 사용하여보다 현실적인 분포 모델을 구축하는 방법을 배웁니다.</p>
<section class="level2" data-number="4.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="4.1"><span class="header-section-number">4.1</span>이 장의 목표</h2>
<p>이 장에서는 다음과 같습니다.</p>
<ul>
<li><p>두 개의 정상 인구로 구성된 분포에서 자체 혼합 모델 데이터를 생성하십시오.</p></li>
<li><p>EM (Expection-Maximization) 알고리즘을 통해 데이터 세트의 기본 혼합물을 "역 엔지니어"할 수있는 방법을 확인하십시오.</p></li>
<li><p>여분의 0이 많은 Chip-Seq 데이터와 같은 데이터에 대해 제로 인플레이션이라는 특수 유형의 혼합물을 사용하십시오.</p></li>
<li><p>경험적 누적 분포 : 관찰 된 데이터에서 구축 할 수있는 특수 혼합물을 발견하십시오. 이를 통해 부트 스트랩을 사용하여 추정치의 변동성을 시뮬레이션 할 수있는 방법을 확인할 수 있습니다.</p></li>
<li><p>많은 구성 요소가있는 무한 혼합 모델의 인스턴스로 라플라스 분포를 구축하십시오. 우리는 그것을 사용하여 프로모터 길이와 마이크로 어레이 강도를 모델링 할 것입니다.</p></li>
<li><p>RNA-Seq 데이터에 유용한 계층 적 모델 인 Gamma-Pooisson 분포와의 첫 번째 만남. 우리는 그것이 다른 포아송 분산 소스를 혼합함으로써 자연스럽게 오는 것을 볼 수 있습니다.</p></li>
<li><p>혼합 모델을 통해 데이터 변환을 선택할 수있는 방법을 확인하십시오.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="4.2" id="finite-mixtures">
<h2 class="anchored" data-anchor-id="finite-mixtures" data-number="4.2"><span class="header-section-number">4.2</span>유한 혼합물</h2>
<section class="level3 page-columns page-full" data-number="4.2.1" id="simple-examples-and-computer-experiments">
<h3 class="anchored" data-anchor-id="simple-examples-and-computer-experiments" data-number="4.2.1"><span class="header-section-number">4.2.1</span>간단한 예와 컴퓨터 실험</h3>
<p>다음은 두 개의 동일한 크기 구성 요소가있는 혼합 모델의 첫 번째 예입니다. 생성 프로세스에는 두 단계가 있습니다.</p>
<p><strong>공정한 동전을 뒤집습니다.</strong></p>
<p>헤드가 올 경우 : 평균 1과 분산 0.25의 정규 분포에서 난수를 생성하십시오.</p>
<p>테일이 오면 : 평균 3 및 분산 0.25의 정규 분포에서 난수를 생성하십시오. 표시된 히스토그램<a class="quarto-xref" href="#fig-twocoins">수치<span>4.1</span></a>다음 코드를 사용 하여이 두 단계를 10000 번 반복하여 제작했습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>코인 플립<span class="ot">=</span> (<span class="fu">runif</span>(<span class="dv">10000</span>))<span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a><span class="fu">테이블</span>(코인 플립)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>코인 플립
잘못된 사실 
 5003 4997</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a>ONEFLIP<span class="ot">=</span> <span class="cf">기능</span>(FL,<span class="at">평균 1 =</span> <span class="dv">1</span>,,,<span class="at">평균 2 =</span> <span class="dv">3</span>,,,<span class="at">sd1 =</span> <span class="fl">0.5</span>,,,<span class="at">SD2 =</span> <span class="fl">0.5</span>) {</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a>  <span class="cf">만약에</span>(fl) {</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>   <span class="fu">rnorm</span>(<span class="dv">1</span>, 평균 1, sd1)</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a>  } <span class="cf">또 다른</span> {</span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5" tabindex="-1"></a>   <span class="fu">rnorm</span>(<span class="dv">1</span>, 평균 2, SD2)</span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6" tabindex="-1"></a>  }</span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7" tabindex="-1"></a>}</span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8" tabindex="-1"></a>페어 믹스<span class="ot">=</span> <span class="fu">vapply</span>(코인 플립, Oneflip,<span class="fu">숫자</span>(<span class="dv">1</span>)))</span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">값 =</span>페어 믹스),<span class="fu">AES</span>(<span class="at">x =</span>값))<span class="sc">+</span></span>
<span id="cb3-12"><a aria-hidden="true" href="#cb3-12" tabindex="-1"></a>     <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"보라"</span>,,,<span class="at">binwidth =</span> <span class="fl">0.1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-twocoins">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twocoins-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="04-chap_files/figure-html/fig-twocoins-1.png" title="Figure 4.1: Histogram of 10,000 random draws from a fair mixture of two normals. The left hand part of the histogram is dominated by numbers generated from (A), on the right from (B)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-twocoins-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twocoins-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.1 : 두 가지 정상의 공정한 혼합물에서 10,000 랜덤 드로우의 히스토그램이 있습니다. 히스토그램의 왼손 부분은 (a)에서 생성 된 숫자, (b)의 오른쪽에 의해 지배됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-vector">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.1</div>
</div>
<div class="callout-body-container callout-body">
<p>R의 벡터화 구문을 사용하여 어떻게<code>vapply</code>-루프 및 생성<code>페어 믹스</code>더 효율적으로 벡터?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-2-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-2-contents callout-collapse collapse" id="callout-2">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a>수단<span class="ot">=</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>))</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a>SDS<span class="ot">=</span> <span class="fu">기음</span>(<span class="fl">0.5</span>,,,<span class="fl">0.5</span>))</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a>값<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(코인 플립),</span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4" tabindex="-1"></a>               <span class="at">평균 =</span> <span class="fu">ifelse</span>(코인 플립, 의미 [<span class="dv">1</span>], 수단[<span class="dv">2</span>]),</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5" tabindex="-1"></a>               <span class="at">SD =</span> <span class="fu">ifelse</span>(코인 플립, SDS [<span class="dv">1</span>], SDS [<span class="dv">2</span>])))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-notice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.2</div>
</div>
<div class="callout-body-container callout-body">
<p>개선 된 코드를 사용하여 백만 개의 코인 플립을 사용하고 200 개의 빈으로 히스토그램을 만듭니다. 당신은 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-4-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-4-contents callout-collapse collapse" id="callout-4">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a>공정한<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a>  <span class="at">코인 플립 =</span> (<span class="fu">runif</span>(<span class="fl">1e6</span>))<span class="sc">&gt;</span> <span class="fl">0.5</span>),)</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3" tabindex="-1"></a>  <span class="at">값 =</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(코인 플립),</span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4" tabindex="-1"></a>                 <span class="at">평균 =</span> <span class="fu">ifelse</span>(코인 플립, 의미 [<span class="dv">1</span>], 수단[<span class="dv">2</span>]),</span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5" tabindex="-1"></a>                 <span class="at">SD =</span> <span class="fu">ifelse</span>(코인 플립, SDS [<span class="dv">1</span>], SDS [<span class="dv">2</span>])))</span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6" tabindex="-1"></a><span class="fu">ggplot</span>(공정한,<span class="fu">AES</span>(<span class="at">x =</span>값)))<span class="sc">+</span></span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7" tabindex="-1"></a>     <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"보라"</span>,,,<span class="at">빈 =</span> <span class="dv">200</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-limitinghistogram">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-limitinghistogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="04-chap_files/figure-html/fig-limitinghistogram-1.png" title="Figure 4.2: Similar to Figure fig-twocoins, but with one million observations."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-limitinghistogram-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-limitinghistogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.2 : 유사합니다<a class="quarto-xref" href="#fig-twocoins">수치<span>4.1</span></a>그러나 백만 개의 관찰이 있습니다.</figcaption>
</figure>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-limitinghistogram">수치<span>4.2</span></a>빈 횟수와 빈당 관측 수를 늘리면 히스토그램이 부드러운 곡선에 접근 함을 보여줍니다. 이 부드러운 제한 곡선을<strong>밀도</strong>랜덤 변수의 함수<code>공정한 $ 값</code>.</p>
</div>
</div>
</div>
<p>정상의 밀도 기능<span class="math inline">\ (n (\ mu, \ sigma) \)</span>랜덤 변수는 명시 적으로 작성할 수 있습니다. 우리는 보통 그것을 부릅니다</p>
<p><span class="math display">\ [
\ phi (x) = \ frac {1} {\ sigma \ sqrt {2 \ pi}} e^{-\ frac {1} {2} (\ frac {x- \ mu} {\ sigma})^2}.
\]</span></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-overlaydensity">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.3</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>해당 값의 히스토그램을 플로팅하십시오<code>공정한 $ 값</code>어느 쪽이든<code>코인 플립</code>~이다<code>진실</code>. 힌트 : 사용<code>y = .. 부인 ..</code>전화에서<code>AES</code>(이는 세로 축이 카운트의 비율을 보여주는 것임을 의미합니다.) Binwidth를 0.01로 설정하십시오.</li>
<li>해당 라인을 오버레이합니다<span class="math inline">\ (\ phi (z) \)</span>.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-6-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-6-contents callout-collapse collapse" id="callout-6">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(dplyr<span class="sc">::</span><span class="fu">필터</span>(공정, 코인 플립),<span class="fu">AES</span>(<span class="at">x =</span>값)))<span class="sc">+</span></span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">AES</span>(<span class="at">y =</span> <span class="fu">후_stat</span>(밀도)),<span class="at">fill =</span> <span class="st">"보라"</span>,,,<span class="at">binwidth =</span> <span class="fl">0.01</span>))<span class="sc">+</span></span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">재미 =</span>Dnorm,<span class="at">색상 =</span> <span class="st">"빨간색"</span>,,,</span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">목록</span>(<span class="at">평균 =</span>수단[<span class="dv">1</span>],,<span class="at">SD =</span>SDS [<span class="dv">1</span>])))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-overlaydensity">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overlaydensity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="04-chap_files/figure-html/fig-overlaydensity-1.png" title="Figure 4.3: Histogram of half a million draws from the normal distribution N(\mu=1,\sigma^2=0.5^2). The curve is the theoretical density \phi(x) calculated using the function dnorm."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-overlaydensity-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overlaydensity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.3 : 정규 분포에서 2 백만 회의 히스토그램<span class="math inline">\ (n (\ mu = 1, \ sigma^2 = 0.5^2) \)</span>. 곡선은 이론적 밀도입니다<span class="math inline">\ (\ phi (x) \)</span>함수를 사용하여 계산되었습니다<code>dnorm</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>실제로 우리는 모든의 밀도에 대한 수학적 공식을 쓸 수 있습니다.<code>공정한 $ 값</code>(히스토그램이 보이는 경향이있는 제한 곡선) 두 밀도의 합으로.</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-eqhalfhalf"><span class="math display">\ [
f (x) = \ frac {1} {2} \ phi_1 (x)+\ frac {1} {2} \ phi_2 (x),
\ tag {4.1} \]</span></span></p>
<p>어디<span class="math inline">\ (\ phi_1 \)</span>정상의 밀도입니다<span class="math inline">\ (n (\ mu_1 = 1, \ sigma^2 = 0.25) \)</span>그리고<span class="math inline">\ (\ phi_2 \)</span>정상의 밀도입니다<span class="math inline">\ (n (\ mu_2 = 3, \ sigma^2 = 0.25) \)</span>. <a class="quarto-xref" href="#fig-twodensity">수치<span>4.4</span></a>다음 코드에 의해 생성되었습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a>좋은 사람<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">서열</span>(<span class="sc">-</span><span class="dv">1</span>,,,<span class="dv">5</span>,,,<span class="at">length.out =</span> <span class="dv">1000</span>),)</span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3" tabindex="-1"></a>  <span class="at">f =</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">dnorm</span>(엑스,<span class="at">평균 =</span>수단[<span class="dv">1</span>],,<span class="at">SD =</span>SDS [<span class="dv">1</span>])))<span class="sc">+</span></span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4" tabindex="-1"></a>      <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">dnorm</span>(엑스,<span class="at">평균 =</span>수단[<span class="dv">2</span>],,<span class="at">SD =</span>SDS [<span class="dv">2</span>])))</span>
<span id="cb7-5"><a aria-hidden="true" href="#cb7-5" tabindex="-1"></a><span class="fu">ggplot</span>(좋은 사람,<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>에프))<span class="sc">+</span></span>
<span id="cb7-6"><a aria-hidden="true" href="#cb7-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">색상 =</span> <span class="st">"빨간색"</span>,,,<span class="at">linewidth =</span> <span class="fl">1.5</span>))<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"혼합 밀도"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-twodensity">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twodensity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="04-chap_files/figure-html/fig-twodensity-1.png" title="Figure 4.4: The theoretical density of the mixture."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-twodensity-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twodensity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.4 : 혼합물의 이론적 밀도.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 경우, 두 구성 요소 분포가 겹치지 않기 때문에 혼합물 모델은 극도로 보입니다.<a class="quarto-xref" href="#fig-twodensity">수치<span>4.4</span></a>두 개의 별개의 피크를 보여줍니다. 우리는 이것을 a라고 부릅니다<strong>바이 모달</strong>분포. 실제로, 많은 경우에 혼합 성분 사이의 분리는 그렇게 명확하지는 않지만 그럼에도 불구하고 관련이 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-histmystery">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histmystery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="04-chap_files/figure-html/fig-histmystery-1.png" title="Figure 4.5: A mixture of two normals that is harder to recognize."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-histmystery-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histmystery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.5 : 인식하기 어려운 두 가지 정상의 혼합.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mystery">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.4</div>
</div>
<div class="callout-body-container callout-body">
<p><a class="quarto-xref" href="#fig-histmystery">수치<span>4.5</span></a>동일한 분산과 함께 두 가지 정상의 공정한 혼합의 히스토그램입니다. 둘을 추측 할 수 있습니까?<em>평균</em>구성 요소 분포의 매개 변수? 힌트 : 시행 착오를 사용하고 다양한 혼합물을 시뮬레이션하여 일치하는 히스토그램을 만들 수 있는지 확인할 수 있습니다. 이 장의 R 코드를 보면 데이터가 어떻게 생성되었는지 정확히 보여줍니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-8-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-8-contents callout-collapse collapse" id="callout-8">
<div class="callout-body-container callout-body">
<p>다음 코드 색상은 빨간색으로 생성 된 점입니다.<em>머리</em>동전이 뒤집히고 파란색으로<em>꼬리</em>. 출력<a class="quarto-xref" href="#fig-betterhistogram-1">수치<span>4.6</span></a>, 두 개의 기본 분포를 보여줍니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" href="#cb8-1" tabindex="-1"></a><span class="fu">머리</span>(신비,<span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 3 × 2
  코인 플립 값
  &lt;lgl&gt; &lt;dbl&gt;
1 거짓 2.40
2 거짓 1.66
3 True 1.22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a>Br<span class="ot">=</span> <span class="fu">~와 함께</span>(신비,<span class="fu">서열</span>(<span class="fu">최소</span>(값),<span class="fu">맥스</span>(값),<span class="at">length.out =</span> <span class="dv">30</span>)))</span>
<span id="cb10-2"><a aria-hidden="true" href="#cb10-2" tabindex="-1"></a><span class="fu">ggplot</span>(신비,<span class="fu">AES</span>(<span class="at">x =</span>값)))<span class="sc">+</span></span>
<span id="cb10-3"><a aria-hidden="true" href="#cb10-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">데이터 =</span>dplyr<span class="sc">::</span><span class="fu">필터</span>(미스터리, 코인 플립),</span>
<span id="cb10-4"><a aria-hidden="true" href="#cb10-4" tabindex="-1"></a>     <span class="at">fill =</span> <span class="st">"빨간색"</span>,,,<span class="at">알파 =</span> <span class="fl">0.2</span>,,,<span class="at">breaks =</span>Br)<span class="sc">+</span></span>
<span id="cb10-5"><a aria-hidden="true" href="#cb10-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">데이터 =</span>dplyr<span class="sc">::</span><span class="fu">필터</span>(신비,<span class="sc">!</span>코인 플립),</span>
<span id="cb10-6"><a aria-hidden="true" href="#cb10-6" tabindex="-1"></a>     <span class="at">fill =</span> <span class="st">"다크 블루"</span>,,,<span class="at">알파 =</span> <span class="fl">0.2</span>,,,<span class="at">breaks =</span>Br)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-betterhistogram-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-betterhistogram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="04-chap_files/figure-html/fig-betterhistogram-1-1.png" title="Figure 4.6: The mixture from Figure fig-histmystery, but with the two components colored in red and blue."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-betterhistogram-1-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-betterhistogram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.6 : 혼합물<a class="quarto-xref" href="#fig-histmystery">수치<span>4.5</span></a>그러나 두 구성 요소가 빨간색과 파란색으로 채색되어 있습니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>~ 안에<a class="quarto-xref" href="#fig-betterhistogram-1">수치<span>4.6</span></a>두 구성 요소 분포의 막대는 서로 위에 표시됩니다. 구성 요소를 보여주는 다른 방법은 다음과 같습니다<a class="quarto-xref" href="#fig-comparecomponents-1">수치<span>4.7</span></a>아래 코드에서 생성.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(신비,<span class="fu">AES</span>(<span class="at">x =</span>값,<span class="at">fill =</span>코인 플립)))<span class="sc">+</span></span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">데이터 =</span>dplyr<span class="sc">::</span><span class="fu">필터</span>(미스터리, 코인 플립),</span>
<span id="cb11-3"><a aria-hidden="true" href="#cb11-3" tabindex="-1"></a>     <span class="at">fill =</span> <span class="st">"빨간색"</span>,,,<span class="at">알파 =</span> <span class="fl">0.2</span>,,,<span class="at">breaks =</span>Br)<span class="sc">+</span></span>
<span id="cb11-4"><a aria-hidden="true" href="#cb11-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">데이터 =</span>dplyr<span class="sc">::</span><span class="fu">필터</span>(신비,<span class="sc">!</span>코인 플립),</span>
<span id="cb11-5"><a aria-hidden="true" href="#cb11-5" tabindex="-1"></a>     <span class="at">fill =</span> <span class="st">"다크 블루"</span>,,,<span class="at">알파 =</span> <span class="fl">0.2</span>,,,<span class="at">breaks =</span>Br)<span class="sc">+</span></span>
<span id="cb11-6"><a aria-hidden="true" href="#cb11-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"보라"</span>,,,<span class="at">breaks =</span>Br,<span class="at">알파 =</span> <span class="fl">0.2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-comparecomponents-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comparecomponents-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="04-chap_files/figure-html/fig-comparecomponents-1-1.png" title="Figure 4.7: As Figure fig-betterhistogram-1, with stacked bars for the two mixture components."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-comparecomponents-1-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comparecomponents-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.7 : AS<a class="quarto-xref" href="#fig-betterhistogram-1">수치<span>4.6</span></a>, 두 혼합물 성분에 대한 스택 막대.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-myst2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.5</div>
</div>
<div class="callout-body-container callout-body">
<p>바가 들어가는 이유<a class="quarto-xref" href="#fig-comparecomponents-1">수치<span>4.7</span></a>, 그러나 그것들은 아닙니다<a class="quarto-xref" href="#fig-betterhistogram-1">수치<span>4.6</span></a>높은 높이를 가지고 있습니다<a class="quarto-xref" href="#fig-histmystery">수치<span>4.5</span></a>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-10-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-10-contents callout-collapse collapse" id="callout-10">
<div class="callout-body-container callout-body">
<p>그림에서<a class="quarto-xref" href="#fig-comparecomponents-1"><span>4.7</span></a>그리고<a class="quarto-xref" href="#fig-histmystery"><span>4.5</span></a>, 각 카운트는 빈에서 다른 수직 공간을 차지합니다. ~ 안에<a class="quarto-xref" href="#fig-betterhistogram-1">수치<span>4.6</span></a>, 겹치는 (어두운) 영역에서, 동일한 빈 안에 떨어지는 일부 수는 과도하게 뿌려집니다.</p>
</div>
</div>
</div>
<p>그림에서<a class="quarto-xref" href="#fig-betterhistogram-1"><span>4.6</span></a>그리고<a class="quarto-xref" href="#fig-comparecomponents-1"><span>4.7</span></a>, 우리는 그것을 사용할 수있었습니다<code>코인 플립</code>데이터의 열은 구성 요소를 풀니다. 실제 데이터에서는이 정보가 누락되었습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="imgs/book_icon.png" title="A book-long treatment on the subject of finite mixtures [@mclachlan2004]."><img alt="A book-long treatment on the subject of finite mixtures (McLachlan and Peel 2004)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
<figcaption>유한 혼합물의 주제에 대한 책장 치료<span class="citation" data-cites="mclachlan2004">(<a href="16-chap.html#ref-mclachlan2004" role="doc-biblioref">McLachlan and Peel 2004</a>))</span>.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level3 page-columns page-full" data-number="4.2.2" id="discovering-the-hidden-class-labels">
<h3 class="anchored" data-anchor-id="discovering-the-hidden-class-labels" data-number="4.2.2"><span class="header-section-number">4.2.2</span>숨겨진 클래스 레이블 발견</h3>
<p>우리는 The라는 메소드를 사용합니다<em>기대 대비 (EM) 알고리즘</em>숨겨진 그룹의 가치를 추론합니다. EM 알고리즘은 다른 부분을 계산하기위한 솔루션의 한 부분을 알고 다른 부분을 척하는 척하는 척하는 대중의 반복 절차입니다. 더 구체적으로, 그것은 번갈아 가며</p>
<ul>
<li><p>우리는 각각의 관찰이 다른 혼합물 성분에 속하는 확률을 알고 있으며, 이로부터, 구성 요소의 매개 변수를 추정하고</p></li>
<li><p>우리는 혼합 성분의 매개 변수를 알고 각 관측치가 구성 요소에 속하는 확률을 추정합니다.</p></li>
</ul>
<p>간단한 예를 들어 봅시다. 변수를 측정합니다<span class="math inline">\(엑스\)</span>우리는 그룹 라벨을 알지 못하지만 두 그룹에서 나온 일련의 객체에서. 우리는 시작합니다<em>증강</em><a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>우리가 호출 할 수없는 (잠재적) 그룹 레이블이있는 데이터.<span class="math inline">\(유\)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>측정되지 않은 다른 변수 추가, 숨겨진 또는<strong>잠재 변수</strong>.</p></div></div><p>우리는 값을 찾는 데 관심이 있습니다<span class="math inline">\(유\)</span>그리고 알려지지 않은 매개 변수<span class="math inline">\ (\ theta \)</span>그룹의 기본 분포. 우리는 도입 된 최대 가능성 접근법을 사용할 것입니다<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>데이터를 만드는 매개 변수를 추정합니다<span class="math inline">\(엑스\)</span>가장 가능성이 높습니다. 확률 밀도를 쓸 수 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-eqeqmix"><span class="math display">\ [
p (x, u \, | \, \ theta) = p (x \, | \, u, \ theta) \, p (u \, | \, \ theta).
\ tag {4.2} \]</span></span></p>
<section class="level4 unnumbered" id="mixture-of-normals">
<h4 class="unnumbered anchored" data-anchor-id="mixture-of-normals">정상의 혼합</h4>
<p>예를 들어, 우리는 두 개의 정상 분포로 이전 혼합물 모델을 일반화 할 수 있습니다.<a class="quarto-xref" href="#eq-mixtures-eqhalfhalf">방정식<span>4.1</span></a>비평형 혼합물 분획을 허용함으로써</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-twonormals"><span class="math display">\ [
f (x) = \ lambda \ phi_1 (x)+(1- \ lambda) \ phi_2 (x),
\ tag {4.3} \]</span></span></p>
<p>~을 위한<span class="math inline">\ (\ lambda \ in [0,1] \)</span>. 위와 마찬가지로<span class="math inline">\ (phi_k \)</span>정상의 밀도입니다<span class="math inline">\ (n (\ mu_k, \ sigma_k^2) \)</span>~을 위한<span class="math inline">\ (k = 1 \)</span>그리고<span class="math inline">\ (k = 2 \)</span>각각. 그런 다음 매개 변수 벡터입니다<span class="math inline">\ (\ theta \)</span>두 가지 수단 중 5 튜플, 두 표준 편차 및 혼합 매개 변수입니다.<span class="math inline">\ (\ lambda \)</span>. 다시 말해서,<span class="math inline">\ (\ theta = (\ m_1, \ in_2, \ sigma_1, \ sigma_2, \ labda) \) \)</span>. 다음은 이러한 모델에 따라 생성 된 데이터의 예입니다. 레이블은로 표시됩니다<span class="math inline">\(유\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a>무스<span class="ot">=</span> <span class="fu">기음</span>(<span class="sc">-</span><span class="fl">0.5</span>,,,<span class="fl">1.5</span>))</span>
<span id="cb12-2"><a aria-hidden="true" href="#cb12-2" tabindex="-1"></a>람다<span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb12-3"><a aria-hidden="true" href="#cb12-3" tabindex="-1"></a>유<span class="ot">=</span> <span class="fu">견본</span>(<span class="dv">2</span>,,,<span class="at">크기 =</span> <span class="dv">100</span>,,,<span class="at">교체 =</span> <span class="cn">진실</span>,,,<span class="at">prob =</span> <span class="fu">기음</span>(람다,<span class="dv">1</span><span class="sc">-</span>람다))</span>
<span id="cb12-4"><a aria-hidden="true" href="#cb12-4" tabindex="-1"></a>엑스<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(유),<span class="at">평균 =</span>간다 [u])</span>
<span id="cb12-5"><a aria-hidden="true" href="#cb12-5" tabindex="-1"></a>DUX<span class="ot">=</span> <span class="fu">티블</span>(u, x)</span>
<span id="cb12-6"><a aria-hidden="true" href="#cb12-6" tabindex="-1"></a><span class="fu">머리</span>(dux)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 6 × 2
      u x
  &lt;int&gt; &lt;dbl&gt;
1 2 0.303
2 2 2.65 
3 1 0.484
4 2 3.04 
5 2 1.10 
6 2 1.96</code></pre>
</div>
</div>
<p>우리가 라벨을 알고 있다면<span class="math inline">\(유\)</span>, 각 그룹에 대해 별도의 MLE를 사용하여 매개 변수를 추정 할 수 있습니다. 전반적인 가능성은입니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-factorizedlikelihood"><span class="math display">\ [
p (x, u \, | \, \ theta) =
\ left (\ prod _ {\ {i : \, u_i = 1 \}} \ phi_1 (x_i) \ 오른쪽) \ times
\ left (\ prod _ {\ {i : \, u_i = 2 \}} \ phi_2 (x_i) \ 오른쪽).
\ tag {4.4} \]</span></span></p>
<p>최대화는 세 가지 독립적 인 조각으로 나눌 수 있습니다.<span class="math inline" data-anchor-id="eq-mixtures">\ (\ mu_1 \)</span>그리고<span class="math inline">\ (\ sigma_1 \)</span>오른쪽에있는 첫 번째 괄호 표현을 최대화함으로써<a class="quarto-xref" href="#eq-mixtures-factorizedlikelihood">방정식<span>4.4</span></a>,,,<span class="math inline">\ (\ mu_2 \)</span>그리고<span class="math inline">\ (\ sigma_2 \)</span>두 번째를 최대화함으로써<span class="math inline">\ (\ lambda \)</span>라벨의 경험적 주파수에서 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" href="#cb14-1" tabindex="-1"></a><span class="fu">Group_by</span>(dux, u)<span class="sc">|&gt;</span> <span class="fu">요약</span>(<span class="at">in =</span> <span class="fu">평균</span>(엑스),<span class="at">시그마 =</span> <span class="fu">SD</span>(엑스))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 2 × 3
      u mu sigma
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1-0.558 1.05
2 2 1.41 1.04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a><span class="fu">테이블</span>(Dux<span class="sc">$</span>유)<span class="sc">/</span> <span class="fu">nrow</span>(dux)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 
0.55 0.45</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mixprop">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.6</div>
</div>
<div class="callout-body-container callout-body">
<p>혼합 비율을 알고 있다고 가정 해 봅시다<span class="math inline">\ (\ lambda = \ frac {1} {2} \)</span>, 그러나<span class="math inline">\ (u_i \)</span>, 밀도가 이루어 지도록<span class="math inline">\ (\ frac {1} {2} \ phi_1 (x)+\ frac {1} {2} \ phi_2 (x) \)</span>. (로그) 가능성을 기록해보십시오. 여기에서 MLE를 명시 적으로 해결하지 못하게하는 것은 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-12-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-12-contents callout-collapse collapse" id="callout-12">
<div class="callout-body-container callout-body">
<p>예를 들어, 챕터를 참조하십시오<em>혼합 모델</em>~에<span class="citation" data-cites="CosmaShalizi2017">샬리 지 (Shalizi)<a href="16-chap.html#ref-CosmaShalizi2017" role="doc-biblioref">2017</a>))</span>정상의 유한 혼합 가능성의 계산. "혼합 모델을 추정하려고하면 사후 라벨 확률에 의해 제공되는 가중치와 함께 가중 최대 가능성을 수행하고 있습니다. 이는 반복하려면 추정하려는 매개 변수에 의존하므로 악순환이있는 것 같습니다."</p>
</div>
</div>
</div>
<p>많은 경우에 우리는 알지 못합니다<span class="math inline">\(유\)</span>라벨 또는 혼합물 비율. 우리가 할 수있는 일은 라벨에 대한 초기 추측으로 시작하고이를 알고, 위와 같이 매개 변수를 추정 한 다음 반복주기를 거치고, 각 단계에서 각 단계에서 라벨과 매개 변수에 대한 최상의 추측을 업데이트하여 더 이상 실질적으로 변경되지 않을 때까지 (즉, 수렴 될 때까지) 가능성에 도달 할 때까지.</p>
<p>실제로 우리는 더 정교한 일을하고 "하드"라벨을 대체 할 수 있습니다.<span class="math inline" data-anchor-id="eq-mixtures">\(유\)</span>각 관찰에 대해 (그룹 1 또는 2에 있습니다) 멤버십 가중치에 의해 최대 1입니다. 혼합 모델<a class="quarto-xref" href="#eq-mixtures-twonormals"><span>4.3</span></a>우리가 해석 할 것을 제안합니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-membershipweights"><span class="math display">\ [
w (x, 1) = \ frac {\ lambda \ phi_1 (x)} {\ lambda \ phi_1 (x)+(1- \ lambda) \ phi_2 (x)}
\ tag {4.5} \]</span></span></p>
<p>가치가있는 관찰 가능성<span class="math inline">\(엑스\)</span>첫 번째 혼합물 성분에 의해 생성되고 유사하게 생성되었다<span class="math inline">\ (w (x, 2) = 1 -w (x, 1) \)</span>두 번째 구성 요소의 경우. 다시 말해서<span class="math inline">\ (\ lambda \)</span>우리가 아직 보지 못한 관찰은 혼합 성분 1에서 나올 확률입니다.<span class="math inline">\ (w (x, 1) \)</span>우리가 그 가치를 관찰 한 후에 해당 후방 확률입니다.<span class="math inline">\(엑스\)</span>. 이것은 다음과 같은 반복 알고리즘을 시사합니다.</p>
<p><strong>E 단계</strong>: 그것을 가정합니다<span class="math inline" data-anchor-id="eq-mixtures">\ (\ theta \)</span>(즉, 평균, 표준 편차 및<span class="math inline">\ (\ lambda \)</span>)는 알려져 있습니다. 회원 가중치를 평가하십시오<a class="quarto-xref" href="#eq-mixtures-membershipweights"><span>4.5</span></a>.</p>
<p><strong>M 단계</strong>: 각 관찰의 멤버십 가중치가 주어졌습니다<span class="math inline">\ (x_i \)</span>, 새롭고 개선 된 최대 가능성 추정치를 결정하십시오<span class="math inline">\ (\ theta \)</span>.</p>
<p>까지 반복하십시오<span class="math inline">\ (\ theta \)</span>그리고 가능성은 수렴되었습니다. 이 시점에서 확인하십시오<a class="quarto-xref" href="#imp-mixtures-emstepbystep">운동<span>4.1</span></a>코드로 시연을 위해. 실제로이 알고리즘은 여기서 특정 응용 프로그램 예보다 훨씬 일반적입니다. 매우 읽기 쉬운 박람회가 제시됩니다<span class="citation" data-cites="Bishop:PRML">(<a href="16-chap.html#ref-Bishop:PRML" role="doc-biblioref">주교 2006</a>))</span>, 여기서 몇 가지 하이라이트 :</p>
<p>우리의 목표는 관찰 된 변수를 포함하는 확률 론적 모델의 한계 가능성을 극대화하는 것입니다.<span class="math inline">\(엑스\)</span>, 관찰되지 않은 변수<span class="math inline">\(유\)</span>그리고 일부 매개 변수<span class="math inline">\ (\ theta \)</span>. 간단한 예에서<span class="math inline">\(유\)</span>두 가지 가능한 값을 가진 범주 형 변수입니다<span class="math inline">\(엑스\)</span>실수. 일반적으로 둘 다<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(유\)</span>모든 가변 유형의 여러 개별 변수 (즉, 다변량이 될 수 있음)의 튜플 일 수 있습니다. 한계 가능성은 가능한 모든 가능한 값에 걸쳐 기대 (즉, 가중 평균)를 취함으로써 계산됩니다.<span class="math inline">\(유\)</span>:</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-marglike1"><span class="math display">\ [
l_ \ text {marg} (\ theta; x) =
\ int_u p (x, u \, | \, \ theta) \, \ text {d} u.
\ tag {4.6} \]</span></span></p>
<p>우리의 구체적인 예에서, 통합은 가능한 모든 멤버십 구성에 대해 평균적으로 (확률 적으로) 멤버십 가중치를 고려하여 가중 합계에 이르고</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-marglike2"><span class="math display">\ [
l_ \ text {marg} (\ theta; x) =
\ prod_ {i = 1}^n \ sum_ {u = 1}^2 p (x_i, u \, | \, \ theta) \, w (x_i, u \, | \, \ theta).
\ tag {4.7} \]</span></span></p>
<p>이 수량을 직접 최대화하는 것은 다루기 어려운 일입니다.</p>
<p>데이터와 현재 매개 변수 추정치가 주어지면 그립이있는 것<span class="math inline">\ (\ theta_t \)</span>, 잠재 변수의 조건부 분포입니다.<span class="math inline">\ (p (u \, | \, x, \ theta_t) \)</span>. 우리는 그것을 사용하여 완전한 데이터 로그 가능성의 기대를 찾을 수 있습니다.<span class="math inline">\ (\ log p (x, u \, | \, \ theta) \)</span>일반적인 매개 변수 값에 대해 평가했습니다<span class="math inline">\ (\ theta \)</span>. 이 기대는 종종 다음으로 표시됩니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-defQ"><span class="math display">\ [
q (\ theta, \ theta_t) = \ int_u \ log p (x, u \, | \, \ theta) \, p (u \, | \, x, \ theta_t) \, \ text {d} u.
\ tag {4.8} \]</span></span></p>
<p>M 단계에서는 수정 된 매개 변수 추정치를 결정합니다.<span class="math inline">\ (\ theta_ {t+1} \)</span>이 기능을 최대화하여</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-MstepwithQ"><span class="math display">\ [
\ theta_ {t+1} = \ arg \ max_ \ theta \, q (\ theta, \ theta_t).
\ tag {4.9} \]</span></span></p>
<p>E 단계는 컴퓨팅으로 구성됩니다<span class="math inline">\ (p (u \, | \, x, \ theta_t) \)</span>, 필수 성분<span class="math inline">\(큐\)</span>.</p>
<p>이 두 단계 (e와 m)는 개선이 작을 때까지 반복됩니다. 이것은 우리가 가능성의 평탄화에 가깝고 최대에 도달했다는 수치 적응증입니다. 반복 궤적이지만, 우리가 도착하는 지점이 아니라는 것은 출발점에 달려 있습니다. 이것은 산 꼭대기로 하이킹과 유사하며, 다른 장소에서 시작하여 다른 경로를 취할 수 있지만 항상 언덕 꼭대기로 이어집니다. 따라서 예방 조치로서, 다른 출발점에서 여러 번 그러한 절차를 반복하고 항상 동일한 답을 얻는 것이 좋습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mixtures-empackages">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.7</div>
</div>
<div class="callout-body-container callout-body">
<p>여러 R 패키지는 포함하여 EM 구현을 제공합니다<strong><a href="https://cran.r-project.org/web/packages/mclust/">mclust</a></strong>,,,<strong><a href="https://cran.r-project.org/web/packages/EMcluster/">emcluster</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/EMMIXskew/">Emmixskew</a></strong>. 하나를 선택하고 다른 시작 값으로 EM 함수를 여러 번 실행하십시오. 그런 다음 함수를 사용하십시오<code>Normalmixem</code>에서<strong><a href="https://cran.r-project.org/web/packages/mixtools/">믹스 툴</a></strong>출력을 비교하기위한 패키지.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-14-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-14-contents callout-collapse collapse" id="callout-14">
<div class="callout-body-container callout-body">
<p>여기서 우리는 출력을 보여줍니다<strong><a href="https://cran.r-project.org/web/packages/mixtools/">믹스 툴</a></strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"믹스 툴"</span>))</span>
<span id="cb18-2"><a aria-hidden="true" href="#cb18-2" tabindex="-1"></a>와이<span class="ot">=</span> <span class="fu">기음</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>,,,<span class="at">평균 =</span> <span class="sc">-</span><span class="fl">0.2</span>,,,<span class="at">SD =</span> <span class="fl">0.5</span>),)</span>
<span id="cb18-3"><a aria-hidden="true" href="#cb18-3" tabindex="-1"></a>      <span class="fu">rnorm</span>( <span class="dv">50</span>,,,<span class="at">평균 =</span>  <span class="fl">0.5</span>,,,<span class="at">SD =</span>   <span class="dv">1</span>)))</span>
<span id="cb18-4"><a aria-hidden="true" href="#cb18-4" tabindex="-1"></a>GM<span class="ot">=</span> <span class="fu">Normalmixem</span>(와이,<span class="at">k =</span> <span class="dv">2</span>,,,</span>
<span id="cb18-5"><a aria-hidden="true" href="#cb18-5" tabindex="-1"></a>                    <span class="at">람다 =</span> <span class="fu">기음</span>(<span class="fl">0.5</span>,,,<span class="fl">0.5</span>),)</span>
<span id="cb18-6"><a aria-hidden="true" href="#cb18-6" tabindex="-1"></a>                    <span class="at">in =</span> <span class="fu">기음</span>(<span class="sc">-</span><span class="fl">0.01</span>,,,<span class="fl">0.01</span>),)</span>
<span id="cb18-7"><a aria-hidden="true" href="#cb18-7" tabindex="-1"></a>                    <span class="at">시그마 =</span> <span class="fu">기음</span>(<span class="dv">3</span>,,,<span class="dv">3</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>반복 수 = 134</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a><span class="fu">~와 함께</span>(GM,<span class="fu">기음</span>(Lambda, Mu, Sigma, Loglik)))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9263 0.0737 -0.1859 1.9216 0.6134 0.4746 -170.5662</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>EM 알고리즘은 매우 유익합니다.</p>
<ol type="1">
<li><p>우리는 첫 번째 예를 보았습니다<em>부드러운</em>관찰이 한 그룹에 속하는지 여부를 결정하지 않지만 회원 확률을 가중치로 사용하여 여러 그룹에 참여할 수 있도록 평균화하여 더 미묘한 추정치를 얻습니다.<span class="citation" data-cites="Slonim:2005">(<a href="16-chap.html#ref-Slonim:2005" role="doc-biblioref">Sloom et al. 2005</a>))</span>.</p></li>
<li><p>그것은 더 간단한 문제를 해결함으로써 너무 많은 미지수로 어려운 문제를 해결할 수있는 방법을 보여줍니다.</p></li>
<li><p>숨겨진 변수가있는 데이터 생성 모델을 고려할 수 있었으며 여전히 매개 변수를 추정 할 수있었습니다. 우리는 숨겨진 변수의 값을 명시 적으로 칭찬하지 않고도 그렇게 할 수 있습니다.<a class="quarto-xref" href="#eq-mixtures-defQ">방정식<span>4.8</span></a>, 회원 확률에 의해 구체화. 이 기본 아이디어는 너무 강력하여 기계 학습에서 더 많은 고급 알고리즘의 시작점입니다.<span class="citation" data-cites="Bishop:PRML">(<a href="16-chap.html#ref-Bishop:PRML" role="doc-biblioref">주교 2006</a>))</span>.</p></li>
<li><p>모델 평균의보다 일반적인 경우로 확장 될 수 있습니다.<span class="citation" data-cites="hoeting1999">(<a href="16-chap.html#ref-hoeting1999" role="doc-biblioref">Hoeting et al. 1999</a>))</span>. 데이터와 관련이 있는지 확실하지 않은 경우 여러 모델을 동시에 고려하는 것이 때때로 유리할 수 있습니다. 우리는 그것들을 가중 모델로 결합 할 수 있습니다. 가중치는 모델의 가능성에 의해 제공됩니다.</p></li>
</ol>
</section>
</section>
<section class="level3 page-columns page-full" data-number="4.2.3" id="models-for-zero-inflated-data">
<h3 class="anchored" data-anchor-id="models-for-zero-inflated-data" data-number="4.2.3"><span class="header-section-number">4.2.3</span>팽창 된 데이터에 대한 모델</h3>
<p>생태 및 분자 데이터는 종종 수의 형태로 나옵니다. 예를 들어, 이것은 여러 위치 각각의 여러 종에서 각각의 개인 수일 수 있습니다. 이러한 데이터는 종종 두 가지 시나리오의 혼합으로 볼 수 있습니다. 종이 존재하지 않으면 수는 반드시 0이지만<em>만약에</em>종은 존재하며, 우리가 관찰하는 개인의 수는 다양하며, 무작위 샘플링 분포가 다양합니다. 이 분포에는 또한 0이 포함될 수 있습니다. 우리는 이것을 혼합물로 모델링합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-ihpqxnkvgazs" id="eq-ihpqxnkvgazs"><span class="math display">\ [
f _ {\ text {zi}} (x) = \ lambda \, \ delta (x) + (1- \ lambda) \, f _ {\ text {count}} (x),
\ tag {4.10} \]</span></span></p>
<p>어디<span class="math inline">\(\델타\)</span>Dirac의 델타 기능은 0에서 모든 질량을 가진 확률 분포를 나타냅니다. 첫 번째 혼합물 구성 요소의 제로를 "구조적"이라고합니다.이 예에서는 특정 종이 특정 서식지에 살지 않기 때문에 발생합니다. 두 번째 구성 요소,<span class="math inline">\ (f _ {\ text {count}} \)</span>단순히 임의의 샘플링으로 인해 0 및 기타 소수가 포함될 수 있습니다. R 패키지<strong><a href="https://cran.r-project.org/web/packages/pscl/">PSCL</a></strong> <span class="citation" data-cites="Zeileis:2008">(<a href="16-chap.html#ref-Zeileis:2008" role="doc-biblioref">Zeileis, Kleiber 및 Jackman 2008</a>))</span>그리고<strong><a href="https://cran.r-project.org/web/packages/zicounts/">zicounts</a></strong>작업을위한 많은 예와 기능을 제공하십시오<strong>제로 팽창</strong>계산.</p>
<section class="level4 unnumbered page-columns page-full" id="example-chip-seq-data">
<h4 class="unnumbered anchored" data-anchor-id="example-chip-seq-data">예 : Chip-Seq 데이터</h4>
<p>Chip-Seq 데이터의 예를 고려해 봅시다. 이들 데이터는 염색질 면역 침전 (ChIP)으로부터 얻은 DNA의 서열이다. 이 기술은 전사 인자, 뉴 클레오 솜, 히스톤 변형, 염색질 리모델링 효소, 샤페론, 폴리머 라제 및 기타 단백질의 게놈 DNA를 따라 위치의 매핑을 가능하게한다. DNA 요소 백과 사전 (Encode) 프로젝트에서 사용하는 주요 기술이었습니다. 여기서 우리는 예를 사용합니다<span class="citation" data-cites="Kuan2011statistical">(<a href="16-chap.html#ref-Kuan2011statistical" role="doc-biblioref">Kuan et al. 2011</a>))</span>에서<strong><a href="https://bioconductor.org/packages/mosaicsExample/">Mosaicsexample</a></strong>STAT1 단백질에 대한 항체의 ChIP-Seq에서 염색체 22에서 측정 된 데이터 및 GM12878 세포주에 적용되는 H3K4ME3 히스톤 변형에서 측정 된 데이터를 보여줍니다. 여기서 우리는<code>bintfbs</code>물체; 이 장의 소스 코드 파일에 표시되며 Vignette를 따릅니다.<strong><a href="https://bioconductor.org/packages/mosaics/">모자이크</a></strong>패키지.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" href="#cb22-1" tabindex="-1"></a>bintfbs</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>요약 : 빈 레벨 데이터 (클래스 : bindata)
------------------------------------------
- 데이터의 염색체의 # : 1
- 총 유효 태그 수 : 462479
  (모든 쓰레기통의 칩 태그 수의 합)
- 제어 샘플이 포함되어 있습니다
- 매핑 가능성 점수가 통합되지 않았습니다
-GC 컨텐츠 점수가 통합되지 않았습니다
- 단일 읽기가 가정됩니다
------------------------------------------</code></pre>
</div>
</div>
<p>이 객체에서 우리는 바인당 카운트의 히스토그램을 만들 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a>신성<span class="ot">=</span> <span class="fu">인쇄</span>(bintfbs)</span>
<span id="cb24-2"><a aria-hidden="true" href="#cb24-2" tabindex="-1"></a><span class="fu">ggplot</span>(신성한,<span class="fu">AES</span>(<span class="at">x =</span>tagcount))<span class="sc">+</span></span>
<span id="cb24-3"><a aria-hidden="true" href="#cb24-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,,,<span class="at">fill =</span> <span class="st">"포레스트 그린"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-chipseqzeros">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chipseqzeros-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="04-chap_files/figure-html/fig-chipseqzeros-1.png" title="Figure 4.8: The number of binding sites found in 200nt windows along chromosome 22 in a ChIP-Seq dataset."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-chipseqzeros-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chipseqzeros-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.8 : Chip-Seq 데이터 세트에서 염색체 22를 따라 200nt 창에서 발견 된 결합 부위의 수.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는<a class="quarto-xref" href="#fig-chipseqzeros">수치<span>4.8</span></a>비록이 플롯에서 다른 작은 수의 빈도를 고려할 때,이 플롯에서 0이 실제로 특별한 지에 대해서는 즉시 분명하지 않습니다.<span class="math inline">\ (1,2, ... \)</span>).</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-loghist">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.8</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>로그 기본 10 스케일을 사용하여 카운트의 히스토그램을 다시<span class="math inline">\(와이\)</span>-중심선.<br/>
</li>
<li>추정<span class="math inline">\ (\ pi_0 \)</span>, 제로 카운트가있는 빈의 비율.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-16-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-16-contents callout-collapse collapse" id="callout-16">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center" data-warning.known='["transformation introduced infinite values","rows containing missing values"]'>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a><span class="fu">ggplot</span>(신성한,<span class="fu">AES</span>(<span class="at">x =</span>tagcount))<span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb25-2"><a aria-hidden="true" href="#cb25-2" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,,,<span class="at">fill =</span> <span class="st">"포레스트 그린"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ChipseqHistlogY">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ChipseqHistlogY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="04-chap_files/figure-html/fig-ChipseqHistlogY-1.png" title="Figure 4.9: As Figure fig-chipseqzeros, but using a logarithm base 10 scale on the y-axis. The fraction of zeros seems elevated compared to that of ones, twos, …"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-ChipseqHistlogY-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ChipseqHistlogY-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.9 : AS<a class="quarto-xref" href="#fig-chipseqzeros">수치<span>4.8</span></a>, 그러나 로그베이스 10 스케일 사용<span class="math inline">\(와이\)</span>-중심선. 0의 분수는 Twos,…</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section class="level3 page-columns page-full" data-number="4.2.4" id="more-than-two-components">
<h3 class="anchored" data-anchor-id="more-than-two-components" data-number="4.2.4"><span class="header-section-number">4.2.4</span>두 개 이상의 구성 요소</h3>
<p>지금까지 우리는 두 구성 요소의 혼합물을 살펴 보았습니다. 우리는 더 많은 것이있을 수있는 경우에 설명을 확장 할 수 있습니다. 예를 들어, Deoxyribonucleotide Monophospates의 혼합물로부터 얻어진 n = 7,000 뉴클레오티드의 무게를 측정 할 때 (각 유형은 동일한 표준 편차 SD = 3으로 측정 된 다른 중량을 갖는다), 우리는 히스토그램을 관찰 할 수있다 (<a class="quarto-xref" href="#fig-nucleotideweights-1">수치<span>4.10</span></a>) 다음 코드에 의해 생성됩니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a>대중<span class="ot">=</span> <span class="fu">기음</span>(<span class="at">a =</span>  <span class="dv">331</span>,,,<span class="at">c =</span>  <span class="dv">307</span>,,,<span class="at">g =</span>  <span class="dv">347</span>,,,<span class="at">t =</span>  <span class="dv">322</span>))</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a>프로브<span class="ot">=</span> <span class="fu">기음</span>(<span class="at">a =</span> <span class="fl">0.12</span>,,,<span class="at">c =</span> <span class="fl">0.38</span>,,,<span class="at">g =</span> <span class="fl">0.36</span>,,,<span class="at">t =</span> <span class="fl">0.14</span>))</span>
<span id="cb26-3"><a aria-hidden="true" href="#cb26-3" tabindex="-1"></a>N<span class="ot">=</span> <span class="dv">7000</span></span>
<span id="cb26-4"><a aria-hidden="true" href="#cb26-4" tabindex="-1"></a>SD<span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb26-5"><a aria-hidden="true" href="#cb26-5" tabindex="-1"></a>핵<span class="ot">=</span> <span class="fu">견본</span>(<span class="fu">길이</span>(probs), n,<span class="at">교체 =</span> <span class="cn">진실</span>,,,<span class="at">prob =</span>프로브)</span>
<span id="cb26-6"><a aria-hidden="true" href="#cb26-6" tabindex="-1"></a>쿼드<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(nuclt),</span>
<span id="cb26-7"><a aria-hidden="true" href="#cb26-7" tabindex="-1"></a>                <span class="at">평균 =</span>질량 [nuclt],</span>
<span id="cb26-8"><a aria-hidden="true" href="#cb26-8" tabindex="-1"></a>                <span class="at">SD =</span>SD)</span>
<span id="cb26-9"><a aria-hidden="true" href="#cb26-9" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">Quadwts =</span>쿼드),<span class="fu">AES</span>(<span class="at">x =</span>쿼드))<span class="sc">+</span></span>
<span id="cb26-10"><a aria-hidden="true" href="#cb26-10" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">100</span>,,,<span class="at">fill =</span> <span class="st">"보라"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-nucleotideweights-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nucleotideweights-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="04-chap_files/figure-html/fig-nucleotideweights-1-1.png" title="Figure 4.10: Simulation of 7,000 nucleotide mass measurements."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-nucleotideweights-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nucleotideweights-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.10 : 7,000 개의 뉴클레오티드 질량 측정 시뮬레이션.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mixture4N">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.9</div>
</div>
<div class="callout-body-container callout-body">
<p>이 시뮬레이션 실험을 반복하십시오<span class="math inline">\ (n = 1000 \)</span>뉴클레오티드 측정. 히스토그램에서 무엇을 알 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mixture4NB">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.10</div>
</div>
<div class="callout-body-container callout-body">
<p>언제 일어날 지<span class="math inline">\ (n = 7000 \)</span>그러나 표준 편차는 10입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mixture4NC">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.11</div>
</div>
<div class="callout-body-container callout-body">
<p>시뮬레이션 된 분포에 대한 이론적 밀도 곡선을 플로팅하십시오.<a class="quarto-xref" href="#fig-nucleotideweights-1">수치<span>4.10</span></a>.</p>
</div>
</div>
<p>이 경우 충분한 정밀도로 충분한 측정이 있으므로 4 개의 뉴클레오티드를 구별하고 표시된 분포를 분해 할 수 있습니다.<a class="quarto-xref" href="#fig-nucleotideweights-1">수치<span>4.10</span></a>. 데이터가 적거나 시끄러운 측정이 적 으면 4 가지 모드와 분포 구성 요소가 덜 명확 할 수 있습니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="4.3" id="empirical-distributions-and-the-nonparametric-bootstrap">
<h2 class="anchored" data-anchor-id="empirical-distributions-and-the-nonparametric-bootstrap" data-number="4.3"><span class="header-section-number">4.3</span>경험적 분포 및 비모수 적 부트 스트랩</h2>
<p>이 섹션에서는 혼합 모델의 극단적 인 사례를 고려할 것입니다.<span class="math inline">\(N\)</span>혼합물로서의 데이터 포인트<span class="math inline">\(N\)</span>포인트 질량. 여기서는 거의 모든 데이터 세트를 사용할 수 있습니다. 구체적으로, 우리는 다윈을 사용합니다<em>Zea Mays</em>데이터<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>그는 15 쌍의 높이를 비교했습니다.<em>Zea Mays</em>식물 (15 자기 하이브리드 화 대 15 교차). 데이터는<strong><a href="https://cran.r-project.org/web/packages/HistData/">사냥</a></strong>패키지 및 우리는 15 가지 높이 차이의 분포를 플로팅합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>그들은 사촌 인 프랜시스 골튼에게 그들을 분석 해달라고 요청한 다윈에 의해 수집되었습니다. R.A. Fisher는 페어링 된 T- 검정을 사용하여 동일한 데이터를 다시 분석했습니다<span class="citation" data-cites="bulmer2003">(<a href="16-chap.html#ref-bulmer2003" role="doc-biblioref">Bulmer 2003</a>))</span>. 우리는이 예로 돌아갈 것입니다<a class="quarto-xref" href="13-chap.html"><span>13 장</span></a>.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"히스 다타"</span>))</span>
<span id="cb27-2"><a aria-hidden="true" href="#cb27-2" tabindex="-1"></a>Zemasys<span class="sc">$</span>차이</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.125 -8.375 1.000 2.000 0.750 2.875 3.500 5.125 1.750 3.625
[11] 7.000 3.000 9.375 7.500 -6.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a><span class="fu">ggplot</span>(Zemasys,<span class="fu">AES</span>(<span class="at">x =</span>diff,<span class="at">ymax =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>,,,<span class="at">ymin =</span> <span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb29-2"><a aria-hidden="true" href="#cb29-2" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="at">linewidth =</span> <span class="dv">1</span>,,,<span class="at">col =</span> <span class="st">"포레스트 그린"</span>))<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="dv">0</span>,,,<span class="fl">0.1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ecdfZea">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ecdfZea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="04-chap_files/figure-html/fig-ecdfZea-1.png" title="Figure 4.11: The observed sample can be seen as a mixture of point masses at each of the values (real point masses would be bars without any width whatsoever)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-ecdfZea-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ecdfZea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.11 : 관찰 된 샘플은 각 값에서 점 질량의 혼합물로 볼 수 있습니다 (실제 점 질량은 폭이없는 막대가 될 것입니다).</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="03-chap.html#sec-graphics-ecdf"><span>섹션 3.6.7</span></a>우리는 크기 샘플에 대한 경험적 누적 분포 함수 (ECDF)가<span class="math inline">\(N\)</span>~이다</p>
<p><span class="anchored-eq" data-anchor-id="eq-Mix" id="eq-Mix-ecdf"><span class="math display">\ [
\ hat {f} _n (x) = \ frac {1} {n} \ sum_ {i = 1}^n {\ mathbb 1} _ {x \ leq x_i},
\ tag {4.11} \]</span></span></p>
<p>그리고 우리는 ECDF 음모를 보았습니다<a class="quarto-xref" href="03-chap.html#fig-graphics-onedecdf">수치<span>3.24</span></a>. 우리는 또한 쓸 수 있습니다<em>밀도</em>우리의 샘플의</p>
<p><span class="anchored-eq" data-anchor-id="eq-Mix" id="eq-Mix-eden"><span class="math display">\ [
\ hat {f} _n (x) = \ frac {1} {n} \ sum_ {i = 1}^n \ delta_ {x_i} (x)
\ tag {4.12} \]</span></span></p>
<div class="page-columns page-full"><p>일반적으로, 확률 분포의 밀도는 분포 함수의 미분 (존재하는 경우)이다. 우리는이 원칙을 여기에 적용했습니다.<a class="quarto-xref" href="#eq-Mix-ecdf">방정식<span class="anchored-eq" data-anchor-id="eq-Mix">4.11</span></a>~이다<a class="quarto-xref" href="#eq-Mix-eden">방정식<span>4.12</span></a>. 기능을 고려할 수 있으므로이 작업을 수행 할 수 있습니다.<span class="math inline">\ (\ delta_a \)</span>단계 함수의 "미분"<span class="math inline">\ ({\ mathbb 1} _ {x \ leq a} \)</span>: 한 지점을 제외하고는 거의 모든 곳에서 완전히 평평합니다.<span class="math inline">\(에이\)</span>단계가있는 곳과 그 가치가 "무한"인 경우.<a class="quarto-xref" href="#eq-Mix-eden">방정식<span>4.12</span></a>우리의 데이터 샘플은 혼합물로 간주 될 수 있음을 강조합니다.<span class="math inline">\(N\)</span> <strong>포인트 질량</strong>관찰 된 값에서<span class="math inline">\ (x_1, x_2, ..., x_ {n} \)</span>,<a class="quarto-xref" href="#fig-ecdfZea">수치<span>4.11</span></a>.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">이것이 의미가있는 데 필요한 약간의 고급 수학 (표준 미적분학을 넘어서)이 있지만 여기서는 치료의 범위를 벗어납니다.</span></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-samplingdist">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-samplingdist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="imgs/BootstrapPrincipleNew.png" title="Figure 4.12: The value of a statistic \tau is estimated from data (the grey matrices) generated from an underlying distribution F. Different samples from F lead to different data, and so to different values of the estimate \hat{\tau}: this is called sampling variability. The distribution of all the \hat{\tau}’s is the sampling distribution."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BootstrapPrincipleNew.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-samplingdist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.12 : 통계의 값<span class="math inline">\ (\ 예 \)</span>기본 분포에서 생성 된 데이터 (회색 행렬)에서 추정됩니다.<span class="math inline">\(에프\)</span>. 다른 샘플<span class="math inline">\(에프\)</span>다른 데이터로 이어지고 추정치의 다른 값으로 이어집니다.<span class="math inline">\ (\ hat {\ numbers} \)</span>: 이것은 호출됩니다<strong>샘플링 변동성</strong>. 모든의 분포<span class="math inline">\ (\ hat {\ numbers} \)</span>S는입니다<strong>샘플링 분포</strong>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>평균, 최소 또는 중앙값과 같은 샘플의 통계는 이제 ECDF의 함수로 작성할 수 있습니다.<span class="math inline">\ (\ bar {x} = \ int \ delta_ {x_i} (x) \, \ text {d} x \)</span>. 다른 예로, if<span class="math inline">\(N\)</span>홀수이고 중앙값은입니다<span class="math inline">\ (x _ {(\ frac {n+1} {2})} \)</span>, 주문 목록의 중간에있는 값.</p>
<p>진실<strong>샘플링 분포</strong>통계의<span class="math inline">\ (\ hat {\ numbers} \)</span>통계를 계산하기 위해 많은 다른 데이터 샘플이 필요하기 때문에 종종 알기가 어렵습니다. 이것은 표시됩니다<a class="quarto-xref" href="#fig-samplingdist">수치<span>4.12</span></a>.</p>
<p>그만큼<strong>부트 스트랩</strong>원칙은 진정한 샘플링 분포를 근사화합니다<span class="math inline">\ (\ hat {\ numbers} \)</span>원래 샘플에서 구축 된 경험적 분포에서 그려진 새로운 샘플을 만들어<a class="quarto-xref" href="#fig-bootpple">수치<span>4.13</span></a>). 우리<em>재사용</em>데이터 (혼합물 분포를 고려함으로써<span class="math inline">\(\델타\)</span>s) 샘플을 가져 와서 통계의 샘플링 분포를 검토하여 새로운 "데이터 세트"를 생성합니다.<span class="math inline">\ (\ hat {\ number} ^ * \)</span>그들에게 계산되었습니다. 이것을<strong>비모수 적 부트 스트랩</strong>리 샘플링 접근 방식, 참조<span class="citation" data-cites="Efron:1994">Bradley Efron과 Tibshirani (<a href="16-chap.html#ref-Efron:1994" role="doc-biblioref">1994</a>))</span>완전한 참조. 아무리 복잡한 통계에 관계없이 기본적으로 모든 통계에 적용 할 수있는 매우 다재다능하고 강력한 방법입니다. 이 방법의 예제 응용 프로그램, 특히 클러스터링에 대한 예제를 볼 수 있습니다.<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-bootpple">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bootpple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="imgs/BootstrapPrinciple2New.png" title="Figure 4.13: The bootstrap simulates the sampling variability by drawing samples not from the underlying true distribution F (as in Figure fig-samplingdist), but from the empirical distribution function \hat{F}_n."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BootstrapPrinciple2New.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bootpple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.13 : 부트 스트랩은 기본 진정한 분포에서 샘플을 그려 샘플링 변동성을 시뮬레이션합니다.<span class="math inline">\(에프\)</span>(에서와 같이<a class="quarto-xref" href="#fig-samplingdist">수치<span>4.12</span></a>), 그러나 경험적 분포 함수에서<span class="math inline">\ (\ hat {f} _n \)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>이러한 아이디어를 사용하여 Zea Mays 차이의 중앙값의 샘플링 분포를 추정 해 보겠습니다.<a class="quarto-xref" href="#fig-ecdfZea">수치<span>4.11</span></a>. 우리는 이전 섹션의 시뮬레이션과 유사한 시뮬레이션을 사용합니다.<span class="math inline">\ (b = 1000 \)</span>15 값으로부터 크기 15의 샘플 (각각 15 개 성분 혼합물의 구성 요소). 그런 다음 15 값 의이 샘플 각각의 1000 중앙값을 계산하고 분포를 살펴 봅니다. 이것은 중앙값의 부트 스트랩 샘플링 분포입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a>비<span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb30-2"><a aria-hidden="true" href="#cb30-2" tabindex="-1"></a>약<span class="ot">=</span> <span class="fu">뒤로 젖히다</span>(b, {</span>
<span id="cb30-3"><a aria-hidden="true" href="#cb30-3" tabindex="-1"></a>나<span class="ot">=</span> <span class="fu">견본</span>(<span class="dv">15</span>,,,<span class="dv">15</span>,,,<span class="at">교체 =</span> <span class="cn">진실</span>))</span>
<span id="cb30-4"><a aria-hidden="true" href="#cb30-4" tabindex="-1"></a>  <span class="fu">중앙값</span>(Zemasys<span class="sc">$</span>diff [i])</span>
<span id="cb30-5"><a aria-hidden="true" href="#cb30-5" tabindex="-1"></a>})</span>
<span id="cb30-6"><a aria-hidden="true" href="#cb30-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">중앙값 =</span>Meds),<span class="fu">AES</span>(<span class="at">x =</span>중앙값))))<span class="sc">+</span></span>
<span id="cb30-7"><a aria-hidden="true" href="#cb30-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">30</span>,,,<span class="at">fill =</span> <span class="st">"보라"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-bootmedian">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bootmedian-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="04-chap_files/figure-html/fig-bootmedian-1.png" title="Figure 4.14: The bootstrap sampling distribution of the median of the Zea Mays differences."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-bootmedian-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bootmedian-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.14 : Zea Mays 차이의 중앙값의 부트 스트랩 샘플링 분포.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-ci99">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.12</div>
</div>
<div class="callout-body-container callout-body">
<p>이러한 시뮬레이션을 기반으로 중앙값에 대한 99% 신뢰 구간을 추정하십시오. 이 간격과 0 사이의 중첩을 보면 무엇을 결론을 내릴 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-bootci99">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.13</div>
</div>
<div class="callout-body-container callout-body">
<p>사용하십시오<strong><a href="https://cran.r-project.org/web/packages/bootstrap/">부트 스트랩</a></strong>함수를 사용하여 동일한 분석을 다시 만들기위한 패키지<code>부트 스트랩</code>둘 다<code>중앙값</code>그리고<code>평균</code>. 평균의 샘플링 분포와 중앙값간에 어떤 차이가 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-22-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-22-contents callout-collapse collapse" id="callout-22">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"부트 스트랩"</span>))</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a><span class="fu">부트 스트랩</span>(Zemasys<span class="sc">$</span>diff, b, mean)</span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a><span class="fu">부트 스트랩</span>(Zemasys<span class="sc">$</span>diff, b, median)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="why-nonparametric">
<h4 class="unnumbered anchored" data-anchor-id="why-nonparametric">왜 비모수 적인가?</h4>
<p>이론적 통계에서, 비모수 적 방법은 무한히 많은 자유도 또는 알려지지 않은 매개 변수를 가진 방법입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="imgs/devil.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p>실제로, 우리는 무한대를 기다리지 않습니다. 매개 변수 수가 사용 가능한 데이터 양보다 크거나 크게되면이 방법이 비모수 적이라고 말합니다. 부트 스트랩은 혼합물을 사용합니다<span class="math inline">\(N\)</span>구성 요소, 크기 샘플이 있습니다<span class="math inline">\(N\)</span>, 그것은 비모수 적 방법으로 자격이 있습니다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">그들의 이름에도 불구하고, 비모수 적 방법은 매개 변수를 사용하지 않는 방법이 아닙니다. 모든 통계적 방법은 알 수없는 수량을 추정합니다.</span></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-boothowmany">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.14</div>
</div>
<div class="callout-body-container callout-body">
<p>샘플이 구성된 경우<span class="math inline">\ (n = 3 \)</span>다른 값, 몇 개의 다른 부트 스트랩 리 샘플이 가능합니까? 같은 질문에 대답하십시오<span class="math inline">\ (n = 15 \)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-24-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-24-contents callout-collapse collapse" id="callout-24">
<div class="callout-body-container callout-body">
<p>모든 부트 스트랩 리 샘플의 세트는 모든 벡터 세트와 동일합니다.<span class="math inline">\(N\)</span>합계의 정수<span class="math inline">\(N\)</span>. 다음을 나타냅니다<span class="math inline">\ mathbf {k} = (k_1, k_2,…, k_n) \</span>관찰의 횟수<span class="math inline">\ (x_1, x_2, ..., x_n \)</span>부트 스트랩 샘플에서 발생합니다. 우리는 각각을 생각할 수 있습니다<span class="math inline">\ (k_i \)</span>상자로 (다중 분포에서와 같이)<span class="math inline">\(N\)</span>떨어질 상자<span class="math inline">\(N\)</span>불알. 분리 방법의 수를 계산하여 구성 수를 계산할 수 있습니다.<span class="math inline">\(N\)</span>상자에 공, 즉 글을 쓰는 것<span class="math inline">\(N\)</span>시간 an<code>영형</code>(공을 위해) 및<span class="math inline">\ (n-1 \)</span>분리기를 시간에<code>|</code>그들 사이. 그래서 우리는 가지고 있습니다<span class="math inline">\ (2N-1)</span>우리가 선택 해야하는 위치<code>영형</code>(공) 또는<code>|</code>(분리기). 을 위한<span class="math inline">\ (n = 3 \)</span>, 가능한 배치가 될 것입니다<code>예 || 영형</code>, 이는에 해당합니다<span class="math inline">\ (\ mathbf {k} = (2,0,1) \)</span>. 일반적 으로이 숫자는입니다<span class="math inline">\ ({2n-1} \ 선택 {n-1} \)</span>따라서 답변<span class="math inline">\ (n = 3 \)</span>그리고<span class="math inline">\ (15 \)</span>이다:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a><span class="fu">기음</span>(<span class="at">n3 =</span> <span class="fu">선택하다</span>(<span class="dv">5</span>,,,<span class="dv">3</span>),)<span class="at">n15 =</span> <span class="fu">선택하다</span>(<span class="dv">29</span>,,,<span class="dv">15</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>N3 N15 
      10 77558760</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-errortypes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.15</div>
</div>
<div class="callout-body-container callout-body">
<p>부트 스트랩을 사용할 때 발생할 수있는 두 가지 유형의 오류는 무엇입니까?<strong><a href="https://cran.r-project.org/web/packages/bootstrap/">부트 스트랩</a></strong>패키지? 그 중 하나를 개선하기 위해 어떤 매개 변수를 수정할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-26-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-26-contents callout-collapse collapse" id="callout-26">
<div class="callout-body-container callout-body">
<p>철저한 부트 스트랩을 무작위로 리샘플링하여 데이터 하위 세트의 Monte Carlo 시뮬레이션<span class="citation" data-cites="Diaconis1994">(<a href="16-chap.html#ref-Diaconis1994" role="doc-biblioref">집사와 홈즈 1994</a>))</span>. 크기의 증가<code>NBOOT</code>인수<code>부트 스트랩</code>함수는 Monte Carlo 오류를 줄이지 만 철저한 부트 스트랩은 여전히 ​​정확하지 않습니다. 우리는 여전히 실제 분포 대신 데이터의 대략적인 분포 함수를 사용하고 있습니다. 샘플 크기가 작거나 원래 샘플 바이어스 된 경우, 우리가 아무리 크게 선택하더라도 근사치는 여전히 가난 할 수 있습니다.<code>NBOOT</code>.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="4.4" id="infinite-mixtures">
<h2 class="anchored" data-anchor-id="infinite-mixtures" data-number="4.4"><span class="header-section-number">4.4</span>무한 혼합물</h2>
<p>때로는 혼합물이 각 관찰에 라벨을 할당하지 않거나 관찰이있는 것처럼 많은 '라벨'을 허용하는 경우 다르게 배치하려는 경우에도 혼합물이 유용 할 수 있습니다. 혼합물 성분의 수가 관찰 수보다 크거나 더 큰 경우<strong>무한 혼합물</strong>. 몇 가지 예를 살펴 보겠습니다.</p>
<section class="level3 page-columns page-full" data-number="4.4.1" id="infinite-mixture-of-normals">
<h3 class="anchored" data-anchor-id="infinite-mixture-of-normals" data-number="4.4.1"><span class="header-section-number">4.4.1</span>정상의 무한한 혼합</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-LaplacePortrait">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-LaplacePortrait-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="imgs/LaplacePortrait_web.png" title="Figure 4.15: Laplace knew already that the probability density f_X(y)=\frac{1}{2\phi}\exp\left(-\frac{|y-\theta|}{\phi}\right),\qquad\phi&gt;0 has the median as its location parameter \theta and the median absolute deviation (MAD) as its scale parameter \phi."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/LaplacePortrait_web.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LaplacePortrait-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.15 : Laplace는 이미 확률 밀도를 알고있었습니다<span class="math display">\ [f_x (y) = \ frac {1} {2 \ phi} \ exp \ left (-\ frac {| y- \ theta |} {\ phi} \ 오른쪽), \ qquad \ phi&gt; 0 \]</span>위치 매개 변수로 중앙값이 있습니다<span class="math inline">\ (\ theta \)</span>그리고 스케일 매개 변수로서 중간 절대 편차 (MAD)<span class="math inline">\ (\ phi \)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>다음 2 단계 데이터 생성 체계를 고려하십시오.</p>
<p><strong>레벨 1</strong>샘플을 만듭니다<code>w</code>지수 분포에서 S.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a>w<span class="ot">=</span> <span class="fu">Rexp</span>(<span class="dv">10000</span>,,,<span class="at">속도 =</span> <span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p><strong>레벨 2</strong>그만큼<span class="math inline">\ (w \)</span>s는 평균의 정상 변수의 차이로 사용됩니다.<span class="math inline">\ (\ 안에 \)</span>사용을 생성합니다<code>rnorm</code>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>무<span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a>LPS<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(w),<span class="at">평균 =</span>안에,<span class="at">SD =</span> <span class="fu">sqrt</span>(W))</span>
<span id="cb35-3"><a aria-hidden="true" href="#cb35-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">데이터. 프레임</span>(LPS),<span class="fu">AES</span>(<span class="at">x =</span>LPS))<span class="sc">+</span></span>
<span id="cb35-4"><a aria-hidden="true" href="#cb35-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"보라"</span>,,,<span class="at">binwidth =</span> <span class="fl">0.1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Laplacedistribution">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Laplacedistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="04-chap_files/figure-html/fig-Laplacedistribution-1.png" title="Figure 4.16: Data sampled from a Laplace distribution."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-Laplacedistribution-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Laplacedistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.16 : 라플라스 분포에서 샘플링 된 데이터.</figcaption>
</figure>
</div>
</div></div></div>
<p>이것은 다소 유용한 분포로 밝혀졌습니다. 그것은 잘 이해 된 속성을 가지고 있으며 Laplace의 이름을 따서 명명되었습니다. Laplace는 중앙값이 위치 매개 변수의 좋은 추정기임을 증명했습니다.<span class="math inline">\ (\ theta \)</span>중간 절대 편차는 스케일 매개 변수를 추정하는 데 사용될 수 있습니다.<span class="math inline">\ (\ phi \)</span>. 캡션의 공식에서<a class="quarto-xref" href="#fig-LaplacePortrait">수치<span>4.15</span></a>우리는 그것을 봅니다<span class="math inline">\ (l_1 \)</span>거리 (차이의 절대 값)는 라플라스 밀도에서 비슷한 위치를 유지합니다.<span class="math inline">\ (l_2 \)</span>(차이의 제곱) 정상 밀도를 위해 수행합니다.</p>
<p>반대로 베이지안 회귀에서<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>, 계수에 대한 사전으로 라플라스 분포를 갖는다.<span class="math inline">\ (l_1 \)</span>페널티,<em>올가미</em> <span class="citation" data-cites="Tibshirani1996">(<a href="16-chap.html#ref-Tibshirani1996" role="doc-biblioref">의료 1996</a>))</span>, 이전의 정규 분포는<span class="math inline">\ (l_2 \)</span>Ridge 회귀라고 불리는 페널티.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>이에 익숙하지 않은 경우 걱정하지 마십시오.이 경우이 문장을 건너 뛰십시오.</p></div></div><div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-Laplacemixt">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.16</div>
</div>
<div class="callout-body-container callout-body">
<p>정상 및 지수 랜덤 변수의 함수로서 분포가 대칭 라플라스 인 랜덤 변수를 작성하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-28-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-28-contents callout-collapse collapse" id="callout-28">
<div class="callout-body-container callout-body">
<p>지수 변수로 생성 된 차이로 계층 적 모델을 쓸 수 있습니다.<span class="math inline">\ (w \)</span>, 처럼:</p>
<p><span class="anchored-eq" data-anchor-id="eq-uqxjoanhtgbs" id="eq-uqxjoanhtgbs"><span class="math display">\ [
x = \ sqrt {w} \ cdot z, \ qquad w \ sim exp (1), \ qquad z \ sim n (0,1).
\ tag {4.13} \]</span></span></p>
</div>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="asymmetric-laplace">
<h4 class="unnumbered anchored" data-anchor-id="asymmetric-laplace">비대칭 라플라스</h4>
<p>라플라스 분포에서 정상 구성 요소의 차이는<span class="math inline">\ (w \)</span>, 수단은 영향을받지 않습니다. 유용한 확장자는 다른 매개 변수를 추가합니다<span class="math inline">\ (\ theta \)</span>구성 요소의 위치 또는 중심을 제어합니다. 우리는 데이터를 생성합니다<code>알프스 산맥</code>계층 적 모델에서<span class="math inline">\ (w \)</span>지수 변수; 표시된 출력<a class="quarto-xref" href="#fig-ALaplacedistribution">수치<span>4.17</span></a>정상의 히스토그램입니다<span class="math inline">\ (n (\ theta + w \ mu, \ sigma w) \)</span>랜덤 숫자, 여기서<span class="math inline">\ (w \)</span>자체는 평균 지수 분포에서 무작위로 생성되었습니다.<span class="math inline">\ (1 \)</span>코드에 표시된대로 :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a>무<span class="ot">=</span> <span class="fl">0.3</span>; 시그마<span class="ot">=</span> <span class="fl">0.4</span>; 세타<span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a>w<span class="ot">=</span> <span class="fu">Rexp</span>(<span class="dv">10000</span>,,,<span class="dv">1</span>))</span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a>알프스 산맥<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(w), 세타<span class="sc">+</span>무<span class="sc">*</span>w, 시그마<span class="sc">*</span> <span class="fu">sqrt</span>(W))</span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(알프스 산맥),<span class="fu">AES</span>(<span class="at">x =</span>알프스 산맥))<span class="sc">+</span></span>
<span id="cb36-5"><a aria-hidden="true" href="#cb36-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"보라"</span>,,,<span class="at">binwidth =</span> <span class="fl">0.1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ALaplacedistribution">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ALaplacedistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="04-chap_files/figure-html/fig-ALaplacedistribution-1.png" title="Figure 4.17: Histogram of data generated from an asymmetric Laplace distribution – a scale mixture of many normals whose means and variances are dependent. We write X \sim AL(\theta, \mu, \sigma)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-ALaplacedistribution-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ALaplacedistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.17 : 비대칭 라플라스 분포에서 생성 된 데이터의 히스토그램 - 평균과 분산이 의존하는 많은 정상의 스케일 혼합물입니다. 우리는 글을 씁니다<span class="math inline">\ (x \ sim al (\ theta, \ sigma) \)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>데이터의 모든 인스턴스에 고유 한 평균 및 분산이있는 이러한 계층 적 혼합 분포는 많은 생물학적 환경에서 유용한 모델입니다. 예제가 표시됩니다<a class="quarto-xref" href="#fig-promoterlengthsandexpression">수치<span>4.18</span></a>.</p>
<div class="quarto-layout-panel page-columns page-full" id="fig-promoterlengthsandexpression">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-promoterlengthsandexpression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-promoterlengthsandexpression" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-promoterlengthsandexpression-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-promoterlengthsandexpression-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-promoterlengthsandexpression" href="imgs/LaplaceMixturePromoterLengths.png" title="Figure 4.18 (a): The lengths of the promoters shorter than 2000bp from Saccharomyces cerevisiae as studied by @Kristiansson2009."><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-promoterlengthsandexpression" src="imgs/LaplaceMixturePromoterLengths.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-promoterlengthsandexpression-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(a) 연구대로 Saccharomyces cerevisiae의 2000bp보다 짧은 프로모터의 길이<span class="citation" data-cites="Kristiansson2009">Kristiansson et al. (<a href="16-chap.html#ref-Kristiansson2009" role="doc-biblioref">2009 년</a>))</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-promoterlengthsandexpression" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-promoterlengthsandexpression-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-promoterlengthsandexpression-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-promoterlengthsandexpression" href="imgs/tcellhist.png" title="Figure 4.18 (b): The log-ratios of microarray gene expression measurements for 20,000 genes [@Purdom2005]."><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-promoterlengthsandexpression" src="imgs/tcellhist.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-promoterlengthsandexpression-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(b) 20,000 유전자에 대한 마이크로 어레이 유전자 발현 측정의 로그-비율<span class="citation" data-cites="Purdom2005">(<a href="16-chap.html#ref-Purdom2005" role="doc-biblioref">Purdom and Holmes 2005</a>))</span>.
</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-promoterlengthsandexpression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.18 : 실제 데이터의 히스토그램. 두 분포 모두 비대칭 라플라스 분포로 모델링 할 수 있습니다.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-logratio">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.17</div>
</div>
<div class="callout-body-container callout-body">
<p>마이크로 어레이에서 유전자 발현 값의 로그-율을 보면 오른쪽에 표시된대로 분포를 얻습니다.<a class="quarto-xref" href="#fig-promoterlengthsandexpression">수치<span>4.18</span></a>. 데이터 에이 형식의 히스토그램이 있다고 어떻게 설명 할 것인가?</p>
</div>
</div>
<p>Laplace 분포는 생성 프로세스의 고려가 분산과 평균이 어떻게 연결되는지를 나타내는 위치의 예입니다. 비대칭 라플라스 분포의 기대 값과 분산<span class="math inline">\ (al (al, \ mu, \ sigma) \)</span>~이다</p>
<p><span class="anchored-eq" data-anchor-id="eq-kimxbflrcdgn" id="eq-kimxbflrcdgn"><span class="math display">\ [
e (x) = \ theta+\ mu \ quad \ quad \ text {and} \ quad \ quad \ text {var} (x) = \ sigma^2+\ mu^2.
\ tag {4.14} \]</span></span></p>
<p>주목은 평균에 따라 다릅니다<span class="math inline">\ (\ in = 0 \)</span>(대칭 라플라스 분포의 경우). 이것이 유용한 분포의 특징입니다. 평균 분산 의존성을 갖는 것은 물리적 측정에서 매우 일반적입니다. 마이크로 어레이 형광 강도, 질량 분석기의 피크 높이 또는 고 처리량 시퀀싱의 수를 읽습니다.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="4.4.2" id="infinite-mixtures-of-poisson-variables.">
<h3 class="anchored" data-anchor-id="infinite-mixtures-of-poisson-variables." data-number="4.4.2"><span class="header-section-number">4.4.2</span>포아송 변수의 무한 혼합물.</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-three-worlds-web">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-three-worlds-web-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-23" href="imgs/three-worlds_web.jpg" title="Figure 4.19: How to count the fish in a lake? MC Escher."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/three-worlds_web.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-three-worlds-web-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.19 : 호수에서 물고기를 세는 방법? MC Escher.</figcaption>
</figure>
</div>
</div></div></div>
<p>실제 계수 데이터를 모델링하기 위해서는 유사한 2 단계 계층 모델도 종종 필요합니다. 하위 수준에서 간단한 포아송 및 이항 분포는 빌딩 블록 역할을하지만 매개 변수는 일부 기본 (잠재적) 프로세스에 따라 다를 수 있습니다. 예를 들어 생태학에서 우리는 지역의 모든 호수에서 어종의 변형에 관심이있을 수 있습니다. 우리는 각 호수의 어류 종을 샘플링하여 진정한 풍요를 추정하며, 이는 포아송에 의해 모델링 될 수 있습니다. 그러나 진정한 풍요는 호수마다 다를 것입니다. 예를 들어, 기후 또는 고도의 변화가 역할을하는지 여부를보고 싶다면, 우리는 무작위 호수마다 변동에서 그러한 체계적인 영향을 풀어야합니다. 다른 포아송 속도 매개 변수<span class="math inline">\ (\ lambda \)</span>요금 분포에서 오는 것으로 모델링 할 수 있습니다. 이러한 계층 적 모델은 또한 계층 구조에 보충 단계를 추가 할 수 있습니다. 예를 들어, 우리는 다양한 유형의 물고기, 모델 고도 및 기타 환경 요인 등에 관심을 가질 수 있습니다.</p>
<p>포아송 변수의 혼합물에 의해 잘 모델링 된 샘플링 체계의 추가 예에는 RNA-Seq와 같은 고 처리량 시퀀싱의 응용이 포함되며, 이는 우리가 자세히 다룰 것입니다.<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>미생물 생태학에 사용되는 16S rRNA-seq 데이터.</p>
</section>
<section class="level3 page-columns page-full" data-number="4.4.3" id="sec-gammadist">
<h3 class="anchored" data-anchor-id="sec-gammadist" data-number="4.4.3"><span class="header-section-number">4.4.3</span>감마 분포 : 두 매개 변수 (모양과 스케일)</h3>
<p>이제 우리는 이전에 보지 못한 새로운 배포를 알게되었습니다. 감마 분포는 (1 개의 파라미터) 지수 분포의 확장이지만 두 개의 매개 변수가있어보다 유연합니다. 계층 적 모델의 상위 레벨의 빌딩 블록으로 종종 유용합니다. 감마 분포는 긍정적 인 값과 연속적입니다. 지수의 밀도는 최대값이 0이고 값이 무한대로 이동함에 따라 단순히 0으로 감소하지만 감마 분포의 밀도는 유한 값에서 최대 값을 갖습니다. 시뮬레이션 예제로 살펴 보겠습니다. 히스토그램<a class="quarto-xref" href="#fig-gammahist1">수치<span>4.20</span></a>다음과 같은 코드 라인에 의해 생성되었습니다.</p>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">x =</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>,,,<span class="at">모양 =</span> <span class="dv">2</span>,,,<span class="at">속도 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a>   <span class="fu">AES</span>(<span class="at">x =</span>엑스))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">100</span>,,,<span class="at">fill =</span> <span class="st">"보라"</span>))</span>
<span id="cb37-3"><a aria-hidden="true" href="#cb37-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">x =</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>,,,<span class="at">모양 =</span> <span class="dv">10</span>,,,<span class="at">속도 =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)),</span>
<span id="cb37-4"><a aria-hidden="true" href="#cb37-4" tabindex="-1"></a>   <span class="fu">AES</span>(<span class="at">x =</span>엑스))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">100</span>,,,<span class="at">fill =</span> <span class="st">"보라"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-gammahist1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gammahist1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gammahist1" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-gammahist1-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-gammahist1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-gammahist1" href="04-chap_files/figure-html/fig-gammahist1-1.png" title="Figure 4.20 (a): gamma(2,\frac{1}{3})"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-gammahist1" src="04-chap_files/figure-html/fig-gammahist1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gammahist1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(a) 감마<span class="math inline">\ ((2, \ frac {1} {3}) \)</span>
</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gammahist1" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-gammahist1-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-gammahist1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-gammahist1" href="04-chap_files/figure-html/fig-gammahist1-2.png" title="Figure 4.20 (b): gamma(10,\frac{3}{2})"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-gammahist1" src="04-chap_files/figure-html/fig-gammahist1-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gammahist1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(b) 감마<span class="math inline">\ ((10, \ frac {3} {2}) \)</span>
</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gammahist1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.20 : 감마 분포의 무작위 샘플의 히스토그램. 감마는 유연한 두 매개 변수 분포입니다.<a href="http://en.wikipedia.org/wiki/Gamma_distribution">Wikipedia를 참조하십시오</a>.
</figcaption>
</figure>
</div>
<section class="level4 unnumbered page-columns page-full" id="sec:gammapoisson">
<h4 class="unnumbered anchored" data-anchor-id="sec:gammapoisson">감마 - 파이슨 혼합물 : 계층 적 모델</h4>
<ol type="1">
<li><p>매개 변수 세트를 생성합니다.<span class="math inline">\ (\ lambda_1, \ lambda_2, ... \)</span>감마 분포에서.</p></li>
<li><p>이것들을 사용하여 Poisson 세트를 생성하십시오 (<span class="math inline">\ (\ lambda_i \)</span>) 랜덤 변수, 각각 하나<span class="math inline">\ (\ lambda_1 \)</span>.</p></li>
</ol>
<!-- -->
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a>람다<span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>,,,<span class="at">모양 =</span> <span class="dv">10</span>,,,<span class="at">속도 =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a>GP<span class="ot">=</span> <span class="fu">RPOIS</span>(<span class="fu">길이</span>(람다),<span class="at">람다 =</span>람다)</span>
<span id="cb38-3"><a aria-hidden="true" href="#cb38-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">x =</span>GP),<span class="fu">AES</span>(<span class="at">x =</span>엑스))<span class="sc">+</span></span>
<span id="cb38-4"><a aria-hidden="true" href="#cb38-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">100</span>,,,<span class="at">fill =</span> <span class="st">"보라"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-generatepoissongamma">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-generatepoissongamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-26" href="04-chap_files/figure-html/fig-generatepoissongamma-1.png" title="Figure 4.21: Histogram of gp, generated via a gamma-Poisson hierachical model."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-generatepoissongamma-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-generatepoissongamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.21 : 히스토그램<code>GP</code>, Gamma-Poisson 상위 요리 모델을 통해 생성됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>결과 값은 감마 - 포이슨 혼합물에서 나온다고합니다.<a class="quarto-xref" href="#fig-generatepoissongamma">수치<span>4.21</span></a>히스토그램을 보여줍니다<code>GP</code>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-distfit">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.18</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>그러한 감마 - 포이슨 혼합물에서 생성 된 값이 연속적이거나 이산적입니까?<br/>
</li>
<li>이 배포의 또 다른 이름은 무엇입니까? 힌트 :<code>좋은 편</code>기능<strong><a href="https://cran.r-project.org/web/packages/vcd/">VCD</a></strong>패키지.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-31-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-31-contents callout-collapse collapse" id="callout-31">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" href="#cb39-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"VCD"</span>))</span>
<span id="cb39-2"><a aria-hidden="true" href="#cb39-2" tabindex="-1"></a>오피이트<span class="ot">=</span> <span class="fu">좋은 편</span>(GP,<span class="st">"nbinomial"</span>))</span>
<span id="cb39-3"><a aria-hidden="true" href="#cb39-3" tabindex="-1"></a><span class="fu">구성</span>(Ofit,<span class="at">xlab =</span> <span class="st">"" "</span>))</span>
<span id="cb39-4"><a aria-hidden="true" href="#cb39-4" tabindex="-1"></a>오피이트<span class="sc">$</span>평가</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ 크기
[1] 9.911829

$ prob
[1] 0.5963857</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-goofy">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-goofy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-27" href="04-chap_files/figure-html/fig-goofy-1.png" title="Figure 4.22: Goodness of fit plot. The rootogram shows the theoretical probabilities of the gamma-Poisson distribution (a.k.a. negative binomial) as red dots and the square roots of the observed frequencies as the height of the rectangular bars. The bars all end close to the horizontal axis, which indicates a good fit to the negative binomial distribution."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-goofy-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-goofy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.22 : 적합 플롯의 선함. 그만큼<strong>루그 그램</strong>감마-포이슨 분포 (즉, 음성 이항)의 이론적 확률은 적색 도트로, 관찰 된 주파수의 제곱근을 직사각형 막대의 높이로 보여줍니다. 막대는 모두 수평 축에 가깝게 끝나며, 이는 음의 이항 분포에 적합하다는 것을 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>R, 그리고 다른 곳에서는 Gamma-Poisson 분포가 별칭 이름으로 이동합니다.<strong>음의 이항 분포</strong>. 두 이름은 동의어입니다. 두 번째는 그 사실을 암시합니다<a class="quarto-xref" href="#eq-mixtures-eqmix-defnb">방정식<span>4.15</span></a>이항 분포의 확률과 공식적인 유사점을 지니고 있습니다. Gamma – Poisson 분포의 이름은 생성 메커니즘을 더욱 나타내며, 이것이 우리가 책의 나머지 부분에서 사용할 것입니다. 이는 불연속 분포입니다. 즉, 자연 숫자에 대해서만 값을 가져옵니다 (전체 양의 실제 축을 다루는 감마 분포와 대조적으로). 확률 분포입니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-eqmix-defnb"><span class="math display">\ [
\ text {p} (k = k) = \ left (\ begin {array} {c} k+a-1 \\ k \ end {array} \ right) \, p^a \, (1-p)^k,
\ tag {4.15} \]</span></span></p>
<p>두 매개 변수에 따라 다릅니다<span class="math inline">\ (a \ in \ mathbb {r}^+\)</span>그리고<span class="math inline">\ (p \ in [0,1] \)</span>. 동등하게 두 파라미터는 평균으로 표현할 수 있습니다.<span class="math inline">\ (em = on/(1-p) \)</span>그리고라는 매개 변수입니다<strong>분산</strong> <span class="math inline">\ (\ alpha = 1/a \)</span>. 분포의 분산은 이러한 매개 변수에 따라 다르며<span class="math inline">\ (\ m+\ alpha \ m^2 \)</span>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-mixtures-dgammapois">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-mixtures-dgammapois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-28" href="04-chap_files/figure-html/fig-mixtures-dgammapois-1.png" title="Figure 4.23: Visualization of the hierarchical model that generates the gamma-Poisson distribution. The top panel shows the density of a gamma distribution with mean 50 (vertical black line) and variance 30. Assume that in one particular experimental replicate, the value 60 is realized. This is our latent variable. The observable outcome is distributed according to the Poisson distribution with that rate parameter, shown in the middle panel. In one particular experiment the outcome may be, say, 55, indicated by the dashed green line. Overall, if we repeat these two subsequent random process many times, the outcomes will be distributed as shown in the bottom panel – the gamma-Poisson distribution."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-mixtures-dgammapois-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mixtures-dgammapois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.23 : 감마-포이슨 분포를 생성하는 계층 적 모델의 시각화. 상단 패널은 평균 50 (수직 블랙 라인)과 분산 30의 감마 분포의 밀도를 보여줍니다. 하나의 특정 실험 복제에서 값 60이 실현된다고 가정합니다. 이것이 우리의 잠재 변수입니다. 관찰 가능한 결과는 중간 패널에 표시된 해당 속도 매개 변수로 포아송 분포에 따라 분포됩니다. 하나의 특정한 실험에서, 결과는 점선에 의해 지시 될 수있는 55 일 수있다. 전반적으로,이 두 가지 후속 랜덤 프로세스를 여러 번 반복하면 결과는 하단 패널 (Gamma-Pooisson 분포)에 표시된대로 배포됩니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-mathnb">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.19</div>
</div>
<div class="callout-body-container callout-body">
<p>예시적인 시뮬레이션보다 분석 파생에 더 관심이 있다면 Gamma-Poisson 확률 분포의 수학적 도출을 작성해보십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-33-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-33-contents callout-collapse collapse" id="callout-33">
<div class="callout-body-container callout-body">
<p>최종 분포는 두 단계 프로세스의 결과라는 것을 상기하십시오.</p>
<ol type="1">
<li>생성 a<span class="math inline">\ (\ text {gamma} (a, b) \)</span>분산 번호, 전화하십시오<span class="math inline">\(엑스\)</span>밀도에서</li>
</ol>
<p><span class="anchored-eq" data-anchor-id="eq-jeqvwlfnabxs" id="eq-jeqvwlfnabxs"><span class="math display">\ [
f_ \ gamma (x, a, b) = \ frac {b^a} {\ gamma (a)} \, x {a-1} \, e^{-b x},
\ tag {4.16} \]</span></span></p>
<p>어디<span class="math inline">\(\감마\)</span>소위입니다<span class="math inline">\(\감마\)</span>-기능,<span class="math inline">\ (\ gamma (a) = \ int_0^\ infty x^{a-1} \, e^{-x} \, \ text {d} x \)</span>(이 부수적 인 관계가 있지만 감마 분포와 혼동하지 마십시오).</p>
<ol start="2" type="1">
<li>숫자를 생성하십시오<span class="math inline">\(케이\)</span>요율로 포아송 분포에서<span class="math inline">\(엑스\)</span>. 확률 분포는입니다</li>
</ol>
<p><span class="math display">\ [
f _ {\ text {pois}} (k, \ lambda = x) = \ frac {x^{k} e^{-x}} {k!}
\]</span></p>
<p>만약에<span class="math inline">\(엑스\)</span>유한 한 값 만 사용했을 때, 우리는 가능한 모든 사례를 합산함으로써 문제를 해결할 수 있습니다.<span class="math inline">\ (f_ \ gamma \)</span>. 하지만<span class="math inline">\(엑스\)</span>연속적이므로, 우리는 합계를 개별 합계 대신 적분으로 쓸 필요가 있습니다. 우리는 분포를 호출합니다<span class="math inline">\(케이\)</span>한계. 확률 질량 기능입니다</p>
<p><span class="math display">\ [
\ begin {aligned}
p (k = k) &amp; = &amp; \ int_ {x = 0}^{\ infty} \, f _ {\ text {pois}} (k, \ lambda = x) \; f_ \ gamma (x, a, b) \; dx \\
&amp; = &amp; \ int_ {x = 0}^{\ infty} \ frac {x^{k} e^{-x}} {k!} \; \ frac {b^a} {\ gamma (a)} x^{a-1} e {-bx} \; DX
\ end {aligned}
\]</span></p>
<p>이용 약관을 수집하고 독립적 인 용어를 이동하십시오<span class="math inline">\(엑스\)</span>적분 외부</p>
<p><span class="math display">\ [
p (k = k) = \ frac {b^a} {\ gamma (a) \, k!} \ int_ {x = 0}^{\ infty} x^{k+a-1} e^{-(b+1) x} dx
\]</span></p>
<p>우리는 감마 밀도 합계를 하나로 알고 있기 때문입니다.<span class="math inline">\ (\ int_0^\ infty x^{k+a-1} e^{-(b+1) x} dx = \ frac {\ gamma (k+a)} {(b+1)^{k+a}} \)</span></p>
<p><span class="math display">\ [
\ begin {aligned}
p (k = k)
&amp; = &amp; \ frac {\ gamma (k+a)} {\ gamma (a) \ gamma (k+1)} \ frac {b^a} {(b+1)^{a} (b+1)^k}
= {k+a-1 \ 선택 K} \ left (\ frac {b} {b+1} \ 오른쪽)^a \ left (1- \ frac {b+1} \ 오른쪽)^k
\ end {aligned}
\]</span></p>
<p>마지막 줄에서 우리는 그것을 사용했습니다<span class="math inline" data-anchor-id="eq-mixtures">\ (\ gamma (v+1) = V! \)</span>. 이것은 방정식과 동일합니다 (<a class="quarto-xref" href="#eq-mixtures-eqmix-defnb"><span>4.15</span></a>), 크기 매개 변수가있는 감마-포이슨<span class="math inline">\(에이\)</span>그리고 확률<span class="math inline">\ (p = \ frac {b} {b+1} \)</span>.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level3 page-columns page-full" data-number="4.4.4" id="sec-mixtures-vst">
<h3 class="anchored" data-anchor-id="sec-mixtures-vst" data-number="4.4.4"><span class="header-section-number">4.4.4</span>분산 안정화 변환</h3>
<div class="page-columns page-full"><p>실험 데이터를 분석 할 때 제어해야 할 주요 문제는 동일한 근본적인 실제 값의 반복 측정, 즉 복제간에 반복되는 변동성의 양입니다. 이것은 우리가 진정한 차이, 즉 다른 조건들 사이에서 어떤 진정한 차이를 볼 수 있는지 여부를 결정합니다. 이 장에서 우리가 연구 한 계층 적 모델의 유형을 통해 발생하는 데이터는 종종 매우 이질적인 분산을 갖는 것으로 판명되며, 이는 도전이 될 수 있습니다. 우리는 그러한 경우에 어떻게 보일 것입니다<strong>분산 안정화 변환</strong> <span class="citation" data-cites="Anscombe1948">(<a href="16-chap.html#ref-Anscombe1948" role="doc-biblioref">Anscombe 1948</a>))</span>도움이 될 수 있습니다. 10에서 100의 속도로 일련의 포아송 변수부터 시작하겠습니다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">데이터 프레임을 어떻게 구성하는지 (또는 더 정확하게<em>티블</em>))<code>미사</code>: 출력<code>lapply</code>루프는의 목록입니다<em>티블</em>s, 각 값마다 하나<code>도주</code>. 파이프 연산자와 함께<code>|&gt;</code>우리는 그것을 함수로 보냅니다<code>bind_rows</code>(<strong><a href="https://cran.r-project.org/web/packages/dplyr/">dplyr</a></strong>패키지). 결과적으로 모든 목록 요소의 데이터 프레임이 서로 깔끔하게 쌓여 있습니다.</span></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a>미사<span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">서열</span>(<span class="dv">10</span>,,,<span class="dv">100</span>,,,<span class="at">by =</span> <span class="dv">10</span>),)<span class="cf">기능</span>(도주)</span>
<span id="cb41-2"><a aria-hidden="true" href="#cb41-2" tabindex="-1"></a>    <span class="fu">티블</span>(<span class="at">n =</span> <span class="fu">RPOIS</span>(<span class="dv">200</span>,,,<span class="at">람다 =</span>도주),</span>
<span id="cb41-3"><a aria-hidden="true" href="#cb41-3" tabindex="-1"></a>           <span class="st">`</span><span class="at">sqrt (n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sqrt</span>(N),</span>
<span id="cb41-4"><a aria-hidden="true" href="#cb41-4" tabindex="-1"></a>       <span class="at">람다 =</span>도주))<span class="sc">|&gt;</span></span>
<span id="cb41-5"><a aria-hidden="true" href="#cb41-5" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-6"><a aria-hidden="true" href="#cb41-6" tabindex="-1"></a>시간제 노동자<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>람다)</span>
<span id="cb41-7"><a aria-hidden="true" href="#cb41-7" tabindex="-1"></a><span class="fu">ggplot</span>(Slydate,<span class="fu">AES</span>(<span class="at">x =</span> <span class="fu">요인</span>(람다),<span class="at">y =</span>값))<span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">표현</span>(람다))<span class="sc">+</span></span>
<span id="cb41-8"><a aria-hidden="true" href="#cb41-8" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="at">줄 =</span> <span class="fu">vars</span>(이름),<span class="at">스케일 =</span> <span class="st">"무료"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-seriesofpoisson">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seriesofpoisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="04-chap_files/figure-html/fig-seriesofpoisson-1.png" title="Figure 4.24: Poisson distributed measurement data, for eight different choices of the mean lambda. In the upper panel, the y-axis is proportional to the data; in the lower panel, it is on a square-root scale. Note how the distribution widths change in the first case, but less so in the second."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-seriesofpoisson-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seriesofpoisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.24 : Poisson Distributed Measurement Data, 8 가지 평균 선택.<code>람다</code>. 상단 패널에서<span class="math inline">\(와이\)</span>-축은 데이터에 비례합니다. 하단 패널에서는 제곱근 규모입니다. 첫 번째 경우 분포 너비가 어떻게 변하지만 두 번째 경우에는 적습니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p>상단 패널에서 볼 수있는 데이터<a class="quarto-xref" href="#fig-seriesofpoisson">수치<span>4.24</span></a>부름의 예입니다<strong>이분산성</strong>: 데이터의 표준 편차 (또는 동일하게 분산)는 데이터 공간의 다른 영역에서 다릅니다. 특히, 그것은 증가합니다<span class="math inline">\(엑스\)</span>평균과 축. 포아송 분포의 경우, 표준 편차가 평균의 제곱근이라는 것을 실제로 알고 있습니다. 다른 유형의 데이터의 경우 다른 종속성이있을 수 있습니다. 차이가 동일하다고 가정하는 후속 분석 기술 (예 : 회귀 또는 통계 테스트)을 적용하려는 경우 문제가 될 수 있습니다. ~ 안에<a class="quarto-xref" href="#fig-seriesofpoisson">수치<span>4.24</span></a>람다의 각 값에 대한 복제 수는 상당히 큽니다. 실제로, 이것이 항상 그런 것은 아닙니다. 더욱이, 데이터는 일반적으로 시뮬레이션에서와 같이 알려진 평균에 의해 명시 적으로 계층화되지 않으므로, 헤테로스 스 캐슬은 그럼에도 불구하고보기가 더 어려울 수 있습니다. 그러나 우리가 하단 패널에서 볼 수 있듯이<a class="quarto-xref" href="#fig-seriesofpoisson">수치<span>4.24</span></a>, 단순히 제곱근 변환을 적용하면 변환 된 변수는 거의 동일한 분산을 갖습니다. 이것은 각 관찰에 대한 기본 평균을 알지 못하더라도 제곱근 변환에는이 정보가 필요하지 않습니다. 다음 코드에서와 같이 샘플링 된 값의 표준 편차를 보여주는 것과 같이 이것을보다 정량적으로 확인할 수 있습니다.<code>N</code>그리고<code>sqrt (n)</code>의 차이 선택<code>람다</code>.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">제곱근 변환 된 값의 표준 편차는 일관되게 약 0.5이므로 변환을 사용합니다.<code>2*sqrt (n)</code>단위 분산을 달성합니다.</span></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a><span class="fu">요약</span>(<span class="fu">Group_by</span>(Simdat, 이름, 람다),<span class="fu">SD</span>(값))<span class="sc">|&gt;</span>시간제 노동자<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="st">`</span><span class="at">SD (값)</span><span class="st">`</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 10 × 3
   lambda n` sqrt (n)`
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 10 2.95 0.478
 2 20 4.19 0.470
 3 30 5.62 0.521
 4 40 5.99 0.473
 5 50 7.69 0.546
 6 60 7.59 0.492
 7 70 8.69 0.520
 8 80 8.99 0.505
 9 90 9.44 0.498
10 100 9.84 0.495</code></pre>
</div>
</div>
<p>이제 Gamma-Pooisson 분포를 사용하는 또 다른 예는 다음과 같습니다.<a class="quarto-xref" href="#fig-seriesofnb">수치<span>4.25</span></a>. 우리는 감마-포이슨 변수를 생성합니다<code>유</code><a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>평균 주위의 95% 신뢰 구간을 플로팅하십시오.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>평균 값에 대한 더 넓은 범위의 값을 포착하려면<code>무</code>, 너무 조밀 한 A 시퀀스를 만들지 않고, 우리는 기하학적 시리즈를 사용합니다.<span class="math inline">\ (\ mu_ {i+1} = 2 \ mu_i \)</span>.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a>최근에<span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">10</span>,,,<span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a>simgp<span class="ot">=</span> <span class="fu">lapply</span>(최근에,<span class="cf">기능</span>(안에) {</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a>유<span class="ot">=</span> <span class="fu">rnbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>,,,<span class="at">in =</span>안에,<span class="at">크기 =</span> <span class="dv">4</span>))</span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a>  <span class="fu">티블</span>(<span class="at">평균 =</span> <span class="fu">평균</span>(유),<span class="at">SD =</span> <span class="fu">SD</span>(유),</span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a>         <span class="at">낮은 =</span> <span class="fu">양자</span>(유,<span class="fl">0.025</span>),)</span>
<span id="cb44-6"><a aria-hidden="true" href="#cb44-6" tabindex="-1"></a>         <span class="at">어퍼 =</span> <span class="fu">양자</span>(유,<span class="fl">0.975</span>),)</span>
<span id="cb44-7"><a aria-hidden="true" href="#cb44-7" tabindex="-1"></a>         <span class="at">in =</span>MU)</span>
<span id="cb44-8"><a aria-hidden="true" href="#cb44-8" tabindex="-1"></a>})<span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb44-9"><a aria-hidden="true" href="#cb44-9" tabindex="-1"></a><span class="fu">머리</span>(<span class="fu">as.data.frame</span>(simgp),<span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>평균 SD 하부 상단 MU
1 0.9965 1.106440 0 4 1
2 2.0233 1.748503 0 6 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="fu">ggplot</span>(simgp,<span class="fu">AES</span>(<span class="at">x =</span>안에,<span class="at">y =</span>평균,<span class="at">ymin =</span>낮추다,<span class="at">ymax =</span>높은))<span class="sc">+</span></span>
<span id="cb46-2"><a aria-hidden="true" href="#cb46-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_errorbar</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-seriesofnb">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seriesofnb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="04-chap_files/figure-html/fig-seriesofnb-1.png" title="Figure 4.25: gamma-Poisson distributed measurement data, for a range of \mu from 1 to 1024."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-seriesofnb-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seriesofnb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.25 : 범위에 대한 Gamma-Poisson 분산 측정 데이터<span class="math inline">\ (\ 안에 \)</span>1에서 1024까지.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-nbtransform">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.20</div>
</div>
<div class="callout-body-container callout-body">
<p>Poisson 분산 데이터의 제곱근 함수와 유사하게 분산을 안정화시키는 이러한 데이터에 대한 변환을 어떻게 찾을 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-35-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-35-contents callout-collapse collapse" id="callout-35">
<div class="callout-body-container callout-body">
<p>우리가 해당 값을 나누면<code>[1]</code>(그리고 중심에 있습니다<code>simgp $ mean [1]</code>) 표준 편차에 의해<code>simgp $ sd [1]</code>, 해당 값<code>[2]</code>(그리고 중심에 있습니다<code>simgp $ mean [2]</code>) 표준 편차에 의해<code>simgp $ sd [2]</code>그리고 그 결과, 결과 값은 구성에 의해 1의 표준 편차 (및 차이)를 가질 것입니다.<em>그리고</em>적절한 값에 적절한 경사가있는 연속 함수.</p>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" href="#cb47-1" tabindex="-1"></a>simgp<span class="ot">=</span> <span class="fu">돌연변이</span>(simgp,</span>
<span id="cb47-2"><a aria-hidden="true" href="#cb47-2" tabindex="-1"></a>  <span class="at">경사 =</span> <span class="dv">1</span> <span class="sc">/</span>SD,</span>
<span id="cb47-3"><a aria-hidden="true" href="#cb47-3" tabindex="-1"></a>  <span class="at">trsf =</span> <span class="fu">CUMSUM</span>(슬로프<span class="sc">*</span>평균))</span>
<span id="cb47-4"><a aria-hidden="true" href="#cb47-4" tabindex="-1"></a><span class="fu">ggplot</span>(simgp,<span class="fu">AES</span>(<span class="at">x =</span>평균,<span class="at">y =</span>trsf))<span class="sc">+</span></span>
<span id="cb47-5"><a aria-hidden="true" href="#cb47-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-pcwlin-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pcwlin-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="04-chap_files/figure-html/fig-pcwlin-1-1.png" title="Figure 4.26: Piecewise linear function that stabilizes the variance of the data in Figure fig-seriesofnb."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-pcwlin-1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pcwlin-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.26 : 데이터의 분산을 안정화시키는 부분 선형 함수<a class="quarto-xref" href="#fig-seriesofnb">수치<span>4.25</span></a>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는<a class="quarto-xref" href="#fig-pcwlin-1">수치<span>4.26</span></a>이 기능은 특히 하단에서 제곱근 함수와 유사합니다. 상단에서는 로그처럼 보입니다. 수학적으로 더 기울어 진 수치 계산의 우아한 확장은<strong>델타 방법</strong>다음과 같이.</p>
<p>변환 기능을 호출하십시오<span class="math inline">\(g\)</span>그리고 차별화 될 수 있다고 가정합니다 (매우 강한 가정이 아닙니다. 여기서 합리적으로 생각할 수있는 기능은 차별화 될 수 있습니다). 또한 임의 변수에 전화하십시오<span class="math inline">\ (x_i \)</span>, 수단으로<span class="math inline">\ (\ mu_i \)</span>그리고 차이<span class="math inline">\ (v_i \)</span>그리고 우리는 그것을 가정합니다<span class="math inline">\ (v_i \)</span>그리고<span class="math inline">\ (\ mu_i \)</span>기능적 관계와 관련이 있습니다<span class="math inline">\ (v_i = v (\ mu_i) \)</span>. 그런 다음 값을 위해<span class="math inline">\ (x_i \)</span>그 평균 근처에서<span class="math inline">\ (\ mu_i \)</span>,,,</p>
<p><span class="anchored-eq" data-anchor-id="eq-vntodgbfqzyu" id="eq-vntodgbfqzyu"><span class="math display">\ [
g (x_i) = g (\ mu_i) + g '(\ mu_i) (x_i- \ mu_i) + ...
\ tag {4.17} \]</span></span></p>
<p>도트는 우리가 소홀히 할 수있는 고차 용어를 나타냅니다. 그런 다음 변환 된 값의 차이가 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-eqvarmean"><span class="math display">\ [
\ 시작 {align}
\ text {var} (g (x_i)) &amp; \ simeq g '(\ mu_i)^2 \\
\ text {var} (x_i) &amp; = g '(\ mu_i)^2 \, v (\ mu_i),
\ end {align}
\ tag {4.18} \]</span></span></p>
<p>우리가 규칙을 사용한 곳<span class="math inline">\ (\ text {was} (x-c) = \ text {way} (x) \)</span>그리고<span class="math inline">\ (\ text {was} (cx) = c^2 \, \ text {was} (x) \)</span>그것은 언제든지 가지고 있습니다<span class="math inline">\(기음\)</span>상수 숫자입니다. 이것이 일정하다고 요구하면 미분 방정식으로 이어집니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-diffeqvst"><span class="math display">\ [
g '(x) = \ frac {1} {\ sqrt {v (x)}}.
\ tag {4.19} \]</span></span></p>
<p>주어진 평균 분산 관계<span class="math inline">\ (v (\ mu) \)</span>, 우리는 기능을 위해 이것을 해결할 수 있습니다<span class="math inline">\(g\)</span>. 간단한 경우를 확인해 봅시다.</p>
<ul>
<li><p>만약에<span class="math inline">\ (v (\ mu) = \ mu \)</span>(Poisson), 우리는 회복합니다<span class="math inline">\ (g (x) = \ sqrt {x} \)</span>, 제곱근 변환.</p></li>
<li><p>만약에<span class="math inline" data-anchor-id="eq-mixtures">\ (v (\ m) = \ alpha \, \ in^2 \)</span>, 미분 방정식을 해결합니다<a class="quarto-xref" href="#eq-mixtures-diffeqvst"><span>4.19</span></a>주어진다<span class="math inline">\ (g (x) = \ log (x) \)</span>. 이것은 많은 데이터 분석 응용 프로그램에서 로그 변환이 왜 인기 있는가를 설명합니다. 데이터가 일정한 변동 계수를 가질 때마다, 즉 표준 편차가 평균에 비례 할 때마다 분산 안정화 변환 역할을합니다.</p></li>
</ul>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-mixtures-otherdelta">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 4.21</div>
</div>
<div class="callout-body-container callout-body">
<p>관련 분산 안정화 변환은 무엇입니까?<span class="math inline">\ (v (\ m) = \ alpha \, \ alpha \, \ m^2 \)</span>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-37-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-37-contents callout-collapse collapse" id="callout-37">
<div class="callout-body-container callout-body">
<p>미분 방정식을 해결합니다<a class="quarto-xref" href="#eq-mixtures-diffeqvst"><span>4.19</span></a>이 기능으로<span class="math inline">\ (v (\ cdot) \)</span>, 우리는 적분을 계산해야합니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-diffeqvstgammapoisson"><span class="math display">\ [\ label {eq :}
\ int \ frac {dx} {\ sqrt {x + \ alpha x^2}}.
\ tag {4.20} \]</span></span></p>
<p>닫힌 양식 표현식은<span class="citation" data-cites="BronsteinSemendjajew">(<a href="16-chap.html#ref-BronsteinSemendjajew" role="doc-biblioref">Bronštein과 Semendjajew 1979</a>))</span>. 이 저자들은 일반적인 해결책을 제공합니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-bronstein"><span class="math display">\ [
\ int \ frac {dx} {\ sqrt {ax^2+bx+c}} = \ frac {1} {\ sqrt {a}}
’
\ tag {4.21} \]</span></span></p>
<p>우리는 특별한 경우를 연결할 수 있습니다<span class="math inline">\ (a = \ alpha \)</span>,,,<span class="math inline">\ (b = 1 \)</span>,,,<span class="math inline">\ (C = 0 \)</span>, 분산 안정화 변환을 얻기 위해</p>
<p><span class="anchored-eq" data-anchor-id="eq-mixtures" id="eq-mixtures-vstgammapoisson"><span class="math display">\ [
\ 시작 {align}
g_ \ alpha (x)
&amp; = \ frac {1} {2 \ sqrt {\ alpha}}
   \ ln \ left (2 \ sqrt {\ alpha x (\ alpha x + 1)} + 2 \ alpha x + 1 \ right) \\
&amp; = \ frac {1} {2 \ sqrt {\ alpha}}
   {\ displayStyle \ OperatorName {arcosh}} (2 \ alpha x+1). \\
\ end {align}
\ tag {4.22} \]</span></span></p>
<p>두 번째 줄의 경우<a class="quarto-xref" href="#eq-mixtures-vstgammapoisson">방정식<span class="anchored-eq" data-anchor-id="eq-mixtures">4.22</span></a>, 우리는 정체성을 사용했습니다<span class="math inline">\ ({\ displayStyle \ OperatorName {arcosh}} (z) = \ ln \ left (z+\ sqrt {z^2-1} \ 오른쪽) \)</span>. 한계에서<span class="math inline">\ (\ alpha \ to0 \)</span>, 선형 근사치를 사용할 수 있습니다<span class="math inline">\ (\ ln (1+ \ varepsilon) = \ varepsilon+ o (\ varepsilon^2) \)</span>그것을 보려면<span class="math inline">\ (g_0 (x) = \ sqrt {x} \)</span>. IF에 유의하십시오<span class="math inline">\ (g_ \ alpha \)</span>분산 안정화 변환입니다<span class="math inline">\ (ug_ \ alpha + v \)</span>숫자 쌍의 경우<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>그리고 우리는이 자유를 사용하여 추가 요인을 삽입했습니다.<span class="math inline">\ (\ frac {1} {2} \)</span>다음과 같은 이유로 분명해집니다. 함수를 확인할 수 있습니다<span class="math inline">\ (g_ \ alpha \)</span>~에서<a class="quarto-xref" href="#eq-mixtures-vstgammapoisson">방정식<span>4.22</span></a>조건을 충족합니다<a class="quarto-xref" href="#eq-mixtures-diffeqvst"><span>4.19</span></a>기본 계산 인 미분을 계산함으로써. 우리는 그것을 계획 할 수 있습니다 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>에프<span class="ot">=</span> <span class="cf">기능</span>(X, A)</span>
<span id="cb48-2"><a aria-hidden="true" href="#cb48-2" tabindex="-1"></a>  <span class="fu">ifelse</span>(에이<span class="sc">==</span><span class="dv">0</span>,,,</span>
<span id="cb48-3"><a aria-hidden="true" href="#cb48-3" tabindex="-1"></a>    <span class="fu">sqrt</span>(엑스),</span>
<span id="cb48-4"><a aria-hidden="true" href="#cb48-4" tabindex="-1"></a>    <span class="fu">통나무</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(에이)<span class="sc">*</span> <span class="fu">sqrt</span>(엑스<span class="sc">*</span>(에이<span class="sc">*</span>엑스<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>에이<span class="sc">*</span>엑스<span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(에이)))</span>
<span id="cb48-5"><a aria-hidden="true" href="#cb48-5" tabindex="-1"></a>엑스<span class="ot">=</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">24</span>,,,<span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb48-6"><a aria-hidden="true" href="#cb48-6" tabindex="-1"></a>DF<span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="fl">0.05</span><span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)), <span class="cf">기능</span>(에이)</span>
<span id="cb48-7"><a aria-hidden="true" href="#cb48-7" tabindex="-1"></a>  <span class="fu">티블</span>(<span class="at">x =</span>엑스,<span class="at">a =</span>에이,<span class="at">y =</span> <span class="fu">에프</span>(X, A)))<span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb48-8"><a aria-hidden="true" href="#cb48-8" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">col =</span> <span class="fu">요인</span>(에이)))<span class="sc">+</span> </span>
<span id="cb48-9"><a aria-hidden="true" href="#cb48-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">실험실</span>(<span class="at">col =</span> <span class="fu">표현</span>(알파))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotvstgammapoisson-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotvstgammapoisson-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-32" href="04-chap_files/figure-html/fig-plotvstgammapoisson-1-1.png" title="Figure 4.27: Graph of the function Equation eq-mixtures-vstgammapoisson for different choices of \alpha."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-plotvstgammapoisson-1-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotvstgammapoisson-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.27 : 기능의 그래프<a class="quarto-xref" href="#eq-mixtures-vstgammapoisson">방정식<span>4.22</span></a>다른 선택을 위해<span class="math inline">\ (\ alpha \)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>그리고 두 용어의 동등성을 경험적으로 확인합니다<a class="quarto-xref" href="#eq-mixtures-vstgammapoisson">방정식<span>4.22</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a>F2<span class="ot">=</span> <span class="cf">기능</span>(X, A)<span class="fu">ifelse</span>(에이<span class="sc">==</span><span class="dv">0</span>,,,<span class="fu">sqrt</span>(엑스),<span class="fu">아코시</span>(<span class="dv">2</span><span class="sc">*</span>에이<span class="sc">*</span>엑스<span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(에이)))</span>
<span id="cb49-2"><a aria-hidden="true" href="#cb49-2" tabindex="-1"></a><span class="fu">~와 함께</span>(df,<span class="fu">맥스</span>(<span class="fu">ABS</span>(<span class="fu">F2</span>(X, A)<span class="sc">-</span>와이)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.881784E-16</code></pre>
</div>
</div>
<p>우리가 볼 수 있듯이<a class="quarto-xref" href="#fig-plotvstgammapoisson-1">수치<span>4.27</span></a>, 작은 값의 경우<span class="math inline">\(엑스\)</span>,,,<span class="math inline">\ (g_ \ alpha (x) \ 대략 \ sqrt {x} \)</span>(독립적으로<span class="math inline">\ (\ alpha \)</span>), 큰 값의 경우 (<span class="math inline">\ (x \ to \ infty \)</span>) 그리고<span class="math inline">\ (\ alpha&gt; 0 \)</span>, 로그처럼 작동합니다.</p>
<p><span class="math display">\ [
\ 시작 {align}
&amp; \ frac {1} {2 \ sqrt {\ alpha}} \ ln \ left (2 \ sqrt {\ alpha \ left (\ alpha x^2+x \ right)}+2 \ alpha x+1 \ right) \\
\ rase &amp; \ frac {1} {2 \ sqrt {\ alpha}} \ ln \ left (2 \ sqrt {\ alpha^2x^2} +2 \ alpha x \ right) \\
= &amp; \ frac {1} {2 \ sqrt {\ alpha}} \ ln \ left (4 \ alpha x \ 오른쪽) \\
= &amp; \ frac {1} {2 \ sqrt {\ alpha}} \ ln x+\ text {const.}
\ end {align}
\]</span></p>
<p>우리는 이것을 경험적으로 확인할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a>에이<span class="ot">=</span> <span class="fu">기음</span>(<span class="fl">0.2</span>,,,<span class="fl">0.5</span>,,,<span class="dv">1</span>))</span>
<span id="cb51-2"><a aria-hidden="true" href="#cb51-2" tabindex="-1"></a>  <span class="fu">에프</span>(<span class="fl">1e6</span>, a)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.196731 10.259171 7.600903</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" href="#cb53-1" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(에이))<span class="sc">*</span> (<span class="fu">통나무</span>(<span class="fl">1e6</span>))<span class="sc">+</span> <span class="fu">통나무</span>(<span class="dv">4</span><span class="sc">*</span>에이))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.196728 10.259170 7.600902</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section class="level2" data-number="4.5" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="4.5"><span class="header-section-number">4.5</span>이 장의 요약</h2>
<p>우리는 생물학적 데이터를 모델링하기 위해 혼합물을 사용하는 동기 부여 예와 방법을 제공했습니다. 우리는 EM 알고리즘이 부분적이고 단순한 문제를 반복하여 데이터에 어려운 확률 론적 모델을 적합한 흥미로운 예인 방법을 보았습니다.</p>
<section class="level4 unnumbered" id="finite-mixture-models">
<h4 class="unnumbered anchored" data-anchor-id="finite-mixture-models">유한 혼합 모델</h4>
<p>우리는 상이한 수단과 분산으로 둘 이상의 정상 분포의 혼합물을 모델링하는 방법을 보았다. EM 알고리즘을 사용하여 잠재 변수를 모르더라도 그러한 혼합물에서 주어진 데이터 샘플을 분해하는 방법을 보았습니다. EM 접근법은 분포의 파라 메트릭 형태와 구성 요소의 수를 알아야합니다. ~ 안에<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>, 우리는 그러한 정보에 의존하지 않고도 데이터에서 그룹화를 찾을 수있는 방법을 살펴볼 것입니다.이를 클러스터링이라고합니다. 클러스터링과 혼합 모델링 사이에는 강력한 개념적 관계가 있음을 명심할 수 있습니다.</p>
</section>
<section class="level4 unnumbered" id="common-infinite-mixture-models">
<h4 class="unnumbered anchored" data-anchor-id="common-infinite-mixture-models">일반적인 무한 혼합 모델</h4>
<p>무한 혼합 모델은 더 기본적인 것 (예 : 이항, 정상, 포아송)에서 새로운 분포 (예 : 감마-포이슨 또는 라플라스)를 구성하는 데 좋습니다. 일반적인 예입니다</p>
<ul>
<li><p>정상의 혼합물 (종종 평균 및 분산에 대한 계층 적 모델);</p></li>
<li><p>베타-비노미얼 혼합물-확률<span class="math inline">\(피\)</span>이항에서는 a에 따라 생성됩니다<span class="math inline">\ (\ text {beta} (a, b) \)</span>분포;</p></li>
<li><p>Read Counts에 대한 Gamma-Pooisson (참조<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>);</p></li>
<li><p>PCR에 대한 감마-전위.</p></li>
</ul>
</section>
<section class="level4 unnumbered" id="applications">
<h4 class="unnumbered anchored" data-anchor-id="applications">응용 프로그램</h4>
<p>혼합 모델은 여러 층의 실험적 변동성이있을 때마다 유용합니다. 예를 들어, 가장 낮은 층에서, 우리의 측정 정밀도는 기본 물리적 탐지 한계에 의해 제한 될 수 있으며, 이들은 계산 기반 분석의 경우 포아송 분포 또는 연속 측정의 경우 정규 분포에 의해 모델링 될 수있다. 위에는 계측기 간 변동의 하나 (또는 ​​그 이상) 층이있을 수 있습니다.</p>
<p>혼합물 모델은 데이터에 종종 이질적인 변동성 (분산)이 있음을 반영합니다. 이러한 경우, 적절한 데이터 변환, 즉 분산 안정화 변환이 후속 시각화 또는 분석 전에 필요합니다. RNA-Seq in의 예를 깊이 공부할 것입니다<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>그리고 이것은 또한 미생물 생태학에서 차세대 판독의 정규화에 유용합니다.<span class="citation" data-cites="mcmurdie2014">(<a href="16-chap.html#ref-mcmurdie2014" role="doc-biblioref">McMurdie와 Holmes 2014</a>))</span>.</p>
<p>혼합 모델링의 또 다른 중요한 응용 프로그램은 다중 테스트에서 2 성분 모델입니다.<a class="quarto-xref" href="06-chap.html"><span>6 장</span></a>.</p>
</section>
<section class="level4 unnumbered" id="the-ecdf-and-bootstrapping">
<h4 class="unnumbered anchored" data-anchor-id="the-ecdf-and-bootstrapping">ECDF 및 부트 스트래핑</h4>
<p>관찰 된 샘플을 혼합물로 사용하여 추정치의 샘플링 분포에 대해 알려주는 많은 시뮬레이션 된 샘플을 생성 할 수 있음을 알았습니다. 이 방법을 부트 스트랩이라고하며 닫힌 양식 표현식을 사용할 수없는 경우에도 추정치를 평가하는 방법을 제공하기 때문에 여러 번 돌아갑니다 (우리는 비모수 적이라고 말함).</p>
</section>
</section>
<section class="level2" data-number="4.6" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="4.6"><span class="header-section-number">4.6</span>추가 독서</h2>
<p>유한 혼합 모델의 유용한 책장 처리는 다음과 같습니다.<span class="citation" data-cites="mclachlan2004">McLachlan과 Peel (<a href="16-chap.html#ref-mclachlan2004" role="doc-biblioref">2004</a>))</span>; EM 알고리즘은 책을 참조하십시오<span class="citation" data-cites="mclachlan2007algorithm">McLachlan과 Krishnan (<a href="16-chap.html#ref-mclachlan2007algorithm" role="doc-biblioref">2007</a>))</span>. MM (Majorize Minimization) 프레임 워크 내에서 모든 EM 유형 알고리즘을 제시하는 최근의 책<span class="citation" data-cites="lange2016mm">랭 (Lange) (<a href="16-chap.html#ref-lange2016mm" role="doc-biblioref">2016</a>))</span>.</p>
<p>많은 자연 현상이 혼합물로 볼 수있는 수학적 이유가 실제로 있습니다. 관찰 된 사건이 ​​교환 가능할 때 발생합니다 (발생하는 순서는 중요하지 않음). 이것을 기본으로하는 이론은 상당히 수학적이며, 시작하는 좋은 방법은 Wikipedia 항목과 논문을 보는 것입니다.<span class="citation" data-cites="diaconis1980finite">Diaconis와 Freedman (<a href="16-chap.html#ref-diaconis1980finite" role="doc-biblioref">1980</a>))</span>.</p>
<p>특히, 우리는 고 처리량 데이터에 혼합물을 사용합니다. 당신은 예를 보게 될 것입니다<a class="quarto-xref" href="08-chap.html"><span>8</span></a>그리고<a class="quarto-xref" href="11-chap.html"><span>11</span></a>.</p>
<p>부트 스트랩은 많은 상황에서 사용할 수 있으며 알아야 할 매우 유용한 도구입니다.<span class="citation" data-cites="efront">(<a href="16-chap.html#ref-efront" role="doc-biblioref">B. Efron and Tibshirani 1993</a>))</span>.</p>
<p>역사적으로 흥미로운 논문은 분산 안정화에 관한 원본 기사입니다.<span class="citation" data-cites="Anscombe1948">안스 콤 (anscombe) (<a href="16-chap.html#ref-Anscombe1948" role="doc-biblioref">1948</a>))</span>Poisson 및 Gamma-Poosson Random 변수에 대한 분산 안정화 변환 방법을 제안한 사람. 분산 안정화는 이론 통계에서 많은 표준 텍스트에서 델타 방법을 사용하여 설명합니다.<span class="citation" data-cites="Rice:2007">쌀 (<a href="16-chap.html#ref-Rice:2007" role="doc-biblioref">2006, 챕터. 6</a>))</span>그리고<span class="citation" data-cites="Kery2015">Kéry와 Royle (<a href="16-chap.html#ref-Kery2015" role="doc-biblioref">2015, 35</a>))</span>.</p>
<p><span class="citation" data-cites="Kery2015">Kéry와 Royle (<a href="16-chap.html#ref-Kery2015" role="doc-biblioref">2015</a>))</span>R을 사용하여 틈새 및 공간 생태학의 풍부한 추정을위한 계층 적 모델을 구축하려는 좋은 탐색을 제공합니다.</p>
</section>
<section class="level2 page-columns page-full" data-number="4.7" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="4.7"><span class="header-section-number">4.7</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-mixtures-emstepbystep">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 4.1</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>EM 알고리즘을 단계별로.</strong>예제 데이터 세트로 파일의 값을 사용합니다.<code>myst.rds</code>. 항상 그렇듯이 먼저 데이터를 시각화하는 것이 좋습니다. 히스토그램이 표시됩니다<a class="quarto-xref" href="#fig-EMillustrate-1">수치<span>4.28</span></a>. 우리는이 데이터를 알려지지 않은 수단 및 표준 편차와 알 수없는 혼합물 분획을 가진 두 가지 정규 분포의 혼합으로 모델링 할 것입니다. 우리는 두 구성 요소를 A와 B로 호출합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a>MX<span class="ot">=</span> <span class="fu">readrds</span>(<span class="st">"../data/myst.rds"</span>))<span class="sc">$</span>이바</span>
<span id="cb55-2"><a aria-hidden="true" href="#cb55-2" tabindex="-1"></a><span class="fu">str</span>(MX)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Num [1 : 1800] 0.3038 0.0596 -0.0204 0.1849 0.2842 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(MX),<span class="fu">AES</span>(<span class="at">x =</span>MX))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.025</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 각 값에 대한 멤버십 가중치를 무작위로 할당하여 시작합니다.<code>MX</code>각 구성 요소에 대해</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a>~의<span class="ot">=</span> <span class="fu">runif</span>(<span class="fu">길이</span>(MX))</span>
<span id="cb58-2"><a aria-hidden="true" href="#cb58-2" tabindex="-1"></a>WB<span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span>~의</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>또한 일부 하우스 키핑 변수를 설정해야합니다.<code>반복</code>EM 알고리즘의 반복에 대한 계산;<code>논리</code>현재 통나무를 저장합니다.<code>델타</code>이전 반복에서 현재 반복으로 로그 불가능한 변화를 저장합니다. 우리는 또한 매개 변수를 정의합니다<code>용인</code>,,,<code>미니터</code>그리고<code>맥스 테이터</code>알고리즘의.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a>반복<span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb59-2"><a aria-hidden="true" href="#cb59-2" tabindex="-1"></a>논리<span class="ot">=</span> <span class="sc">-</span><span class="cn">inf</span></span>
<span id="cb59-3"><a aria-hidden="true" href="#cb59-3" tabindex="-1"></a>델타<span class="ot">=</span> <span class="sc">+</span><span class="cn">inf</span></span>
<span id="cb59-4"><a aria-hidden="true" href="#cb59-4" tabindex="-1"></a>용인<span class="ot">=</span> <span class="fl">1E-12</span></span>
<span id="cb59-5"><a aria-hidden="true" href="#cb59-5" tabindex="-1"></a>미니터<span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb59-6"><a aria-hidden="true" href="#cb59-6" tabindex="-1"></a>맥스 테이터<span class="ot">=</span> <span class="dv">1000</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>아래 코드를 연구하고 다음 질문에 답하십시오.</p>
<ol type="a">
<li><p>어떤 라인이 E 단계에 해당 하는가?</p></li>
<li><p>역할은 무엇입니까<code>용인</code>,,,<code>미니터</code>그리고<code>맥스 테이터</code>?</p></li>
<li><p>우리가 여기서하는 일의 결과를<code>Normalmixem</code>기능<strong><a href="https://cran.r-project.org/web/packages/mixtools/">믹스 툴</a></strong>패키지.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" href="#cb60-1" tabindex="-1"></a><span class="cf">~하는 동안</span>((델타<span class="sc">&gt;</span>용인)<span class="sc">&amp;&amp;</span>(반복<span class="sc">&lt;=</span>맥스 테이터)<span class="sc">||</span>(반복<span class="sc">&lt;</span>장관)) {mp3</span>
<span id="cb60-2"><a aria-hidden="true" href="#cb60-2" tabindex="-1"></a>람다<span class="ot">=</span> <span class="fu">평균</span>(의)</span>
<span id="cb60-3"><a aria-hidden="true" href="#cb60-3" tabindex="-1"></a>첫 번째<span class="ot">=</span> <span class="fu">가중치</span>(MX, 사용 가능)</span>
<span id="cb60-4"><a aria-hidden="true" href="#cb60-4" tabindex="-1"></a>요약<span class="ot">=</span> <span class="fu">가중치</span>(MX, WB)</span>
<span id="cb60-5"><a aria-hidden="true" href="#cb60-5" tabindex="-1"></a>SDA<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">가중치</span>((MX<span class="sc">-</span>첫 번째)<span class="sc">^</span><span class="dv">2</span>, 의)))</span>
<span id="cb60-6"><a aria-hidden="true" href="#cb60-6" tabindex="-1"></a>SDB<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">가중치</span>((MX<span class="sc">-</span>mub)<span class="sc">^</span><span class="dv">2</span>, wb))</span>
<span id="cb60-7"><a aria-hidden="true" href="#cb60-7" tabindex="-1"></a></span>
<span id="cb60-8"><a aria-hidden="true" href="#cb60-8" tabindex="-1"></a>아빠<span class="ot">=</span>람다<span class="sc">*</span> <span class="fu">dnorm</span>(MX,<span class="at">평균 =</span>첫 번째,<span class="at">SD =</span>SDA)</span>
<span id="cb60-9"><a aria-hidden="true" href="#cb60-9" tabindex="-1"></a>PB<span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span>람다)<span class="sc">*</span> <span class="fu">dnorm</span>(MX,<span class="at">평균 =</span>멍청이<span class="at">SD =</span>SDB)</span>
<span id="cb60-10"><a aria-hidden="true" href="#cb60-10" tabindex="-1"></a>PTOT<span class="ot">=</span>아빠<span class="sc">+</span>PB</span>
<span id="cb60-11"><a aria-hidden="true" href="#cb60-11" tabindex="-1"></a>~의<span class="ot">=</span>아빠<span class="sc">/</span>PTOT</span>
<span id="cb60-12"><a aria-hidden="true" href="#cb60-12" tabindex="-1"></a>WB<span class="ot">=</span>PB<span class="sc">/</span>PTOT</span>
<span id="cb60-13"><a aria-hidden="true" href="#cb60-13" tabindex="-1"></a></span>
<span id="cb60-14"><a aria-hidden="true" href="#cb60-14" tabindex="-1"></a>loglikold<span class="ot">=</span>논리</span>
<span id="cb60-15"><a aria-hidden="true" href="#cb60-15" tabindex="-1"></a>논리<span class="ot">=</span> <span class="fu">합집합</span>(<span class="fu">통나무</span>(아빠<span class="sc">+</span>PB))</span>
<span id="cb60-16"><a aria-hidden="true" href="#cb60-16" tabindex="-1"></a>델타<span class="ot">=</span> <span class="fu">ABS</span>(loglikold<span class="sc">-</span>논리)</span>
<span id="cb60-17"><a aria-hidden="true" href="#cb60-17" tabindex="-1"></a>반복<span class="ot">=</span>반복<span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb60-18"><a aria-hidden="true" href="#cb60-18" tabindex="-1"></a>}</span>
<span id="cb60-19"><a aria-hidden="true" href="#cb60-19" tabindex="-1"></a>반복</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 447</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a><span class="fu">기음</span>(Lambda, Mua, Mub, SDA, SDB)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4756 -0.1694 0.1473 0.0983 0.1498</code></pre>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display callout-margin-content">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-EMillustrate-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-EMillustrate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-33" href="04-chap_files/figure-html/fig-EMillustrate-1-1.png" title="Figure 4.28: Histogram of mx, our example data for the EM algorithm."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-EMillustrate-1-1.png" width="200"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-EMillustrate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.28 : 히스토그램<code>MX</code>EM 알고리즘에 대한 예제 데이터.</figcaption>
</figure>
</div>
</div></div><div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-39-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-39-contents callout-collapse collapse" id="callout-39">
<div class="callout-body-container callout-body">
<p>처음 5 줄<code>~하는 동안</code>루프를 구현합니다<em>최대화 단계</em>. 현재 값이 주어지면<code>~의</code>그리고<code>WB</code>, 우리는 최대-불쾌한 추정기를 사용하여 혼합물 모델의 매개 변수를 추정합니다 : 혼합물 분획<code>람다</code>평균에 따라<code>~의</code>및 두 가지 정규 분포 성분의 매개 변수 (<code>첫 번째</code>,,,<code>SDA</code>) 그리고 (<code>요약</code>,,,<code>SDB</code>) 샘플 수단과 샘플 표준 편차에 의해. 멤버십 가중치를 고려하기 위해 가중 평균 (기능<code>가중치</code>) 및 표준 편차.</p>
<p>다음은 온다<em>기대 단계</em>. 데이터 벡터의 각 요소에 대해<code>MX</code>, 우리는 확률 밀도를 계산합니다<code>아빠</code>그리고<code>PB</code>정상 밀도 함수를 사용하여 생성 분포 모델 A 및 B의 경우<code>dnorm</code>, 혼합물 분획에 의해 가중<code>람다</code>그리고<code>(1 람다)</code>각각. 이로부터 업데이트 된 멤버십 가중치를 계산합니다<code>~의</code>그리고<code>WB</code>, 에 따르면<a class="quarto-xref" href="#eq-mixtures-membershipweights">방정식<span>4.5</span></a>.</p>
<p>멤버십 가중치와 매개 변수가 주어지면 로그 가능성<code>논리</code>쉽게 계산됩니다<code>~하는 동안</code>루프는 이러한 단계를 반복합니다.</p>
<p>루프의 종료 기준은 다음과 같습니다<code>델타</code>, 가능성의 변화. 루프가 더 작아지면 루프가 종료 될 수 있습니다<code>용인</code>. 이것은 알고리즘이 수렴되었는지 여부를 확인하는 간단한 방법입니다. 추가 조건<code>반복</code>적어도 그것을 확인하십시오<code>미니터</code>반복이 실행되고 루프가 항상 멈 춥니 다.<code>맥스 테이터</code>반복. 후자는 루프가 어떤 일이 있어도 유한 한 시간으로 종료되도록하는 것입니다. (이러한 반복 알고리즘의 "전문적인"구현은 일반적으로 중지하기에 가장 좋은시기를 결정하기 위해 조금 더 어렵습니다.)</p>
<p>마지막으로, 우리의 추정치를 기능의 추정치와 비교해 봅시다.<code>Normalmixem</code>에서<strong><a href="https://cran.r-project.org/web/packages/mixtools/">믹스 툴</a></strong>패키지.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a>GM<span class="ot">=</span>믹스 툴<span class="sc">::</span><span class="fu">Normalmixem</span>(MX,<span class="at">k =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>반복 수 = 215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" href="#cb66-1" tabindex="-1"></a><span class="fu">~와 함께</span>(GM,<span class="fu">기음</span>(Lambda [<span class="dv">1</span>], in, Sigma)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4757 -0.1694 0.1473 0.0983 0.1498</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-mixtures-whylog">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 4.2</div>
</div>
<div class="callout-body-container callout-body">
<p>왜 우리는 종종 가능성보다는 가능성의 로그를 고려합니까? 예를 들어, 위의 EM 코드에서 왜 우리는 로그 척도에서 확률로 작업 했습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-41-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-41-contents callout-collapse collapse" id="callout-41">
<div class="callout-body-container callout-body">
<p>가능성은 종종 (데이터 포인트가 독립적으로 샘플링 될 때마다) 제품의 형태를 취합니다. 예를 들어, 사례입니다<a class="quarto-xref" href="#eq-mixtures-factorizedlikelihood">방정식<span>4.4</span></a>. 가능성 최적화를 위해 미분을 계산하려면 제품 규칙의 적용이 필요합니다. 로그 척도에서, 제품은 합으로 바뀌고 합의 파생물은 단순히 개별 요약의 파생물의 합입니다.</p>
<p>추가 이유는 컴퓨터가 산술을 구현하는 방식에서 비롯됩니다. 그들은 일반적으로 유한 수의 비트를 가진 숫자의 부동 소수점 표현을 사용합니다. 예를 들어, IEEE 754-2008 표준은 64 비트를 사용합니다.<em>이중 프레임</em>숫자 : 부호의 경우 1 비트, Mantissa (impiction)의 경우 52, 지수의 경우 11. 그러한 숫자 사이의 곱셈은 지수의 추가를 의미하지만 지수의 범위는<span class="math inline">\ (0 \)</span>에게<span class="math inline">\ (2^{11} -1 = 2047 \)</span>. 수백 개의 데이터 포인트 만 포함하는 가능성조차도 산술 오버플로 또는 정밀도 문제로 이어질 수 있습니다. 제품이 합계 인 로그 척도에서, 워크로드는 Mantissa와 지수 사이에 더 잘 분포되는 경향이 있으며, 수백만 개의 데이터 포인트가 합리적인 정밀도로 처리 되더라도 로그 원성성.</p>
<p>Gregory Gundersen의 게시물도 참조하십시오<a href="https://gregorygundersen.com/blog/2020/02/09/log-sum-exp/">로그 확률의 벡터를 정상화하기위한 로그 -Sum-EXP 트릭</a>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-mixtures-comparenb">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 4.3</div>
</div>
<div class="callout-body-container callout-body">
<p>Gamma-Poisson 분포의 이론적 값을 추정치에 의해 주어진 매개 변수와 비교하십시오.<code>ofit $ by</code>~에<a class="quarto-xref" href="#sec-gammadist"><span>섹션 4.4.3</span></a>QQ 플롯을 사용한 추정에 사용 된 데이터.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-mixtures-regressionmixt">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 4.4</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>회귀를위한 혼합 모델링 예</strong>. 그만큼<strong><a href="https://cran.r-project.org/web/packages/flexmix/">Flexmix</a></strong>패키지<span class="citation" data-cites="Grun2012">(<a href="16-chap.html#ref-Grun2012" role="doc-biblioref">Green, Scharl 및 Leisch 2012</a>))</span>우리는 데이터에 동시에 클러스터링하고 회귀를 맞출 수 있습니다. 표준 M 단계<code>flxmrglm</code>~의<strong><a href="https://cran.r-project.org/web/packages/flexmix/">Flexmix</a></strong>R의 일반화 된 선형 모델링 시설에 대한 인터페이스입니다 (<code>GLM</code>기능). 패키지와 예제 데이터 세트를로드하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" href="#cb68-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Flexmix"</span>))</span>
<span id="cb68-2"><a aria-hidden="true" href="#cb68-2" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"npreg"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>먼저 데이터를 플롯하고 포인트가 어떻게 생성되었는지 추측하십시오.</p></li>
<li><p>명령을 사용하여 두 구성 요소 혼합 모델을 맞추십시오</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a aria-hidden="true" href="#cb69-1" tabindex="-1"></a>M1<span class="ot">=</span> <span class="fu">Flexmix</span>(안에<span class="sc">~</span>엑스<span class="sc">+</span> <span class="fu">나</span>(엑스<span class="sc">^</span><span class="dv">2</span>),)<span class="at">데이터 =</span>npreg,<span class="at">k =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li><p>혼합 구성 요소의 예상 매개 변수를보고 실제 클래스 대 클러스터 멤버십을 교차 클래스하는 진실 테이블을 만드십시오. 대상의 요약은 무엇을합니까?<code>M1</code>보여주세요?</p></li>
<li><p>이번에는 추정 클래스에 따라 각 지점을 채색합니다.</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-44-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-44-contents callout-collapse collapse" id="callout-44">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" href="#cb70-1" tabindex="-1"></a><span class="fu">ggplot</span>(npreg,<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>안에))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-npreg">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-npreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-34" href="04-chap_files/figure-html/fig-npreg-1.png" title="Figure 4.29: The points seem to come from two different generative processes, one is linear; the other quadratic."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-npreg-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-npreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.29 : 점은 두 가지 다른 생성 프로세스에서 나오는 것처럼 보이며 하나는 선형입니다. 다른 2 차.</figcaption>
</figure>
</div>
</div>
</div>
<p>구성 요소는 다음과 같습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a aria-hidden="true" href="#cb71-1" tabindex="-1"></a>Modelools<span class="sc">::</span><span class="fu">매개 변수</span>(M1,<span class="at">구성 요소 =</span> <span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>comp.1
Coef. (인터셉트) -0.20998685
Coef.x 4.81807854
Coef.i (x^2) 0.03613061
시그마 3.47665584</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a aria-hidden="true" href="#cb73-1" tabindex="-1"></a>Modelools<span class="sc">::</span><span class="fu">매개 변수</span>(M1,<span class="at">구성 요소 =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>comp.2
Coef. (인터셉트) 14.7167886
Coef.x 9.8468507
Coef.i (x^2) -0.9683734
시그마 3.4795657</code></pre>
</div>
</div>
<p>두 구성 요소의 매개 변수 추정치는 실제 값에 가깝습니다. 실제 클래스 및 클러스터 멤버십의 교차 표현은</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a aria-hidden="true" href="#cb75-1" tabindex="-1"></a><span class="fu">테이블</span>(npreg<span class="sc">$</span>클래스, modeltools<span class="sc">::</span><span class="fu">클러스터</span>(M1))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2
  1 95 5
  2 5 95</code></pre>
</div>
</div>
<p>이 예제 데이터의 경우, 두 구성 요소의 비율은 대략 0.7이며, 이는 선과 포물선의 단면에서 클래스의 중첩을 나타냅니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a><span class="fu">요약</span>(M1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>요약은 추정 된 사전 확률을 보여줍니다<span class="math inline">\ (\ hat \ pi_k \)</span>, 두 클러스터에 할당 된 관찰 수, 관측 수<span class="math inline">\ (p_ {nk}&gt; \ delta \)</span>(기본값으로<span class="math inline">\ (\ delta = 10^{-4} \)</span>), 후자의 두 숫자의 비율. 잘 분리 된 구성 요소의 경우, 비 정기 후구를 사용한 많은 비율의 관찰<span class="math inline">\ (p_ {nk} \)</span>클러스터에 할당되어 1에 가까운 비율을 제공해야합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a>npreg<span class="ot">=</span> <span class="fu">돌연변이</span>(npreg,<span class="at">gr =</span> <span class="fu">요인</span>(수업))</span>
<span id="cb78-2"><a aria-hidden="true" href="#cb78-2" tabindex="-1"></a><span class="fu">ggplot</span>(npreg,<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>안에,,<span class="at">그룹 =</span>Gr))<span class="sc">+</span></span>
<span id="cb78-3"><a aria-hidden="true" href="#cb78-3" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>gr,<span class="at">모양 =</span>Gr))<span class="sc">+</span></span>
<span id="cb78-4"><a aria-hidden="true" href="#cb78-4" tabindex="-1"></a>   <span class="fu">scale_colour_hue</span>(<span class="at">l =</span> <span class="dv">40</span>,,,<span class="at">c =</span> <span class="dv">180</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-npregC">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-npregC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-35" href="04-chap_files/figure-html/fig-npregC-1.png" title="Figure 4.30: Regression example using flexmix with the points colored according to their estimated class. You can see that at the intersection we have an `identifiability’ problem: we cannot distinguish points that belong to the straight line from ones that belong to the parabole."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="04-chap_files/figure-html/fig-npregC-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-npregC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 4.30 : 회귀 예제 사용<code>Flexmix</code>추정 클래스에 따라 점을 채색합니다. 교차로에서 우리는 '식별 가능성'문제가 있음을 알 수 있습니다. 우리는 가종에 속하는 직선과 직선에 속하는 지점을 구별 할 수 없습니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-mixtures-hierarchicalnoise">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 4.5</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>기타 계층 적 노이즈 모델 :</strong><br/>분자 생물학 기술 변화를 모델링하기위한 다른 무한 혼합물의 사용을 탐구하는 두 가지 논문을 찾으십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-46-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-46-contents callout-collapse collapse" id="callout-46">
<div class="callout-body-container callout-body">
<p>종이<span class="citation" data-cites="Chen2011">Chen, Xie 및 Story (<a href="16-chap.html#ref-Chen2011" role="doc-biblioref">2011</a>))</span>비드 어레이의 배경 노이즈 모델링을위한 지수-포이슨 모델을 탐색합니다.<span class="citation" data-cites="Wills2013">Wills et al. (<a href="16-chap.html#ref-Wills2013" role="doc-biblioref">2013</a>))</span>여러 Poisson 혼합 모델을 비교합니다.</p>
</div>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Anscombe1948" role="listitem">Anscombe, Francis J. 1948.<span>“의 변화<span>피</span>Oisson, Binomial 및 부정적인 이분기 데이터.”</span> <em>생체 인식</em>, 246–54.</div>
<div class="csl-entry" id="ref-Bishop:PRML" role="listitem">주교, Christopher M. 2006.<em>패턴 인식 및 기계 학습</em>. 뛰는 것.</div>
<div class="csl-entry" id="ref-BronsteinSemendjajew" role="listitem">Bronštein, Jja N. 및 Konstantin A Semendjaj. 1979.<em>수학의 페이퍼 백</em>. B.G. Teubner Verlagsgesellschaft, 라이프 치히; Verlag Nauka, 모스크바.</div>
<div class="csl-entry" id="ref-bulmer2003" role="listitem">Bulmer, Michael George. 2003.<em>Francis Galton : 유전과 생체 측정의 선구자</em>, Jhu Press.</div>
<div class="csl-entry" id="ref-Chen2011" role="listitem">Chen, Min, Yang Xie 및 Michael Story. 2011.<span>“배경 보정을위한 지수-감마 컨볼 루션 모델<span>나</span>빛<span>비니</span>데이터."</span> <em>통계 이론 및 방법의 커뮤니케이션</em>40 (17) : 3055–69.</div>
<div class="csl-entry" id="ref-diaconis1980finite" role="listitem">집사, 페르시, 데이비드 프리드먼. 1980.<span>"유한 교환 시퀀스."</span> <em>확률의 연대기</em>, 745–64.</div>
<div class="csl-entry" id="ref-Diaconis1994" role="listitem">집사, 페르시, 수잔 홈즈. 1994.<span>"무작위 배정 절차를위한 회색 코드."</span> <em>통계 및 컴퓨팅</em>4 (4) : 287–302.</div>
<div class="csl-entry" id="ref-Efron:1994" role="listitem">Efron, Bradley 및 Robert J Tibshirani. 1994.<em>부트 스트랩 소개</em>. CRC 프레스.</div>
<div class="csl-entry" id="ref-efront" role="listitem">Efron, B. 및 R. Tibshirani. 1993.<em>부트 스트랩 소개</em>. 채프먼 &amp; 홀/CRC.</div>
<div class="csl-entry" id="ref-Grun2012" role="listitem">Green, Bettina, Theresa Scharl 및 Friedrich Leisch. 2012.<span>"선형 첨가제 모델의 유한 혼합물을 갖춘 시간 코스 유전자 발현 데이터 모델링."</span> <em>생물 정보학</em>28 (2) : 222–28.<a href="https://doi.org/10.1093/bioinformatics/btr653">https://doi.org/10.1093/bioinformatics/btr653</a>.
</div>
<div class="csl-entry" id="ref-hoeting1999" role="listitem">Hoeting, Jennifer A, David Madigan, Adrian E Raftery 및 Chris T Volinsky. 1999.<span>"베이지안 모델 평균 : 튜토리얼."</span> <em>통계 과학</em>, 382–401.</div>
<div class="csl-entry" id="ref-Kery2015" role="listitem">Kéry, Marc 및 J Andrew Royle. 2015.<em>생태학에서의 적용 계층 적 모델링 : R 및 버그의 분포, 풍부 및 종 풍부 성 분석 : 1 권 : Prelude 및 정적 모델</em>. 학업 언론.</div>
<div class="csl-entry" id="ref-Kristiansson2009" role="listitem">Kristiansson, Erik, Michael Thorsen, Markus J Tamás 및 Olle Nerman. 2009 년.<span>"진화력은 프로모터 길이에 작용합니다 : 풍부한 시스 조절 요소의 식별."</span> <em>분자 생물학 및 진화</em>26 (6) : 1299–1307.</div>
<div class="csl-entry" id="ref-Kuan2011statistical" role="listitem">두려움, Pei FN, Doggun Folg, Guangjein Pan, James A Thomson, Ron Stepar, Sennuz Genera. 2011.<span>“분석을위한 통계 프레임 워크<span>Chip-seq</span>데이터."</span> <em>미국 통계 협회 저널</em>106 (495) : 891–903.</div>
<div class="csl-entry" id="ref-lange2016mm" role="listitem">LANGE, 케네스 2016.<em>MM 최적화 알고리즘</em>. 시암.</div>
<div class="csl-entry" id="ref-mclachlan2007algorithm" role="listitem">McLachlan, Geoffrey 및 Thriyambakam Krishnan. 2007.<em>그만큼<span>여자 이름</span>알고리즘 및 확장</em>. vol. 382. John Wiley &amp; Sons.</div>
<div class="csl-entry" id="ref-mclachlan2004" role="listitem">McLachlan, Geoffrey 및 David Peel. 2004.<em>유한 혼합 모델</em>. John Wiley &amp; Sons.</div>
<div class="csl-entry" id="ref-mcmurdie2014" role="listitem">McMurdie, Paul J 및 Susan Holmes. 2014.<span>"폐기물은 원하지 않습니다.</span> <em>PLOS 계산 생물학</em>10 (4) : E1003531.</div>
<div class="csl-entry" id="ref-Purdom2005" role="listitem">Purdom, Elizabeth 및 Susan P Holmes. 2005.<span>"유전자 발현 데이터에 대한 오류 분포."</span> <em>유전학 및 분자 생물학에서의 통계 적용</em>4 (1).</div>
<div class="csl-entry" id="ref-Rice:2007" role="listitem">라이스, 존. 2006.<em>수학적 통계 및 데이터 분석</em>. Cengage Learning.</div>
<div class="csl-entry" id="ref-CosmaShalizi2017" role="listitem">Shalizi, Cosma. 2017.<em>기본 관점에서 고급 데이터 분석</em>. 케임브리지 대학교 출판부.<a href="https://www.stat.cmu.edu/~cshalizi/ADAfaEPoV/ADAfaEPoV.pdf">https://www.stat.cmu.edu/~cshalizi/adafaepov/adafaepov.pdf</a>.
</div>
<div class="csl-entry" id="ref-Slonim:2005" role="listitem">Slonim, Noam, Gurinder Singh Atwal, Gašper Tkačik 및 William Bialek. 2005.<span>"정보 기반 클러스터링."</span> <em>PNA</em>102 (51) : 18297–302.</div>
<div class="csl-entry" id="ref-Tibshirani1996" role="listitem">Tibshirani, Robert. 1996.<span>"회귀 수축과 선정을 통한 선택."</span> <em>왕실 통계 학회지. 시리즈 B (방법 론적)</em>, 267–88.</div>
<div class="csl-entry" id="ref-Wills2013" role="listitem">Wills, Quin F, Kenneth J Livak, Alex J Tipping, Tariq Enver, Andrew J Goldson, Darren W Sexton 및 Chris Holmes. 2013.<span>"단일 세포 유전자 발현 분석은 전 조직 실험에서 마스크 된 유전자 연관성을 보여준다."</span> <em>자연 생명 공학</em>31 (8) : 748–52.</div>
<div class="csl-entry" id="ref-Zeileis:2008" role="listitem">Zeileis, Achim, Christian Kleiber 및 Simon Jackman. 2008.<span>“카운트 데이터에 대한 회귀 모델<span>아르 자형</span>.”</span> <em>통계 소프트웨어 저널</em>27 (8).<a href="http://www.jstatsoft.org/v27/i08/">http://www.jstatsoft.org/v27/i08/</a>.
</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
