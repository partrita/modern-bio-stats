<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>7  Multivariate Analysis – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="7  Multivariate Analysis – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="7  Multivariate Analysis – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">7.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#what-are-the-data-matrices-and-their-motivation" href="#what-are-the-data-matrices-and-their-motivation" id="toc-what-are-the-data-matrices-and-their-motivation"><span class="header-section-number">7.2</span>데이터는 무엇입니까? 매트릭스와 동기 부여</a></li>
<li><a class="nav-link" data-scroll-target="#dimension-reduction" href="#dimension-reduction" id="toc-dimension-reduction"><span class="header-section-number">7.3</span>치수 감소</a></li>
<li><a class="nav-link" data-scroll-target="#the-new-linear-combinations" href="#the-new-linear-combinations" id="toc-the-new-linear-combinations"><span class="header-section-number">7.4</span>새로운 선형 조합</a></li>
<li><a class="nav-link" data-scroll-target="#the-pca-workflow" href="#the-pca-workflow" id="toc-the-pca-workflow"><span class="header-section-number">7.5</span>PCA 워크 플로</a></li>
<li><a class="nav-link" data-scroll-target="#the-inner-workings-of-pca-rank-reduction" href="#the-inner-workings-of-pca-rank-reduction" id="toc-the-inner-workings-of-pca-rank-reduction"><span class="header-section-number">7.6</span>PCA의 내부 작업 : 순위 감소</a></li>
<li><a class="nav-link" data-scroll-target="#plotting-the-observations-in-the-principal-plane" href="#plotting-the-observations-in-the-principal-plane" id="toc-plotting-the-observations-in-the-principal-plane"><span class="header-section-number">7.7</span>주요 평면에서 관측치를 플로팅합니다</a></li>
<li><a class="nav-link" data-scroll-target="#pca-as-an-exploratory-tool-using-extra-information" href="#pca-as-an-exploratory-tool-using-extra-information" id="toc-pca-as-an-exploratory-tool-using-extra-information"><span class="header-section-number">7.8</span>탐색 도구로서의 PCA : 추가 정보 사용</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">7.9</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">7.10</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">7.11</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-multivariate"><span class="chapter-number">7</span>  <span class="chapter-title">다변량 분석</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/TheMatrix.jpg"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/TheMatrix.jpg"/></a></p>
</figure>
</div>
</div></div></div>
<p>많은 데이터 세트는 환자, 샘플 또는 유기체와 같은 동일한 대상 세트에서 측정 된 여러 변수로 구성됩니다. 예를 들어, 우리는 높이, 체중, 연령, 혈압, 혈당, 심박수 및 천명의 유전자 데이터와 같은 임상 변수와 같은 생체 인식 특성을 가질 수 있습니다. 그만큼<em>이유</em>다변량 분석의 경우 측정 된 서로 다른 변수 간의 연결 또는 연관성을 조사하는 것입니다. 일반적으로 데이터는 각 주제에 대해 하나의 행, 각 변수에 대해 하나의 열이있는 표의 표 데이터 구조로보고됩니다. 다음은 각 변수가 숫자 인 특수 사례에 중점을 두므로 데이터 구조를<em>행렬</em>R.에서</p>
<p>매트릭스의 열이 모두 서로 독립적 인 경우 (관련되지 않은), 우리는 단순히 각 열을 별도로 연구하고 표준 "일 변량"통계를 하나씩 수행 할 수 있습니다. 매트릭스로 연구하는 데 도움이되지 않습니다.</p>
<p>더 자주 패턴과 종속성이 있습니다. 예를 들어, 세포의 생물학에서, 우리는 증식 속도가 많은 유전자의 발현에 동시에 영향을 미칠 것임을 알고있다. 환자 유래 세포의 많은 샘플 (행)에서 25,000 유전자 (열)의 발현을 연구하면서, 많은 유전자가 함께 작용하는 것으로 나타났습니다. 각 유전자 만 별도로 연구한다면 중요한 정보를 많이 놓칠 것입니다. 유전자 간의 중요한 연결은 데이터 전체를 고려할 때만 탐지 할 수 있습니다. 각 행은 동일한 관찰 단위에서 이루어진 많은 측정을 나타냅니다. 그러나 한 번에 고려해야 할 25,000 차원의 변동이있는 것은 어려운 일입니다. 데이터를 더 적은 수의 가장 중요한 차원으로 줄이는 방법을 보여 드리겠습니다.<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>너무 많은 정보를 잃지 않고.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>우리는 아래에서 훨씬 더 자세하게 치수 감소에 대한이 아이디어를 자세히 설명 할 것입니다. 당분간 우리는 4 차원 세계에 살고 있다는 것을 기억하십시오.</p></div></div><p>이 장에서는 고 처리량 실험에서 발생하는 다변량 데이터 매트릭스의 많은 예와 직감을 향상시킬 수있는 몇 가지 기본 예를 제시합니다. 우리는이 장에 중점을 둘 것입니다<strong>피</strong>rincipal<strong>기음</strong>요소<strong>에이</strong>nalysis, 약식<strong>PCA</strong>, a<strong>치수 감소</strong>방법. PCA 분석의 출력을 해석하는 데 도움이되는 시각화뿐만 아니라 알고리즘에 대한 기하학적 설명을 제공 할 것입니다.</p>
<section class="level2" data-number="7.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="7.1"><span class="header-section-number">7.1</span>이 장의 목표</h2>
<p>이 장에서는 다음과 같습니다.</p>
<ul>
<li><p>생물학적 데이터 연구에서 나오는 매트릭스의 예를 참조하십시오.</p></li>
<li><p>변수 간의 상관 관계를 이해하려면 차원 감소를 수행하십시오.</p></li>
<li><p>다변량 분석을 시작하기 전에 데이터를 전제, 재생산 및 중앙 데이터.</p></li>
<li><p>원래 측정보다 유용한 주요 구성 요소 (PC)라고하는 새로운 변수를 구축하십시오.</p></li>
<li><p>PCA의 "후드 아래"가 무엇인지 확인하십시오 : 행렬의 단일 값 분해.</p></li>
<li><p>이 분해가 달성 한 것을 시각화하고 주요 구성 요소의 수를 선택하는 방법을 배우십시오.</p></li>
<li><p>완전한 PCA 분석을 처음부터 끝까지 실행하십시오.</p></li>
<li><p>프로젝트 팩터는 PCA 맵에 공변하여 결과를보다 유용한 해석 할 수 있습니다.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="7.2" id="what-are-the-data-matrices-and-their-motivation">
<h2 class="anchored" data-anchor-id="what-are-the-data-matrices-and-their-motivation" data-number="7.2"><span class="header-section-number">7.2</span>데이터는 무엇입니까? 매트릭스와 동기 부여</h2>
<p>먼저, 직사각형의 예를 살펴 보겠습니다.<strong>매트릭스</strong>측정 테이블을 나타내는 데 사용됩니다. 각 행렬에서 행과 열은 특정 엔티티를 나타냅니다.</p>
<p><strong>거북이 :</strong>기본 원리를 이해하는 데 도움이되는 간단한 데이터 세트는 페인트 거북에 대한 3 차원의 생체 측정 매트릭스입니다.<span class="citation" data-cites="Jolicoeur1960">(<a href="16-chap.html#ref-Jolicoeur1960" role="doc-biblioref">Jolicoeur와 Mosimann 1960</a>))</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>거북이<span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"../data/PaintedTurtles.txt"</span>,,,<span class="at">헤더 =</span> <span class="cn">진실</span>))</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>거북이 [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>성 길이 너비 높이
1 F 98 81 38
2 F 103 84 38
3 F 103 86 42
4 F 105 86 40</code></pre>
</div>
</div>
<p>마지막 3 개의 열은 길이 측정 (밀리미터) 인 반면 첫 번째 열은 각 동물의 성별을 알려주는 요인 변수입니다.</p>
<p><strong>운동 선수 :</strong>이 매트릭스는 스포츠 세계의 흥미로운 예입니다. 그것은 Decathlon의 10 개 분야에서 33 명의 선수들의 공연을보고합니다.<code>M100</code>,,,<code>M400</code>그리고<code>M1500</code>100 미터, 400 미터 및 1500 미터의 시간의 시간입니다.<code>M110</code>110 미터 장애물을 끝내는 시간입니다.<code>폴</code>기둥 금고 높이입니다<code>높은</code>그리고<code>긴</code>높이와 긴 점프의 결과는 모두 미터입니다.<code>무게</code>,,,<code>디스크</code>, 그리고<code>표백제</code>운동 선수가 체중, 원반 및 창 던지기를 던질 수 있었던 미터의 길이입니다. 처음 3 명의 선수를위한 이러한 변수는 다음과 같습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"국제 올림픽 경기 대회"</span>,,,<span class="at">패키지 =</span> <span class="st">"ADE4"</span>))</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a>운동 선수<span class="ot">=</span> <span class="fu">setNames</span>(국제 올림픽 경기 대회<span class="sc">$</span>꼬리표,</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>  <span class="fu">기음</span>(<span class="st">"M100"</span>,,,<span class="st">"긴"</span>,,,<span class="st">"무게"</span>,,,<span class="st">"높은"</span>,,,<span class="st">"M400"</span>,,,<span class="st">"M110"</span>,,,<span class="st">"디스크"</span>,,,<span class="st">"폴"</span>,,,<span class="st">"표백제"</span>,,,<span class="st">"M1500"</span>)))</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a>운동 선수 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>M100 긴 무게 높이 M400 M110 디스크 장대 창조 M1500
1 11.25 7.43 15.48 2.27 48.90 15.13 49.28 4.7 61.32 268.95
2 10.87 7.45 14.97 1.97 47.71 14.46 44.36 5.1 61.76 273.02
3 11.18 7.44 14.20 1.97 48.29 14.81 43.66 5.2 64.16 263.20</code></pre>
</div>
</div>
<p><strong>셀 유형 :</strong> <span class="citation" data-cites="holmes2005memory">Holmes et al. (<a href="16-chap.html#ref-holmes2005memory" role="doc-biblioref">2005</a>))</span>상이한 대상으로부터 분류 된 T- 세포 집단의 유전자 발현 프로파일을 연구했다. 컬럼은 유전자 발현 측정의 서브 세트이며, 세포 유형 사이의 차등 발현을 나타내는 156 개의 유전자에 해당한다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/msig3transp.rdata"</span>))</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a><span class="fu">둥근</span>(MSSSSST3TRANSP,<span class="dv">2</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X3968 X14831 X13492 X5108 X16348 X585
HEA26_EFFE_1 -2.61 -1.19 -0.06 -0.15 0.52 -0.02
HEA26_MEM_1 -2.26 -0.47 0.28 0.54 -0.37 0.11
HEA26_NAI_1 -0.27 0.82 0.81 0.72 -0.90 0.75
Mel36_effe_1 -2.24 -1.08 -0.24 -0.18 0.64 0.01
MEL36_MEM_1 -2.68 -0.15 0.25 0.95 -0.20 0.17</code></pre>
</div>
</div>
<p><strong>박테리아 종 풍부함 :</strong>카운트의 매트릭스는 미생물 생태학 연구에 사용됩니다 (우리가 보았 듯이<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>). 여기서 컬럼은 박테리아의 다른 종 (또는 작동 분류 학적 단위, OTU)을 나타냅니다. 이것은 수치 태그로 식별됩니다. 행은 측정 된 샘플에 따라 표지되며 (정수) 숫자는 각 샘플에서 관찰 된 각 OTU의 횟수를 나타냅니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"GlobalPatterns"</span>,,,<span class="at">패키지 =</span> <span class="st">"Phyloseq"</span>))</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a>gpotus<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">티</span>(Phyloseq<span class="sc">::</span><span class="fu">One_table</span>(GlobalPatterns))))</span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3" tabindex="-1"></a>gpotus [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,,,<span class="dv">6</span><span class="sc">:</span><span class="dv">13</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OTU 테이블 : [4 개의 분류군과 8 개의 샘플]
                     분류군은 줄입니다
        246140 143239 244960 255340 144887 141782 215972 31759
CL3 0 7 0 153 3 9 0 0
CC1 0 1 0 194 5 35 3 1
SV1 0 0 0 0 0 0
M31FCSW 0 0 0 0 0 0 0</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="imgs/devil.png" title="Notice the propensity of the matrix entries to be zero; we call such data sparse."><img alt="Notice the propensity of the matrix entries to be zero; we call such data sparse." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>매트릭스 항목의 성향이 0이라는 것을 알 수 있습니다. 우리는 그러한 데이터를 호출합니다<strong>부족한</strong>.</figcaption>
</figure>
</div>
</div></div></div>
<p><strong>mRNA 읽기 :</strong>RNA-Seq Transcriptome 데이터 보고서 서열 수는 각 유전자와 일치하는 것과 일치합니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>여러 생물학적 샘플 각각에서. 우리는이 유형의 데이터를 자세히 연구 할 것입니다.<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>또는 엑손과 같은 하위 유전자 구조.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"요약 실험"</span>))</span>
<span id="cb9-2"><a aria-hidden="true" href="#cb9-2" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"기도"</span>,,,<span class="at">패키지 =</span> <span class="st">"기도"</span>))</span>
<span id="cb9-3"><a aria-hidden="true" href="#cb9-3" tabindex="-1"></a><span class="fu">시험</span>(기도)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SRR1039508 SRR1039509 SRR1039512 SRR1039513
ENSG00000000003 679 448 873 408
ENSG00000000005 0 0 0 0
ENSG00000000419 467 515 621 365</code></pre>
</div>
</div>
<p>그것은 RNA-Seq 필드에서 관례 적이므로<code>기도</code>위의 데이터 - 행의 유전자와 열의 샘플을보고합니다. 우리가 여기에서 보는 다른 행렬과 비교하여 이것은<em>전환</em>: 행과 열이 교환됩니다. 이러한 다른 규칙은 쉽게 오류로 이어 지므로 주목할 가치가 있습니다.<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>. <strong>단백질 프로파일 :</strong>여기서 열은 정렬됩니다<strong>질량 분광학</strong>피크 또는 분자를 통해 확인되었습니다<span class="math inline">\ (m/z \)</span>-RATIOS; 행렬의 항목은 측정 된 강도입니다<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>Biocenductor Project는 이러한 규칙이 명시 적으로 고정 된 데이터 컨테이너를 정의하여 사용자와 개발자가 이러한 모호성을 피하도록 돕기 위해 노력합니다. ~ 안에<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>, 우리는 그 예를 볼 것입니다<em>요약 경험</em>수업.</p></div><div id="fn4"><p><sup>4</sup>자세한 내용은 예를 들어 on을 찾을 수 있습니다<a href="https://en.wikipedia.org/wiki/Mass_spectrum">위키 백과</a>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a>대사<span class="ot">=</span> <span class="fu">티</span>(<span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">"../data/metabolites.csv"</span>,,,<span class="at">row.names =</span> <span class="dv">1</span>))))</span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>대체 [<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>146.0985388 148.7053275 310.1505057 132.4512963
Kogchum1 29932.36 17055.70 1132.82 785.5129
Kogchum2 94067.61 74631.69 28240.85 5232.0499
Kogchum3 146411.33 147788.71 64950.49 10283.0037
WTGCHUM1 229912.57 384932.56 220730.39 26115.2007</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="imgs/devil.png" title="In many of the matrices we have seen here, important information about the samples (subjects) and the measured features is stored in the row or column names, often through some ad hoc string concatenation. This is not the best place to store all available information, and quickly becomes limiting and error-prone. A much better approach is the Bioconductor SummarizedExperiment class."><img alt="In many of the matrices we have seen here, important information about the samples (subjects) and the measured features is stored in the row or column names, often through some ad hoc string concatenation. This is not the best place to store all available information, and quickly becomes limiting and error-prone. A much better approach is the Bioconductor SummarizedExperiment class." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>우리가 여기서 본 많은 행렬에서 샘플 (대상) 및 측정 된 특징에 대한 중요한 정보는 종종 일부 임시 문자열 연결을 통해 행 또는 열 이름에 저장됩니다. 이것은 모든 가용 정보를 저장하기에 가장 좋은 곳이 아니며 제한되고 오류가 발생하기 쉽습니다. 훨씬 더 나은 접근 방식은 생체 전도체입니다<em>요약 경험</em>수업.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>특정에 대해 피크가 감지되지 않은 경우<span class="math inline">\ (m/z \)</span>질량 분광법 실행에서 점수가 기록되었고, 0이 기록되었습니다.<code>대사</code>. 마찬가지로, 0은<code>gpotus</code>또는<code>기도</code>일치하는 시퀀스가 ​​감지되지 않은 경우 객체가 발생합니다. 이 데이터 매트릭스에서 0의 주파수를 표로 작성하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-namesvariables">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.1</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>이 데이터 매트릭스의 열은 일반적으로 호출됩니까?</p></li>
<li><p>이 각 예제에서 행렬의 행은 무엇입니까?</p></li>
<li><p>매트릭스의 셀은 무엇을 나타내나요?</p></li>
<li><p>데이터 매트릭스가 호출되는 경우<code>운동 선수</code>그리고 당신은 다섯 번째 선수의 세 번째 변수의 값을보고 싶습니다. R에 무엇을 입력합니까?</p></li>
</ol>
</div>
</div>
<section class="level3 page-columns page-full" data-number="7.2.1" id="low-dimensional-data-summaries-and-preparation">
<h3 class="anchored" data-anchor-id="low-dimensional-data-summaries-and-preparation" data-number="7.2.1"><span class="header-section-number">7.2.1</span>저 차원 데이터 요약 및 준비</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-flatland">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-flatland-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="imgs/flatland.png" title="Figure 7.1: xkcd: What do we mean by low-dimensional? We live in 3 dimensions, or 4 if you count time, a plane has 2 dimensions, a line has one dimension. A point is said to be zero-dimensional. For the amusing novel referenced in the cartoon see @Abbott:1884."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/flatland.png"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-flatland-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.1 : XKCD : 저 차원이란 무엇을 의미합니까? 우리는 3 차원으로 살고 있으며, 시간을 계산하면 비행기에는 2 차원이 있고 선에는 1 차원이 있습니다. 요점은 차원 제로라고합니다. 만화에서 언급 된 재미있는 소설은 참조하십시오<span class="citation" data-cites="Abbott:1884">애보트 (Abbott)<a href="16-chap.html#ref-Abbott:1884" role="doc-biblioref">1884</a>))</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>우리가 하나의 변수 만 연구하는 경우, 즉 거북이 행렬의 세 번째 열만<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>, 우리는 1 차원 데이터를보고 있다고 말합니다. 이러한 벡터, 모든 거북이 무게는 우리가 본 것과 같은 플롯으로 시각화 할 수 있습니다.<a class="quarto-xref" href="03-chap.html#sec-graphics-univar"><span>섹션 3.6</span></a>, 예를 들어, 히스토그램. 평균 또는 중간 값이라고 한 숫자 요약을 계산하면 1 차원 데이터에 대한 차원의 차원 요약을 작성했습니다. 이것은 이미 치수 감소의 예입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>행렬의 세 번째 열<span class="math inline">\(엑스\)</span>수학적으로 표시됩니다<span class="math inline">\ ({\ mathbf x} _ {\ cdot 3} \)</span>또는 R을 사용하여 액세스합니다<code>x [, 3]</code>.</p></div></div><p>~ 안에<a class="quarto-xref" href="03-chap.html"><span>3 장</span></a>우리는 2 차원 산란 플로트를 연구했습니다. 우리는 관찰이 너무 많으면 데이터를 (육각형) 쓰레기통으로 그룹화하는 것이 도움이 될 수 있음을 알았습니다.<em>2 차원</em>히스토그램. 두 변수를 고려할 때 (<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>) 일련의 관측치에서 함께 측정 됨<strong>상관 계수</strong>변수의 공동 변수를 측정합니다. 이것은 2 차원 데이터의 단일 숫자 요약입니다. 그 공식에는 요약이 포함됩니다<span class="math inline">\ (\ bar {x} \)</span>그리고<span class="math inline">\ (\ bar {y} \)</span>:</p>
<p><span class="anchored-eq" data-anchor-id="eq-corrcoeff" id="eq-corrcoeff"><span class="math display">\ [
\ hat {\ rho} =
\ frac {\ sum_ {i = 1}^n (x_i- \ bar {x}) (y_i- \ bar {y})}
{\ sqrt {\ sum_ {i = 1}^n (x_i- \ bar {x})^2}
\ sqrt {\ sum_ {j = 1}^n (y_j- \ bar {y})^2}}
\ tag {7.1} \]</span></span></p>
<p>R에서는 사용합니다<code>코</code>값을 계산하는 기능. 행렬에 적용된이 함수는 연속 변수 간의 두 가지 방법을 모두 계산합니다. ~ 안에<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>다변량 범주 데이터를 분석하는 방법을 살펴 보겠습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-corrturtles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.2</div>
</div>
<div class="callout-body-container callout-body">
<p>Turtles 데이터의 측정간에 모든 상관 관계의 매트릭스를 계산합니다. 당신은 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-4-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-4-contents callout-collapse collapse" id="callout-4">
<div class="callout-body-container callout-body">
<p>범주 형 변수를 꺼내어 매트릭스를 계산합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a><span class="fu">코</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>])))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>길이 너비 높이
길이 1.0000000 0.9783116 0.9646946
너비 0.9783116 1.0000000 0.9605705
높이 0.9646946 0.9605705 1.0000000</code></pre>
</div>
</div>
<p>우리는이 정사각형 매트릭스가 대칭이고 값은 모두 1에 가깝습니다. 대각선 값은 항상 1입니다.</p>
</div>
</div>
</div>
<p>다음 두 질문에서 보는 것과 같은 시각적 디스플레이를 사용하여 간단한 1 차원 및 2 차원 요약 통계를 확인하여 다차원 분석을 시작하는 것이 항상 좋습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-ggallypairs">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.3</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>거북이 데이터에 대한 대각선의 1 차원 히스토그램뿐만 아니라 모든 쌍별 산점도를 생성합니다. 패키지를 사용하십시오<strong><a href="https://cran.r-project.org/web/packages/GGally/">GGALLY</a></strong>.<br/>
</li>
<li>이 데이터의 기본 또는 "진정한 차원"을 추측합니까?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-6-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-6-contents callout-collapse collapse" id="callout-6">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Ggally"</span>))</span>
<span id="cb15-4"><a aria-hidden="true" href="#cb15-4" tabindex="-1"></a><span class="fu">ggpairs</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>],,<span class="at">axisLabels =</span> <span class="st">"없음"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-turtlespairs">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-turtlespairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="07-chap_files/figure-html/fig-turtlespairs-1.png" title="Figure 7.2: All pairs of bivariate scatterplots for the three biometric measurements on painted turtles."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-turtlespairs-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-turtlespairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.2 : 페인트 거북에 대한 세 가지 생체 측정을위한 모든 이변 량 산점도 쌍.</figcaption>
</figure>
</div>
</div>
</div>
<p>에서<a class="quarto-xref" href="#fig-turtlespairs">수치<span>7.2</span></a>, 세 가지 변수가 모두 상관 관계가 있고 대부분 동일한 "기본"변수를 반영하는 것처럼 보이며, 이는 다음과 같이 해석 할 수 있습니다.<em>크기</em>거북이.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-pairsathletes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.4</div>
</div>
<div class="callout-body-container callout-body">
<p>변수의 모든 쌍별 상관 관계를 계산합니다<code>운동 선수</code>히트 맵에 데이터를 데이터를 표시하고 표시합니다. 당신은 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-8-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-8-contents callout-collapse collapse" id="callout-8">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"pheatmap"</span>))</span>
<span id="cb16-2"><a aria-hidden="true" href="#cb16-2" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">코</span>(운동 선수),<span class="at">cell.width =</span> <span class="dv">10</span>,,,<span class="at">cell.height =</span> <span class="dv">10</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-heatmapathletes">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heatmapathletes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="07-chap_files/figure-html/fig-heatmapathletes-1.png" title="Figure 7.3: Heatmap of correlations between variables in the athletes data. Higher values are color coded red-orange. The hierarchical clustering shows a grouping of related disciplines."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-heatmapathletes-1.png" style="width:100.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heatmapathletes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.3 : 변수 간의 상관 관계<code>운동 선수</code>데이터. 더 높은 값은 색상 코드 레드 오렌지입니다. 계층 적 클러스터링은 관련 분야의 그룹화를 보여줍니다.</figcaption>
</figure>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-heatmapathletes">수치<span>7.3</span></a>10 변수가 그룹으로 어떻게 클러스터되는지 보여줍니다 : 달리기, 던지기 및 점프.</p>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="7.2.2" id="preprocessing-the-data">
<h3 class="anchored" data-anchor-id="preprocessing-the-data" data-number="7.2.2"><span class="header-section-number">7.2.2</span>데이터 전처리</h3>
<p>대부분의 경우 다른 변수는 다른 단위로 측정되므로 기준선과 스케일이 다릅니다.<a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>. 이것들은 원래 형태로 직접 비교할 수 없습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>일반적인 규모의 측정 값은 범위와 표준 편차입니다. 예를 들어, 110 미터의 시간은 14.18에서 16.2 사이이며 표준 편차는 0.51이며, 1500 미터를 완료하는 시간은 256.64에서 303.17 사이이며 표준 편차는 13.66입니다. 1 배 이상 더 크다. 또한,<code>운동 선수</code>데이터는 또한 다른 단위 (초, 미터)의 측정을 포함하며, 그 선택은 임의적입니다 (길이는 센티미터 또는 피트, 밀리 초의 시간에도 기록 될 수 있음).</p></div></div><p>PCA 및 기타 여러 방법의 경우 비교를 의미있게 만들기 위해 숫자 값을 공통 척도로 변환해야합니다.<strong>센터링</strong>중앙 데이터의 평균이 원점에 있도록 평균을 빼기를 의미합니다.<strong>스케일링</strong>또는<strong>표준화</strong>그런 다음 새로운 표준 편차가 다음과 같이 표준 편차로 나누는 것을 의미합니다.<span class="math inline" data-anchor-id="eq-corrcoeff">\ (1 \)</span>. 실제로, 우리는 상관 계수를 계산할 때 이미 이러한 작업을 수행했습니다 (<a class="quarto-xref" href="#eq-corrcoeff">방정식<span>7.1</span></a>) : 상관 계수는 단순히 중앙 및 스케일 변수의 벡터 생성물입니다. 이러한 작업을 수행하려면 R 기능이 있습니다<code>규모</code>매트릭스 또는 데이터 프레임이 주어지면 기본 동작은 모든 열이 평균 0과 표준 편차를 갖도록하는 것입니다.<span class="math inline">\ (1 \)</span>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-onedims">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.5</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>의 수단과 표준 편차를 계산하십시오<code>거북이</code>데이터를 사용합니다<code>규모</code>연속 변수를 중심하고 표준화하는 기능. 이것을 불러주세요<code>ScaledTurtles</code>그런 다음 평균 및 표준 편차에 대한 새 값을 확인하십시오.<code>ScaledTurtles</code>.<br/>
</li>
<li>거북 데이터의 스케일링 및 중앙 너비 및 높이 변수의 산점도를 만들고 성별로 점을 채색하십시오.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-10-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-10-contents callout-collapse collapse" id="callout-10">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a><span class="fu">적용하다</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>],,<span class="dv">2</span>, SD)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>길이 너비 높이 
20.481602 12.675838 8.392837</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a><span class="fu">적용하다</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>],,<span class="dv">2</span>, 평균)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>길이 너비 높이 
124.68750 95.43750 46.33333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a>ScaledTurtles<span class="ot">=</span> <span class="fu">규모</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>])))</span>
<span id="cb21-2"><a aria-hidden="true" href="#cb21-2" tabindex="-1"></a><span class="fu">적용하다</span>(ScaledTurtles,<span class="dv">2</span>, 평균)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>길이 너비 높이 
-1.432050E-18 1.940383E-17 -2.870967E-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="fu">적용하다</span>(ScaledTurtles,<span class="dv">2</span>, SD)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>길이 너비 높이 
     1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a><span class="fu">데이터. 프레임</span>(ScaledTurtles,<span class="at">섹스 =</span>거북이 [,<span class="dv">1</span>])))<span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a aria-hidden="true" href="#cb25-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">x =</span>너비,<span class="at">y =</span>키,<span class="at">그룹 =</span>섹스))<span class="sc">+</span></span>
<span id="cb25-3"><a aria-hidden="true" href="#cb25-3" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>섹스))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-turtlesDim12">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-turtlesDim12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="07-chap_files/figure-html/fig-turtlesDim12-1.png" title="Figure 7.4: Turtles data projected onto the plane defined by the width and height variables: each point colored according to sex."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-turtlesDim12-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-turtlesDim12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.4 :<code>너비</code>그리고<code>키</code>변수 : 각 지점에 따라 채색됩니다<code>섹스</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>우리는 이미 챕터에서 다른 데이터 변환 선택을 이미 발견했습니다.<a class="quarto-xref" href="04-chap.html"><span>4</span></a>그리고<a class="quarto-xref" href="05-chap.html"><span>5</span></a>, 우리가 사용한 곳<code>통나무</code>그리고<code>asinh</code>기능. 이러한 변환의 목표는 (일반적으로) 분산 안정화, 즉 복제 측정의 분산을 만드는 것입니다.<em>하나와 동일한 변수</em>동적 범위의 다른 부분에서 더 유사합니다. 대조적으로, 위에서 설명한 표준화 변환은 (평균 및 표준 편차로 측정 된대로)를 만드는 것을 목표로합니다.<em>다른 변수</em>동일합니다.</p>
<p>때로는 변수를 다른 척도로 남겨 두는 것이 좋습니다. 원래 규모가 관련이 있다면 데이터를 그대로 두어야합니다. 다른 경우, 변수는 선험적으로 알려진 다른 정밀도를 가지고 있습니다. 우리는 볼 것입니다<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>그러한 변수를 가중시키는 방법에는 여러 가지가 있습니다.</p>
<p>데이터를 전처리 한 후 데이터를 수행 할 준비가되었습니다.<em>단순화</em>~을 통해<strong>치수 감소</strong>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="imgs/book_icon.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">관련 장이있는 유용한 책이 있습니다<span class="citation" data-cites="Flury">플라이 (Flury) (<a href="16-chap.html#ref-Flury" role="doc-biblioref">1997</a>))</span>입문 계정 및<span class="citation" data-cites="Mardia">Mardia, Kent 및 Bibby (<a href="16-chap.html#ref-Mardia" role="doc-biblioref">1979</a>))</span>자세한 수학적 접근법.</span></div></div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="7.3" id="dimension-reduction">
<h2 class="anchored" data-anchor-id="dimension-reduction" data-number="7.3"><span class="header-section-number">7.3</span>치수 감소</h2>
<p>우리는 여러 가지 다른 관점에서 차원 축소를 설명 할 것입니다. 그것은 1901 년 Karl Pearson에 의해 발명되었습니다<span class="citation" data-cites="Pearson1901">(<a href="16-chap.html#ref-Pearson1901" role="doc-biblioref">피어슨 1901</a>))</span>2 변수 산점도를 단일 좌표로 줄이는 방법으로. 그것은 1930 년대 통계 학자들에 의해 동일한 주제에 대한 심리 시험 배터리를 요약하기 위해 사용했습니다.<span class="citation" data-cites="Hotelling:1933ki">(<a href="16-chap.html#ref-Hotelling:1933ki" role="doc-biblioref">호텔 1933</a>))</span>; 따라서 많은 테스트 된 변수를 한 번에 요약하는 전체 점수를 제공합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="imgs/devil.png" title="Principal and principle are two different words, which have different meanings. So please do not confuse them. With PCA, it is always principal."><img alt="Principal and principle are two different words, which have different meanings. So please do not confuse them. With PCA, it is always principal." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption><em>주요한</em>그리고<em>원칙</em>의미가 다른 두 단어입니다. 그러니 혼동하지 마십시오. PCA를 사용하면 항상입니다<em>주요한</em>.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 아이디어<strong>주요한</strong>점수는 Principal Component Analysis (약식 PCA)라는 이름에 영감을주었습니다. PCA는 an이라고합니다<strong>감독되지 않은 학습</strong>클러스터링에서와 같이 모든 변수를 동일하게 처리하기 때문에 기술<strong>상태</strong>. 우리는 하나의 특정 변수의 값을 다른 변수로부터 예측하거나 설명하려고하지 않습니다. 오히려 우리는 모든 변수에 대한 기본 구조에 대한 수학적 모델을 찾으려고 노력하고 있습니다. PCA는 주로 변수 간의 관계와 유용한 방식으로 관측치 간의 관계를 보여주는 맵을 생성하는 탐색 기술입니다.</p>
<p>우리는 먼저이 다변량 분석이 데이터에 수행하는 맛을 제공합니다. 선형 대수를 통해 이러한 방법의 우아한 수학 공식화가 있지만, 여기서는 사용을 최소화하고 시각화 및 데이터 예제에 중점을 둘 것입니다.</p>
<p>우리는 기하학을 사용합니다<strong>예측</strong>이는 고차원 공간에서 포인트를 가져 와서 더 낮은 차원으로 투사합니다.<a class="quarto-xref" href="#fig-projectv">수치<span>7.5</span></a>요점의 투영을 보여줍니다<span class="math inline">\(에이\)</span>벡터에 의해 생성 된 라인에<span class="math inline">\ ({\ mathbf v} \)</span>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-projectv">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-projectv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="07-chap_files/figure-html/fig-projectv-1.png" title="Figure 7.5: Point A is projected onto the red line generated by the vector v. The dashed projection line is perpendicular (or orthogonal) to the red line. The intersection point of the projection line and the red line is called the orthogonal projection of A onto the red line generated by the vector v."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-projectv-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-projectv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.5 : 포인트<span class="math inline">\(에이\)</span>벡터가 생성 한 빨간색 선에 투사됩니다.<span class="math inline">\(다섯\)</span>. 점선 돌출선은 수직입니다 (또는<strong>직교</strong>) 빨간색 선에. 프로젝션 라인과 빨간색 선의 교차점은 벡터에 의해 생성 된 빨간색 선으로 A의 직교 투영이라고합니다.<span class="math inline">\(다섯\)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>PCA는 a입니다<strong>선의</strong>기술, 우리는 변수들 사이의 선형 관계를 찾고 원래 변수의 선형 함수 인 새로운 변수를 사용한다는 것을 의미합니다.<span class="math inline">\ (f (ax+by) = af (x)+b (y) \)</span>). 선형성 제약 조건은 계산을 특히 쉽게 만듭니다. 우리는 비선형 기술을 볼 것입니다<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>.</p>
<section class="level3 page-columns page-full" data-number="7.3.1" id="lower-dimensional-projections">
<h3 class="anchored" data-anchor-id="lower-dimensional-projections" data-number="7.3.1"><span class="header-section-number">7.3.1</span>저 차원 예측</h3>
<p>여기서 우리는 2 차원 데이터를 라인에 투사하는 한 가지 방법을 보여줍니다.<code>운동 선수</code>데이터. 아래 코드는 생성에 사용 된 전처리 및 플로팅 단계를 제공합니다.<a class="quarto-xref" href="#fig-SimpleScatter">수치<span>7.6</span></a>:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a>운동 선수<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="fu">규모</span>(운동 선수))</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a>ATH_GG<span class="ot">=</span> <span class="fu">ggplot</span>(운동 선수,<span class="fu">AES</span>(<span class="at">x =</span>무게,<span class="at">y =</span>디스크))<span class="sc">+</span></span>
<span id="cb26-3"><a aria-hidden="true" href="#cb26-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">크기 =</span> <span class="dv">2</span>,,,<span class="at">모양 =</span> <span class="dv">21</span>))</span>
<span id="cb26-4"><a aria-hidden="true" href="#cb26-4" tabindex="-1"></a>ATH_GG<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">y =</span> <span class="dv">0</span>),)<span class="at">색상 =</span> <span class="st">"빨간색"</span>))<span class="sc">+</span></span>
<span id="cb26-5"><a aria-hidden="true" href="#cb26-5" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">AES</span>(<span class="at">xend =</span>무게,<span class="at">yend =</span> <span class="dv">0</span>),)<span class="at">lineType =</span> <span class="st">"점선"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-SimpleScatter">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SimpleScatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="07-chap_files/figure-html/fig-SimpleScatter-1.png" title="Figure 7.6: Scatterplot of two variables showing the projection on the horizontal x axis (defined by y=0) in red and the lines of projection appear as dashed."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-SimpleScatter-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SimpleScatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.6 : 수평 x 축의 투영을 보여주는 두 변수의 산점도 (<span class="math inline">\ (y = 0 \)</span>)) 빨간색과 투영 선이 점선으로 나타납니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>빨간색 점의 분산을 계산하십시오<a class="quarto-xref" href="#fig-SimpleScatter">수치<span>7.6</span></a>.<br/>
</li>
<li>프로젝션 라인을 보여주는 플롯을<span class="math inline">\(와이\)</span>축 및 투사 지점.<br/>
</li>
<li>수직에 투사 된 점의 분산 계산<span class="math inline">\(와이\)</span>중심선.</li>
</ol>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="7.3.2" id="sec-multivariate-pcaline">
<h3 class="anchored" data-anchor-id="sec-multivariate-pcaline" data-number="7.3.2"><span class="header-section-number">7.3.2</span>2 차원 데이터를 라인으로 어떻게 요약합니까?</h3>
<p>일반적으로 두 차원 (평면)에서 1 (라인)으로 투사 할 때 포인트에 대한 정보를 잃습니다. 우리가 원래 좌표를 사용하여 만하면<code>무게</code>변수<a class="quarto-xref" href="#fig-SimpleScatter">수치<span>7.6</span></a>, 우리는에 대한 모든 정보를 잃습니다<code>디스크</code>변하기 쉬운. 우리의 목표는 우리가 할 수있는 한 많은 정보를 유지하는 것입니다.<em>둘 다</em>변수. 실제로 포인트 클라우드를 라인에 투사하는 방법에는 여러 가지가 있습니다. 하나는 알려진 것을 사용하는 것입니다<strong>회귀선</strong>. 이 라인과 R으로 구성된 방법을 살펴 보겠습니다.</p>
<section class="level4 unnumbered" id="regressing-one-variable-on-the-other">
<h4 class="unnumbered anchored" data-anchor-id="regressing-one-variable-on-the-other">하나의 변수가 다른 변수를 회귀합니다</h4>
<p>선형 회귀를 본 경우, 산점도를 요약하는 선을 계산하는 방법을 이미 알고 있습니다.<strong>선형 회귀</strong>a<strong>감독</strong>선호도를 제공하는 방법은 한 방향으로 사각형의 잔류 합계를 최소화합니다. 응답 변수의 것.</p>
</section>
<section class="level4 unnumbered page-columns page-full" id="regression-of-the-disc-variable-on-weight.">
<h4 class="unnumbered anchored" data-anchor-id="regression-of-the-disc-variable-on-weight.">의 회귀<code>디스크</code>변수 켜기<code>무게</code>.</h4>
<p>~ 안에<a class="quarto-xref" href="#fig-Reg1">수치<span>7.7</span></a>, 우리는 사용합니다<code>LM</code>(선형 모델) 기능 회귀선을 찾는 기능. 그것의 경사와 절편은<code>계수</code>결과 객체의 슬롯<code>reg1</code>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a>reg1<span class="ot">=</span> <span class="fu">LM</span>(디스크<span class="sc">~</span>무게,<span class="at">데이터 =</span>운동 선수)</span>
<span id="cb27-2"><a aria-hidden="true" href="#cb27-2" tabindex="-1"></a>A1<span class="ot">=</span>reg1<span class="sc">$</span>계수 [<span class="dv">1</span>]]<span class="co"># 인터셉트</span></span>
<span id="cb27-3"><a aria-hidden="true" href="#cb27-3" tabindex="-1"></a>B1<span class="ot">=</span>reg1<span class="sc">$</span>계수 [<span class="dv">2</span>]]<span class="co"># 경사</span></span>
<span id="cb27-4"><a aria-hidden="true" href="#cb27-4" tabindex="-1"></a>pline1<span class="ot">=</span>ATH_GG<span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">인터셉트 =</span>A1,<span class="at">경사 =</span>B1,</span>
<span id="cb27-5"><a aria-hidden="true" href="#cb27-5" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"파란색"</span>,,,<span class="at">linewidth =</span> <span class="fl">1.5</span>))</span>
<span id="cb27-6"><a aria-hidden="true" href="#cb27-6" tabindex="-1"></a>pline1<span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="fu">AES</span>(<span class="at">xend =</span>무게,<span class="at">yend =</span>reg1<span class="sc">$</span>장착),,</span>
<span id="cb27-7"><a aria-hidden="true" href="#cb27-7" tabindex="-1"></a>    <span class="at">색상 =</span> <span class="st">"빨간색"</span>,,,<span class="at">화살표 =</span> <span class="fu">화살</span>(<span class="at">길이 =</span> <span class="fu">단위</span>(<span class="fl">0.15</span>,,,<span class="st">"cm"</span>))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Reg1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Reg1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="07-chap_files/figure-html/fig-Reg1-1.png" title="Figure 7.7: The blue line minimizes the sum of squares of the vertical residuals (in red)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-Reg1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Reg1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.7 : 파란색 선은 수직 잔차 (빨간색)의 제곱의 합을 최소화합니다.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level4 unnumbered page-columns page-full" id="regression-of-weight-on-discus.">
<h4 class="unnumbered anchored" data-anchor-id="regression-of-weight-on-discus.">의 회귀<code>무게</code>~에<code>원반</code>.</h4>
<p><a class="quarto-xref" href="#fig-Reg2">수치<span>7.8</span></a>두 변수의 역할을 되돌릴 때 생성 된 선을 보여줍니다.<code>무게</code>응답 변수가됩니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a>reg2<span class="ot">=</span> <span class="fu">LM</span>(무게<span class="sc">~</span>디스크,<span class="at">데이터 =</span>운동 선수)</span>
<span id="cb28-2"><a aria-hidden="true" href="#cb28-2" tabindex="-1"></a>A2<span class="ot">=</span>reg2<span class="sc">$</span>계수 [<span class="dv">1</span>]]<span class="co"># 인터셉트</span></span>
<span id="cb28-3"><a aria-hidden="true" href="#cb28-3" tabindex="-1"></a>B2<span class="ot">=</span>reg2<span class="sc">$</span>계수 [<span class="dv">2</span>]]<span class="co"># 경사</span></span>
<span id="cb28-4"><a aria-hidden="true" href="#cb28-4" tabindex="-1"></a>가스<span class="ot">=</span>ATH_GG<span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">인터셉트 =</span> <span class="sc">-</span>A2<span class="sc">/</span>B2,<span class="at">경사 =</span> <span class="dv">1</span><span class="sc">/</span>B2,</span>
<span id="cb28-5"><a aria-hidden="true" href="#cb28-5" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"Darkgreen"</span>,,,<span class="at">linewidth =</span> <span class="fl">1.5</span>))</span>
<span id="cb28-6"><a aria-hidden="true" href="#cb28-6" tabindex="-1"></a>가스<span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="fu">AES</span>(<span class="at">xend =</span>reg2<span class="sc">$</span>장착,<span class="at">yend =</span>디스크),</span>
<span id="cb28-7"><a aria-hidden="true" href="#cb28-7" tabindex="-1"></a>    <span class="at">색상 =</span> <span class="st">"주황색"</span>,,,<span class="at">화살표 =</span> <span class="fu">화살</span>(<span class="at">길이 =</span> <span class="fu">단위</span>(<span class="fl">0.15</span>,,,<span class="st">"cm"</span>))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Reg2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Reg2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="07-chap_files/figure-html/fig-Reg2-1.png" title="Figure 7.8: The green line minimizes the sum of squares of the horizontal residuals (in orange)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-Reg2-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Reg2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.8 : 녹색 선은 수평 잔차 (주황색)의 제곱의 합을 최소화합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>그림의 각 회귀선<a class="quarto-xref" href="#fig-Reg1"><span>7.7</span></a>그리고<a class="quarto-xref" href="#fig-Reg2"><span>7.8</span></a>우리에게 대략적인 선형 관계를 제공합니다<code>디스크</code>그리고<code>무게</code>. 그러나 관계는 우리가 예측자가되기로 선택한 변수와 응답에 따라 다릅니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-pointsonline">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.6</div>
</div>
<div class="callout-body-container callout-body">
<p>블루 회귀선에있는 투사 지점의 분산은 얼마나 큽니까<a class="quarto-xref" href="#fig-Reg1">수치<span>7.7</span></a>? 이것을 원래 축에 투사 할 때 데이터의 분산과 비교하십시오.<code>무게</code>그리고<code>디스크</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-13-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-13-contents callout-collapse collapse" id="callout-13">
<div class="callout-body-container callout-body">
<p>피타고라스의 정리는 오른쪽 변형 삼각형의 hypotenuse의 제곱 길이가 다른 양면의 제곱 길이의 합과 같다고 말합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a><span class="fu">우리의</span>(운동 선수<span class="sc">$</span>무게)<span class="sc">+</span> <span class="fu">우리의</span>(reg1<span class="sc">$</span>장착)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.650204</code></pre>
</div>
</div>
<p>원래 축을 따라 점의 차이<code>무게</code>그리고<code>디스크</code>변수를 축소했기 때문에 1입니다.</p>
</div>
</div>
</div>
</section>
<section class="level4 unnumbered page-columns page-full" id="a-line-that-minimizes-distances-in-both-directions">
<h4 class="unnumbered anchored" data-anchor-id="a-line-that-minimizes-distances-in-both-directions">양방향으로 거리를 최소화하는 선</h4>
<p><a class="quarto-xref" href="#fig-PCAmin">수치<span>7.9</span></a>데이터 포인트의 직교 (수직) 예측의 정상을 최소화하기 위해 선택된 라인을 보여줍니다. 우리는 이것을이라고 부릅니다<strong>주요 구성 요소</strong>선. 라인을 맞추는 세 가지 방법 (그림<a class="quarto-xref" href="#fig-Reg1"><span>7.7</span></a>-<a class="quarto-xref" href="#fig-PCAmin"><span>7.9</span></a>) 하나의 플롯에서 함께 표시됩니다<a class="quarto-xref" href="#fig-PCAR1R2-1">수치<span>7.10</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a>xy<span class="ot">=</span> <span class="fu">cbind</span>(운동 선수<span class="sc">$</span>디스크, 운동 선수<span class="sc">$</span>무게)</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a>SVDA<span class="ot">=</span> <span class="fu">SVD</span>(xy)</span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a>PC<span class="ot">=</span>xy<span class="sc">%*%</span>SVDA<span class="sc">$</span>다섯[,<span class="dv">1</span>]]<span class="sc">%*%</span> <span class="fu">티</span>(SVDA<span class="sc">$</span>다섯[,<span class="dv">1</span>])))</span>
<span id="cb31-4"><a aria-hidden="true" href="#cb31-4" tabindex="-1"></a>BP<span class="ot">=</span>SVDA<span class="sc">$</span>다섯[<span class="dv">2</span>,,,<span class="dv">1</span>]]<span class="sc">/</span>SVDA<span class="sc">$</span>다섯[<span class="dv">1</span>,,,<span class="dv">1</span>]]</span>
<span id="cb31-5"><a aria-hidden="true" href="#cb31-5" tabindex="-1"></a>ap<span class="ot">=</span> <span class="fu">평균</span>(PC [,<span class="dv">2</span>])))<span class="sc">-</span>BP<span class="sc">*</span> <span class="fu">평균</span>(PC [,<span class="dv">1</span>])))</span>
<span id="cb31-6"><a aria-hidden="true" href="#cb31-6" tabindex="-1"></a>ATH_GG<span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="at">xend =</span>PC [,<span class="dv">1</span>],,<span class="at">yend =</span>PC [,<span class="dv">2</span>])))<span class="sc">+</span></span>
<span id="cb31-7"><a aria-hidden="true" href="#cb31-7" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">인터셉트 =</span>AP,<span class="at">경사 =</span>BP,<span class="at">col =</span> <span class="st">"보라"</span>,,,<span class="at">linewidth =</span> <span class="fl">1.5</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-PCAmin">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PCAmin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="07-chap_files/figure-html/fig-PCAmin-1.png" title="Figure 7.9: The purple principal component line minimizes the sums of squares of the orthogonal projections."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-PCAmin-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PCAmin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.9 : 보라색<strong>주요 구성 요소</strong>라인은 직교 예측의 제곱의 합을 최소화합니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-PCAR1R2-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PCAR1R2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="07-chap_files/figure-html/fig-PCAR1R2-1-1.png" title="Figure 7.10: The blue line minimizes the sum of squares of the vertical residuals, the green line minimizes the horizontal residuals, the purple line, called the principal component, minimizes the orthogonal projections. Notice the ordering of the slopes of the three lines."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-PCAR1R2-1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PCAR1R2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.10 : 파란색 선은 수직 잔차의 제곱의 합을 최소화하고 녹색 선은 수평 잔차, 자주색 선을 최소화합니다.<strong>주요 구성 요소</strong>, 직교 예측을 최소화합니다. 세 줄의 경사면의 순서에 주목하십시오.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAline">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.7</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>보라색 선의 경사면에서 특별한 점은 무엇입니까?<br/>
</li>
<li>원본 (척도가없는) 변수의 플롯을 다시 실행하십시오. 어떻게됩니까?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-15-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-15-contents callout-collapse collapse" id="callout-15">
<div class="callout-body-container callout-body">
<p>여기에서 계산 된 라인은 단위 선택에 따라 다릅니다. 표준 편차를 두 변수 모두에 대해 하나와 동일하게 만들었 기 때문에 PCA 라인은 두 회귀선의 중간에서 정확하게 절단되는 대각선입니다. 데이터는 수단을 빼서 중앙에 걸쳐 있었으므로 라인은 원점을 통과합니다.<span class="math inline">\ ((0,0) \)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAvariance">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.8</div>
</div>
<div class="callout-body-container callout-body">
<p>보라색 선에서 점의 분산을 계산하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-17-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-17-contents callout-collapse collapse" id="callout-17">
<div class="callout-body-container callout-body">
<p>우리는 우리가 줄거리를 만들 때 점의 좌표를 계산했습니다.<code>PC</code>벡터:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a><span class="fu">적용하다</span>(PC,<span class="dv">2</span>, 였다)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9031761 0.9031761</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a><span class="fu">합집합</span>(<span class="fu">적용하다</span>(PC,<span class="dv">2</span>, 였다))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.806352</code></pre>
</div>
</div>
<p>우리는이 축을 따르는 분산이 우리가 계산 한 다른 분산보다 크다는 것을 알 수 있습니다.<a class="quarto-xref" href="#wrn-multivariate-pointsonline">질문<span>7.6</span></a>.</p>
</div>
</div>
</div>
<p>피타고라스의 정리는 여기서 두 가지 흥미로운 것을 알려줍니다.</p>
<ul>
<li><p>우리가 수평 및 수직 방향을 최소화한다면 실제로 각 지점에서 선으로 직교 돌출부를 최소화합니다.</p></li>
<li><p>점의 총 변동성은 점수의 중심에 대한 지점의 투영 제곱의 합으로 측정되며, 이는 데이터가 중심에있는 경우 원점 (0,0)입니다. 이것을<em>총 분산</em>또는<strong>관성</strong>포인트 클라우드의. 이 관성은 선으로 돌출부의 제곱의 합으로 분해 될 수 있으며 해당 라인을 따라 차이가 발생할 수 있습니다. 고정 분산의 경우, 투영 거리를 최소화하면 해당 라인의 분산이 최대화됩니다. 종종 우리는 첫 번째 주요 구성 요소를 최대 차이가있는 선으로 정의합니다.</p></li>
</ul>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="7.4" id="the-new-linear-combinations">
<h2 class="anchored" data-anchor-id="the-new-linear-combinations" data-number="7.4"><span class="header-section-number">7.4</span>새로운 선형 조합</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="imgs/Vegetables_small.jpg"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Vegetables_small.jpg"/></a></p>
</figure>
</div>
</div></div></div>
<!-- TODO: '\small' is currently ignored -->
<div class="page-columns page-full"><p>이전 섹션에서 찾은 PC 라인은 작성 될 수 있습니다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">이미지 크레딧 : 사라 홈즈</span></div></div>
<p><span class="anchored-eq" data-anchor-id="eq-eoytpgqvcauf" id="eq-eoytpgqvcauf"><span class="math display">\ [
PC = \ frac {1} {2} \ mbox {disc} + \ frac {1} {2} \ mbox {weight}.
\ tag {7.2} \]</span></span></p>
<p>주요 구성 요소입니다<em>선형 조합</em>원래 측정 된 변수 중에서<em>새로운 좌표계</em>. 무엇을 이해하기 위해<strong>선형 조합</strong>실제로, 우리는 비유를 취할 수 있습니다. 건강한 주스 믹스를 만들 때와 같은 레시피를 따릅니다.</p>
<p><span class="math display">\ [
\ 시작 {align}
v &amp; = 2 \ times \ text {beet} + 1 \ times \ text {carrot} \\
  &amp; + \ tfrac {1} {2} \ text {gala} + \ tfrac {1} {2} \ text {grannysmith} \\
  &amp; + 0.02 \ times \ text {ginger} + 0.25 \ times \ text {lemon}.
\ end {align}
\]</span></p>
<p>이 레시피는 개별 주스 유형 (원래 변수)의 선형 조합입니다. 결과는 새로운 변수입니다.<span class="math inline">\(다섯\)</span>및 계수<span class="math inline">\ ((2,1, \ frac {1} {2}, \ frac {1} {2}, 0.02,0.25) \)</span>are called the<strong>로딩</strong>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAjuice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.9</div>
</div>
<div class="callout-body-container callout-body">
<p>주스 한 잔에서 칼로리를 어떻게 계산 하시겠습니까?</p>
</div>
</div>
<section class="level3 page-columns page-full" data-number="7.4.1" id="optimal-lines">
<h3 class="anchored" data-anchor-id="optimal-lines" data-number="7.4.1"><span class="header-section-number">7.4.1</span>최적의 라인</h3>
<p>변수의 선형 조합은 2 차원의 산점도 평면에서 선을 구성한 것과 같은 방식으로 더 높은 치수로 선을 정의합니다. 이 경우에 보았 듯이 데이터를 투사 할 줄을 선택하는 방법에는 여러 가지가 있지만 목적을위한 '최고의'라인이 있습니다.</p>
<p>모든 변수의 모든 지점의 총 분산은 분해 될 수 있습니다. PCA에서, 우리는 포인트와 라인 사이의 거리의 총 사각형의 총 합이 선까지의 거리와 선을 따라 분산으로 분해 될 수 있다는 사실을 사용합니다.</p>
<p>우리는 주요 구성 요소가 라인까지의 거리를 최소화하고 라인을 따라 예측의 분산을 극대화한다는 것을 알았습니다.</p>
<p>선을 따라 분산을 최대화하는 이유는 무엇입니까? 세 가지 차원에서 2 개로 투영의 또 다른 예를 살펴 보겠습니다. 실제로 인간의 비전은 그러한 차원 감소에 달려 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cam1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cam1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="imgs/CAM3.png" title="Figure 7.11: A mystery silhouette."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/CAM3.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cam1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.11 : 미스터리 실루엣.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAtwodthreed">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.10</div>
</div>
<div class="callout-body-container callout-body">
<p>~ 안에<a class="quarto-xref" href="#fig-cam1">수치<span>7.11</span></a>, 3 차원 물체의 2 차원 투영이 있습니다. 대상은 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-camel">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.11</div>
</div>
<div class="callout-body-container callout-body">
<p>두 가지 예측 중 어느 것이<a class="quarto-xref" href="#fig-cam1">수치<span>7.11</span></a>또는<a class="quarto-xref" href="#fig-cam2"><span>7.13</span></a>, 당신은 더 유익한 정보를 찾으십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-21-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-21-contents callout-collapse collapse" id="callout-21">
<div class="callout-body-container callout-body">
<p>그림자의 영역을 최대화하는 투영은 더 많은 '정보'를 보여준다고 주장 할 수 있습니다.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="7.5" id="the-pca-workflow">
<h2 class="anchored" data-anchor-id="the-pca-workflow" data-number="7.5"><span class="header-section-number">7.5</span>PCA 워크 플로</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-pca">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="imgs/orgacp1.png" title="Figure 7.12: Many choices have to be made during PCA processing."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/orgacp1.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.12 : PCA 처리 중에 많은 선택이 필요합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>PCA는 가장 큰 관성/변동성을 보여주는 축을 찾는 원리를 기반으로 해당 방향의 변동성을 제거한 다음 반복하여 다음 최고의 직교 축 등을 찾습니다. 실제로, 우리는 반복을 실행할 필요가 없으며, 모든 축은 하나의 선형 대수 조작에서 찾을 수 있습니다.<strong>에스</strong>ingular<strong>다섯</strong>알루<strong>디</strong>Ecomposition (아래 세부 사항을 더 깊이 파고들 것입니다).</p>
<p>다이어그램에서<a class="quarto-xref" href="#fig-pca">수치<span>7.12</span></a>, 우리는 먼저 평균과 분산이 계산되고 공분산 행렬과 직접 작동할지 또는 상관 관계 행렬과 직접 작동할지 여부를 선택해야한다는 것을 알 수 있습니다. 다음 단계는 선택입니다<span class="math inline">\(케이\)</span>, 우리가 데이터와 관련된 구성 요소의 수. 우리는 그렇게 말합니다<span class="math inline">\(케이\)</span>근사치의 순위입니다. 최선의 선택<span class="math inline">\(케이\)</span>어려운 질문이며 아래에 접근하는 방법에 대해 논의합니다. 선택<span class="math inline">\(케이\)</span>연속적인 주요 구성 요소에 의해 설명 된 차이의 플롯을 살펴 봐야합니다. 우리가 선택한 후<span class="math inline">\(케이\)</span>, 우리는 새로운 데이터의 예측을 진행할 수 있습니다.<span class="math inline">\(케이\)</span>-차원 하위 ​​공간.</p>
<p>PCA 워크 플로의 최종 결과는 변수와 샘플의 유용한 맵입니다. 이러한지도가 어떻게 구성되는지 이해하면 우리가 수집 할 수있는 정보가 최대화됩니다.</p>
</section>
<section class="level2 page-columns page-full" data-number="7.6" id="the-inner-workings-of-pca-rank-reduction">
<h2 class="anchored" data-anchor-id="the-inner-workings-of-pca-rank-reduction" data-number="7.6"><span class="header-section-number">7.6</span>PCA의 내부 작업 : 순위 감소</h2>
<p>이것은 선형 대수학의 배경이 희미한 기억 일뿐 아니라 희미한 기억에 대한 작은 섹션입니다. 그것은 너무 많은 표기법없이 PCA의 기초가되는 단일 가치 분해 방법에 대해 약간의 직관을 제공하려고합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cam2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cam2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="imgs/CAM4.png" title="Figure 7.13: Another two-dimensional projection of the same object shown in Figure fig-cam1. Here, the perspective is more informative. Generally, choosing the perspective such that the spread (in other words, the variance) of the points is maximal generally provides most information. We want to see as much of the variation as possible, that’s what PCA does."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/CAM4.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cam2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.13 : 표시된 동일한 물체의 다른 2 차원 투영<a class="quarto-xref" href="#fig-cam1">수치<span>7.11</span></a>. 여기서 관점은 더 유익합니다. 일반적으로 포인트의 스프레드 (즉, 분산)가 최대가되도록 관점을 선택하면 일반적으로 대부분의 정보를 제공합니다. 우리는 가능한 한 많은 변형을보고 싶습니다. 그것이 PCA가하는 일입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>매트릭스의 단일 값 분해는 수평 및 수직 벡터 (단일 벡터라고 함)와 정규화 값 (단수 값이라고 함)을 찾습니다. 이전과 마찬가지로, 우리는 분해를 만드는 데 사용되는 실제 리버스 엔지니어링을 수행하기 전에 미래의 생성 설명을 제공하는 것으로 시작합니다. 각 단계의 의미를 보정하기 위해 실제 데이터의 복잡성으로 이동하기 전에 인공 예로 시작합니다.</p>
<section class="level3 page-columns page-full" data-number="7.6.1" id="rank-one-matrices">
<h3 class="anchored" data-anchor-id="rank-one-matrices" data-number="7.6.1"><span class="header-section-number">7.6.1</span>순위 매트릭스</h3>
<p>간단한 생성 모델은의 의미를 보여줍니다<strong>매트릭스 순위</strong>그리고 우리가 실제로 그것을 찾는 방법을 설명합니다. 두 개의 벡터가 있다고 가정합니다.<span class="math inline">\(유\)</span>(1 열 매트릭스) 및<span class="math inline">\ (v^t = t (v) \)</span>(1 열 행렬-1 열 매트릭스의 조상<span class="math inline">\(다섯\)</span>). 예를 들어,<span class="math inline">\ (u = \ 왼쪽 (
  \ 시작 {smallmatrix}
1 \\ 2 \\ 3 \\ 4
  \ end {smallmatrix}
\오른쪽)\)</span>그리고<span class="math inline">\ (v = \ 왼쪽 (
  \ 시작 {smallmatrix}
2 \\ 4 \\ 8
\ end {smallmatrix}
\오른쪽)\)</span>. 전가<span class="math inline">\(다섯\)</span>작성되었습니다<span class="math inline">\ (v^t = t (v) = (2 \; 4 \; 8) \)</span>. 우리는 사본을 곱합니다<span class="math inline">\(유\)</span>각 요소에 의해<span class="math inline">\ (v^t \)</span>다음과 같이 다음과 같이 :</p>
<!-- TODO: prettify these -->
<p>단계 0 :<br/>
</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">엑스</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Step 1:<br/>
</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">엑스</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Step 2:<br/>
</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">엑스</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>3 단계 : 3 단계 :<br/>
</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">엑스</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">32</td>
</tr>
</tbody>
</table>
<p>따라서,<span class="math inline">\ ((2,3) \)</span>매트릭스의 진입<span class="math inline">\(엑스\)</span>, 작성<span class="math inline">\ (x_ {2,3} \)</span>, 곱하기에 의해 얻어진다<span class="math inline">\ (u_2 \)</span>~에 의해<span class="math inline">\ (v_3 \)</span>. 우리는 이것을 쓸 수 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-riyzhwnmovjg" id="eq-riyzhwnmovjg"><span class="math display">\ [
x = \ 시작 {pmatrix}
2 &amp; 4 &amp; 8 \\ 4 &amp; 8 &amp; 16 \\
6 &amp; 12 &amp; 24 \\
8 &amp; 16 &amp; 32 \\
\ end {pmatrix}
= u * t (v) = u * v^t
\ tag {7.3} \]</span></span></p>
<p>매트릭스<span class="math inline">\(엑스\)</span>우리는 여기서 랭크 1이라고합니다. 둘 다<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>열 하나가 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAeconomical">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.12</div>
</div>
<div class="callout-body-container callout-body">
<p>왜 우리는 그 글을 말할 수 있습니다<span class="math inline">\ (x = u*v^t \)</span>전체 매트릭스를 철자하는 것보다 더 경제적입니다<span class="math inline">\(엑스\)</span>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-23-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-23-contents callout-collapse collapse" id="callout-23">
<div class="callout-body-container callout-body">
<p><span class="math inline">\(엑스\)</span>가지다<span class="math inline">\ (4 \ times3 = 12 \)</span>요소는 측면에서<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>그것은 만 표현할 수 있습니다<span class="math inline">\ (4+3 = 7 \)</span>숫자. 압축은 언제 더 인상적입니다<span class="math inline">\(유\)</span>또는<span class="math inline">\(다섯\)</span>더 길다.</p>
</div>
</div>
</div>
<p>반면에 프로세스를 뒤집고 다른 매트릭스를 단순화하고 싶다고 가정 해 봅시다.<span class="math inline" data-anchor-id="eq-DecomposeX">\(엑스\)</span>아래에는 3 개의 행과 4 개의 열 (12 숫자)이 있습니다. 정보 손실없이 항상 벡터의 산물과 비슷한 방식으로 표현할 수 있습니까? 그림에 표시된 다이어그램에서<a class="quarto-xref" href="#fig-mosaic0"><span>7.14</span></a>그리고<a class="quarto-xref" href="#fig-mosaic123"><span>7.15</span></a>, 컬러 박스는 매트릭스의 셀의 숫자에 비례하는 영역을 갖는다 (<a class="quarto-xref" href="#eq-DecomposeX"><span>7.4</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mosaic0">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="imgs/SVD-mosaicXplot0.png" title="Figure 7.14: Some special matrices have numbers in them that make them easy to decompose. Each colored rectangle in this diagram has an area that corresponds to the number in it."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SVD-mosaicXplot0.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.14 : 일부 특수 행렬에는 숫자가있어 쉽게 분해 할 수 있습니다. 이 다이어그램의 각 색상 사각형에는 그 숫자에 해당하는 영역이 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-rectangularmatrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.13</div>
</div>
<div class="callout-body-container callout-body">
<p>여기 매트릭스가 있습니다<span class="math inline">\(엑스\)</span>우리는 분해하고 싶습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-DecomposeX" id="eq-DecomposeX"><span class="math display">\ [
\ begin {array} {rrrrr}
\ hline
{\ large x} &amp; x _ {. 1} &amp; x _ {. 2} &amp; x _ {. 3} &amp; x _ {. 4} \\
\ hline
x_ {1.} &amp; 780 &amp; 936 &amp; 1300 &amp; 728 \\
x_ {2.} &amp; 75 &amp; 90 &amp; 125 &amp; 70 \\
x_ {3.} &amp; 540 &amp; 648 &amp; 900 &amp; 504 \\
\ hline
\ end {array}
\ tag {7.4} \]</span></span></p>
<p><span class="math inline">\(엑스\)</span>일련의 직사각형으로 다시 그려졌습니다<a class="quarto-xref" href="#fig-mosaic0">수치<span>7.14</span></a>. 우리는 어떤 숫자를 흰색으로 넣을 수 있습니까?<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>사각형 측면의 값이 숫자를 제품으로 제공하도록 상자?</p>
</div>
</div>
<p>완벽하게 "직사각형"이라는 특수 특성을 가진 매트릭스<span class="math inline">\(엑스\)</span>순위 1이라고합니다. 우리는 숫자를 나타낼 수 있습니다.<span class="math inline">\(엑스\)</span>사각형의 면적에 의해, 사각형의 측면이 측면 벡터의 값에 의해 주어진다 (<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>).</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-mosaic123">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-mosaic123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mosaic123" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mosaic123-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic123-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-mosaic123" href="imgs/SVD-mosaicXplot1.png" title="Figure 7.15 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-mosaic123" id="fig-mosaic123-1" src="imgs/SVD-mosaicXplot1.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic123-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mosaic123" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mosaic123-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic123-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-mosaic123" href="imgs/SVD-mosaicXplot2.png" title="Figure 7.15 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-mosaic123" id="fig-mosaic123-2" src="imgs/SVD-mosaicXplot2.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic123-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mosaic123" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mosaic123-3">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic123-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-mosaic123" href="imgs/SVD-mosaicXplot3.png" title="Figure 7.15 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-mosaic123" id="fig-mosaic123-3" src="imgs/SVD-mosaicXplot3.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic123-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mosaic123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.15 : 셀의 숫자는 (a), (b) 및 (c)의 해당 마진의 산물과 같습니다. 우리는 여러 가지 방법으로 제품의 세포를 만들 수 있습니다. (c)에서, 우리는 여백이 표준을 갖도록 강요합니다<span class="math inline">\ (1 \)</span>.
</figcaption>
</figure>
</div>
</div>
<p>우리는<a class="quarto-xref" href="#fig-mosaic123">수치<span>7.15</span></a>그 분해<span class="math inline">\(엑스\)</span>독특하지 않습니다 : 벡터에 대한 몇 가지 후보 선택이 있습니다.<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>. 우리는 각 벡터 요소의 제곱의 합이 1에 추가되도록 요구함으로써 선택을 독특하게 만듭니다 (벡터를 말합니다.<span class="math inline">\(다섯\)</span>그리고<span class="math inline">\(유\)</span>표준 1). 그런 다음 각 제품을 곱할 수있는 추가 번호를 추적해야하며 이는 "전체 스케일"을 나타냅니다.<span class="math inline">\(엑스\)</span>. 이것이 우리가 왼쪽 상단에 넣은 값입니다. 그것은 단일 가치라고합니다<span class="math inline">\ (s_1 \)</span>. 아래 R 코드에서 우리는 값을 알고 있다고 가정하여 시작합니다.<code>유</code>,,,<code>다섯</code>그리고<code>S1</code>; 나중에 우리는 우리를 위해 그들을 찾는 함수를 볼 것입니다. r : 곱셈과 규범 속성을 확인해 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a>엑스<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">기음</span>(<span class="dv">780</span>,,,<span class="dv">75</span>,,,<span class="dv">540</span>,,,</span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a>             <span class="dv">936</span>,,,<span class="dv">90</span>,,,<span class="dv">648</span>,,,</span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a>            <span class="dv">1300</span>,,,<span class="dv">125</span>,,,<span class="dv">900</span>,,,</span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a>             <span class="dv">728</span>,,,<span class="dv">70</span>,,,<span class="dv">504</span>),)<span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb36-5"><a aria-hidden="true" href="#cb36-5" tabindex="-1"></a>유<span class="ot">=</span> <span class="fu">기음</span>(<span class="fl">0.8196</span>,,,<span class="fl">0.0788</span>,,,<span class="fl">0.5674</span>))</span>
<span id="cb36-6"><a aria-hidden="true" href="#cb36-6" tabindex="-1"></a>다섯<span class="ot">=</span> <span class="fu">기음</span>(<span class="fl">0.4053</span>,,,<span class="fl">0.4863</span>,,,<span class="fl">0.6754</span>,,,<span class="fl">0.3782</span>))</span>
<span id="cb36-7"><a aria-hidden="true" href="#cb36-7" tabindex="-1"></a>S1<span class="ot">=</span> <span class="fl">2348.2</span></span>
<span id="cb36-8"><a aria-hidden="true" href="#cb36-8" tabindex="-1"></a><span class="fu">합집합</span>(유<span class="sc">^</span><span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="fu">합집합</span>(다섯<span class="sc">^</span><span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" href="#cb40-1" tabindex="-1"></a>S1<span class="sc">*</span>유<span class="sc">%*%</span> <span class="fu">티</span>(다섯)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3] [, 4]
[1,] 780 936 1300 728
[2,] 75 90 125 70
[3,] 540 648 900 504</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a>엑스<span class="sc">-</span>S1<span class="sc">*</span>유<span class="sc">%*%</span> <span class="fu">티</span>(다섯)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3] [, 4]
[1,] -0.03419 0.0745 0.1355 0.1221
[2,] 0.00403 0.0159 0.0252 0.0186
[3,] -0.00903 0.0691 0.1182 0.0982</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-svdnumbers">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.14</div>
</div>
<div class="callout-body-container callout-body">
<p>노력하다<code>SVD (X)</code>R.에서 출력의 구성 요소를보십시오.<code>SVD</code>조심스럽게 기능합니다. 이 호출에서 발생하는 행렬 열의 표준을 확인하십시오. 위의 값은 어디에 있었습니까?<code>S1</code>= 2348.2에서 나왔습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-26-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-26-contents callout-collapse collapse" id="callout-26">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a><span class="fu">SVD</span>(엑스)<span class="sc">$</span>유[,<span class="dv">1</span>]]</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a><span class="fu">SVD</span>(엑스)<span class="sc">$</span>다섯[,<span class="dv">1</span>]]</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a><span class="fu">합집합</span>(<span class="fu">SVD</span>(엑스)<span class="sc">$</span>유[,<span class="dv">1</span>]]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a><span class="fu">합집합</span>(<span class="fu">SVD</span>(엑스)<span class="sc">$</span>다섯[,<span class="dv">1</span>]]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a><span class="fu">SVD</span>(엑스)<span class="sc">$</span>디</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>실제로,이 특별한 경우에 우리는 운이 좋았습니다. 우리는 두 번째와 세 번째 단수 값이 0이라는 것을 알 수 있습니다 (우리가 관심을 갖는 숫자 정밀도까지). 그것이 우리가 그렇게 말하는 이유입니다<span class="math inline">\(엑스\)</span>입니다<strong>계급</strong>1.보다 일반적인 매트릭스<span class="math inline">\(엑스\)</span>, 글을 쓸 수있는 것은 드 rare니다<span class="math inline">\(엑스\)</span>이 유형의 2 벡터 제품과 정확히 같습니다. 다음 하위 섹션은 우리가 어떻게 분해 할 수 있는지 보여줍니다<span class="math inline">\(엑스\)</span>순위 1이 아닌 경우 : 더 많은 조각이 필요합니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="7.6.2" id="how-do-we-find-such-a-decomposition-in-a-unique-way">
<h3 class="anchored" data-anchor-id="how-do-we-find-such-a-decomposition-in-a-unique-way" data-number="7.6.2"><span class="header-section-number">7.6.2</span>우리는 어떻게 그러한 분해를 독특한 방식으로 찾을 수 있습니까?</h3>
<p>위의 분해에는 세 가지 요소가있었습니다 : 수평 및 수직 단수 벡터와 단수 값이라고 불리는 대각선 코너가있었습니다. 이것들은 단수 값 분해 함수를 사용하여 찾을 수 있습니다 (<code>SVD</code>). 예를 들어:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a>XTWO<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">기음</span>(<span class="fl">12.5</span>,,,<span class="fl">35.0</span>,,,<span class="fl">25.0</span>,,,<span class="dv">25</span>,,,<span class="dv">9</span>,,,<span class="dv">14</span>,,,<span class="dv">26</span>,,,<span class="dv">18</span>,,,<span class="dv">16</span>,,,<span class="dv">21</span>,,,<span class="dv">49</span>,,,<span class="dv">32</span>,,,</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a>       <span class="dv">18</span>,,,<span class="dv">28</span>,,,<span class="dv">52</span>,,,<span class="dv">36</span>,,,<span class="dv">18</span>,,,<span class="fl">10.5</span>,,,<span class="fl">64.5</span>,,,<span class="dv">36</span>),)<span class="at">NCOL =</span> <span class="dv">4</span>,,,<span class="at">Byrow =</span> <span class="cn">진실</span>))</span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a>USV<span class="ot">=</span> <span class="fu">SVD</span>(XTWO)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-USVobject">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.15</div>
</div>
<div class="callout-body-container callout-body">
<p>봐<code>USV</code>객체, 호출 결과<code>SVD</code>기능. 구성 요소는 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-28-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-28-contents callout-collapse collapse" id="callout-28">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="fu">이름</span>(UPS)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "D" "U" "V"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>USV<span class="sc">$</span>디</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.350624E+02 2.805191E+01 3.111680E-15 2.290270E-15</code></pre>
</div>
</div>
<p>따라서 135.1은 첫 번째 단일 값입니다<code>usv $ d [1]</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-svdapprox">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.16</div>
</div>
<div class="callout-body-container callout-body">
<p>각 연속적인 단수 벡터 쌍이 어떻게 우리의 근사치를 향상시키는 지 확인하십시오.<code>XTWO</code>. 세 번째 및 네 번째 단수 값에 대해 무엇을 알 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-30-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-30-contents callout-collapse collapse" id="callout-30">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a>XTWO<span class="sc">-</span>USV<span class="sc">$</span>디[<span class="dv">1</span>]]<span class="sc">*</span>USV<span class="sc">$</span>유[,<span class="dv">1</span>]]<span class="sc">%*%</span> <span class="fu">티</span>(UPS<span class="sc">$</span>다섯[,<span class="dv">1</span>])))</span>
<span id="cb50-2"><a aria-hidden="true" href="#cb50-2" tabindex="-1"></a>XTWO<span class="sc">-</span>USV<span class="sc">$</span>디[<span class="dv">1</span>]]<span class="sc">*</span>USV<span class="sc">$</span>유[,<span class="dv">1</span>]]<span class="sc">%*%</span> <span class="fu">티</span>(UPS<span class="sc">$</span>다섯[,<span class="dv">1</span>])))<span class="sc">-</span></span>
<span id="cb50-3"><a aria-hidden="true" href="#cb50-3" tabindex="-1"></a>USV<span class="sc">$</span>디[<span class="dv">2</span>]]<span class="sc">*</span>USV<span class="sc">$</span>유[,<span class="dv">2</span>]]<span class="sc">%*%</span> <span class="fu">티</span>(UPS<span class="sc">$</span>다섯[,<span class="dv">2</span>])))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>세 번째 및 네 번째 단수 값은 너무 작아서 근사치를 향상시키지 않기 때문에 (반올림 오류 내)<code>XTWO</code>순위 2입니다.</p>
</div>
</div>
</div>
<p>다시 한 번, 등급 2 행렬을 작성하는 방법에는 여러 가지가 있습니다.<code>XTWO</code>순위 하나의 매트릭스의 합으로 : 고유성을 보장하기 위해 우리는 또 다른 것을 부과합니다.<a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>단수 벡터의 조건. 단일 분해의 출력 벡터는 표준이 1과 동일 할뿐만 아니라 각 열 벡터가<span class="math inline">\(유\)</span>매트릭스는 이전의 모든 것과 직교합니다. 우리는 글을 씁니다<span class="math inline">\ (u _ {\ cdot 1} \ perp u _ {\ cdot 2} \)</span>, 이것은 동일한 위치에있는 값의 제품의 합이<span class="math inline">\ (0 \)</span>: <span class="math inline">\ (\ sum_i u_ {i1} u_ {i2} = 0 \)</span>. The<span class="math inline">\(다섯\)</span>행렬.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>위에서, 우리는 벡터의 표준을 1으로 선택했습니다.</p></div></div><div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>교차 제품을 계산하여 직교 성을 확인하십시오.<span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>매트릭스 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a><span class="fu">티</span>(UPS<span class="sc">$</span>유)<span class="sc">%*%</span>USV<span class="sc">$</span>유</span>
<span id="cb51-2"><a aria-hidden="true" href="#cb51-2" tabindex="-1"></a><span class="fu">티</span>(UPS<span class="sc">$</span>다섯)<span class="sc">%*%</span>USV<span class="sc">$</span>다섯</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>제출합시다<code>ScaledTurtles</code>단일 값 분해에 대한 매트릭스.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a>Turtles.svd<span class="ot">=</span> <span class="fu">SVD</span>(ScaledTurtles)</span>
<span id="cb52-2"><a aria-hidden="true" href="#cb52-2" tabindex="-1"></a>Turtles.svd<span class="sc">$</span>디</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.746475 1.419035 1.003329</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a>Turtles.svd<span class="sc">$</span>다섯</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3]
[1,] 0.5787981 0.3250273 0.74789704
[2,] 0.5779840 0.4834699 -0.65741263
[3,] 0.5752628 -0.8127817 -0.09197088</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a><span class="fu">어둑한</span>(Turtles.svd<span class="sc">$</span>유)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48 3</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-turtleSVD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.17</div>
</div>
<div class="callout-body-container callout-body">
<p>거북이 매트릭스에 대해 무엇을 결론을 내릴 수 있습니까?<code>SVD</code>산출?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-33-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-33-contents callout-collapse collapse" id="callout-33">
<div class="callout-body-container callout-body">
<p>첫 번째 열<code>Turtles.svd $ v</code>세 변수의 계수는 실질적으로 동일하다는 것을 보여줍니다. 다른 눈에 띄는 "일치"는 다음과 같습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a><span class="fu">합집합</span>(Turtles.svd<span class="sc">$</span>다섯[,<span class="dv">1</span>]]<span class="sc">^</span><span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" href="#cb60-1" tabindex="-1"></a><span class="fu">합집합</span>(Turtles.svd<span class="sc">$</span>디<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span> <span class="dv">47</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>우리는 실제로 계수가 있음을 알 수 있습니다<span class="math inline">\ (\ sqrt {1/3} \)</span>단수 값의 제곱의 합은 다음과 같습니다.<span class="math inline">\ ((N-1) \ Times P \)</span>.</p>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="7.6.3" id="singular-value-decomposition">
<h3 class="anchored" data-anchor-id="singular-value-decomposition" data-number="7.6.3"><span class="header-section-number">7.6.3</span>단일 가치 분해</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-24" href="imgs/SumRankOneD.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SumRankOneD.png"/></a></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(엑스\)</span>랭크 1 조각으로 추가로 분해됩니다. 각각<span class="math inline">\(유\)</span>벡터는<span class="math inline">\(유\)</span>매트릭스 및 각각<span class="math inline">\(다섯\)</span>벡터로<span class="math inline">\(다섯\)</span>. 그만큼<em>단일 가치 분해</em>~이다</p>
<p><span class="anchored-eq" data-anchor-id="eq-usv" id="eq-usv"><span class="math display">\ [
{\ mathbf x} = u s v^t, v^t v = {\ mathbb i}, u^t u = {\ mathbb i},
\ tag {7.5} \]</span></span></p>
<p>어디<span class="math inline" data-anchor-id="eq-usv">\(에스\)</span>단일 값의 대각선 행렬입니다.<span class="math inline">\ (v^t \)</span>의 전환입니다<span class="math inline">\(다섯\)</span>, 그리고<span class="math inline">\ ({\ mathbb i} \)</span>ID 매트릭스입니다. 표현<a class="quarto-xref" href="#eq-usv"><span>7.5</span></a>요소로 작성할 수 있습니다</p>
<p><span class="math display">\ [
x_ {ij} = u_ {i1} s_1v_ {1j} + u_ {i2} s_2v_ {2j} + u_ {i3} s_3v_ {3j} + ... +
u_ {ir} s_rv_ {rj},
\]</span></p>
<p><span class="math inline">\(유\)</span>그리고<span class="math inline">\(다섯\)</span>직교성이라고합니다<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>, 자체 크로스 제품이 정체성 매트릭스이기 때문에.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>정규 분포와 관련이 없으며, 직교 및 규범 1을 나타냅니다.</p></div></div></section>
<section class="level3" data-number="7.6.4" id="principal-components">
<h3 class="anchored" data-anchor-id="principal-components" data-number="7.6.4"><span class="header-section-number">7.6.4</span>주요 구성 요소</h3>
<p>단수 값 분해의 단일 벡터 (<code>SVD</code>R)의 함수는 원래 변수 앞에 놓을 계수를 포함하여 주요 구성 요소라고 부르는보다 유익한 변수를 만들 수 있습니다. 우리는 이것을 다음과 같이 씁니다.</p>
<p><span class="math display">\ [
Z_1 = V_ {11} X _ {\ CDOT 1} + V_ {21} X _ {\ CDOT 2} + V_ {31} x _ {\ CDOT 3} + \ CDOTS + V_ {P1} X _ {\ CDOT P}.
\]</span></p>
<p>만약에<code>usv = svd (x)</code>, 그 다음에<span class="math inline">\ ((v_ {11}, v_ {21}, v_ {31}, ...) \)</span>첫 번째 열에 의해 제공됩니다<code>USV $ v</code>; 마찬가지로<span class="math inline">\ (Z_2 \)</span>두 번째 열로<code>USV $ v</code>그리고 아들.<span class="math inline">\(피\)</span>열의 수입니다<span class="math inline">\(엑스\)</span>그리고 행의 수<span class="math inline">\(다섯\)</span>. 이 새로운 변수<span class="math inline">\ (Z_1, Z_2, Z_3, ... \)</span>크기가 감소하는 차이가 있습니다.<span class="math inline">\ (s_1^2 \ geq s_2^2 \ geq s_3^2 \ geq ... \)</span>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-checkus">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.18</div>
</div>
<div class="callout-body-container callout-body">
<p>첫 번째 단수 값을 곱하여 거북이 데이터에 대한 첫 번째 주요 구성 요소 계산<code>D [1]</code>~에 의해<code>u [, 1]</code>. 그것을 컴퓨팅하는 또 다른 방법은 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-35-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-35-contents callout-collapse collapse" id="callout-35">
<div class="callout-body-container callout-body">
<p>코드를 사용하여 이것을 보여줍니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a>우리를<span class="ot">=</span>Turtles.svd<span class="sc">$</span>유[,<span class="dv">1</span>, 떨어지다<span class="ot">=</span> <span class="cn">거짓</span>]]<span class="sc">%*%</span>Turtles.svd<span class="sc">$</span>디[<span class="dv">1</span>]]</span>
<span id="cb62-2"><a aria-hidden="true" href="#cb62-2" tabindex="-1"></a>XV<span class="ot">=</span>ScaledTurtles<span class="sc">%*%</span>Turtles.svd<span class="sc">$</span>다섯[,<span class="dv">1</span>, 떨어지다<span class="ot">=</span> <span class="cn">거짓</span>]]</span>
<span id="cb62-3"><a aria-hidden="true" href="#cb62-3" tabindex="-1"></a><span class="fu">맥스</span>(<span class="fu">ABS</span>(우리를<span class="sc">-</span>xv))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 또한 매트릭스 대수를 사용하는 것을 볼 수 있습니다<span class="math inline">\ (xv \)</span>그리고<span class="math inline">\(우리를\)</span>동일합니다. 기억하십시오<span class="math inline">\(다섯\)</span>직교입니다<span class="math inline">\ (v^t v = {\ mathBB I} \)</span>그리고<span class="math inline">\ (xv = usv^tv = us \, {\ mathbb i} \)</span>.</p>
<p><em>메모:</em>그만큼<code>drop = false</code>아래 코드의 첫 번째 줄에서 인수는 선택한 행렬 열이 유지되도록합니다.<em>행렬</em> / <em>정렬</em>클래스 속성이므로 행렬 곱셈 연산자가 자격이 있습니다. 또는 일반 곱셈 연산자를 사용할 수 있습니다<code>*</code>. 두 번째 줄에서<code>drop = false</code>엄격하게 필요하지는 않지만 대칭을 위해 있습니다.</p>
</div>
</div>
</div>
<p>다음은 두 가지 유용한 사실, 먼저 말로, 수학적 속기가 있습니다.</p>
<p>주요 구성 요소의 수<span class="math inline">\(케이\)</span>원래 변수 수 또는 관찰 수보다 항상 선택됩니다. 우리는 문제의 차원을“낮추고있다”.</p>
<p><span class="math display">\ [
k \ leq \ min (n, p).
\]</span></p>
<p>주요 구성 요소 변환은 첫 번째 주요 구성 요소가 가능한 가장 큰 분산을 갖도록 정의되며 (즉, 가능한 한 데이터의 많은 변동성을 설명 함), 각각의 연속 구성 요소는 전례 구성 요소와 직교 할 수있는 제약 조건 하에서 가능한 가장 높은 분산을 갖습니다.</p>
<p><span class="math display">\ [
\ max_ {ax \ perp bx} \ mbox {var} (\ mbox {proj} _ {ax} (x)), \ qquad \ mbox {where} bx = \ mbox {이전 구성 요소}
\]</span></p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="7.7" id="plotting-the-observations-in-the-principal-plane">
<h2 class="anchored" data-anchor-id="plotting-the-observations-in-the-principal-plane" data-number="7.7"><span class="header-section-number">7.7</span>주요 평면에서 관측치를 플로팅합니다</h2>
<div class="page-columns page-full"><p>우리는 두 변수 운동 선수 데이터를 다시 방문합니다<code>원반</code>그리고<code>무게</code>변수. ~ 안에<a class="quarto-xref" href="#sec-multivariate-pcaline"><span>섹션 7.3.2</span></a>, 우리는 첫 번째 주요 구성 요소를 계산하여 보라색 선으로 표시했습니다.<a class="quarto-xref" href="#fig-PCAR1R2-1">수치<span>7.10</span></a>. 우리는 그것을 보여 주었다<span class="math inline">\ (Z_1 \)</span>대각선에 의해 주어진 선형 조합이었다. 계수에 제곱의 합이 추가되어야하므로<span class="math inline">\ (1 \)</span>, 우리는 그것을 가지고 있습니다<span class="math display">\ [z_1 = -0.707*\ text {선수 \ $ disc}- 0.707*\ text {선수 \ $ weight}. \]</span> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">이것은 두 좌표가<span class="math inline">\ (C_1 = 0.7071 \)</span>그리고<span class="math inline">\ (C_2 = 0.7071 \)</span>.</span></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-xmultivariate-pcxy">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.19</div>
</div>
<div class="callout-body-container callout-body">
<p>출력의 어떤 부분<code>SVD</code>함수는 우리를 PC라고도하는 첫 번째 PC 계수로 이어집니다.<strong>로딩</strong> ?</p>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">우리가 사용합니다<code>SVDA</code>SVD는 두 변수에 적용되었습니다<code>원반</code>그리고<code>무게</code>.</span></div></div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-37-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-37-contents callout-collapse collapse" id="callout-37">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a aria-hidden="true" href="#cb63-1" tabindex="-1"></a>SVDA<span class="sc">$</span>다섯[,<span class="dv">1</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.7071068 -0.7071068</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>우리가 회전하면<code>(원반, 체중)</code>보라색 선을 수평으로 만들어 평면<span class="math inline">\(엑스\)</span>축, 우리는 첫 번째로 알려진 것을 얻습니다<strong>주요 비행기</strong>.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a>PPDF<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">PC1N =</span> <span class="sc">-</span>SVDA<span class="sc">$</span>유[,<span class="dv">1</span>]]<span class="sc">*</span>SVDA<span class="sc">$</span>디[<span class="dv">1</span>],,</span>
<span id="cb65-2"><a aria-hidden="true" href="#cb65-2" tabindex="-1"></a>              <span class="at">PC2N =</span>SVDA<span class="sc">$</span>유[,<span class="dv">2</span>]]<span class="sc">*</span>SVDA<span class="sc">$</span>디[<span class="dv">2</span>])))</span>
<span id="cb65-3"><a aria-hidden="true" href="#cb65-3" tabindex="-1"></a>GG<span class="ot">=</span> <span class="fu">ggplot</span>(PPDF,<span class="fu">AES</span>(<span class="at">x =</span>PC1N,<span class="at">y =</span>PC2N)<span class="sc">+</span> </span>
<span id="cb65-4"><a aria-hidden="true" href="#cb65-4" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb65-5"><a aria-hidden="true" href="#cb65-5" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,,,<span class="at">색상 =</span> <span class="st">"보라"</span>,,,<span class="at">linewidth =</span> <span class="fl">1.5</span>,,,<span class="at">알파 =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb65-6"><a aria-hidden="true" href="#cb65-6" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"PC1"</span>))<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"PC2"</span>))<span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.5</span>,,,<span class="fl">2.7</span>))<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="sc">-</span><span class="dv">2</span>,,,<span class="dv">2</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb65-7"><a aria-hidden="true" href="#cb65-7" tabindex="-1"></a>GG<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">x =</span>PC1N,<span class="at">y =</span> <span class="dv">0</span>),)<span class="at">색상 =</span> <span class="st">"빨간색"</span>))<span class="sc">+</span></span>
<span id="cb65-8"><a aria-hidden="true" href="#cb65-8" tabindex="-1"></a>     <span class="fu">geom_segment</span>(<span class="fu">AES</span>(<span class="at">xend =</span>PC1N,<span class="at">yend =</span> <span class="dv">0</span>),)<span class="at">색상 =</span> <span class="st">"빨간색"</span>))</span>
<span id="cb65-9"><a aria-hidden="true" href="#cb65-9" tabindex="-1"></a>GG<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">x =</span> <span class="dv">0</span>,,,<span class="at">y =</span>PC2N),<span class="at">색상 =</span> <span class="st">"파란색"</span>))<span class="sc">+</span></span>
<span id="cb65-10"><a aria-hidden="true" href="#cb65-10" tabindex="-1"></a>     <span class="fu">geom_segment</span>(<span class="fu">AES</span>(<span class="at">yend =</span>PC2N,<span class="at">xend =</span> <span class="dv">0</span>),)<span class="at">색상 =</span> <span class="st">"파란색"</span>))<span class="sc">+</span></span>
<span id="cb65-11"><a aria-hidden="true" href="#cb65-11" tabindex="-1"></a>     <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,,,<span class="at">색상 =</span> <span class="st">"스카이 블루"</span>,,,<span class="at">linewidth =</span> <span class="fl">1.5</span>,,,<span class="at">알파 =</span> <span class="fl">0.5</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-pcablue">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pcablue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-pcablue" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-pcablue-1" width="480">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-pcablue-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-pcablue" href="07-chap_files/figure-html/fig-pcablue-1.png" title="Figure 7.16 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-pcablue" id="fig-pcablue-1" src="07-chap_files/figure-html/fig-pcablue-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-pcablue-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-pcablue" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-pcablue-2" width="480">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-pcablue-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-pcablue" href="07-chap_files/figure-html/fig-pcablue-2.png" title="Figure 7.16 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-pcablue" id="fig-pcablue-2" src="07-chap_files/figure-html/fig-pcablue-2.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-pcablue-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pcablue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.16 : 두 개의 원래 변수 만있는 경우 PCA 변환은 간단한 회전입니다. 새로운 좌표는 항상 수평 및 수직 축으로 선택됩니다.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAdiscusweight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.20</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>빨간 세그먼트의 제곱 합의 평균은 무엇입니까?<a class="quarto-xref" href="#fig-pcablue">수치<span>7.16</span></a>동일하게?<br/>
</li>
<li>이것은 빨간색 점의 분산과 어떻게 비교됩니까?<br/>
</li>
<li>파란색 세그먼트의 표준 편차의 레드 세그먼트의 비율을 계산합니다.<a class="quarto-xref" href="#fig-pcablue">수치<span>7.16</span></a>. 이것을 단수 값 1 및 2의 비율과 비교하십시오.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-39-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-39-contents callout-collapse collapse" id="callout-39">
<div class="callout-body-container callout-body">
<ol type="a">
<li>빨간 세그먼트의 제곱의 합은 두 번째 단수 값의 제곱에 해당합니다.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" href="#cb66-1" tabindex="-1"></a><span class="fu">합집합</span>(PPDF<span class="sc">$</span>PC2N<span class="sc">^</span><span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.196729</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" href="#cb68-1" tabindex="-1"></a>SVDA<span class="sc">$</span>디[<span class="dv">2</span>]]<span class="sc">^</span><span class="dv">2</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.196729</code></pre>
</div>
</div>
<p>빨간 세그먼트의 평균은 0이므로 상기 수량은 분산에 비례합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" href="#cb70-1" tabindex="-1"></a><span class="fu">평균</span>(PPDF<span class="sc">$</span>PC2N)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.451106E-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a><span class="fu">우리의</span>(PPDF<span class="sc">$</span>PC2N)<span class="sc">*</span> (<span class="fu">nrow</span>(PPDF)<span class="sc">-</span><span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.196729</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>빨간색 점의 분산은입니다<code>(ppdf $ pc1n)</code>, 이것은 첫 번째 PC의 설계에 의해 a)에서 계산 한 것보다 큽니다.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a><span class="fu">우리의</span>(PPDF<span class="sc">$</span>PC1N)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.806352</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a><span class="fu">우리의</span>(PPDF<span class="sc">$</span>PC2N)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1936478</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>우리는 컴퓨팅을 통해 수직 및 수평 축의 포인트로 설명 된 표준 편차의 비율을 취합니다.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a><span class="fu">SD</span>(PPDF<span class="sc">$</span>PC1N)<span class="sc">/</span> <span class="fu">SD</span>(PPDF<span class="sc">$</span>PC2N)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.054182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a>SVDA<span class="sc">$</span>디[<span class="dv">1</span>]]<span class="sc">/</span>SVDA<span class="sc">$</span>디[<span class="dv">2</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.054182</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>사용<code>prcomp</code>운동 선수 데이터의 첫 두 열의 PCA를 계산하려면 출력을보십시오. 단수 값 분해와 비교하십시오.</p>
</div>
</div>
<section class="level3 page-columns page-full" data-number="7.7.1" id="pca-of-the-turtles-data">
<h3 class="anchored" data-anchor-id="pca-of-the-turtles-data" data-number="7.7.1"><span class="header-section-number">7.7.1</span>거북이 데이터의 PCA</h3>
<p>이제 Turtles 데이터에 대한 완전한 PCA 분석을 원합니다. 우리는 이미 1 차원 및 2 차원 데이터에 대한 요약 통계를 살펴 보았습니다. 이제 우리는 이러한 저조 데이터의 "진정한"차원에 대한 질문에 답할 것입니다.</p>
<p>다음 코드에서는 기능을 사용합니다<code>왕자</code>. 반환 값은 PCA를 플롯하고 해석하는 데 필요한 모든 중요한 정보의 목록입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-27" href="imgs/devil.png" title="In fact, PCA is such a fundamental technique that there are many different implementations of it in various R packages. Unfortunately, the input arguments and the formatting and naming of their output is not standardized, and some even use different conventions for the scaling of their output. We will experiment with several different ones to familiarize ourselves with these choices."><img alt="In fact, PCA is such a fundamental technique that there are many different implementations of it in various R packages. Unfortunately, the input arguments and the formatting and naming of their output is not standardized, and some even use different conventions for the scaling of their output. We will experiment with several different ones to familiarize ourselves with these choices." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>실제로, PCA는 다양한 R 패키지에 IT의 여러 구현이있는 기본 기술입니다. 불행히도, 입력 인수와 출력의 서식 및 이름 지정은 표준화되지 않았으며 일부는 출력 스케일링을 위해 다른 규칙을 사용하기도합니다. 우리는 이러한 선택에 익숙해지기 위해 여러 가지 다른 것을 실험 할 것입니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a><span class="fu">코</span>(ScaledTurtles)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>길이 너비 높이
길이 1.0000000 0.9783116 0.9646946
너비 0.9783116 1.0000000 0.9605705
높이 0.9646946 0.9605705 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a aria-hidden="true" href="#cb84-1" tabindex="-1"></a>pcaturtles<span class="ot">=</span> <span class="fu">왕자</span>(ScaledTurtles)</span>
<span id="cb84-2"><a aria-hidden="true" href="#cb84-2" tabindex="-1"></a>pcaturtles</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>부르다:
Princomp (x = ScaledTurtles)

표준 편차 :
   comp.1 comp.2 comp.3 
1.6954576 0.2048201 0.1448180 

 3 개의 변수와 48 개의 관찰.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" href="#cb86-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"팩트라"</span>))</span>
<span id="cb86-2"><a aria-hidden="true" href="#cb86-2" tabindex="-1"></a><span class="fu">fviz_eig</span>(pcaturtles,<span class="at">geom =</span> <span class="st">"술집"</span>,,,<span class="at">bar_width =</span> <span class="fl">0.4</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-PCAturtles">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PCAturtles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-28" href="07-chap_files/figure-html/fig-PCAturtles-1.png" title="Figure 7.17: The screeplot shows the eigenvalues for the standardized turtles data (scaledTurtles): there is one large value and two small ones. The data are (almost) one-dimensional. We will see why this dimension is called an axis of size, a frequent phenomenon in biometric data [@Jolicoeur1960]."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-PCAturtles-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PCAturtles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.17 : screeplot은 표준화 된 거북 데이터의 고유 값을 보여줍니다 (<code>ScaledTurtles</code>) : 하나의 큰 값과 두 개의 작은 값이 있습니다. 데이터는 (거의) 1 차원입니다. 우리는 왜이 차원이 크기의 축이라고하는지, 생체 인식 데이터에서 빈번한 현상입니다.<span class="citation" data-cites="Jolicoeur1960">(<a href="16-chap.html#ref-Jolicoeur1960" role="doc-biblioref">Jolicoeur와 Mosimann 1960</a>))</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-pcavariations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.21</div>
</div>
<div class="callout-body-container callout-body">
<p>많은 PCA 기능은 다른 시간에 다른 영역에서 일한 다른 팀에 의해 만들어졌습니다. 이것은 특히 명명 규칙이 다르기 때문에 혼란을 초래할 수 있습니다. 그들 중 세 가지를 비교해 봅시다. 다음 줄의 코드를 실행하고 결과 객체를보십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a aria-hidden="true" href="#cb87-1" tabindex="-1"></a><span class="fu">SVD</span>(ScaledTurtles)<span class="sc">$</span>다섯[,<span class="dv">1</span>]]</span>
<span id="cb87-2"><a aria-hidden="true" href="#cb87-2" tabindex="-1"></a><span class="fu">prcomp</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>])))<span class="sc">$</span>회전[,<span class="dv">1</span>]]</span>
<span id="cb87-3"><a aria-hidden="true" href="#cb87-3" tabindex="-1"></a><span class="fu">왕자</span>(ScaledTurtles)<span class="sc">$</span>하중 [,<span class="dv">1</span>]]</span>
<span id="cb87-4"><a aria-hidden="true" href="#cb87-4" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ADE4"</span>))</span>
<span id="cb87-5"><a aria-hidden="true" href="#cb87-5" tabindex="-1"></a><span class="fu">dudi.pca</span>(거북이 [,<span class="sc">-</span><span class="dv">1</span>],,<span class="at">nf =</span> <span class="dv">2</span>,,,<span class="at">scannf =</span> <span class="cn">거짓</span>))<span class="sc">$</span>C1 [,<span class="dv">1</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>스케일링을 비활성화하면 어떻게됩니다<code>prcomp</code>그리고<code>왕자</code>기능?</p>
</div>
</div>
<p>다음에서 우리는 항상 매트릭스를 가정합니다<span class="math inline">\(엑스\)</span>중앙 및 스케일링 된 매트릭스를 나타냅니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-newvariables">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.22</div>
</div>
<div class="callout-body-container callout-body">
<p>새로운 변수에서 관측치의 좌표<code>prcomp</code>기능 (전화하십시오<code>해안</code>)에 있습니다<code>점수</code>결과의 슬롯. PC1을 살펴보십시오<code>거북이</code>그리고 그것을 비교하십시오<code>RES $ 점수</code>. 표준 편차를 비교하십시오<code>SD1</code>그것에<code>해안</code>객체 및 점수의 표준 편차.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-43-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-43-contents callout-collapse collapse" id="callout-43">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a aria-hidden="true" href="#cb88-1" tabindex="-1"></a>해안<span class="ot">=</span> <span class="fu">왕자</span>(ScaledTurtles)</span>
<span id="cb88-2"><a aria-hidden="true" href="#cb88-2" tabindex="-1"></a>PC1<span class="ot">=</span>ScaledTurtles<span class="sc">%*%</span>해안<span class="sc">$</span>하중 [,<span class="dv">1</span>]]</span>
<span id="cb88-3"><a aria-hidden="true" href="#cb88-3" tabindex="-1"></a>SD1<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">평균</span>(res<span class="sc">$</span>점수 [,<span class="dv">1</span>]]<span class="sc">^</span><span class="dv">2</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-orthoscores">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.23</div>
</div>
<div class="callout-body-container callout-body">
<p>의 직교성을 확인하십시오<code>RES $ 점수</code>행렬. 왜 그렇게 말할 수 없어요<strong>직교</strong>?</p>
</div>
</div>
<p>이제 우리는 두 PC 점수를 모두 결합 할 것입니다 (<span class="math inline">\(우리를\)</span>) 및 하중 계수 (<span class="math inline">\(다섯\)</span>). 샘플과 표현 된 변수가 모두있는 플롯을 호출합니다.<strong>이하</strong>. 이것은 다음을 사용하여 한 줄로 수행 할 수 있습니다.<strong><a href="https://cran.r-project.org/web/packages/factoextra/">팩트라</a></strong>패키지 기능.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a aria-hidden="true" href="#cb89-1" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pcaturtles,<span class="at">레이블 =</span> <span class="st">"우리의"</span>,,,<span class="at">드레싱 =</span>거북이 [,<span class="dv">1</span>])))<span class="sc">+</span></span>
<span id="cb89-2"><a aria-hidden="true" href="#cb89-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-turtlebiplot">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-turtlebiplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="07-chap_files/figure-html/fig-turtlebiplot-1.png" title="Figure 7.18: A biplot of the first two dimensions showing both variables and observations. The arrows show the variables. The turtles are labeled by sex. The extended horizontal direction is due to the size of the first eigenvalue, which is much larger than the second."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-turtlebiplot-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-turtlebiplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.18 : 변수와 ​​관측치를 모두 보여주는 처음 두 차원의 이형. 화살표는 변수를 보여줍니다. 거북이는 성별로 표시됩니다. 확장 된 수평 방향은 첫 번째 고유 값의 크기로 인한 것이며, 이는 두 번째보다 훨씬 큽니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="imgs/devil.png" title="Beware the aspect ratio when plotting a PCA. It is rare to have the two components be of similar norm, so square shaped plots will be the exception. More common are elongated plots, which show that the horizontal (first) principal component is more important than the second. This matters, e.g., for interpreting distances between points in the plots."><img alt="Beware the aspect ratio when plotting a PCA. It is rare to have the two components be of similar norm, so square shaped plots will be the exception. More common are elongated plots, which show that the horizontal (first) principal component is more important than the second. This matters, e.g., for interpreting distances between points in the plots." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>PCA를 플로팅 할 때 종횡비를 조심하십시오. 두 구성 요소가 비슷한 표준이되는 것은 드 rare므로 정사각형 모양의 음모가 예외가 될 것입니다. 더 일반적으로 길쭉한 음모가 있는데, 이는 수평 (첫 번째) 원칙 구성 요소가 두 번째보다 중요하다는 것을 보여줍니다. 예를 들어, 플롯의 지점 사이의 거리를 해석하는 것입니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-aspectratio">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.24</div>
</div>
<div class="callout-body-container callout-body">
<p>높이가 너비보다 긴 수평 축으로 PC1을 가진 PCA 플롯을 가질 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-46-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-46-contents callout-collapse collapse" id="callout-46">
<div class="callout-body-container callout-body">
<p>PC1 방향의 점 분산은 다음과 같습니다<span class="math inline">\ (\ lambda_1 = s_1^2 \)</span>항상보다 큽니다<span class="math inline">\ (\ lambda_2 = s_2^2 \)</span>따라서 PCA 플롯은 항상 높음보다 넓습니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAturtles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.25</div>
</div>
<div class="callout-body-container callout-body">
<p>보고 있습니다<a class="quarto-xref" href="#fig-turtlebiplot">수치<span>7.18</span></a>: a) 남성이나 암컷 거북이 더 큰 경향이 있습니까?<br/>b) 화살표는 상관 관계에 대해 무엇을 알려주나요?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-Eigenturtles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.26</div>
</div>
<div class="callout-body-container callout-body">
<p>각각의 새로운 좌표의 분산을 PCA에서 반환 한 고유 값과 비교하십시오.<code>dudi.pca</code>기능.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-49-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-49-contents callout-collapse collapse" id="callout-49">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a aria-hidden="true" href="#cb90-1" tabindex="-1"></a>PCADUDIT<span class="ot">=</span> <span class="fu">dudi.pca</span>(ScaledTurtles,<span class="at">nf =</span> <span class="dv">2</span>,,,<span class="at">scannf =</span> <span class="cn">거짓</span>))</span>
<span id="cb90-2"><a aria-hidden="true" href="#cb90-2" tabindex="-1"></a><span class="fu">적용하다</span>(PCADUDIT<span class="sc">$</span>Li,<span class="dv">2</span>,,,<span class="cf">기능</span>(엑스)<span class="fu">합집합</span>(엑스<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span><span class="dv">48</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Axis1 axis2 
2.93573765 0.04284387</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a aria-hidden="true" href="#cb92-1" tabindex="-1"></a>PCADUDIT<span class="sc">$</span>eig</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.93573765 0.04284387 0.02141848</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>이제 우리는 상관 관계 원으로 알려진 것을 그려서 구식과 새로운 변수 간의 관계를 살펴 봅니다. 종횡비는 여기서 1이고 변수는 다음과 같이 화살표로 표시됩니다.<a class="quarto-xref" href="#fig-turtlesCirclef">수치<span>7.19</span></a>. 화살표의 길이는 첫 번째 주요 평면에 대한 예측의 품질을 나타냅니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a aria-hidden="true" href="#cb94-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pcaturtles,<span class="at">col.circle =</span> <span class="st">"검은색"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span></span>
<span id="cb94-2"><a aria-hidden="true" href="#cb94-2" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">기음</span>(<span class="sc">-</span><span class="fl">1.2</span>,,,<span class="fl">1.2</span>)))<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="sc">-</span><span class="fl">1.2</span>,,,<span class="fl">1.2</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-turtlesCirclef">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-turtlesCirclef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="07-chap_files/figure-html/fig-turtlesCirclef-1.png" title="Figure 7.19: Part of the “circle of correlations” showing the original variables. Their correlations with each other and with the new principal components are given by the angles between the vectors and between the axes and the vectors."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-turtlesCirclef-1.png" width="256"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-turtlesCirclef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.19 : 원래 변수를 보여주는 "상관 관계 원"의 일부. 서로 및 새로운 주요 구성 요소와의 상관 관계는 벡터와 축과 벡터 사이의 각도에 의해 주어집니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-relationsvdsd">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.27</div>
</div>
<div class="callout-body-container callout-body">
<p>Turtles Data Matrix의 행 수와 다음 숫자 사이의 관계를 설명하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a aria-hidden="true" href="#cb95-1" tabindex="-1"></a><span class="fu">SVD</span>(ScaledTurtles)<span class="sc">$</span>디<span class="sc">/</span>pcaturtles<span class="sc">$</span>SDEV</span>
<span id="cb95-2"><a aria-hidden="true" href="#cb95-2" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">47</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-51-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-51-contents callout-collapse collapse" id="callout-51">
<div class="callout-body-container callout-body">
<p>분산 공분산 행렬을 계산할 때 많은 구현이 사용됩니다<span class="math inline">\ (1/(n-1) \)</span>분모로서. 여기,<span class="math inline">\ (n = 48 \)</span>따라서 차이의 합은 48/47의 계수로 꺼져 있습니다.</p>
</div>
</div>
</div>
<div class="page-columns page-full"><p>이 데이터는 때때로 데이터의 거의 모든 변동이 저차원 공간에서 어떻게 캡처 될 수 있는지에 대한 좋은 예입니다. 여기서는 3 차원 데이터가 본질적으로 라인으로 대체 될 수 있습니다.  명심하십시오 :<span class="math inline">\ (x ^ tc = vsu ^ tus = vs ^ 2. \)</span>그만큼<strong>주요 구성 요소</strong>매트릭스의 열입니다<span class="math inline">\ (C = US \)</span>. 그만큼<span class="math inline">\(피\)</span>의 열<span class="math inline">\(유\)</span>(주어진 매트릭스<code>usv $ u</code>출력에서<code>SVD</code>위의 기능)은 규범을 갖도록 저장됩니다<span class="math inline">\ ((S_1^2, S_2^2, ..., S_P^2) \)</span>. 각 열에는 다른 차이가 있습니다<em>책임이 있는</em>설명을 위해. 이것들은 숫자가 줄어들 것입니다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">우리가 첫 번째를 원한다면 그것은 단지<span class="math inline">\ (C_1 = S_1 U_1 \)</span>. 주목하십시오<span class="math inline">\ (|| C_1 ||^2 = S_1^TU_1 U_1^T S_1 = S_1^2 U_1^TU_1 = S_1^2 = \ lambda_1 \)</span></span></div></div>
<p>매트릭스 인 경우<span class="math inline">\(엑스\)</span>연구에서 나옵니다<span class="math inline">\(N\)</span>다른 샘플 또는 시편, 그 다음 주요 구성 요소는 이들에 대한 새로운 좌표를 제공합니다.<span class="math inline">\(N\)</span>에서<a class="quarto-xref" href="#fig-pcablue">수치<span>7.16</span></a>. 이것들은 때때로라고 불립니다<em>점수</em>PCA 기능의 결과에서.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-xkcd-ev">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-xkcd-ev-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-32" href="imgs/xkcdEigenVectors.jpg" title="Figure 7.20: Another great xkcd take: this time eigenvectors."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/xkcdEigenVectors.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-xkcd-ev-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.20 : 또 다른 훌륭한 XKCD 테이크 : 이번에는 고유 벡터입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>보다 자세한 예를 들어보기 전에 SVD와 PCA가 제공하는 내용을 요약하겠습니다.</p>
<ul>
<li><p>각 주요 구성 요소는 해당 고유 값, 해당 단수 값의 제곱에 의해 측정 된 분산을 갖습니다.</p></li>
<li><p>새로운 변수는 직교로 만들어집니다. 그것들도 중심에 있기 때문에 이것은 그들이 상관 관계가 없음을 의미합니다. 정상 분산 데이터의 경우 이는 또한 독립적이라는 것을 의미합니다.</p></li>
<li><p>변수가 저장되면 모든 변수의 차이의 합은 변수 수입니다.<span class="math inline">\ (= p \)</span>). 차이의 합은 크로스 제품 매트릭스의 대각선을 추가하여 계산됩니다.<a class="footnote-ref" href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p></li>
<li><p>주요 구성 요소는 고유 값의 크기에 따라 순서입니다. 보유 할 구성 요소 수를 결정하기 전에 항상 ScreePlot을 확인합니다. 우리가했던 것처럼 가장 모범 사례입니다.<a class="quarto-xref" href="#fig-turtlebiplot">수치<span>7.18</span></a>그리고 설명하는 분산의 비율로 각 PC 축에 주석을 달 수 있습니다.</p></li>
</ul>
<div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>자체 분해 :</strong>자체가있는 X의 교차 제품이 확인됩니다<span class="math display">\ [x^tx = vsu^tusv^t = vs^2v^t = v \ lambda v^t \]</span>어디<span class="math inline">\(다섯\)</span>대칭 행렬의 고유 벡터 매트릭스라고합니다<span class="math inline">\ (x^tx \)</span>그리고<span class="math inline">\ (\ lambda \)</span>고유 값의 대각선 행렬입니다<span class="math inline">\ (x^tx \)</span>.</span><div id="fn9"><p><sup>9</sup>이 대각선 요소 의이 합을 호출합니다<strong>흔적</strong>매트릭스의.</p></div></div><div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>위키 백과에서 고유 값을 찾으십시오. 공식을 사용하지 않고 정의하는 문장을 찾으십시오. 왜 고유 벡터가 신데렐라에서 (스트레치에서) 사용하게 될까요? (XKCD 만화를 참조하십시오<a class="quarto-xref" href="#fig-xkcd-ev">수치<span>7.20</span></a>.))</p>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-33" href="imgs/book_icon.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">선형 대수의 기본에 대한 도움을 얻으려면 시간 동안 동기 부여 된 학생이 상담 할 수 있습니다.<a href="https://www.khanacademy.org/math/linear-algebra/alternate-bases/eigen-everything/v/linear-algebra-introduction-to-eigenvalues-and-eigenvectors">칸 아카데미</a>. 더 많은 시간이 있고 깊이있는 커버리지를 원한다면<a href="http://ocw.mit.edu/courses/mathematics/18-06-linear-algebra-spring-2010">길 스트란은 물론입니다</a>고전적인 것입니다<a href="http://math.mit.edu/linearalgebra">이 책의 일부는 온라인으로 제공됩니다</a> <span class="citation" data-cites="Strang:09">(<a href="16-chap.html#ref-Strang:09" role="doc-biblioref">Strang 2009</a>))</span>.</span></div></div>
</section>
<section class="level3 page-columns page-full" data-number="7.7.2" id="a-complete-analysis-the-decathlon-athletes">
<h3 class="anchored" data-anchor-id="a-complete-analysis-the-decathlon-athletes" data-number="7.7.2"><span class="header-section-number">7.7.2</span>완전한 분석 : Decathlon 운동 선수</h3>
<p>우리는이 장의 앞부분 에서이 데이터를보기 시작했습니다. 여기서는 완전한 다변량 분석을 단계별로 따라갑니다. 먼저, 상관 행렬 (소수점 후 2 자리로 반올림)을 다시 살펴 보겠습니다. 우리는 이미 그것을 컬러 히트 맵으로 그렸습니다<a class="quarto-xref" href="#fig-heatmapathletes">수치<span>7.3</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a aria-hidden="true" href="#cb96-1" tabindex="-1"></a><span class="fu">코</span>(운동 선수)<span class="sc">|&gt;</span> <span class="fu">둥근</span>(<span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>M100 긴 무게 높이 M400 M110 디스크 장대 창조 M1500
M100 1.00 1.00 -0.54 -0.21 -0.15 0.61 0.64 -0.05 -0.39 -0.06 0.26
LONG -0.54 1.00 0.14 0.27 -0.52 -0.48 0.04 0.35 0.18 -0.40
중량 -0.21 0.14 1.00 0.12 0.09 -0.30 0.81 0.48 0.60 0.27
높은 -0.15 0.27 0.12 1.00 -0.09 -0.31 0.15 0.21 0.12 -0.11
M400 0.61 -0.52 0.09 -0.09 1.00 0.55 0.14 -0.32 0.12 0.59
M110 0.64 -0.48 -0.30 -0.31 0.55 1.00 -0.11 -0.52 -0.06 0.14
디스크 -0.05 0.04 0.81 0.15 0.14 -0.11 1.00 0.34 0.44 0.40
극 -0.39 0.35 0.48 0.21 -0.32 -0.52 0.34 1.00 0.27 -0.03
창 던지기 -0.06 0.18 0.60 0.12 0.12 -0.06 0.44 0.27 1.00 0.10
M1500 0.26 -0.40 0.27 -0.11 0.59 0.14 0.40 -0.03 0.10 1.00</code></pre>
</div>
</div>
<p>그런 다음 우리는 ScreePlot을보고 계급을 선택하는 데 도움이됩니다.<span class="math inline">\(케이\)</span>이 데이터의 본질을 나타내는 것.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a aria-hidden="true" href="#cb98-1" tabindex="-1"></a>pca.ath<span class="ot">=</span> <span class="fu">dudi.pca</span>(운동 선수,<span class="at">scannf =</span> <span class="cn">거짓</span>))</span>
<span id="cb98-2"><a aria-hidden="true" href="#cb98-2" tabindex="-1"></a>pca.ath<span class="sc">$</span>eig</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.4182381 2.6063931 0.9432964 0.8780212 0.5566267 0.4912275 0.4305952
 [8] 0.3067981 0.2669494 0.1018542</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a aria-hidden="true" href="#cb100-1" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca.ath,<span class="at">geom =</span> <span class="st">"술집"</span>,,,<span class="at">bar_width =</span> <span class="fl">0.3</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-screeplota">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-screeplota-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-34" href="07-chap_files/figure-html/fig-screeplota-1.png" title="Figure 7.21: The screeplot of the athletes data indicates that most of the variation in the data can be captured in a two-dimensional plane (spanned by the first two principal components)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-screeplota-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-screeplota-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.21 : 운동 선수 데이터의 스크리 플롯은 데이터의 대부분의 변동이 2 차원 평면 (처음 두 주요 구성 요소에 의해 스프인)에서 캡처 될 수 있음을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>Screeplot<a class="quarto-xref" href="#fig-screeplota">수치<span>7.21</span></a>두 번째 후 고유 값의 명확한 낙하를 보여줍니다. 이것은 좋은 근사치가 Rank 2에서 얻어 질 것임을 나타냅니다. 원래 변수의로드를 주요 구성 요소 인 두 가지 변수의 하중을 투사하여 처음 두 축의 해석을 살펴 보겠습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a aria-hidden="true" href="#cb101-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca.ath,<span class="at">col.var =</span> <span class="st">"파란색"</span>,,,<span class="at">repel =</span> <span class="cn">진실</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-athletecorr">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-athletecorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-35" href="07-chap_files/figure-html/fig-athletecorr-1.png" title="Figure 7.22: Correlation circle of the original variables."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-athletecorr-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-athletecorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.22 : 원래 변수의 상관 관계 원.</figcaption>
</figure>
</div>
</div></div></div>
<p>상관 관계 원<a class="quarto-xref" href="#fig-athletecorr">수치<span>7.22</span></a>원래 변수의 투영을 두 개의 첫 번째 새로운 주요 축에 표시합니다. 벡터 사이의 각도는 상관 관계로 해석됩니다. 비행기의 오른쪽에는 트랙 및 필드 이벤트 (M110, M100, M400, M1500)가 있으며 왼쪽에는 던지기 및 점프 이벤트가 있습니다. 어쩌면 상관 관계 매트릭스에 특징적인 기술의 반대가있을 수 있습니다. 우리는이 두 그룹의 변수 사이에서 상관 관계가 음의 임시를 보았습니다. 우리는 이것을 어떻게 해석 할 수 있습니까?</p>
<p>최고를 던지는 사람들은 트랙 대회에서 점수가 낮은 것으로 보입니다. 실제로 원래 측정을 보면 무슨 일이 일어나고 있는지 알 수 있습니다. 짧은 시간에 달리는 운동 선수는 더 강한 사람입니다. 트랙 변수의 점수를 변경하고 분석을 다시 만들어야 할 것입니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-changesigns">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.28</div>
</div>
<div class="callout-body-container callout-body">
<p>변수의 변환은 최고의 운동 공연이 같은 방향으로 다양하게 유발되는 것입니다. 즉, 대부분 긍정적 인 상관 관계가 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-54-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-54-contents callout-collapse collapse" id="callout-54">
<div class="callout-body-container callout-body">
<p>우리가 달리기 성능의 표지판을 변경하면 거의 모든 변수가 양의 상관 관계가 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a aria-hidden="true" href="#cb102-1" tabindex="-1"></a>Runningvars<span class="ot">=</span> <span class="fu">grep</span>(<span class="st">"^m"</span>,,,<span class="fu">colnames</span>(운동 선수),<span class="at">값 =</span> <span class="cn">진실</span>))</span>
<span id="cb102-2"><a aria-hidden="true" href="#cb102-2" tabindex="-1"></a>Runningvars</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "M100" "M400" "M110" "M1500"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a aria-hidden="true" href="#cb104-1" tabindex="-1"></a>운동 선수 [, runningvars]<span class="ot">=</span> <span class="sc">-</span>운동 선수 [, runningvars]</span>
<span id="cb104-2"><a aria-hidden="true" href="#cb104-2" tabindex="-1"></a><span class="fu">코</span>(운동 선수)<span class="sc">|&gt;</span> <span class="fu">둥근</span>(<span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>M100 긴 무게 높이 M400 M110 디스크 장대 창조 M1500
M100 1.00 0.54 0.21 0.15 0.61 0.64 0.05 0.39 0.06 0.26
LONG 0.54 1.00 0.14 0.27 0.52 0.48 0.04 0.35 0.18 0.40
체중 0.21 0.14 1.00 0.12 -0.09 0.30 0.81 0.48 0.60 -0.27
높은 0.15 0.27 0.12 1.00 0.09 0.31 0.15 0.21 0.12 0.11
M400 0.61 0.52 -0.09 0.09 1.00 0.55 -0.14 0.32 -0.12 0.59
M110 0.64 0.48 0.30 0.31 0.55 1.00 0.11 0.52 0.06 0.14
디스크 0.05 0.04 0.81 0.15 -0.14 0.11 1.00 0.34 0.44 -0.40
극 0.39 0.35 0.48 0.21 0.32 0.52 0.34 1.00 0.27 0.03
창 던지기 0.06 0.18 0.60 0.12 -0.12 0.06 0.44 0.27 1.00 -0.10
M1500 0.26 0.40 -0.27 0.11 0.59 0.14 -0.40 0.03 -0.10 1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a aria-hidden="true" href="#cb106-1" tabindex="-1"></a>pca.ath<span class="ot">=</span> <span class="fu">dudi.pca</span>(운동 선수,<span class="at">nf =</span> <span class="dv">2</span>,,,<span class="at">scannf =</span> <span class="cn">거짓</span>))</span>
<span id="cb106-2"><a aria-hidden="true" href="#cb106-2" tabindex="-1"></a>pca.ath<span class="sc">$</span>eig</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.4182381 2.6063931 0.9432964 0.8780212 0.5566267 0.4912275 0.4305952
 [8] 0.3067981 0.2669494 0.1018542</code></pre>
</div>
</div>
<p>이제 모든 부정적인 상관 관계는 상당히 작습니다. 매트릭스의 고유 값이 상기 부호 플립의 영향을받지 않기 때문에 ScreePlot은 변화를 나타내지 않을 것입니다. 변화하는 유일한 OUPUT는 우리가 징후가 뒤집힌 변수에 대한 주요 구성 요소 로딩 계수의 징후입니다.</p>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a aria-hidden="true" href="#cb108-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pcan.thhard,<span class="at">col.var =</span> <span class="st">"파란색"</span>,,,<span class="at">repel =</span> <span class="cn">진실</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-athletecorrn">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-athletecorrn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-36" href="07-chap_files/figure-html/fig-athletecorrn-1.png" title="Figure 7.23: Correlation circle after changing the signs of the running variables."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-athletecorrn-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-athletecorrn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.23 : 실행 변수의 부호를 변경 한 후 상관 관계.</figcaption>
</figure>
</div>
</div></div></div>
<p><a class="quarto-xref" href="#fig-athletecorrn">수치<span>7.23</span></a>변환 된 변수의 상관 관계 원을 보여줍니다. 우리는 이제 우리는 전체적인 공통 축을 가지고 있음을 알 수 있습니다. 모든 화살표는 같은 방향으로 크게 향하고 있습니다.</p>
<p>이제 우리는 다음을 사용하여 주요 비행기에 투사 된 선수들을 계획합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a aria-hidden="true" href="#cb109-1" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pcan.thhard,<span class="at">repel =</span> <span class="cn">진실</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-athletepc">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-athletepc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-37" href="07-chap_files/figure-html/fig-athletepc-1.png" title="Figure 7.24: First principal plane showing the projections of the athletes. Do you notice something about the organization of the numbers?"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-athletepc-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-athletepc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.24 : 운동 선수의 투영을 보여주는 첫 번째 주요 비행기. 숫자 조직에 대해 뭔가를 보십니까?</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-PCAnumba">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.29</div>
</div>
<div class="callout-body-container callout-body">
<p>우리가 선수들이 보여지는대로 스스로를 보면<a class="quarto-xref" href="#fig-athletepc">수치<span>7.24</span></a>, 우리는 약간의 주문 효과가 있음을 알 수 있습니다. 운동 선수의 성능과 그 번호 사이의 관계를 보십니까?<a class="quarto-xref" href="#fig-athletepc">수치<span>7.24</span></a> ?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-56-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-56-contents callout-collapse collapse" id="callout-56">
<div class="callout-body-container callout-body">
<p>당신이 숫자의 순서에 따라 점에 합류한다면, 당신은 아마도 숫자가 무작위로 할당 된 것보다 플롯의 한쪽에서 더 많은 시간을 보내고 있다는 것을 알게 될 것입니다.</p>
</div>
</div>
</div>
<p>그것은<code>국제 올림픽 경기 대회</code>데이터 세트. 추가 벡터 변수가 호출됩니다<code>점수</code>1988 년 올림픽에서 열린 남성 데카 슬론, 대회에서 최종 점수를보고합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a aria-hidden="true" href="#cb110-1" tabindex="-1"></a>국제 올림픽 경기 대회<span class="sc">$</span>점수</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8488 8399 8328 8306 8286 8272 8216 8189 8180 8167 8143 8114 8093 8083 8036
[16] 8021 7869 7860 7859 7781 7753 7745 7743 7623 7579 7517 7505 7422 7310 7237
[31] 7231 7016 6907</code></pre>
</div>
</div>
<p>따라서 선수의 첫 번째 주요 구성 요소 좌표를이 점수와 비교하는 ScatterPlot을 살펴 보겠습니다. 이것은 표시됩니다<a class="quarto-xref" href="#fig-AthleteScorePCA">수치<span>7.25</span></a>. 우리는 두 변수 사이에 강한 상관 관계를 볼 수 있습니다. 우리는 선수 1 위 (실제로 올림픽 데카 슬론 금메달을 획득 한 사람)는 가장 높은 점수를 받았지만 PC1에서 가장 높은 가치는 아닙니다. 왜 그렇게 생각하세요?</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a aria-hidden="true" href="#cb112-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">데이터 =</span> <span class="fu">티블</span>(<span class="at">PC1 =</span>pca.ath<span class="sc">$</span>li [,<span class="dv">1</span>],,<span class="at">점수 =</span>국제 올림픽 경기 대회<span class="sc">$</span>점수,<span class="at">레이블 =</span> <span class="fu">Rownames</span>(운동 선수)),</span>
<span id="cb112-2"><a aria-hidden="true" href="#cb112-2" tabindex="-1"></a>       <span class="at">매핑 =</span> <span class="fu">AES</span>(<span class="at">y =</span>점수,<span class="at">x =</span>PC1))<span class="sc">+</span> </span>
<span id="cb112-3"><a aria-hidden="true" href="#cb112-3" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span>상표))<span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">방법 =</span> <span class="st">"LM"</span>,,,<span class="at">se =</span> <span class="cn">거짓</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-AthleteScorePCA">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AthleteScorePCA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-38" href="07-chap_files/figure-html/fig-AthleteScorePCA-1.png" title="Figure 7.25: Scatterplot between olympic$score and the first principal component. The points are labeled by their order in the data set. We can see a strong correlation. Why is it not a perfectly linear fit?"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-AthleteScorePCA-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AthleteScorePCA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.25 : 사이의 산점도<code>올림픽 $ 점수</code>그리고 첫 번째 주요 구성 요소. 포인트는 데이터 세트에서 순서로 표시됩니다. 우리는 강한 상관 관계를 볼 수 있습니다. 왜 완벽하게 선형 적합하지 않습니까?</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level3 page-columns page-full" data-number="7.7.3" id="how-to-choose-k-the-number-of-dimensions">
<h3 class="anchored" data-anchor-id="how-to-choose-k-the-number-of-dimensions" data-number="7.7.3"><span class="header-section-number">7.7.3</span>선택하는 방법<span class="math inline">\(케이\)</span>, 치수 수?</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-screeploteq">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-screeploteq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-39" href="07-chap_files/figure-html/fig-screeploteq-1.png" title="Figure 7.26: A screeplot showing ‘dangerously’ similar variances. Choosing to cutoff at a hard threshold of 80% of the variance would give unstable PC plots. With so such cutoff, the axes corresponding to the 3D subspace of 3 similar eigenvalues are unstable and cannot be individually interpreted."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-screeploteq-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-screeploteq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.26 : '위험한'비슷한 차이를 보여주는 스크리 플롯. 분산의 80%의 단단한 임계 값에서 컷오프를 선택하면 불안정한 PC 플롯이 제공됩니다. 그러한 컷오프를 사용하면 3 개의 유사한 고유 값의 3D 서브 스페이스에 해당하는 축이 불안정하고 개별적으로 해석 할 수 없습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>PCA의 첫 번째 단계는 새로운 변수의 분산의 스크리 플롯을 만드는 것입니다 (<strong>고유 값</strong>). 이 플롯을보기 전에 얼마나 많은 차원이 필요한지 결정할 수 없습니다. 그 이유는 주요 구성 요소가 잘못 정의 된 상황이 있기 때문입니다. 2 ~ 3 개의 연속 PC가 매우 유사한 분산을 가질 때<a class="quarto-xref" href="#fig-screeploteq">수치<span>7.26</span></a>, 유사한 고유 값 그룹에 해당하는 서브 스페이스가 존재한다. 이 경우 이것은 3D 공간이 생성됩니다.<span class="math inline">\ (u_2, u_3, u_4 \)</span>. 벡터는 개별적으로 의미가 없으며 하중을 해석 할 수 없습니다. 한 관측치에서 약간의 변화가 완전히 다른 세 벡터 세트를 제공 할 수 있기 때문입니다. 이것들은 동일한 3D 공간을 생성하지만 매우 다른 하중을 가질 수 있습니다. 우리는 PC가 불안정하다고 말합니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="7.8" id="pca-as-an-exploratory-tool-using-extra-information">
<h2 class="anchored" data-anchor-id="pca-as-an-exploratory-tool-using-extra-information" data-number="7.8"><span class="header-section-number">7.8</span>탐색 도구로서의 PCA : 추가 정보 사용</h2>
<p>우리는 회귀와 달리 PCA는 모든 변수를 동등하게 취급한다는 것을 알았습니다 (동등한 표준 편차를 갖도록 전처리 된 정도). 그러나 결과를 해석하기 위해 다른 연속 변수 또는 범주 형 요소를 플롯에 매핑 할 수 있습니다. 종종 우리는 샘플에 대한 보완 정보, 예를 들어 당뇨병 데이터의 진단 라벨 또는 T- 세포 유전자 발현 데이터의 세포 유형을 가지고 있습니다.</p>
<p>여기서 우리는 이러한 추가 변수를 사용하여 해석을 알리는 방법을 알 수 있습니다. 소위 소위 저장하기 가장 좋은 곳<em>메타 데이터</em>데이터 객체의 적절한 슬롯에 있습니다 (예 : 생체 전도체<em>요약 경험</em>수업); 숫자 데이터를 포함하는 데이터 프레임의 추가 열에서 두 번째로 최고입니다. 실제로, 그러한 정보는 종종 행렬의 행 이름에 다소 비밀스러운 방식으로 저장됩니다. 아래에서는 후자의 시나리오에 직면해야하며 사용합니다.<code>기판</code>세포 유형을 추출하고 screeplot을 보여주는 체조<a class="quarto-xref" href="#fig-tcellexpr">수치<span>7.27</span></a>그리고 PCA는<a class="quarto-xref" href="#fig-tcelltypes-1">수치<span>7.28</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a aria-hidden="true" href="#cb113-1" tabindex="-1"></a>PCAMSIG3<span class="ot">=</span> <span class="fu">dudi.pca</span>(MSSSSST3TRANSP,<span class="at">중심 =</span> <span class="cn">진실</span>,,,<span class="at">스케일 =</span> <span class="cn">진실</span>,,,</span>
<span id="cb113-2"><a aria-hidden="true" href="#cb113-2" tabindex="-1"></a>                    <span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">4</span>))</span>
<span id="cb113-3"><a aria-hidden="true" href="#cb113-3" tabindex="-1"></a><span class="fu">fviz_screeplot</span>(PCAMSIG3)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-tcellexpr">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tcellexpr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-40" href="07-chap_files/figure-html/fig-tcellexpr-1.png" title="Figure 7.27: T-cell expression PCA screeplot."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-tcellexpr-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tcellexpr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.27 : T- 세포 발현 PCA ScreePlot.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a aria-hidden="true" href="#cb114-1" tabindex="-1"></a>이드<span class="ot">=</span> <span class="fu">Rownames</span>(MSSSSST3TRANSP)</span>
<span id="cb114-2"><a aria-hidden="true" href="#cb114-2" tabindex="-1"></a>Cellypes<span class="ot">=</span> <span class="fu">요인</span>(<span class="fu">기판</span>(IDS,<span class="dv">7</span>,,,<span class="dv">9</span>)))</span>
<span id="cb114-3"><a aria-hidden="true" href="#cb114-3" tabindex="-1"></a>상태<span class="ot">=</span> <span class="fu">요인</span>(<span class="fu">기판</span>(IDS,<span class="dv">1</span>,,,<span class="dv">3</span>)))</span>
<span id="cb114-4"><a aria-hidden="true" href="#cb114-4" tabindex="-1"></a><span class="fu">테이블</span>(세포 유형)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>Cellypes
Eff mem nai 
 10 9 11</code></pre>
</div>
<div class="sourceCode cell-code" data-cap-location="margin" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a aria-hidden="true" href="#cb116-1" tabindex="-1"></a><span class="fu">cbind</span>(PCAMSIG3<span class="sc">$</span>Li,<span class="fu">티블</span>(<span class="at">클러스터 =</span>cellypes,<span class="at">샘플 =</span>ID)))<span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a aria-hidden="true" href="#cb116-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">x =</span>axis1,<span class="at">y =</span>Axis2))<span class="sc">+</span></span>
<span id="cb116-3"><a aria-hidden="true" href="#cb116-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>무리),<span class="at">크기 =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb116-4"><a aria-hidden="true" href="#cb116-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,,,<span class="at">lineType =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb116-5"><a aria-hidden="true" href="#cb116-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,,,<span class="at">lineType =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb116-6"><a aria-hidden="true" href="#cb116-6" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">이름 =</span> <span class="st">"무리"</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-tcelltypes-1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-tcelltypes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-41" href="07-chap_files/figure-html/fig-tcelltypes-1-1.png" title="Figure 7.28: PCA of gene expression for a subset of 156 genes involved in specificities of each of the three separate T-cell types: effector, naïve and memory. Again, we see that the plot is elongated along the the first axis, as that explains much of the variance. Notice that one of the T-cells seems to be mislabeled."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-tcelltypes-1-1.png" width="640"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-tcelltypes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.28 : 세 가지 별도의 T- 세포 유형 각각의 특이성에 관여하는 156 개의 유전자의 서브 세트에 대한 유전자 발현의 PCA : 이펙터, 순진 및 기억. 다시 말하지만, 우리는 플롯이 첫 번째 축을 따라 길어지고 있으며, 이는 분산의 대부분을 설명합니다. T- 세포 중 하나가 잘못 표지 된 것 같습니다.</figcaption>
</figure>
</div>
</div>
</div>
<section class="level3 page-columns page-full" data-number="7.8.1" id="mass-spectroscopy-data-analysis">
<h3 class="anchored" data-anchor-id="mass-spectroscopy-data-analysis" data-number="7.8.1"><span class="header-section-number">7.8.1</span>질량 분석 데이터 분석</h3>
<p>이 데이터는 관련 기능을 열과 함께 및 행으로 샘플로 원하는 행렬을 얻기 전에 섬세한 전처리가 필요합니다. 원시 질량 분광법 판독 값으로 시작하여, 단계는 관련 기능의 피크를 추출하고 여러 샘플에 걸쳐 정렬하고 피크 높이를 추정하는 것을 포함합니다. 우리는 독자를 생체 전도체의 vignette를 언급합니다.<strong><a href="https://bioconductor.org/packages/xcms/">XCMS</a></strong>끔찍한 세부 사항을위한 패키지. 파일에서 생성 된 데이터 행렬을로드합니다.<code>mat1xcms.rdata</code>. 아래 코드의 출력은 그림에 있습니다<a class="quarto-xref" href="#fig-xset3scree"><span>7.29</span></a>그리고<a class="quarto-xref" href="#fig-Stretchedbiplot"><span>7.30</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a aria-hidden="true" href="#cb117-1" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/mat1xcms.rdata"</span>))</span>
<span id="cb117-2"><a aria-hidden="true" href="#cb117-2" tabindex="-1"></a><span class="fu">어둑한</span>(MAT1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 399 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a aria-hidden="true" href="#cb119-1" tabindex="-1"></a>pcamat1<span class="ot">=</span> <span class="fu">dudi.pca</span>(<span class="fu">티</span>(mat1),<span class="at">scannf =</span> <span class="cn">거짓</span>,,,<span class="at">nf =</span> <span class="dv">3</span>))</span>
<span id="cb119-2"><a aria-hidden="true" href="#cb119-2" tabindex="-1"></a><span class="fu">fviz_eig</span>(pcamat1,<span class="at">geom =</span> <span class="st">"술집"</span>,,,<span class="at">bar_width =</span> <span class="fl">0.7</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-xset3scree">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-xset3scree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-42" href="07-chap_files/figure-html/fig-xset3scree-1.png" title="Figure 7.29: Screeplot showing the eigenvalues for the mice data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-xset3scree-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-xset3scree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.29 : 마우스 데이터에 대한 고유 값을 보여주는 screeplot.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a aria-hidden="true" href="#cb120-1" tabindex="-1"></a>DFMAT1<span class="ot">=</span> <span class="fu">cbind</span>(pcamat1<span class="sc">$</span>Li,<span class="fu">티블</span>(</span>
<span id="cb120-2"><a aria-hidden="true" href="#cb120-2" tabindex="-1"></a>    <span class="at">레이블 =</span> <span class="fu">Rownames</span>(pcamat1<span class="sc">$</span>Li),</span>
<span id="cb120-3"><a aria-hidden="true" href="#cb120-3" tabindex="-1"></a>    <span class="at">번호 =</span> <span class="fu">기판</span>(상표,<span class="dv">3</span>,,,<span class="dv">4</span>),)</span>
<span id="cb120-4"><a aria-hidden="true" href="#cb120-4" tabindex="-1"></a>    <span class="at">유형 =</span> <span class="fu">요인</span>(<span class="fu">기판</span>(상표,<span class="dv">1</span>,,,<span class="dv">2</span>))))</span>
<span id="cb120-5"><a aria-hidden="true" href="#cb120-5" tabindex="-1"></a>PCSPLOT<span class="ot">=</span> <span class="fu">ggplot</span>(dfmat1,</span>
<span id="cb120-6"><a aria-hidden="true" href="#cb120-6" tabindex="-1"></a>  <span class="fu">AES</span>(<span class="at">x =</span>axis1,<span class="at">y =</span>axis2,<span class="at">레이블 =</span>상표,<span class="at">그룹 =</span>숫자,<span class="at">색상 =</span>유형))<span class="sc">+</span></span>
<span id="cb120-7"><a aria-hidden="true" href="#cb120-7" tabindex="-1"></a> <span class="fu">geom_text</span>(<span class="at">크기 =</span> <span class="dv">4</span>,,,<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>))<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">크기 =</span> <span class="dv">3</span>))<span class="sc">+</span><span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="sc">-</span><span class="dv">18</span>,,,<span class="dv">19</span>)))</span>
<span id="cb120-8"><a aria-hidden="true" href="#cb120-8" tabindex="-1"></a>PCSPLOT<span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,,,<span class="at">lineType =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb120-9"><a aria-hidden="true" href="#cb120-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,,,<span class="at">lineType =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-Stretchedbiplot">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-Stretchedbiplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-43" href="07-chap_files/figure-html/fig-Stretchedbiplot-1.png" title="Figure 7.30: The first principal plane for the mat1 data. It explains 59% of the variance."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-Stretchedbiplot-1.png" width="720"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-Stretchedbiplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.30 : 첫 번째 주요 평면<code>MAT1</code>데이터. 분산의 59%를 설명합니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-multivariate-Stretchedbiplot">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 7.30</div>
</div>
<div class="callout-body-container callout-body">
<p>보고 있습니다<a class="quarto-xref" href="#fig-Stretchedbiplot">수치<span>7.30</span></a>, 샘플이 평면에 무작위로 배치 된 것처럼 보입니까? 레이블에 의해 설명 된 구조가 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-58" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-58-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-58-contents callout-collapse collapse" id="callout-58">
<div class="callout-body-container callout-body">
<p>이 플롯을 만들면 대답이 더 분명해집니다. 녹아웃은 항상 쌍을 이루는 야생형 샘플보다 낮습니다. 우리는 다음 장에서 감독 된 다변량 방법을 볼 때이 예를 다시 방문 할 것입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a aria-hidden="true" href="#cb121-1" tabindex="-1"></a>PCSPLOT<span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">색상 =</span> <span class="st">"빨간색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="7.8.2" id="biplots-and-scaling">
<h3 class="anchored" data-anchor-id="biplots-and-scaling" data-number="7.8.2"><span class="header-section-number">7.8.2</span>이분기 및 스케일링</h3>
<p>이전 예에서 측정 된 변수의 수는 너무 커서 변수와 샘플의 유용한 동시 플로팅을 가능하게했습니다. 이 예에서 우리는 다른 와인에서 화학적 측정이 만들어지는 간단한 데이터 세트의 PCA 이브 플롯을 플로팅합니다.<code>와인. 클래스</code>변하기 쉬운. 우리는 변수의 2 차원 상관 관계와 열도를 살펴보면 분석을 시작합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a aria-hidden="true" href="#cb122-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"pheatmap"</span>))</span>
<span id="cb122-2"><a aria-hidden="true" href="#cb122-2" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/wine.rdata"</span>))</span>
<span id="cb122-3"><a aria-hidden="true" href="#cb122-3" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/wineclass.rdata"</span>))</span>
<span id="cb122-4"><a aria-hidden="true" href="#cb122-4" tabindex="-1"></a>와인[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>알코올 malicacid ash alcash mg phenols flav
1 14.23 1.71 2.43 15.6 127 2.80 3.06
2 13.20 1.78 2.14 11.2 100 2.65 2.76</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a aria-hidden="true" href="#cb124-1" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">코</span>(와인),<span class="at">treeheight_row =</span> <span class="fl">0.2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-WineHeatplot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-WineHeatplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-44" href="07-chap_files/figure-html/fig-WineHeatplot-1.png" title="Figure 7.31: The difference between 1 and the correlation can be used as a distance between variables and is used to make a heatmap of the associations between the variables."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-WineHeatplot-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-WineHeatplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.31 : 1과 상관 관계의 차이는 변수 사이의 거리로 사용될 수 있으며 변수 간의 연관의 열도를 만드는 데 사용됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>에이<strong>이브 플롯</strong>관측의 공간과 변수 공간의 동시 표현입니다. PCA Biplot과 같은 경우<a class="quarto-xref" href="#fig-WineBiplot2">수치<span>7.32</span></a>화살표는 처음 두 개의 새로운 축에 의해 정의 된 평면에 투영 될 때 이전 변수의 방향을 나타냅니다. 여기서 관찰은 단지 색상의 점입니다. 색상은 어떤 유형의 와인을 플로팅하는지에 따라 선택되었습니다. 우리는 샘플 포인트와 관련하여 변수의 방향을 해석 할 수 있습니다. 예를 들어 Blue Points는 Barbera 그룹에서 나오고 다른 와인보다 더 높은 말산 함량을 보여줍니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a aria-hidden="true" href="#cb125-1" tabindex="-1"></a>Winepcad<span class="ot">=</span> <span class="fu">dudi.pca</span>(와인,<span class="at">scannf =</span><span class="cn">거짓</span>))</span>
<span id="cb125-2"><a aria-hidden="true" href="#cb125-2" tabindex="-1"></a><span class="fu">테이블</span>(Wine.class)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>와인. 클래스
    Barolo Grignolino Barbera 
        59 71 48</code></pre>
</div>
<div class="sourceCode cell-code" data-cap-location="margin" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a aria-hidden="true" href="#cb127-1" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(Winepcad,<span class="at">geom =</span> <span class="st">"가리키다"</span>,,,<span class="at">드레싱 =</span>Wine.class,</span>
<span id="cb127-2"><a aria-hidden="true" href="#cb127-2" tabindex="-1"></a>   <span class="at">col.var =</span> <span class="st">"제비꽃"</span>,,,<span class="at">addEllipses =</span> <span class="cn">진실</span>,,,<span class="at">Ellipse.level =</span> <span class="fl">0.69</span>))<span class="sc">+</span></span>
<span id="cb127-3"><a aria-hidden="true" href="#cb127-3" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-WineBiplot2">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-WineBiplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-45" href="07-chap_files/figure-html/fig-WineBiplot2-1.png" title="Figure 7.32: PCA biplot including ellipses for the three types of wine: barolo, grignolino and barbera. For each ellipsis, the axis lengths are given by one standard deviation. Small angles between the vectors Phenols, Flav and Proa indicate that they are strongly correlated, whereas Hue and Alcohol are uncorrelated."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-WineBiplot2-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-WineBiplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.32 : 세 가지 유형의 와인에 대한 타원을 포함한 PCA Biplot : Barolo, Grignolino 및 Barbera. 각각의 타원에 대해 축 길이는 하나의 표준 편차에 의해 주어집니다. 벡터 사이의 작은 각도<code>페놀</code>,,,<code>Flav</code>그리고<code>절하다</code>그들이 강하게 상관 관계가 있음을 나타냅니다<code>색조</code>그리고<code>술</code>상관 관계가 없습니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>다변량 플롯의 해석을 위해서는 가능한 많은 이용 가능한 정보를 사용해야합니다. 여기서 우리는 와인의 주요 차이점을 이해하기 위해 샘플과 그 그룹과 변수를 사용했습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="7.8.3" id="an-example-of-weighted-pca">
<h3 class="anchored" data-anchor-id="an-example-of-weighted-pca" data-number="7.8.3"><span class="header-section-number">7.8.3</span>가중 PCA의 예</h3>
<p>때때로 우리는 다른 그룹이나 관찰 사이의 변동성을보고 싶지만 가중치를 가중시키기를 원합니다. 예를 들어 그룹의 크기가 매우 다른 경우 경우에 해당됩니다. 우리가 이미 본 Hiiragi 데이터를 다시 검사합시다<a class="quarto-xref" href="03-chap.html"><span>3 장</span></a>. 아래 코드에서는 전체 분산이 가장 높은 WildType (WT) 샘플과 상위 100 가지 기능을 선택합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a aria-hidden="true" href="#cb128-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"엑스"</span>,,,<span class="at">패키지 =</span> <span class="st">"Hiiragi2013"</span>))</span>
<span id="cb128-2"><a aria-hidden="true" href="#cb128-2" tabindex="-1"></a>XWT<span class="ot">=</span>x [, x<span class="sc">$</span>유전자형<span class="sc">==</span> <span class="st">"wt"</span>]]</span>
<span id="cb128-3"><a aria-hidden="true" href="#cb128-3" tabindex="-1"></a>셀<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">Rowvars</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(xwt)),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]]</span>
<span id="cb128-4"><a aria-hidden="true" href="#cb128-4" tabindex="-1"></a>XWT<span class="ot">=</span>XWT [Cell,]</span>
<span id="cb128-5"><a aria-hidden="true" href="#cb128-5" tabindex="-1"></a>꼬리표<span class="ot">=</span> <span class="fu">테이블</span>(XWT<span class="sc">$</span>샘플 그룹)</span>
<span id="cb128-6"><a aria-hidden="true" href="#cb128-6" tabindex="-1"></a>꼬리표</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E3.25 E3.5 (EPI) E3) E3) E4.5 (PPI) E4.5. 
        36 11 11 4 4</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a aria-hidden="true" href="#cb130-1" tabindex="-1"></a>XWT<span class="sc">$</span>무게<span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">as.numeric</span>(탭 [XWT<span class="sc">$</span>샘플 그룹])</span>
<span id="cb130-2"><a aria-hidden="true" href="#cb130-2" tabindex="-1"></a>pcamouse<span class="ot">=</span> <span class="fu">dudi.pca</span>(<span class="fu">as.data.frame</span>(<span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(xwt))),</span>
<span id="cb130-3"><a aria-hidden="true" href="#cb130-3" tabindex="-1"></a>  <span class="at">row.w =</span>XWT<span class="sc">$</span>무게,</span>
<span id="cb130-4"><a aria-hidden="true" href="#cb130-4" tabindex="-1"></a>  <span class="at">중심 =</span> <span class="cn">진실</span>,,,<span class="at">스케일 =</span> <span class="cn">진실</span>,,,<span class="at">nf =</span> <span class="dv">2</span>,,,<span class="at">scannf =</span> <span class="cn">거짓</span>))</span>
<span id="cb130-5"><a aria-hidden="true" href="#cb130-5" tabindex="-1"></a><span class="fu">fviz_eig</span>(pcamouse)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"" "</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-resPCADscree">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resPCADscree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-46" href="07-chap_files/figure-html/fig-resPCADscree-1.png" title="Figure 7.33: Screeplot from the weighted PCA of the Hiiragi data. The drop after the second eigenvalue suggests that a two-dimensional PCA is appropriate."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-resPCADscree-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resPCADscree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.33 : Hiiragi 데이터의 가중 PCA의 ScreePlot. 두 번째 고유 값 후의 하락은 2 차원 PCA가 적절하다는 것을 시사합니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a aria-hidden="true" href="#cb131-1" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pcamouse,<span class="at">geom =</span> <span class="st">"가리키다"</span>,,,<span class="at">col.ind =</span>XWT<span class="sc">$</span>샘플 그룹)<span class="sc">+</span></span>
<span id="cb131-2"><a aria-hidden="true" href="#cb131-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는<code>꼬리표</code>그룹은 다소 불평등하게 나타납니다. 이를 설명하기 위해, 우리는 그룹 크기의 역수로 각 샘플을 다시 we습니다. 기능<code>dudi.pca</code>에서<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>패키지에는 a가 있습니다<code>row.w</code>우리가 무게에 들어갈 수있는 논쟁. 코드의 출력은 그림에 있습니다<a class="quarto-xref" href="#fig-resPCADscree"><span>7.33</span></a>그리고<a class="quarto-xref" href="#fig-resPCADplot"><span>7.34</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-resPCADplot">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-resPCADplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-47" href="07-chap_files/figure-html/fig-resPCADplot-1.png" title="Figure 7.34: Output from weighted PCA on the Hiiragi data. The samples are colored according to their groups."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="07-chap_files/figure-html/fig-resPCADplot-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-resPCADplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.34 : Hiiragi 데이터의 가중 PCA의 출력. 샘플은 그룹에 따라 채색됩니다.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section class="level2" data-number="7.9" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="7.9"><span class="header-section-number">7.9</span>이 장의 요약</h2>
<p><strong>전처리 매트릭스</strong>다변량 데이터 분석에는 "의식적인"전처리가 필요합니다. 모든 수단, 분산 및 1 차원 히스토그램을 상담 한 후 우리는 데이터를 다시 제정하고 최근에 데이터를 보는 방법을 보았습니다.</p>
<p><strong>새로운 변수에 투사</strong>너무 많은 정보를 잃지 않고 높은 차원 데이터의 차원 (2D 평면 및 3D가 가장 자주 사용되는 3D)으로 돌출되는 방법을 보았습니다. PCA는 원래 (오래된)의 선형 조합 인 새로운 "보다 유익한"변수를 검색합니다.</p>
<p><strong>매트릭스 분해</strong>PCA는 행렬의 분해를 찾는 것을 기반으로합니다<span class="math inline">\(엑스\)</span>SVD라고합니다. 이 분해는 더 낮은 순위 근사를 제공하며 Eigendecomposition과 동일합니다.<span class="math inline">\ (x^tx \)</span>. 단일 값의 제곱은 고유 값과 새로운 변수의 분산과 같습니다. 우리는 데이터에서 신호를 재현하는 데 필요한 축의 수를 결정하기 전에 이러한 값을 체계적으로 플로팅했습니다.</p>
<p>매우 가까운 두 개의 고유 값은 매우 불안정한 점수 또는 PC 점수를 일으킬 수 있습니다. 고유 값의 방송구를 보고이 근접 고유 값에 해당하는 축을 분리하지 않아야합니다. 이를 위해서는 여러 R 패키지로 제공되는 대화식 3 차원 투영을 사용해야 할 수 있습니다.</p>
<p><strong>이브 플롯 표현</strong>관찰 공간은 당연히 a입니다<span class="math inline">\(피\)</span>-차원 공간 (the<span class="math inline">\(피\)</span>원래 변수는 좌표를 제공합니다). 변수의 공간은입니다<span class="math inline">\(N\)</span>-차원. 우리가 연구 한 두 분해 (단일 값 / 고유 값 및 단수 벡터 / 고유 벡터)는이 두 공간 모두에 대한 새로운 좌표를 제공하며 때로는 하나를 다른 공간의 듀얼이라고 부릅니다. 우리는 관측치와 변수의 투영을 동일한 고유 벡터에 플로팅 할 수 있습니다. 이는 PCA 출력을 해석하는 데 유용 할 수있는 이브 플롯을 제공합니다.</p>
<p><strong>다른 그룹 변수를 투사합니다</strong>PCA의 해석은 관측치에 대한 중복 또는 연속 데이터에 의해 촉진 될 수 있습니다.</p>
</section>
<section class="level2" data-number="7.10" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="7.10"><span class="header-section-number">7.10</span>추가 독서</h2>
<p>단일 가치 분해에 대한 이해를 심화시키는 가장 좋은 방법은 7 장을 읽는 것입니다.<span class="citation" data-cites="Strang:09">겨울 (<a href="16-chap.html#ref-Strang:09" role="doc-biblioref">2009 년</a>))</span>. 전체 책은 행렬 순위의 의미와 행 공간과 열 공간 사이의 이중성을 이해하는 데 필요한 선형 대수의 기초를 설정합니다.<span class="citation" data-cites="frenchway">(<a href="16-chap.html#ref-frenchway" role="doc-biblioref">홈즈 2006</a>))</span>.</p>
<p>PCA 및 관련 방법의 주제에 대해 완전한 교과서가 작성되었습니다.<span class="citation" data-cites="Mardia">Mardia, Kent 및 Bibby (<a href="16-chap.html#ref-Mardia" role="doc-biblioref">1979</a>))</span>선형 대수 및 행렬과 함께 모든 다변량 방법을 고전적인 방식으로 포괄하는 표준 텍스트입니다. 데이터가 다변량 정규 분포에서 나오는 파라 메트릭 가정을 만들어<span class="citation" data-cites="Mardia">Mardia, Kent 및 Bibby (<a href="16-chap.html#ref-Mardia" role="doc-biblioref">1979</a>))</span>또한 구성 요소의 수와 제한 속성에 대한 추론 테스트를 제공합니다.<span class="citation" data-cites="Jolliffe">Jolliffe (<a href="16-chap.html#ref-Jolliffe" role="doc-biblioref">2002</a>))</span>광범위한 사례와 함께 PCA와 관련된 모든 것에 대한 책장적인 대우입니다.</p>
<p>보충 정보를 관찰 및 변수를 위해 가중치에 통합 할 수 있습니다. 이것은 1970 년대 프랑스 데이터 과학자들이 소개했습니다.<span class="citation" data-cites="frenchway">홈즈 (Holmes) (<a href="16-chap.html#ref-frenchway" role="doc-biblioref">2006</a>))</span>검토 및<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>추가 예를 보려면.</p>
<p>PCA의 해석 및 안정성 개선은 선형 조합에 나타나는 0이 아닌 계수의 수를 최소화하는 페널티를 추가하여 얻을 수 있습니다.<span class="citation" data-cites="Zou2006">Will, Hastie 및 Tibshirani (<a href="16-chap.html#ref-Zou2006" role="doc-biblioref">2006</a>))</span>그리고<span class="citation" data-cites="Witten2009">Witten, Tibshirani 및 Hastie (<a href="16-chap.html#ref-Witten2009" role="doc-biblioref">2009 년</a>))</span>스파 스 버전의 주요 구성 요소 분석 및 패키지를 개발했습니다.<strong><a href="https://cran.r-project.org/web/packages/elasticnet/">탄성 넷</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/PMA/">PMA</a></strong>R에서 구현을 제공</p>
</section>
<section class="level2" data-number="7.11" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="7.11"><span class="header-section-number">7.11</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-multivariate-svdstepbystep">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 7.1</div>
</div>
<div class="callout-body-container callout-body">
<p>섹션 1, 2 및 3을 읽어 SVD에 대한 자료를 수정하십시오.<a href="http://en.wikipedia.org/wiki/Singular_value_decomposition">SVD에 관한 Wikipedia 기사</a>. 또한 섹션 1, 2 및 2.1을 읽음으로써 관련 고유 값 분해에 대해 읽는 것이 좋습니다.<a href="http://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">매트릭스의 eigendecomposition에 관한 Wikipedia 기사</a>. 우리는 우리가 a를 분해 할 수 있다는 것을 알고 있습니다<span class="math inline">\(N\)</span>바이<span class="math inline">\(피\)</span>열 순위 1 매트릭스<span class="math inline">\(엑스\)</span>처럼:</p>
<p><span class="math display">\ [
** x ** =
\ 시작 {pmatrix}
x_ {11} &amp; x_ {12} &amp; ... &amp; x_ {1p} \\
x_ {21} &amp; x_ {22} &amp; ... &amp; x_ {2p} \\
\ vdots &amp; \ vdots &amp; \ vdots &amp; \ vdots \\
x_ {n1} &amp; x_ {n2} &amp; ... &amp; x_ {np}
\ end {pmatrix}
=
\ 시작 {pmatrix}
u_ {11} \\ u_ {21} \\ \ vdots \\ u_ {n1} \\
\ end {pmatrix}
\타임스
\ 시작 {pmatrix}
v_ {11} &amp; v_ {21} &amp; \ cdots &amp; v_ {p1}
\ end {pmatrix}
\]</span></p>
<ol type="a">
<li><p>만약에<span class="math inline">\(엑스\)</span>행이없고 열이 모두 없어서 모든 0이 없으므로이 분해가 독특합니까?<br/>
</p></li>
<li><p>순위 1 매트릭스를 생성하십시오. 2 ~ 30의 값을 2 단위로, 값 3, 6, 9, 12 값의 길이 4의 벡터 인 길이 15의 벡터를 취한 다음 외부 제품을 가져갑니다.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a aria-hidden="true" href="#cb132-1" tabindex="-1"></a>유<span class="ot">=</span> <span class="fu">서열</span>(<span class="dv">2</span>,,,<span class="dv">30</span>,,,<span class="at">by =</span> <span class="dv">2</span>))</span>
<span id="cb132-2"><a aria-hidden="true" href="#cb132-2" tabindex="-1"></a>다섯<span class="ot">=</span> <span class="fu">서열</span>(<span class="dv">3</span>,,,<span class="dv">12</span>,,,<span class="at">by =</span> <span class="dv">3</span>))</span>
<span id="cb132-3"><a aria-hidden="true" href="#cb132-3" tabindex="-1"></a>x1<span class="ot">=</span>유<span class="sc">%*%</span> <span class="fu">티</span>(다섯)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 왜 가져 가야합니까?<code>TV)</code>?</p>
<ol start="3" type="a">
<li>이제 우리는 우리가 호출하는 행렬 형식으로 약간의 노이즈를 추가합니다.<code>문제</code>그래서 우리는“대략 순위 1”매트릭스를 가지고 있습니다.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a aria-hidden="true" href="#cb133-1" tabindex="-1"></a>문제<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">rnorm</span>(<span class="dv">60</span>,,,<span class="dv">1</span>),)<span class="at">nrow =</span><span class="dv">15</span>,,,<span class="at">NCOL =</span><span class="dv">4</span>))</span>
<span id="cb133-2"><a aria-hidden="true" href="#cb133-2" tabindex="-1"></a>엑스<span class="ot">=</span>x1<span class="sc">+</span>문제</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>시각화<span class="math inline">\(엑스\)</span>사용<code>ggplot</code>.</p>
<ol start="4" type="a">
<li>Rank 2 매트릭스로 동일한 분석을 다시 실행하십시오.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-60-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-60-contents callout-collapse collapse" id="callout-60">
<div class="callout-body-container callout-body">
<p>주목하십시오<code>x1</code>또한 계산할 수도 있습니다</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a aria-hidden="true" href="#cb134-1" tabindex="-1"></a><span class="fu">밖의</span>(u, v)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a aria-hidden="true" href="#cb135-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">데이터 =</span><span class="fu">데이터. 프레임</span>(엑스),<span class="fu">AES</span>(<span class="at">x =</span>X1,<span class="at">y =</span>X2,<span class="at">col =</span>X3,<span class="at">크기 =</span>x4))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 우리는 데이터가 4 차원 모두에서 선형으로 보인다는 것을 알 수 있습니다. 이것이 순위를 의미한다는 의미입니다. 이제 Rank 2 매트릭스를 고려해 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a aria-hidden="true" href="#cb136-1" tabindex="-1"></a>N<span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb136-2"><a aria-hidden="true" href="#cb136-2" tabindex="-1"></a>피<span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb136-3"><a aria-hidden="true" href="#cb136-3" tabindex="-1"></a>Y2<span class="ot">=</span> <span class="fu">밖의</span>(<span class="fu">rnorm</span>(N),<span class="fu">rnorm</span>(피))<span class="sc">+</span> <span class="fu">밖의</span>(<span class="fu">rnorm</span>(N),<span class="fu">rnorm</span>(피))</span>
<span id="cb136-4"><a aria-hidden="true" href="#cb136-4" tabindex="-1"></a><span class="fu">머리</span>(Y2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3] [, 4]
[1,] -0.44143871 2.3213197 0.433215525 -1.35523790
[2,] 0.79620920 -1.0748037 1.217052906 -13096295
[3,] 0.16787281 0.2259296 0.547203332 -0.75836031
[4,] 0.87269426 -1.9208649 0.856966180 -0.38621340
[5,] 0.03751521 -0.1480678 -0.005217966 0.05864122
[6,] 0.50195482 -2.0409896 -0.108241027 0.85336630</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a aria-hidden="true" href="#cb138-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">데이터 =</span><span class="fu">데이터. 프레임</span>(Y2),<span class="fu">AES</span>(<span class="at">x =</span>X1,<span class="at">y =</span>X2,<span class="at">col =</span>X3,<span class="at">크기 =</span>x4))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 데이터를 처음 두 좌표에 투사하면 (기본적으로<code>x1</code>그리고<code>x2</code>매트릭스를 r의 데이터 프레임으로 변환하면 데이터는 두 차원에 따라 다릅니다. 따라서 다음 단계는 두 가지 이상의 차원이 있는지 결정하는 것입니다. 상단 오른쪽 지점은 당신에게 가장 가까운 지점이며 (그들은 가장 크다) 줄거리에서 내려 가면서 그 지점은 더 멀리 떨어져 있습니다. 왼쪽에는 가장 푸른 지점이 있으며 오른쪽으로 움직일 때 더 어두워지는 것 같습니다. 아마 알 수 있듯이, "높은 차원"만이 4를 의미하는 경우에도 더 높은 차원에서 저 차원 공간을 시각적으로 발견하는 것은 매우 어렵습니다! 이것이 우리가 단일 가치 분해에 의존하는 이유 중 하나입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a aria-hidden="true" href="#cb139-1" tabindex="-1"></a><span class="fu">SVD</span>(Y2)<span class="sc">$</span>디<span class="co"># 0이 아닌 고유 값 2 개</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.637465E+01 1.266346E+01 3.144564E-15 1.023131E-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a aria-hidden="true" href="#cb141-1" tabindex="-1"></a>와이<span class="ot">=</span>Y2<span class="sc">+</span> <span class="fu">행렬</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span>피,<span class="at">SD =</span><span class="fl">0.01</span>), n, p)<span class="co"># Y2에 약간의 소음을 추가하십시오</span></span>
<span id="cb141-2"><a aria-hidden="true" href="#cb141-2" tabindex="-1"></a><span class="fu">SVD</span>(와이)<span class="sc">$</span>디<span class="co"># 4 개의 0이 아닌 고유 값 (그러나 2 개의 큰 것만)</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26.39673712 12.68547439 0.10735103 0.09104741</code></pre>
</div>
</div>
<p>여기에는 0이 아닌 2 차원과 약 0의 2 차원이 있습니다 ( "Y2"의 경우 컴퓨터 공차의 제곱근 내에 있습니다).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-multivariate-elongated">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 7.2</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>표시된 것과 같은 고도로 상관 관계가있는 이변 량 데이터의 첫 번째 매트릭스를 만듭니다.<a class="quarto-xref" href="#fig-binormalpc">수치<span>7.35</span></a>.<br/>힌트 : 기능을 사용하십시오<code>mvrnorm</code>.</li>
</ol>
<p>단일 값을 보면서 매트릭스의 순위를 확인하십시오.</p>
<ol start="2" type="a">
<li>PCA를 수행하고 회전 된 주요 구성 요소 축을 표시하십시오.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-62" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-62-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-62-contents callout-collapse collapse" id="callout-62">
<div class="callout-body-container callout-body">
<ol type="a">
<li>우리는 다음을 사용하여 상관 관계 이변 량 정상 데이터를 생성합니다.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a aria-hidden="true" href="#cb143-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"대량의"</span>))</span>
<span id="cb143-2"><a aria-hidden="true" href="#cb143-2" tabindex="-1"></a>MU1<span class="ot">=</span> <span class="dv">1</span>; MU2<span class="ot">=</span> <span class="dv">2</span>; S1<span class="ot">=</span><span class="fl">2.5</span>; S2<span class="ot">=</span><span class="fl">0.8</span>; Rho<span class="ot">=</span><span class="fl">0.9</span>;</span>
<span id="cb143-3"><a aria-hidden="true" href="#cb143-3" tabindex="-1"></a>시그마<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">기음</span>(S1<span class="sc">^</span><span class="dv">2</span>, S1<span class="sc">*</span>S2<span class="sc">*</span>Rho, S1<span class="sc">*</span>S2<span class="sc">*</span>Rho, S2<span class="sc">^</span><span class="dv">2</span>),)<span class="dv">2</span>))</span>
<span id="cb143-4"><a aria-hidden="true" href="#cb143-4" tabindex="-1"></a>sim2d<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="fu">mvrnorm</span>(<span class="dv">50</span>,,,<span class="at">in =</span> <span class="fu">기음</span>(MU1, MU2),<span class="at">시그마 =</span>시그마))</span>
<span id="cb143-5"><a aria-hidden="true" href="#cb143-5" tabindex="-1"></a><span class="fu">SVD</span>(<span class="fu">규모</span>(sim2d))<span class="sc">$</span>디</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.647686 2.218592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a aria-hidden="true" href="#cb145-1" tabindex="-1"></a><span class="fu">SVD</span>(<span class="fu">규모</span>(sim2d))<span class="sc">$</span>다섯[,<span class="dv">1</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7071068 0.7071068</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>우리는 사용합니다<code>prcomp</code>PCA를 수행하고 점수는 원하는 회전을 제공합니다.</li>
</ol>
<div class="cell" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a aria-hidden="true" href="#cb147-1" tabindex="-1"></a>respc<span class="ot">=</span> <span class="fu">왕자</span>(sim2d)</span>
<span id="cb147-2"><a aria-hidden="true" href="#cb147-2" tabindex="-1"></a>DFPC<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="at">PC1 =</span>respc<span class="sc">$</span>점수 [,<span class="dv">1</span>],,</span>
<span id="cb147-3"><a aria-hidden="true" href="#cb147-3" tabindex="-1"></a>                   <span class="at">PC2 =</span>respc<span class="sc">$</span>점수 [,<span class="dv">2</span>])))</span>
<span id="cb147-4"><a aria-hidden="true" href="#cb147-4" tabindex="-1"></a></span>
<span id="cb147-5"><a aria-hidden="true" href="#cb147-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">데이터. 프레임</span>(sim2d),<span class="fu">AES</span>(<span class="at">x =</span>X1,<span class="at">y =</span>x2))<span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb147-6"><a aria-hidden="true" href="#cb147-6" tabindex="-1"></a><span class="fu">ggplot</span>(DFPC,<span class="fu">AES</span>(<span class="at">x =</span>PC1,<span class="at">y =</span>PC2))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>(<span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-binormalpc">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-binormalpc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-binormalpc" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-binormalpc-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-binormalpc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-binormalpc" href="07-chap_files/figure-html/fig-binormalpc-1.png" title="Figure 7.35 (a): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-binormalpc" src="07-chap_files/figure-html/fig-binormalpc-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-binormalpc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-binormalpc" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-binormalpc-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-binormalpc-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-binormalpc" href="07-chap_files/figure-html/fig-binormalpc-2.png" title="Figure 7.35 (b): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-binormalpc" src="07-chap_files/figure-html/fig-binormalpc-2.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-binormalpc-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binormalpc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 7.35 : ScatterPlot (a)에 표시된 원래 데이터와 주요 구성 요소 회전 (b)을 사용하여 얻은 플롯.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-multivariate-coordfixed">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 7.3</div>
</div>
<div class="callout-body-container callout-body">
<p>파트 (a) in<a class="quarto-xref" href="#fig-binormalpc">수치<span>7.35</span></a>매우 길쭉한 음모 영역을 보여줍니다.<br/>사용하지 않으면 어떻게됩니까?<code>coord_fixed ()</code>옵션과 사각형 플로팅 영역이 있습니까? 이것이 왜 오도 될 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-multivariate-innerworkingPCA">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 7.4</div>
</div>
<div class="callout-body-container callout-body">
<p>Hiiragi 데이터를 다시 방문하고 가중치 및 비가 중 접근법을 비교해 봅시다.</p>
<ol type="a">
<li><p>비가 중 Hiiragi 데이터에 대한 상관 관계 원을 만드십시오<code>XWT</code>. 첫 번째 주요 평면에서 가장 좋은 예측이있는 유전자는 무엇입니까 (최상의 근사치)?</p></li>
<li><p>첫 번째 평면에서 대부분의 분산을 설명하는 극한의 유전자 변수의 레이블을 보여주는 이브 플롯을 만드십시오. 샘플 포인트를 추가하십시오.</p></li>
</ol>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Abbott:1884" role="listitem">애보트, 에드윈 A. 1884.<em>플랫 랜드 : 많은 차원의 로맨스</em>. OUP 옥스포드.</div>
<div class="csl-entry" id="ref-Flury" role="listitem">플라이, 버나드 1997.<em>다변량 통계의 첫 번째 과정</em>. 뛰는 것.</div>
<div class="csl-entry" id="ref-frenchway" role="listitem">홈즈, 수잔 2006.<span>“다변량 분석 :<span class="nocase">프랑스 방식</span>.”</span>~ 안에<em>확률 및 통계 : David a를 기리는 에세이. 자유민</em>, D. Nolan 및 T. P. Speed에 의해 편집. vol. 56. IMS 강의 노트 - 노조 시리즈. Beachwood, OH : IMS.<a href="http://www.imstat.org/publications/lecnotes.htm">http://www.imstat.org/publications/lecnotes.htm</a>.
</div>
<div class="csl-entry" id="ref-holmes2005memory" role="listitem">Holmes, Susan, Michael He, Tong Xu 및 Peter P Lee. 2005.<span>"메모리 T 세포는 순진하고 이펙터 사이의 유전자 발현 패턴을 가지고있다."</span> <em>PNA</em>102 (15) : 5519–23.</div>
<div class="csl-entry" id="ref-Hotelling:1933ki" role="listitem">Hotelling, Harold. 1933.<span>"통계적 변수의 복잡한 복합체를 주요 구성 요소로 분석합니다."</span> <em>교육 심리학 저널</em>24 (6) : 417–41.</div>
<div class="csl-entry" id="ref-Jolicoeur1960" role="listitem">Jolicoeur, Pierre 및 James E Mosimann. 1960.<span>"페인트 거북의 크기와 모양 변화. 주요 구성 요소 분석."</span> <em>성장</em>24 : 339–54.</div>
<div class="csl-entry" id="ref-Jolliffe" role="listitem">Jolliffe, Ian. 2002.<em>주요 구성 요소 분석</em>. 와일리 온라인 도서관.</div>
<div class="csl-entry" id="ref-Mardia" role="listitem">Mardia, Kanti, John T Kent 및 John M Bibby. 1979.<em>다중 해수 분석</em>. 뉴욕 : Academic Press.</div>
<div class="csl-entry" id="ref-Pearson1901" role="listitem">피어슨, 칼. 1901.<span>"<span>. 영형</span>우주의 지점 시스템에 가장 가까운 N 라인과 평면.”</span> <em>런던, 에든버러 및 더블린 철학 잡지 및 Journal of Science</em>2 (11) : 559–72.</div>
<div class="csl-entry" id="ref-Strang:09" role="listitem">길, 길버트. 2009 년.<em>소개<span>엘</span>inear<span>에이</span>lgebra</em>. 네번째. Wellesley-Cambridge Press.</div>
<div class="csl-entry" id="ref-Witten2009" role="listitem">Witten, Daniela M, Robert Tibshirani 및 Trevor Hastie. 2009 년.<span>"심각한 원칙적 구성 요소와 표준 상관 관계 분석에 대한 응용 프로그램을 갖춘 처벌 된 매트릭스 분해."</span> <em>생물 통계학</em>, KXP008.</div>
<div class="csl-entry" id="ref-Zou2006" role="listitem">Hui, Trevor Hastie 및 Robert Tibshirani. 2006.<span>"스파 스 주요 구성 요소 분석."</span> <em>계산 및 그래픽 통계 저널</em>15 (2) : 265–86.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
