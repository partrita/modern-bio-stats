<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>8  High-Throughput Count Data &amp; Generalized Linear Models – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="8  High-Throughput Count Data &amp; Generalized Linear Models – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/08-chap_files/figure-html/fig-countdata-MA-1.png" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="720" property="og:image:height"/>
<meta content="720" property="og:image:width"/>
<meta content="8  High-Throughput Count Data &amp; Generalized Linear Models – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/08-chap_files/figure-html/fig-countdata-MA-1.png" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<meta content="720" name="twitter:image-height"/>
<meta content="720" name="twitter:image-width"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-of-this-chapter" href="#goals-of-this-chapter" id="toc-goals-of-this-chapter"><span class="header-section-number">8.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#some-core-concepts" href="#some-core-concepts" id="toc-some-core-concepts"><span class="header-section-number">8.2</span>일부 핵심 개념</a></li>
<li><a class="nav-link" data-scroll-target="#sec-countdata-counttable" href="#sec-countdata-counttable" id="toc-sec-countdata-counttable"><span class="header-section-number">8.3</span>데이터 계산</a></li>
<li><a class="nav-link" data-scroll-target="#modeling-count-data" href="#modeling-count-data" id="toc-modeling-count-data"><span class="header-section-number">8.4</span>모델링 카운트 데이터</a></li>
<li><a class="nav-link" data-scroll-target="#sec-countdata-debasic" href="#sec-countdata-debasic" id="toc-sec-countdata-debasic"><span class="header-section-number">8.5</span>기본 분석</a></li>
<li><a class="nav-link" data-scroll-target="#sec-countdata-critique" href="#sec-countdata-critique" id="toc-sec-countdata-critique"><span class="header-section-number">8.6</span>기본 선택 및 가능한 수정에 대한 비판</a></li>
<li><a class="nav-link" data-scroll-target="#sec-countdata-multifactor" href="#sec-countdata-multifactor" id="toc-sec-countdata-multifactor"><span class="header-section-number">8.7</span>다중 인자 디자인 및 선형 모델</a></li>
<li><a class="nav-link" data-scroll-target="#sec\:glm" href="#sec:glm" id="toc-sec:glm"><span class="header-section-number">8.8</span>일반화 된 선형 모델</a></li>
<li><a class="nav-link" data-scroll-target="#sec-countdata-pasillatwofac" href="#sec-countdata-pasillatwofac" id="toc-sec-countdata-pasillatwofac"><span class="header-section-number">8.9</span>파실라 데이터의 2 요인 분석</a></li>
<li><a class="nav-link" data-scroll-target="#further-statistical-concepts" href="#further-statistical-concepts" id="toc-further-statistical-concepts"><span class="header-section-number">8.10</span>추가 통계 개념</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">8.11</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">8.12</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">8.13</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-countdata"><span class="chapter-number">8</span>  <span class="chapter-title">고 처리량 수 데이터 및 일반화 된 선형 모델</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/xkcd-1725-linear_regression_2x.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/xkcd-1725-linear_regression_2x.png"/></a></p>
</figure>
</div>
</div></div></div>
<p>생명 공학의 많은 측정 장치는 분자의 대규모 병렬 샘플링 및 계수를 기반으로합니다. 한 가지 예는 고 처리량 DNA 시퀀싱입니다. 응용 프로그램은 두 가지 주요 데이터 출력 클래스의 데이터 출력으로 크게 떨어집니다. 첫 번째 경우 관심의 출력은 시퀀스 자체, 아마도 이전에 보이는 다른 서열과의 다형성 또는 차이 일 것입니다. 두 번째 경우, 서열 자체는 다소 잘 이해되지 않았으며 (예 : 잘 조립되고 주석이 달린 게놈이 있음), 우리의 관심은 샘플에 얼마나 풍부한 다른 서열 영역이 있는지에 대한 관심이 있습니다.</p>
<p>예를 들어,<strong>RNA-seq</strong> <span class="citation" data-cites="OzsolakMilos">(<a href="16-chap.html#ref-OzsolakMilos" role="doc-biblioref">Ozsolak 및 Milos 2011</a>))</span>, 우리는 세포 집단 또는 조직에서 발견 된 RNA 분자를 서열시킨다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="imgs/devil.png" title="Strictly speaking, we don’t sequence the RNA but the complementary DNA (cDNA) obtained from reverse transcription. The pool of all RNA might be reduced to a subset of interest (e.,g., messenger RNA) by biochemical means, such as poly-A selection or ribosomal RNA depletion. Sensitive variants of RNA-Seq exist that enable assaying single cells, and large numbers of them."><img alt="Strictly speaking, we don’t sequence the RNA but the complementary DNA (cDNA) obtained from reverse transcription. The pool of all RNA might be reduced to a subset of interest (e.,g., messenger RNA) by biochemical means, such as poly-A selection or ribosomal RNA depletion. Sensitive variants of RNA-Seq exist that enable assaying single cells, and large numbers of them." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>엄밀히 말하면, 우리는 RNA를 서열하지 않고 역전사로부터 얻은 상보적인 DNA (cDNA)를 서열합니다. 모든 RNA의 풀은 폴리 -A 선택 또는 리보솜 RNA 고갈과 같은 생화학 적 수단에 의해 관심의 서브 세트 (예 : G., Messenger RNA)로 감소 될 수있다. RNA-Seq의 민감한 변이체는 단일 세포를 분석하고 많은 수를 가능하게하는 존재한다.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<strong>Chip-seq</strong>, 우리는 특정 DNA- 결합 단백질에 결합 된 DNA 영역 (면역-침전에 의해 선택됨); ~에<strong>RIP-Seq</strong>, RNA 분자 또는 그 영역은 특정 RNA- 결합 단백질에 결합되고; ~에<strong>DNA-seq</strong>, 우리는 게놈 DNA를 서열하고, 이질적인 세포 집단, 예를 들어 종양의 클론 조성에서 유전자 변이체의 유병률에 관심이있다. 고 처리량 염색질 형태 캡처에서 (<strong>hic</strong>) 우리는 DNA의 3D 공간 배열을 매핑하는 것을 목표로한다; ~에<strong>유전자 화면</strong>(예 : 판독을위한 섭동 및 고 처리량 시퀀싱을위한 RNAI 또는 CRISPR-CAS9 라이브러리를 사용하여, 우리는 유전자 녹다운, 녹아웃 또는 변형시 세포의 증식 또는 생존에 관심이 있습니다. 미생물 분석에서, 우리는 복잡한 미생물 서식지에서 다른 미생물 종의 풍부함을 연구합니다.</p>
<p>이상적으로는 순서와 계산을 원할 수도 있습니다<em>모두</em>샘플에 관심있는 분자. 일반적으로 이것은 불가능합니다. 생화학 적 프로토콜은 100% 효율적이지 않으며 일부 분자 또는 중간체는 길을 따라 손실됩니다. 또한 종종 필요하지 않습니다. 대신, 우리는 순서와 계산 a<em>통계 샘플</em>. 샘플 크기는 분석 된 서열 풀의 복잡성에 의존 할 것이다; 그것은 수만에서 수십억에서 수십억에이를 수 있습니다. 이것<em>견본 추출</em>데이터의 특성은 분석 할 때 중요합니다. 우리는 샘플링이 흥미로운 트렌드와 패턴을 식별하기에 충분히 대표되기를 바랍니다.</p>
<section class="level2" data-number="8.1" id="goals-of-this-chapter">
<h2 class="anchored" data-anchor-id="goals-of-this-chapter" data-number="8.1"><span class="header-section-number">8.1</span>이 장의 목표</h2>
<p>이 장에서는 RNA-Seq와 같은 고 처리량 시퀀싱 애플리케이션에서 카운트 데이터에 익숙해집니다. 데이터를 해석하기 위해 데이터의 기초가되는 샘플링 프로세스를 이해하고 모델링 할 것입니다. 우리의 주요 목표는 다른 조건에서 샘플들 사이의 체계적인 변화를 감지하고 정량화하는 것입니다.<em>치료받지 않았습니다</em>~ 대<em>치료</em>여기서, 동일한 조건 내에서 이러한 체계적인 변화를 샘플링 변동과 실험적 변동과 구별하는 작업. 이를 위해, 우리는 또한 필요한 통계 개념과 도구 세트를 갖게 될 것입니다.</p>
<ul>
<li><p>다 인성 설계, 선형 모델 및 분산 분석</p></li>
<li><p>일반화 된 선형 모델</p></li>
<li><p>견고성과 이상치 탐지</p></li>
<li><p>수축 추정</p></li>
</ul>
<p>실제로, 이러한 개념은 훨씬 더 광범위한 응용 프로그램을 가지고 있습니다. 또한 실험적인 공변량의 함수로서 노이즈 데이터의 차이를 감지하려는 다른 유형의 데이터에도 적용될 수 있습니다. 특히, 일반화 된 선형 모델의 프레임 워크는 상당히 추상적이고 일반적인 것이지만, 이는 다양한 데이터 유형에 적응할 수 있다는 이점이 있으므로 휠을 재발 명 할 필요는 없지만 즉시 다양한 관련 도구와 진단을 즐길 수 있습니다.</p>
<p>보너스로서, 우리는 또한 챕터에서 본 것과 같은 감독되지 않은 방법에 대한 데이터 변환을 살펴볼 것입니다.<a class="quarto-xref" href="05-chap.html"><span>5</span></a>그리고<a class="quarto-xref" href="07-chap.html"><span>7</span></a>데이터를보다 쉽게 ​​시각화 할 수 있습니다.</p>
</section>
<section class="level2 page-columns page-full" data-number="8.2" id="some-core-concepts">
<h2 class="anchored" data-anchor-id="some-core-concepts" data-number="8.2"><span class="header-section-number">8.2</span>일부 핵심 개념</h2>
<p>시작하기 전에 주요 용어를 해결해 봅시다.</p>
<ul>
<li><p>에이<em>시퀀싱 라이브러리</em>시퀀싱 기계의 입력으로 사용되는 DNA 분자의 수집입니다.</p></li>
<li><p><em>조각</em>분자는 서열화되고 있습니다. 현재 가장 널리 사용되는 기술 이후<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>약 300-1000 뉴클레오티드의 길이의 분자만을 다룰 수 있으며, 이들은 관심있는 (일반적으로 더 긴) DNA 또는 cDNA 분자를 단편화함으로써 얻어진다.</p></li>
<li><p>에이<strong>읽다</strong>단편으로부터 얻은 서열이다. 현재의 기술을 사용하면 읽기는 전체 조각이 아니라 하나 또는 양쪽 끝만 포함하며 양쪽의 읽기 길이는 약 150 개의 뉴클레오티드입니다.</p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>우리는 참조합니다<a class="uri" href="https://www.illumina.com/techniques/sequencing.html">https://www.illumina.com/techniques/sequencing.html</a></p></div><div id="fn2"><p><sup>2</sup>특정 응용 프로그램의 경우 가장 적절한 접근 방식과 선택에 대한 최근 문헌을 확인하는 것이 가장 좋습니다.</p></div><div id="fn3"><p><sup>3</sup>예를 들어, RNA-Seq의 경우, 게놈은 전 사체의 주석과 함께.</p></div></div><p>시퀀싱과 계산 사이에는 중요합니다<em>집합</em>또는 함께 속하는 서열을 집계하는 클러스터링 단계 (예를 들어, 동일한 유전자) (RNA-Seq) 또는 동일한 결합 영역 (ChIP-Seq)에 속한다. 실험의 목표에 따라 이것에 대한 몇 가지 접근법과 선택을 선택해야합니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>. 이 방법에는 명시 적 정렬 또는 참조 시퀀스에 대한 해시 기반 매핑이 포함됩니다.<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>및 판독의 참조-독립적 인 서열-유사성 기반 클러스터-특히 메타 게놈 또는 메타 트란 스크립트 연구와 같이 명백한 기준이없는 경우. 우리는 다른 대립 유전자 또는 이소 형을 개별적으로 고려할 것인지 또는 동등성 클래스로 병합할지 여부를 선택해야합니다. 단순화하기 위해이 용어를 사용합니다<em>유전자</em>이 장에서는 이러한 운영 집계의 경우 특정 응용 프로그램에 따라 다양한 것들이 될 수 있습니다.</p>
</section>
<section class="level2 page-columns page-full" data-number="8.3" id="sec-countdata-counttable">
<h2 class="anchored" data-anchor-id="sec-countdata-counttable" data-number="8.3"><span class="header-section-number">8.3</span>데이터 계산</h2>
<p>예제 데이터 세트를로드하겠습니다. 실험 데이터 패키지에 있습니다<strong><a href="https://bioconductor.org/packages/pasilla/">패자</a></strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>FN<span class="ot">=</span> <span class="fu">System.file</span>(<span class="st">"Extraded"</span>,,,<span class="st">"pasilla_gene_counts.tsv"</span>,,,</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>                  <span class="at">패키지 =</span> <span class="st">"파실라"</span>,,,<span class="at">Mustwork =</span> <span class="cn">진실</span>))</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>계산<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(fn,<span class="at">sep =</span> <span class="st">"</span><span class="sc">\티</span><span class="st">"</span>,,,<span class="at">row.names =</span> <span class="st">"gene_id"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="imgs/devil.png" title="In the code shown here, we use the function system.file to locate a file that is shipped together with the pasilla package. When you work with your own data, you will need to prepare the matrix counts yourself."><img alt="In the code shown here, we use the function system.file to locate a file that is shipped together with the pasilla package. When you work with your own data, you will need to prepare the matrix counts yourself." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>여기에 표시된 코드에서는 기능을 사용합니다<code>System.file</code>함께 배송되는 파일을 찾으려면<strong><a href="https://bioconductor.org/packages/pasilla/">패자</a></strong>패키지. 자신의 데이터로 작업하면 매트릭스를 준비해야합니다.<code>계산</code>당신 자신.</figcaption>
</figure>
</div>
</div></div></div>
<p>데이터는 탭으로 표시된 파일의 직사각형 테이블로 저장되며 매트릭스를 읽습니다.<code>계산</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="fu">어둑한</span>(카운트)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14599 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a>카운트 [<span class="dv">2000</span><span class="sc">+</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>),]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>처리되지 않은 1 미 처리되지 않은 처리되지 않은 2 처리되지 않은 처리 된 처리 2
FBGN0020369 3387 4295 1315 1853 4884 2133
FBGN0020370 3186 4305 1824 2094 3525 1973
FBGN0020371 1 0 1 1 1 0
FBGN0020372 38 84 29 28 63 28
            치료 3
FBGN0020369 2165
FBGN0020370 2120
FBGN0020371 0
FBGN0020372 27</code></pre>
</div>
</div>
<p>매트릭스는 각 샘플에서 각 유전자에 대해 보이는 판독 수를 키우고 있습니다. 우리는 그것을라고 부릅니다<strong>카운트 테이블</strong>. 유전자에 해당하는 14599 개의 행과 샘플에 해당하는 7 개의 열이 있습니다. 파일에서 데이터를로드 할 때, 타당성이 좋은 점검은 일부 데이터를 인쇄하는 것입니다. 아마도 처음에는 아마도 위에서했던 것처럼 중간의 임의의 지점에도 아마도 아마도 아마도 임의의 지점에 있습니다.</p>
<p>테이블은 정수 값의 행렬입니다.<span class="math inline">\(나\)</span>th Row와<span class="math inline">\ (J \)</span>매트릭스의 컬럼은 유전자에 얼마나 많은 읽기가 맵핑되었는지를 나타냅니다.<span class="math inline">\(나\)</span>샘플에서<span class="math inline">\ (J \)</span>. 이 장에서 논의하는 통계 샘플링 모델은 값이 직접적인 "원시"수의 시퀀싱 수치라는 사실에 의존합니다. 정규화 된 수, 덮힌 기본 쌍의 수 등과 같은 일부 파생 수량이 아닙니다. 이것은 단지 무의미한 결과로 이어질 것입니다.</p>
<section class="level3 page-columns page-full" data-number="8.3.1" id="the-challenges-of-count-data">
<h3 class="anchored" data-anchor-id="the-challenges-of-count-data" data-number="8.3.1"><span class="header-section-number">8.3.1</span>카운트 데이터의 과제</h3>
<p>그러한 카운트 데이터로 극복해야 할 과제는 무엇입니까?</p>
<ul>
<li><p>데이터는 0에서 수백만까지의 큰 동적 범위를 가지고 있습니다. 동적 범위의 다른 부분에서 데이터의 분산 형태는 매우 다릅니다. 우리는이 현상을 취해야합니다<strong>헤테로스 스테이 스틱</strong>고려합니다.</p></li>
<li><p>데이터는 음이 아닌 정수이며 분포는 대칭이 아니므로 정상 또는 로그 정상 분포 모델이 적합하지 않을 수 있습니다.</p></li>
<li><p>체계적인 샘플링 바이어스를 이해하고 조정해야합니다. 혼란스럽게도, 이것은 종종 호출됩니다<strong>표준화</strong>. 예는 실험의 총 시퀀싱 깊이입니다 (두 라이브러리에서 유전자의 진정한 풍부도가 동일하더라도, 우리는 총 판독 값에 따라 다른 수의 판독 값이 예상되거나 다른 샘플링 확률을 기대합니다. 구조, 바인딩 파트너).</p></li>
<li><p>우리는 샘플링의 확률 적 특성과 다른 확률 적 실험 변화의 소스를 이해해야합니다. 많은 수의 생물학적 샘플에 대한 연구의 경우, 이것은 일반적으로 간단하며 리샘플링 또는 순열 기반 방법에 빠질 수도 있습니다. 그러나 설계된 실험의 경우 샘플 크기가 제한되는 경향이 있습니다.</p></li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="imgs/devil.png" title="There are important conceptual and practical differences between experiments and studies – see also sec-design."><img alt="There are important conceptual and practical differences between experiments and studies – see also sec-design." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>실험과 연구간에 중요한 개념적이고 실용적인 차이점이 있습니다.<a class="quarto-xref" href="13-chap.html"><span>13 장</span></a>.</figcaption>
</figure>
</div>
</div></div></div>
<p>예를 들어, 4 개의 복제물이 있습니다<em>치료받지 않았습니다</em>그리고 3에서<em>치료</em>파실라 데이터의 상태. 이는 리 샘플링 또는 순열 기반 방법에 충분한 전력이 없음을 의미합니다. 진행하려면 분포 가정을해야합니다. 본질적으로, 그러한 가정은 우리가 소수의 분포 매개 변수에서 분포의 꼬리 (즉, 매우 높거나 낮은 카운트)의 희귀 한 사건의 확률을 계산할 수 있다는 것입니다.</p>
<ul>
<li>그러나 그조차도 종종 충분하지 않습니다. 특히 분산 매개 변수의 추정<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>작은 샘플 크기로 인해 어렵습니다. 이 경우, 우리는 유사한 위치를 가진 유전자에도 비슷한 분산이 있다는 것과 같은 추가 가정을해야합니다. 이것을 유전자 전체에 대한 정보 공유라고하며, 우리는 다시 돌아올 것입니다.<a class="quarto-xref" href="#sec-countdata-sharingInformation"><span>섹션 8.10.1</span></a>.</li>
</ul>
<!-- -->
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>분포는 다양한 방식으로 매개 변수화 될 수 있습니다. 종종 매개 변수는 어느 정도의 위치 및 분산 척도에 해당합니다. 친숙한 위치 측정은 평균이며, 친숙한 분산 척도는 분산 (또는 표준 편차)이지만 일부 분포의 경우 다른 측정 값도 사용 중입니다.</p></div></div></section>
<section class="level3" data-number="8.3.2" id="rna-seq-what-about-gene-structures-splicing-isoforms">
<h3 class="anchored" data-anchor-id="rna-seq-what-about-gene-structures-splicing-isoforms" data-number="8.3.2"><span class="header-section-number">8.3.2</span>RNA-Seq : 유전자 구조, 스 플라이 싱, 이소 형은 어떻습니까?</h3>
<p>진핵 생물 유전자는 복잡합니다. 대부분은 여러 엑손으로 구성되며 mRNA는 스 플라이 싱이라는 과정을 통해 엑손의 연결로 인해 발생합니다. 대안 적 스 플라이 싱 및 다중 가능한 시작 및 정지 부위의 선택은 동일한 유전자 유전자 좌위에서 다수의 대체 이소 형을 생성 할 수있게한다. 전 사체의 이소 형 구조를 감지하기 위해 고 처리량 시퀀싱을 사용하는 것이 가능합니다. 특정 이소 형에 특징적인 단편으로부터, 이소 형 특이 적 풍부도를 감지 할 수도있다. 전장 이소 형의 비교적 짧은 조각 만 제공하는 현재 RNA-Seq 데이터를 사용하면 조립하기가 어렵고 전반질 전장 이소 형 이소 형 구조 및 풍부함을 제공하는 경향이 있습니다.<span class="citation" data-cites="SteijgerBertone:2013">(<a href="16-chap.html#ref-SteijgerBertone:2013" role="doc-biblioref">Steijger et al. 2013</a>))</span>. 이로 인해 현지 진술 만 제기하려는 절차 (예 : 개별 엑손의 포함 또는 제외)가 공식화되었습니다.<span class="citation" data-cites="Reyes:GnomeResearch:2012">(<a href="16-chap.html#ref-Reyes:GnomeResearch:2012" role="doc-biblioref">Anders, Reyes 및 Huber 2012</a>))</span>그리고 이것들은 더 강력 할 수 있습니다. 우리는 미래의 기술이 전장 전 사체를 시퀀싱 할 것으로 기대할 수 있습니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="8.4" id="modeling-count-data">
<h2 class="anchored" data-anchor-id="modeling-count-data" data-number="8.4"><span class="header-section-number">8.4</span>모델링 카운트 데이터</h2>
<section class="level3 page-columns page-full" data-number="8.4.1" id="dispersion">
<h3 class="anchored" data-anchor-id="dispersion" data-number="8.4.1"><span class="header-section-number">8.4.1</span>분산</h3>
<p>포함 된 시퀀싱 라이브러리를 고려하십시오<span class="math inline">\ (n_1 \)</span>유전자 1에 해당하는 단편,<span class="math inline">\ (n_2 \)</span>총 라이브러리 크기와 함께 유전자 2 등의 조각<span class="math inline">\ (n = n_1+n_2+\ cdots \)</span>. 우리는 도서관을 시퀀싱에 제출하고 신원을 결정합니다.<span class="math inline">\(아르 자형\)</span>무작위로 샘플링 된 조각. 환영 단순화는이 숫자의 순서를 보는 것입니다.</p>
<ul>
<li><p>유전자의 수는 수만에 달합니다.</p></li>
<li><p>의 가치<span class="math inline">\(N\)</span>준비하는 데 사용 된 세포의 양에 따라 다르지만 벌크 RNA-seq의 경우 수십억 또는 수조에 달합니다.</p></li>
<li><p>읽기 수<span class="math inline">\(아르 자형\)</span>보통 수천만이므로<span class="math inline">\(N\)</span>.</p></li>
</ul>
<p>이것으로부터 우리는 주어진 판독 가능성이<span class="math inline">\ (i^{\ text {th}} \)</span>유전자입니다<span class="math inline">\ (p_i = n_i/n \)</span>그리고 이것은 다른 모든 읽기의 결과와 거의 독립적입니다. 그래서 우리는 유전자에 대한 읽기 수를 모델링 할 수 있습니다.<span class="math inline">\(나\)</span>포아송 분포에 의해<em>비율</em>포아송 프로세스의 제품입니다<span class="math inline">\ (p_i \)</span>, 단편의 초기 비율<span class="math inline">\ (i^{\ text {th}} \)</span>유전자, 시간<span class="math inline">\(아르 자형\)</span>, 즉 :<span class="math inline">\ (\ lambda_i = rp_i \)</span>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="imgs/devil.png" title="In principle, we should consider sampling without replacement and the multinomial distribution here: the probability of sampling a read for the i^{\text{th}} gene depends on how many times the same gene, and other genes, have already been sampled. However, these dependencies are so negligibly small that we’ll ignore them. This is because n is so much larger than r, the number of genes is large, and each individual n_i is small compared to n."><img alt="In principle, we should consider sampling without replacement and the multinomial distribution here: the probability of sampling a read for the i^{\text{th}} gene depends on how many times the same gene, and other genes, have already been sampled. However, these dependencies are so negligibly small that we’ll ignore them. This is because n is so much larger than r, the number of genes is large, and each individual n_i is small compared to n." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>원칙적으로 우리는 고려해야합니다<strong>교체없이 샘플링</strong>그리고 여기서 다국적 분포 : 샘플링 할 확률은<span class="math inline">\ (i^{\ text {th}} \)</span>유전자는 같은 유전자와 다른 유전자가 이미 샘플링되었는지에 따라 다릅니다. 그러나 이러한 종속성은 무시할 정도로 작기 때문에 우리가 무시할 것입니다. 이건 때문입니다<span class="math inline">\(N\)</span>보다 훨씬 큽니다<span class="math inline">\(아르 자형\)</span>, 유전자의 수는 크고 각 개인<span class="math inline">\ (n_i \)</span>에 비해 작습니다<span class="math inline">\(N\)</span>.</figcaption>
</figure>
</div>
</div></div></div>
<p>실제로, 우리는 일반적으로 단일 라이브러리 내에서 읽기 수를 모델링하는 데 관심이 없지만 라이브러리 간의 수를 비교할 때. 즉, 우리는 다른 생물학적 조건 (예를 들어, 약물 치료의 유무에 관계없이 동일한 세포주) 사이에서 볼 수있는 차이가“우연히”예상보다 큽니다. 경험적으로, 복제 실험은 포아송 분포가 예측하는 것보다 더 다양하다는 것이 밝혀졌습니다. 직관적으로, 일어날 일은 그 것입니다<span class="math inline">\ (p_i \)</span>따라서 또한<span class="math inline">\ (\ lambda_i \)</span>생물학적 복제물들 사이에서도 다양합니다. 아마도 세포가 성장하는 온도는 약간 다르거나 첨가 된 약물의 양은 몇 % 증가했거나 배양 시간이 약간 길어졌습니다. 이를 설명하기 위해 다른 모델링 계층을 맨 위에 추가해야합니다. 우리는 이미 계층 적 모델과 혼합물을 보았습니다<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>. 그것은 그게 밝혀졌습니다<strong>감마-포이슨</strong>(일명 부정적인 이항) 분포는 모델링 요구에 적합합니다. 싱글 대신<span class="math inline">\ (\ lambda \)</span>- 평균과 분산을 모두 나타내는이 분포에는 두 가지 매개 변수가 있습니다. 원칙적으로, 이들은 각 유전자마다 다를 수 있으며, 우리는 데이터에서이를 추정하는 방법에 대한 질문으로 돌아올 것입니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="8.4.2" id="sec-countdata-normalization">
<h3 class="anchored" data-anchor-id="sec-countdata-normalization" data-number="8.4.2"><span class="header-section-number">8.4.2</span>표준화</h3>
<p>종종 데이터 생성에 영향을 미치고 고려할 가치가있는 체계적인 편견이 있습니다. 불행히도 용어<strong>표준화</strong>오해의 소지가 있지만 분석의 해당 측면에 일반적으로 사용됩니다. 정규 분포, 벡터 공간의 규범 또는 정상 벡터와 관련이 없습니다. 오히려, 우리가 목표로하는 것은 본질을 식별하고 체계적인 편견의 크기를 추정하고 데이터 기반 분석에서 고려하는 것입니다.</p>
<p>가장 중요한 체계적인 바이어스는 각 샘플의 총 판독 수의 변화에서 비롯됩니다. 우리가 한 라이브러리에 대해 다른 라이브러리에 대해 더 많은 읽기를 가지고 있다면, 다른 모든 것은 동일하다고 생각할 수 있습니다.<span class="math inline">\(에스\)</span>. 순진하게, 우리는 괜찮은 추정치를 제안 할 수 있습니다<span class="math inline">\(에스\)</span>각 샘플에 대해 단순히 모든 유전자의 수의 합에 의해 주어진다. 그러나 우리가 더 잘할 수 있다는 것이 밝혀졌습니다. 이것을 이해하려면 장난감 예제가 도움이됩니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-normalization">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-normalization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="08-chap_files/figure-html/fig-countdata-normalization-1.png" title="Figure 8.1: Size factor estimation. The points correspond to hypothetical genes whose counts in two samples are indicated by their x- and y-coordinates. The lines indicate two different ways of size factor estimation explained in the text."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-normalization-1.png" width="200"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-normalization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.1 : 크기 계수 추정. 포인트는 두 샘플의 계산이 그로 인해<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-코디네스. 선은 텍스트에 설명 된 두 가지 크기의 크기 계수 추정 방식을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>표시된대로 5 개의 유전자와 2 개의 샘플이있는 데이터 세트를 고려하십시오.<a class="quarto-xref" href="#fig-countdata-normalization">수치<span>8.1</span></a>. 우리가 추정하는 경우<span class="math inline">\(에스\)</span>두 샘플 각각의 계수에 따라 파란색 선의 기울기는 비율을 나타냅니다. 이에 따르면, 유전자 C는 샘플 1과 비교하여 샘플 2에서 하향 조절되는 반면, 다른 유전자는 모두 다소 상향 조절된다. 우리가 지금 대신 추정한다면<span class="math inline">\(에스\)</span>이들의 비율이 적색 선에 해당하는 경우, 우리는 여전히 유전자 C가 하향 조절되고 다른 유전자는 변하지 않는다는 결론을 내릴 것이다. 두 번째 버전은 더 심각하며 과학자들이 종종 선호합니다. 빨간색 선의 기울기는 강력한 회귀로 얻을 수 있습니다. 이것이 바로<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>방법.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-estimateSizeFactorsForMatrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.1</div>
</div>
<div class="callout-body-container callout-body">
<p>예제 데이터 세트<code>세다</code>~의<a class="quarto-xref" href="#sec-countdata-counttable"><span>섹션 8.3</span></a>, 출력은 어떻게됩니까?<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>'에스<code>추정 변수 formatrix를 추정합니다</code>단순히 열 합계를 가져 와서 얻는 것과 비교해?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-2-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-2-contents callout-collapse collapse" id="callout-2">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-countdata-sfvssum">수치<span>8.2</span></a>아래 코드에서 생성. 이 경우에는 큰 차이가 없으며 결과는 거의 비례합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"tibble"</span>))</span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"deseq2"</span>))</span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(</span>
<span id="cb6-5"><a aria-hidden="true" href="#cb6-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">크기 요인</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">추정 변수 formatrix를 추정합니다</span>(카운트),</span>
<span id="cb6-6"><a aria-hidden="true" href="#cb6-6" tabindex="-1"></a>  <span class="st">`</span><span class="at">합집합</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">Colsums</span>(카운트)),<span class="fu">AES</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">크기 요인</span><span class="st">`</span>,,,<span class="at">y =</span> <span class="st">`</span><span class="at">합집합</span><span class="st">`</span>)))<span class="sc">+</span></span>
<span id="cb6-7"><a aria-hidden="true" href="#cb6-7" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-sfvssum">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-sfvssum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="08-chap_files/figure-html/fig-countdata-sfvssum-1.png" title="Figure 8.2: Size factors versus sums for the pasilla data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-sfvssum-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-sfvssum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.2 : 파실라 데이터의 크기 요인 대 합.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>이 책의 R 출처를 찾고 생성하는 코드를 살펴보십시오.<a class="quarto-xref" href="#fig-countdata-normalization">수치<span>8.1</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-meanvar">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.2</div>
</div>
<div class="callout-body-container callout-body">
<p>Pasilla 데이터 세트에서 생물학적 복제에 대한 평균 분산 관계를 플로팅하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-5-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-5-contents callout-collapse collapse" id="callout-5">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-countdata-varmean">수치<span>8.3</span></a>다음 코드에 의해 생성됩니다.</p>
<div class="cell" data-layout-align="center" data-warning.known="rows containing non-finite">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"매트릭스 스타트"</span>))</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a>sf<span class="ot">=</span> <span class="fu">추정 변수 formatrix를 추정합니다</span>(카운트)</span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3" tabindex="-1"></a>ncounts<span class="ot">=</span>계산<span class="sc">/</span> <span class="fu">행렬</span>(SF,</span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4" tabindex="-1"></a>   <span class="at">Byrow =</span> <span class="cn">진실</span>,,,<span class="at">NCOL =</span> <span class="fu">NCOL</span>(카운트),<span class="at">nrow =</span> <span class="fu">nrow</span>(카운트))</span>
<span id="cb7-5"><a aria-hidden="true" href="#cb7-5" tabindex="-1"></a>uncounts<span class="ot">=</span>ncounts [,<span class="fu">grep</span>(<span class="st">"^치료되지 않은"</span>,,,<span class="fu">colnames</span>(ncounts)),</span>
<span id="cb7-6"><a aria-hidden="true" href="#cb7-6" tabindex="-1"></a>떨어지다<span class="ot">=</span> <span class="cn">거짓</span>]]</span>
<span id="cb7-7"><a aria-hidden="true" href="#cb7-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(</span>
<span id="cb7-8"><a aria-hidden="true" href="#cb7-8" tabindex="-1"></a>        <span class="at">평균 =</span> <span class="fu">Rowmeans</span>(uncounts),</span>
<span id="cb7-9"><a aria-hidden="true" href="#cb7-9" tabindex="-1"></a>        <span class="at">=</span> <span class="fu">Rowvars</span>(uncounts)),</span>
<span id="cb7-10"><a aria-hidden="true" href="#cb7-10" tabindex="-1"></a>     <span class="fu">AES</span>(<span class="at">x =</span> <span class="fu">통나무</span>(평균),<span class="at">y =</span> <span class="fu">통나무</span>(우리의)))<span class="sc">+</span></span>
<span id="cb7-11"><a aria-hidden="true" href="#cb7-11" tabindex="-1"></a>  <span class="fu">GEOM_HEX</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span> <span class="st">"없음"</span>))<span class="sc">+</span></span>
<span id="cb7-12"><a aria-hidden="true" href="#cb7-12" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">경사 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,,,<span class="at">색상 =</span> <span class="fu">기음</span>(<span class="st">"포레스트 그린"</span>,,,<span class="st">"빨간색"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-varmean">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-varmean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="08-chap_files/figure-html/fig-countdata-varmean-1.png" title="Figure 8.3: Variance versus mean for the (size factor adjusted) counts data. The axes are logarithmic. Also shown are lines through the origin with slopes 1 (green) and 2 (red)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-varmean-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-varmean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.3 : 분산 대 평균 (크기 요인 조정)<code>계산</code>데이터. 축은 로그입니다. 또한 경사 1 (녹색) 및 2 (빨간색)가있는 원점을 통한 선이 표시됩니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>녹색 선 (경사 1)은 분산이있을 경우 우리가 기대하는 것입니다.<span class="math inline">\(다섯\)</span>) 평균과 같습니다 (<span class="math inline">\(중\)</span>), 포아송 분포 랜덤 변수의 경우와 마찬가지로 :<span class="math inline">\ (v = m \)</span>. 우리는 이것이 하위 범위의 데이터에 대략 적합하다는 것을 알 수 있습니다. 빨간색 선 (경사 2)은 2 차 평균 분산 관계에 해당합니다.<span class="math inline">\ (v = m^2 \)</span>; 그것과 평행 한 선 (표시되지 않음)은 나타납니다<span class="math inline">\ (v = cm^2 \)</span>다양한 값의 경우<span class="math inline">\(기음\)</span>. 우리는 데이터의 상위 범위에서 2 차 관계가 데이터에 대략 적합한 것을 볼 수 있습니다.<span class="math inline">\ (C &lt;1 \)</span>.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="8.5" id="sec-countdata-debasic">
<h2 class="anchored" data-anchor-id="sec-countdata-debasic" data-number="8.5"><span class="header-section-number">8.5</span>기본 분석</h2>
<section class="level3 page-columns page-full" data-number="8.5.1" id="example-dataset-the-pasilla-data">
<h3 class="anchored" data-anchor-id="example-dataset-the-pasilla-data" data-number="8.5.1"><span class="header-section-number">8.5.1</span>예제 데이터 세트 : Pasilla 데이터</h3>
<p>다시 돌아 갑시다<strong><a href="https://bioconductor.org/packages/pasilla/">패자</a></strong>데이터의 데이터<a class="quarto-xref" href="#sec-countdata-counttable"><span>섹션 8.3</span></a>. 이 데이터는 실험에서 나온 것입니다<em>Drosophila melanogaster</em>스 플라이 싱 팩터의 RNAI 녹다운 효과를 조사한 세포 배양<em>패자</em> <span class="citation" data-cites="Brooks2010">(<a href="16-chap.html#ref-Brooks2010" role="doc-biblioref">Brooks et al. 2011</a>))</span>세포의 전 사체에. 두 가지 실험 조건이있었습니다<em>치료받지 않았습니다</em>그리고<em>치료</em>로드 한 카운트 테이블의 헤더에서. 그것들은 음성 대조군과 siRNA에 해당합니다<em>패자</em>. 이 데이터 세트에서 7 개의 샘플의 실험 메타 데이터는 스프레드 시트와 같은 테이블로 제공되며로드합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="imgs/devil.png" title="In the code shown here, we load the file pasilla_sample_annotation.csv that comes with the pasilla package. We locate it with the function system.file. When you work with your own data, you will need to prepare an analogous file, or directly a dataframe like pasillaSampleAnno."><img alt="In the code shown here, we load the file pasilla_sample_annotation.csv that comes with the pasilla package. We locate it with the function system.file. When you work with your own data, you will need to prepare an analogous file, or directly a dataframe like pasillaSampleAnno." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>여기에 표시된 코드에서 파일을로드합니다<code>pasilla_sample_annotation.csv</code>그것은 함께 제공됩니다<strong><a href="https://bioconductor.org/packages/pasilla/">패자</a></strong>패키지. 우리는 기능으로 그것을 찾습니다<code>System.file</code>. 자신의 데이터로 작업 할 때는 유사한 파일을 준비하거나 다음과 같은 데이터 프레임을 직접 준비해야합니다.<code>Pasillasampleanno</code>.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" href="#cb8-1" tabindex="-1"></a>주석 파일<span class="ot">=</span> <span class="fu">System.file</span>(<span class="st">"Extraded"</span>,,,</span>
<span id="cb8-2"><a aria-hidden="true" href="#cb8-2" tabindex="-1"></a>  <span class="st">"pasilla_sample_annotation.csv"</span>,,,</span>
<span id="cb8-3"><a aria-hidden="true" href="#cb8-3" tabindex="-1"></a>  <span class="at">패키지 =</span> <span class="st">"파실라"</span>,,,<span class="at">Mustwork =</span> <span class="cn">진실</span>))</span>
<span id="cb8-4"><a aria-hidden="true" href="#cb8-4" tabindex="-1"></a>Pasillasampleanno<span class="ot">=</span>readr<span class="sc">::</span><span class="fu">read_csv</span>(AnnotationFile)</span>
<span id="cb8-5"><a aria-hidden="true" href="#cb8-5" tabindex="-1"></a>Pasillasampleanno</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 7 × 6
  파일 조건 유형`레인 수 '총 판독 수… ¹`엑손 카운트'
  &lt;CHR&gt; &lt;CHR&gt; &lt;CH&gt; &lt;DBL&gt; &lt;CHR&gt; &lt;DBL&gt;
1 치료… 처리 된 노래… 5 35158667 15679615
2 처리… 처리 된 쌍… 2 12242535 (x2) 15620018
3 치료… 처리 된 쌍… 2 12443664 (x2) 12733865
4 Untrea… 처리되지 않은 노래… 2 17812866 14924838
5 Untrea… 처리되지 않은 노래… 6 34284521 20764558
6 Untrea… 처리되지 않은 쌍… 2 10542625 (x2) 10283129
7 Untrea… 처리되지 않은 쌍… 2 12214974 (x2) 11653031
# iated 약식 이름 : ¹`총 reads`</code></pre>
</div>
</div>
<p>여기서 볼 수 있듯이 전체 데이터 세트는 두 개의 배치로 생성되었으며, 첫 번째 데이터 세트는 단일 판독 시퀀싱에 적용되는 3 개의 시퀀싱 라이브러리로 구성되었으며, 두 번째 배치는 짝을 이루는 4 개의 라이브러리로 구성되어 있습니다. 종종 우리는 일부 데이터가 필요합니다. 우리는 하이픈을 교체합니다.<code>유형</code>요인 수준의 산술 연산자가<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>, 그리고 변환<code>유형</code>그리고<code>상태</code>열을 요인으로, 레벨의 선호하는 순서를 명시 적으로 지정합니다 (기본값은 알파벳순입니다).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb10-2"><a aria-hidden="true" href="#cb10-2" tabindex="-1"></a>Pasillasampleanno<span class="ot">=</span> <span class="fu">돌연변이</span>(Pasillasampleanno,</span>
<span id="cb10-3"><a aria-hidden="true" href="#cb10-3" tabindex="-1"></a><span class="at">조건 =</span> <span class="fu">요인</span>(상태,<span class="at">레벨 =</span> <span class="fu">기음</span>(<span class="st">"치료받지 못함"</span>,,,<span class="st">"처리"</span>)),</span>
<span id="cb10-4"><a aria-hidden="true" href="#cb10-4" tabindex="-1"></a><span class="at">유형 =</span> <span class="fu">요인</span>(<span class="fu">보결</span>(<span class="st">"-.*"</span>,,,<span class="st">"" "</span>, 유형),<span class="at">레벨 =</span> <span class="fu">기음</span>(<span class="st">"하나의"</span>,,,<span class="st">"페어링"</span>))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 디자인이 관심있는 요인간에 대략 균형을 이룹니다.<code>상태</code>및 "Nuisance Factor"<code>유형</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a><span class="fu">~와 함께</span>(Pasillasampleanno,</span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>       <span class="fu">테이블</span>(조건, 유형)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>유형
조건 싱글 쌍
  처리되지 않은 2 2
  처리 된 1 2</code></pre>
</div>
</div>
<p><strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>호출 된 특수 데이터 컨테이너를 사용합니다<em>deseqdataset</em>작업하는 데이터 세트를 저장하려면 특수 컨테이너의 이러한 사용 - 또는 R 용어에서<em>수업</em>- 사용자는 관련 데이터를 유지하는 데 도움이되므로 생체 전도기 프로젝트의 일반적인 원칙입니다. 이러한 작업을 수행하는 방법은 사용자가 클래스를 이해하기 위해 약간 더 많은 시간을 투자해야합니다.<em>행렬</em>데이터 프레임은 데이터의 관련 부분 간의 동기화 손실로 인해 버그를 피하는 데 도움이됩니다. 또한 항상 기본 용어로 표현되면 상당히 말할 수있는 공통 작업의 추상화 및 캡슐화를 가능하게합니다.<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>. <em>deseqdataset</em>클래스의 확장입니다<em>요약 경험</em>생체 전도체에서. 그만큼<em>요약 경험</em>클래스는 다른 많은 패키지에서도 사용되므로 작업을 배우면 다양한 도구를 사용할 수 있습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>또 다른 장점은 수업에 포함될 수 있다는 것입니다<em>효력</em>예를 들어, 카운트가 양수 정수이거나 샘플 주석 데이터 프레임의 행과 정렬되는 카운트 매트릭스의 열이 데이터가 항상 특정 기대치를 충족시키는 방법.</p></div><div id="fn6"><p><sup>6</sup>아래 코드에서 어떻게<code>계산</code>객체<code>파일</code>의 열<code>Pasillasampleanno</code>데이터 프레임, 특히 우리는 그것을 제거해야합니다<code>"FB"</code>그것은에서 사용됩니다<code>파일</code>어떤 이유로 든 열. 이러한 데이터 정수는 매우 일반적입니다. 데이터를 저장하는 이유 중 하나<em>deseqdataset</em>대상은 더 이상 그런 것들에 대해 걱정할 필요가 없다는 것입니다.</p></div></div><p>우리는 생성자 함수를 사용합니다<code>deseqdatasetfrommatrix</code>a<em>deseqdataset</em>카운트 데이터 매트릭스에서<code>계산</code>및 샘플 주석 데이터 프레임<code>Pasillasampleanno</code><a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a>산<span class="ot">=</span> <span class="fu">성냥</span>(<span class="fu">colnames</span>(카운트),<span class="fu">보결</span>(<span class="st">"FB $"</span>,,,<span class="st">"" "</span>, pasillasampleanno<span class="sc">$</span>파일))</span>
<span id="cb13-2"><a aria-hidden="true" href="#cb13-2" tabindex="-1"></a><span class="fu">Stopifnot</span>(<span class="sc">!</span><span class="fu">어느</span>(<span class="fu">is.na</span>(MT)))</span>
<span id="cb13-3"><a aria-hidden="true" href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a aria-hidden="true" href="#cb13-4" tabindex="-1"></a>패자<span class="ot">=</span> <span class="fu">deseqdatasetfrommatrix</span>(</span>
<span id="cb13-5"><a aria-hidden="true" href="#cb13-5" tabindex="-1"></a>  <span class="at">countdata =</span>카운트,</span>
<span id="cb13-6"><a aria-hidden="true" href="#cb13-6" tabindex="-1"></a>  <span class="at">collta =</span>pasillasampleanno [mt,],</span>
<span id="cb13-7"><a aria-hidden="true" href="#cb13-7" tabindex="-1"></a>  <span class="at">디자인 =</span> <span class="sc">~</span>상태)</span>
<span id="cb13-8"><a aria-hidden="true" href="#cb13-8" tabindex="-1"></a><span class="fu">수업</span>(파실라)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "deseqdataset"
attr (, "패키지")
[1] "Deseq2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">~이다</span>(파실라,<span class="st">"요약 실험"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 사실</code></pre>
</div>
</div>
<p>그만큼<em>요약 경험</em>수업 - 따라서<em>deseqdataset</em>- 또한 카운트 매트릭스 행의 주석을 저장하기위한 시설도 포함되어 있습니다. 지금은 우리는 행 이름의 유전자 식별자에 만족합니다.<code>계산</code>테이블.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-rowData">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.3</div>
</div>
<div class="callout-body-container callout-body">
<p>a의 행 메타 데이터에 어떻게 액세스 할 수 있습니까?<em>요약 경험</em>물체, 즉, 어떻게 읽을 수 있습니까? 어떻게 변경할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-7-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-7-contents callout-collapse collapse" id="callout-7">
<div class="callout-body-container callout-body">
<p>의 매뉴얼 페이지를 확인하십시오<em>요약 경험</em>클래스와 방법<code>RowData</code>그리고<code>RowData &lt;-</code>.</p>
</div>
</div>
</div>
</section>
<section class="level3" data-number="8.5.2" id="sec-countdata-deseq2">
<h3 class="anchored" data-anchor-id="sec-countdata-deseq2" data-number="8.5.2"><span class="header-section-number">8.5.2</span>그만큼<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>방법</h3>
<p>이러한 준비 후, 우리는 이제 차등 발현 분석으로 바로 이동할 준비가되었습니다. 우리의 목표는 처리 된 세포와 처리되지 않은 세포 사이에 차별적으로 풍부한 유전자를 식별하는 것입니다. 이를 위해 개념적으로 유사한 테스트를 적용합니다.<span class="math inline">\(티\)</span>-우리가 만난 테스트<a class="quarto-xref" href="06-chap.html#sec-testing-ttest"><span>섹션 6.5</span></a>수학적으로 다소 더 관여하지만. 우리는 지금이 세부 사항을 연기 할 것이며, 그들에게 다시 올 것입니다.<a class="quarto-xref" href="#sec-countdata-multifactor"><span>섹션 8.7</span></a>. 표준 분석 단계의 선택은 단일 함수로 래핑됩니다.<code>Deseq</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a>패자<span class="ot">=</span> <span class="fu">Deseq</span>(파실라)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>그만큼<code>Deseq</code>함수는 단순히 함수를 순서대로 호출하는 래퍼입니다.<code>추정 변호사</code>(정규화를 위해, 논의 된 바와 같이<a class="quarto-xref" href="#sec-countdata-normalization"><span>섹션 8.4.2</span></a>),)<code>추정 대상</code>(분산 추정) 및<code>nbinomwaldtest</code>(차등 풍부도에 대한 가설 테스트). 테스트는 두 레벨 사이에 있습니다<span>치료받지 않았습니다</span>그리고 Exttt<span>치료</span>요인의<code>상태</code>, 이것은 우리가 구축 할 때 지정한 것입니다.<code>패자</code>논쟁을 통해 반대하십시오<code>디자인 = \ simcondition</code>. 동작을 수정하거나 사용자 정의 단계를 개입하려면이 세 가지 기능을 각각 개별적으로 호출 할 수 있습니다. 결과를 살펴 보겠습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a>해안<span class="ot">=</span> <span class="fu">결과</span>(파실라)</span>
<span id="cb18-2"><a aria-hidden="true" href="#cb18-2" tabindex="-1"></a>res [<span class="fu">주문하다</span>(res<span class="sc">$</span>padj),]<span class="sc">|&gt;</span> <span class="fu">머리</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Log2 Fold Change (MLE) : 처리 된 상태 대 처리되지 않은 상태 
Wald 테스트 P- 값 : 조건 처리 대 처리되지 않은 상태 
6 행과 6 개의 열이있는 데이터 프레임
             Basemean log2foldchange lfcse stat pvalue
            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
FBGN0039155 730.596 -4.61901 0.1687068 -27.3789 4.88599E -165
FBGN0025111 1501.411 2.89986 0.1269205 22.8479 1.53430E-115
FBGN0029167 3706.117 -2.19700 0.0969888 -22.6521 1.33042E -113
FBGN0003360 4343.035 -3.17967 0.1435264 -22.1539 9.56283E -109
FBGN0035085 638.233 -2.56041 0.1372952 -18.6490 1.28772E -77
FBGN0039827 261.916 -4.16252 0.2325888 -17.8965 1.25663E -71
                    padj
               &lt;numeric&gt;
FBGN0039155 4.06661E-161
FBGN0025111 6.38497E-112
FBGN0029167 3.69104E-110
FBGN0003360 1.98979E-105
FBGN0035085 2.14354E-74
FBGN0039827 1.74316E-68</code></pre>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="8.5.3" id="sec-countdata-explore">
<h3 class="anchored" data-anchor-id="sec-countdata-explore" data-number="8.5.3"><span class="header-section-number">8.5.3</span>결과 탐색</h3>
<p>미분 발현 분석 후 첫 번째 단계는 다음 3-4 개의 기본 플롯을 시각화하는 것입니다.</p>
<ul>
<li><p>p- 값의 히스토그램 (<a class="quarto-xref" href="#fig-countdata-hist1">수치<span>8.4</span></a>),)</p></li>
<li><p>MA 플롯 (<a class="quarto-xref" href="#fig-countdata-MA">수치<span>8.5</span></a>) 그리고</p></li>
<li><p>안수 플롯 (<a class="quarto-xref" href="#fig-countdata-PCA">수치<span>8.6</span></a>).</p></li>
<li><p>또한 히트 맵 (<a class="quarto-xref" href="#fig-figHeatmap-1">수치<span>8.7</span></a>)는 유익 할 수 있습니다.</p></li>
</ul>
<p>이들은 필수 데이터 품질 평가 측정입니다.<a class="quarto-xref" href="13-chap.html#sec-design-quality"><span>섹션 13.6</span></a>여기에도 적용됩니다.</p>
<p>p- 값 히스토그램은 간단합니다 (<a class="quarto-xref" href="#fig-countdata-hist1">수치<span>8.4</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="rows containing non-finite outside">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">~처럼</span>(res,<span class="st">"data.frame"</span>),)<span class="fu">AES</span>(<span class="at">x =</span>PValue))<span class="sc">+</span></span>
<span id="cb20-2"><a aria-hidden="true" href="#cb20-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>,,,<span class="at">fill =</span> <span class="st">"RoyalBlue"</span>,,,<span class="at">경계 =</span> <span class="dv">0</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-hist1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-hist1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="08-chap_files/figure-html/fig-countdata-hist1-1.png" title="Figure 8.4: Histogram of p-values of a differential expression analysis."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-hist1-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-hist1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.4 : 미분 발현 분석의 p- 값의 히스토그램.</figcaption>
</figure>
</div>
</div></div></div>
<p>분포에는 두 가지 주요 구성 요소가 표시됩니다. 0과 1 사이의 값을 가진 균일 한 배경과 왼쪽에 작은 p- 값의 피크가 표시됩니다. 균일 한 배경은 비 2 다이어티브 발현 유전자에 해당합니다. 일반적으로 이것은 대부분의 유전자입니다. 왼손 피크는 차별적으로 발현 된 유전자에 해당합니다<a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>. 우리가 이미 본 것처럼<a class="quarto-xref" href="06-chap.html"><span>6 장</span></a>, 피크 높이에 대한 배경 수준의 비율은 우리에게 가장 왼쪽 빈에서 유전자를 호출하는 것과 관련된 FDR (False Discovery rate)을 대략적으로 표시합니다. 우리의 경우, 가장 왼쪽 빈에는 0과 0.01 사이의 모든 p- 값이 포함되어 있으며, 이는 993 개의 유전자에 해당합니다. 배경 수준은 약 100이므로 가장 왼쪽 쓰레기통의 모든 유전자를 호출하는 것과 관련된 FDR은 약 10%입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>여기에 표시된 데이터의 경우 히스토그램에는 중간 또는 오른쪽에 몇 개의 분리 된 피크가 포함되어 있습니다. 이들은 작은 수의 유전자에서 비롯되며 데이터의 불분명을 반영합니다.</p></div></div><p>때로는 배경 분포가 균일하지 않지만 오른쪽을 향해 증가하는 틸트 모양을 보여줍니다. 이것은 배치 효과를 나타내는 경향이 있습니다. 당신은 이것을 더 탐색 할 수 있습니다<a class="quarto-xref" href="#imp-countdata-batch">운동<span>8.1</span></a>.</p>
<p>MA 플롯을 생성하려면 기능을 사용할 수 있습니다.<code>음모</code>에서<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>패키지 (<a class="quarto-xref" href="#fig-countdata-MA">수치<span>8.5</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a><span class="fu">음모</span>(파실라,<span class="at">어퍼 =</span> <span class="fu">기음</span>( <span class="sc">-</span><span class="dv">2</span>,,,<span class="dv">2</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-MA">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-MA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="08-chap_files/figure-html/fig-countdata-MA-1.png" title="Figure 8.5: MA plot: fold change versus mean of size-factor normalized counts. Logarithmic scaling is used for both axes. By default, points are colored red if the adjusted p-value is less than 0.1. Points which fall out of the y-axis range are plotted as triangles."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-MA-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-MA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.5 :<a href="https://en.wikipedia.org/wiki/MA_plot">나는 비가 내리고있다</a>: 주름 변화 대 크기 요소 정규화 된 수의 평균. 로그 스케일링은 두 축 모두에 사용됩니다. 기본적으로 조정 된 p- 값이 0.1 미만인 경우 점은 빨간색으로 표시됩니다. 에서 떨어지는 포인트<span class="math inline">\(와이\)</span>-축 범위는 삼각형으로 표시됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리가 본 것과 유사한 PCA 플롯을 생산합니다.<a class="quarto-xref" href="07-chap.html"><span>7 장</span></a>, 우리는 사용할 수 있습니다<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>기능<code>Plotpca</code> (<a class="quarto-xref" href="#fig-countdata-PCA">수치<span>8.6</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" href="#cb22-1" tabindex="-1"></a>pas_rlog<span class="ot">=</span> <span class="fu">rlogtransformation</span>(파실라)</span>
<span id="cb22-2"><a aria-hidden="true" href="#cb22-2" tabindex="-1"></a><span class="fu">Plotpca</span>(pas_rlog,<span class="at">intgroup =</span><span class="fu">기음</span>(<span class="st">"상태"</span>,,,<span class="st">"유형"</span>)))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-PCA">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-PCA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="08-chap_files/figure-html/fig-countdata-PCA-1.png" title="Figure 8.6: PCA plot. The 7 samples are shown in the 2D plane spanned by their first two principal components."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-PCA-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-PCA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.6 : PCA 플롯. 7 개의 샘플은 2D 평면에서 처음 두 개의 주요 구성 요소에 의해 표시됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이전 장에서 보았 듯이,이 유형의 플롯은 실험 공변량의 전반적인 효과를 시각화하거나 배치 효과를 감지하는 데 유용합니다. 여기서, 첫 번째 주요 축, PC1은 주로 실험적인 관심 공변량 (처리되지 않은 / 처리)과 정렬되는 반면, 두 번째 축은 시퀀싱 프로토콜 (단일 / 쌍)과 거의 정렬된다.</p>
<p>우리는 데이터 변환을 사용했습니다<strong>정규화 된 로그</strong>또는<strong>rlog</strong>우리는 더 자세히 조사 할 것입니다<a class="quarto-xref" href="#sec-countdata-rnaseq"><span>섹션 8.10.2</span></a>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-pca">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.4</div>
</div>
<div class="callout-body-container callout-body">
<p>PCA 플롯의 축은 항상 알려진 실험 공변량과 일치해야합니까?</p>
</div>
</div>
<p>히트 맵은 매트릭스와 같은 데이터 세트에 대한 개요를 빠르게 얻는 강력한 방법이 될 수 있습니다. 아래는 rlog 변환 데이터에서 히트 맵을 만드는 방법을 참조하십시오. 만큼 큰 매트릭스의 경우<code>카운트 (Pasilla)</code>,이 모든 것을 플로팅하는 것은 실용적이지 않기 때문에 우리는 30 개의 유전자의 서브 매트릭스를 평균 표현이 가장 높은 것으로 표시합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"pheatmap"</span>))</span>
<span id="cb23-2"><a aria-hidden="true" href="#cb23-2" tabindex="-1"></a>선택하다<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">Rowmeans</span>(<span class="fu">시험</span>(pas_rlog)),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>]]</span>
<span id="cb23-3"><a aria-hidden="true" href="#cb23-3" tabindex="-1"></a><span class="fu">pheatmap</span>( <span class="fu">시험</span>(pas_rlog) [select,],</span>
<span id="cb23-4"><a aria-hidden="true" href="#cb23-4" tabindex="-1"></a>     <span class="at">스케일 =</span> <span class="st">"열"</span>,,,</span>
<span id="cb23-5"><a aria-hidden="true" href="#cb23-5" tabindex="-1"></a>     <span class="at">annotation_col =</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb23-6"><a aria-hidden="true" href="#cb23-6" tabindex="-1"></a>        <span class="fu">충돌</span>(pas_rlog) [,<span class="fu">기음</span>(<span class="st">"상태"</span>,,,<span class="st">"유형"</span>))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-figHeatmap-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-figHeatmap-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="08-chap_files/figure-html/fig-figHeatmap-1-1.png" title="Figure 8.7: Heatmap of regularized log transformed data of the top 30 genes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-figHeatmap-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-figHeatmap-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.7 : 상위 30 개의 유전자의 정규화 된 로그 변환 데이터의 열 맵.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="#fig-figHeatmap-1">수치<span>8.7</span></a>,,,<code>pheatmap</code>감독되지 않은 클러스터링에서 덴드로 그램으로 매트릭스의 행과 열을 배열하고 열 (샘플)의 클러스터링이 지배적입니다.<code>유형</code>요인. 이것은 위의 차등 발현 분석이 아마도 너무 순진했을 것이며, 우리는 조건 사이에서 차별적으로 발현 된 유전자에 대한 테스트에 관심이있을 때이 강력한 "nuisance"요소를 조정해야한다는 것을 강조합니다. 우리는 이것을 할 것입니다<a class="quarto-xref" href="#sec-countdata-pasillatwofac"><span>섹션 8.9</span></a>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>비슷한 줄거리를 생성합니다<a class="quarto-xref" href="#fig-figHeatmap-1">수치<span>8.7</span></a>그러나 대신 가장 가변적 인 30 개의 유전자를 선택합니다. 다른 것은 무엇입니까? 매우 높은 평균을 가진 유전자와 분산이 매우 높은 유전자는 어떻게 관련이 있습니까? 그들의 데이터는 어떻게 보입니까?</p>
</div>
</div>
</section>
<section class="level3" data-number="8.5.4" id="exporting-the-results">
<h3 class="anchored" data-anchor-id="exporting-the-results" data-number="8.5.4"><span class="header-section-number">8.5.4</span>결과 내보내기</h3>
<p>플롯 및 정렬 가능한/여과 가능한 열이있는 결과에 대한 HTML 보고서는<strong><a href="https://bioconductor.org/packages/ReportingTools/">보고서</a></strong>패키지 a<em>deseqdataset</em>그것은 처리되었습니다<code>Deseq</code>기능. 코드 예제는 참조하십시오<em>RNA-seq 차등 발현</em>vignette<strong><a href="https://bioconductor.org/packages/ReportingTools/">보고서</a></strong>패키지 또는 수동 페이지<code>게시</code>방법을위한 방법<em>deseqdataset</em>수업.</p>
<p>결과의 CSV 파일은<code>write.csv</code>(또는 그 상대<strong><a href="https://cran.r-project.org/web/packages/readr/">readr</a></strong>패키지).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(res),<span class="at">파일 =</span> <span class="st">"treated_vs_untreated.csv"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="8.6" id="sec-countdata-critique">
<h2 class="anchored" data-anchor-id="sec-countdata-critique" data-number="8.6"><span class="header-section-number">8.6</span>기본 선택 및 가능한 수정에 대한 비판</h2>
<section class="level3 page-columns page-full" data-number="8.6.1" id="the-few-changes-assumption">
<h3 class="anchored" data-anchor-id="the-few-changes-assumption" data-number="8.6.1"><span class="header-section-number">8.6.1</span>몇 가지 변화 가정</h3>
<p>기본 정규화 및 분산 추정의 기본<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>(그리고 다른 많은 다른 미분 발현 방법)는 대부분의 유전자가 차별적으로 발현되지 않는다는 것입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="imgs/devil.png" title="For the normalization, although not for the dispersion estimation, one can slightly relax this assumption: it is still valid if many genes are changing, but in a way that is balanced between up- and downward directions."><img alt="For the normalization, although not for the dispersion estimation, one can slightly relax this assumption: it is still valid if many genes are changing, but in a way that is balanced between up- and downward directions." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>정규화의 경우, 분산 추정은 아니지만,이 가정을 약간 이완시킬 수 있습니다. 많은 유전자가 변화하는 경우에도 여전히 유효하지만 상향 및 하향 방향 사이에서 균형을 이루는 방식으로 여전히 유효합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 가정은 종종 합리적입니다 (잘 설계된 실험은 일반적으로 구체적인 질문을하므로 모든 것이 한 번에 모두 변경되지는 않습니다). 그러나 그것이 유지되지 않으면 어떻게해야합니까? 그런 다음 모든 유전자의 데이터에 이러한 작업을 적용하는 대신, 이전의 생물학적 지식으로 인해 또는 외부 "스파이크 된"기능으로 풍부함을 명시 적으로 통제하기 때문에 가정이 어렵다고 생각하는 ( "부정적인 대조군") 유전자의 하위 집합을 식별해야합니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>실행<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>크기 요인 및 분산 파라미터가있는 워크 플로는 미리 정의 된 유전자의 서브 세트에서만 추정됩니다.</p>
</div>
</div>
</section>
<section class="level3" data-number="8.6.2" id="point-like-null-hypothesis">
<h3 class="anchored" data-anchor-id="point-like-null-hypothesis" data-number="8.6.2"><span class="header-section-number">8.6.2</span>점과 같은 귀무 가설</h3>
<p>기본값으로<code>Deseq</code>각 유전자가 조건에 걸쳐 동일한 풍부함을 가지고 있다는 귀무 가설에 대한 기능 테스트; 이것은 간단하고 실용적인 선택입니다. 실제로, 샘플 크기가 제한되어 있다면, 통계적으로 유의 한 것은 생물학적으로 흥미로울 정도로 강한 경향이있다. 그러나 표본 크기가 증가함에 따라,이 시험에서 통계적 유의성은 생물학적으로 많은 관련성없이 존재할 수있다. 예를 들어, 많은 유전자가 하류의 간접 효과에 의해 약간 교란 될 수 있습니다. 보다 허용적이고 간격 기반 귀무 가설을 사용하도록 테스트를 수정할 수 있습니다. 우리는 이것을 더 탐구 할 것입니다<a class="quarto-xref" href="#sec-countdata-bandedtests"><span>섹션 8.10.4</span></a>.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="8.7" id="sec-countdata-multifactor">
<h2 class="anchored" data-anchor-id="sec-countdata-multifactor" data-number="8.7"><span class="header-section-number">8.7</span>다중 인자 디자인 및 선형 모델</h2>
<section class="level3 page-columns page-full" data-number="8.7.1" id="sec-countdata-lm">
<h3 class="anchored" data-anchor-id="sec-countdata-lm" data-number="8.7.1"><span class="header-section-number">8.7.1</span>다 인성 디자인이란 무엇입니까?</h3>
<p>Pasilla 유전자의 siRNA 녹다운 외에도 특정 약물의 효과를 테스트하고자한다고 가정 해 봅시다. 그런 다음 실험자가 세포를 음성 대조군, 파실라에 대한 siRNA, 약물 또는 둘 다로 처리하는 실험을 구상 할 수있었습니다. 이 실험을 분석하기 위해 표기법을 사용할 수 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-basiclm"><span class="math display">\ [
y = \ beta_0 + x_1 \ beta_1 + x_2 \ beta_2 + x_1x_2 \ beta_ {12}.
\ tag {8.1} \]</span></span></p>
<p>이 방정식은 다음과 같이 구문 분석 할 수 있습니다. 왼쪽,<span class="math inline" data-anchor-id="eq-countdata">\(와이\)</span>, 관심의 실험 측정입니다. 우리의 경우, 이것은 적절하게 변형 된 발현 수준입니다 (우리는 이것을 논의 할 것입니다.<a class="quarto-xref" href="#sec-countdata-glmdeseq2"><span>섹션 8.8.3</span></a>유전자의). RNA-Seq 실험에는 많은 유전자가 있기 때문에 많은 사본이 있습니다.<a class="quarto-xref" href="#eq-countdata-basiclm">방정식<span>8.1</span></a>, 각각 하나. 계수<span class="math inline">\ (\ beta_0 \)</span>음성 대조군에서 측정의 기본 수준이다. 종종 그것을라고합니다<strong>인터셉트</strong>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="imgs/devil.png" title="Sometimes Equation eq-countdata-basiclm is written with an additional term x_0 that is multiplied with \beta_0, where it is understood that x_0=1 always. It turns out that this makes subsequent notation and bookkeeping easier since then the intercept can be handled consistently together with the other \betas, instead of being a separate case."><img alt="Sometimes Equation eq-countdata-basiclm is written with an additional term x_0 that is multiplied with \beta_0, where it is understood that x_0=1 always. It turns out that this makes subsequent notation and bookkeeping easier since then the intercept can be handled consistently together with the other \betas, instead of being a separate case." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>때때로<a class="quarto-xref" href="#eq-countdata-basiclm">방정식<span>8.1</span></a>추가 용어로 작성됩니다<span class="math inline">\ (x_0 \)</span>그것은 곱합니다<span class="math inline">\ (\ beta_0 \)</span>, 그것이 이해되는 곳<span class="math inline">\ (x_0 = 1 \)</span>언제나. 이것은 후속 표기법과 부기가 더 쉬워 지므로 인터셉트는 다른 사람과 함께 일관되게 처리 될 수 있습니다.<span class="math inline">\(\베타\)</span>S, 별도의 사례 대신.</figcaption>
</figure>
</div>
</div></div></div>
<p>설계 요소<span class="math inline" data-anchor-id="eq-countdata">\ (x_1 \)</span>그리고<span class="math inline">\ (x_2 \)</span>이진 지표 변수입니다.<span class="math inline">\ (x_1 \)</span>siRNA가 형질 감염된 경우 값 1을 취하고 그렇지 않은 경우 0, 그리고 마찬가지로,<span class="math inline">\ (x_2 \)</span>약물이 투여되었는지 여부를 나타냅니다. siRNA 만 사용되는 실험에서<span class="math inline">\ (x_1 = 1 \)</span>그리고<span class="math inline">\ (x_2 = 0 \)</span>, 세 번째와 네 번째 용어<a class="quarto-xref" href="#eq-countdata-basiclm">방정식<span>8.1</span></a>사라지다. 그런 다음 방정식이 단순화됩니다<span class="math inline">\ (y = \ beta_0+\ beta_1 \)</span>. 이것은 그것을 의미합니다<span class="math inline">\ (\ beta_1 \)</span>치료와 대조군의 차이를 나타냅니다. 우리의 측정이 로그 척도에 있다면</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-examplebeta1"><span class="math display">\ [
\ 시작 {align}
\ beta_1 = y- \ beta_0
&amp; = \ log_2 (\ text {expression} _ {\ text {treated}})
-\ log_2 (\ text {expression} _ {\ text {undreated}}) \\
&amp; = \ log_2 \ frac
{\ text {expression} _ {\ text {treated}}}
{\ text {expression} _ {\ text {undreated}}}
\ end {align}
\ tag {8.2} \]</span></span></p>
<p>siRNA 로의 치료로 인한 로그 폴드 변화입니다. 정확히 같은 방식으로<span class="math inline" data-anchor-id="eq-countdata">\ (\ beta_2 \)</span>약물 치료로 인한 로그 폴드 변화입니다. 세포를 siRNA 및 약물로 처리하면 어떻게됩니까? 이 경우<span class="math inline">\ (x_1 = x_2 = 1 \)</span>, 그리고<a class="quarto-xref" href="#eq-countdata-basiclm">방정식<span>8.1</span></a>다시 작성할 수 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-exampleinteract"><span class="math display">\ [
\ beta_ {12} = y- (\ beta_0 + \ beta_1 + \ beta_2).
\ tag {8.3} \]</span></span></p>
<p>이것은 그것을 의미합니다<span class="math inline">\ (\ beta_ {12} \)</span>관찰 된 결과의 차이는<span class="math inline">\(와이\)</span>및 기준선에 siRNA 단독의 효과를 추가함으로써 얻은 개별 치료에서 예상되는 결과,<span class="math inline">\ (\ beta_1 \)</span>, 그리고 약물만으로,<span class="math inline">\ (\ beta_2 \)</span>.</p>
<p>우리는 전화합니다<span class="math inline">\ (\ beta_ {12} \)</span>그만큼<em>상호 작용</em>siRNA 및 약물의 효과. 물리적 상호 작용과는 아무런 관련이 없으며, 용어는이 두 가지 다른 실험 요소의 효과가 단순히 추가되는 것이 아니라 더 복잡한 방식으로 결합된다는 것을 나타냅니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="imgs/devil.png" title="Note that the addition is on the logarithmic scale, which corresponds to multiplication on the original scale."><img alt="Note that the addition is on the logarithmic scale, which corresponds to multiplication on the original scale." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>추가는 로그 척도에 있으며, 이는 원래 척도의 곱셈에 해당합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>예를 들어, 약물과 siRNA의 표적이 동등하여 세포에 동일한 영향을 미치면 생물학적으로<span class="math inline">\ (\ beta_1 = \ beta_2 \)</span>. 우리는 또한 그들의 조합이 더 이상 영향을 미치지 않을 것으로 기대합니다.<span class="math inline">\ (\ beta_ {12} =-\ beta_1 \)</span>. 반면에 약물과 siRNA의 표적이 서로 완충 할 수있는 병렬 경로에 있다면<span class="math inline">\ (\ beta_1 \)</span>그리고<span class="math inline">\ (\ beta_2 \)</span>둘 다 상대적으로 작지만 결합 된 효과는 상승적이며<span class="math inline">\ (\ beta_ {12} \)</span>크다.</p>
<p>우리가 항상 상호 작용에 관심이있는 것은 아닙니다. 많은 실험은 각각의 개별 효과에 대해 가장 잘 관리하는 여러 요인으로 설계되었습니다. 이 경우 조합 처리는 실험 설계에 존재하지 않을 수 있으며 분석에 사용할 모델은 다음과 같습니다.<a class="quarto-xref" href="#eq-countdata-basiclm">방정식<span>8.1</span></a>가장 오른쪽 용어가 제거되었습니다.</p>
<p>실험의 설계를 간결하게 인코딩 할 수 있습니다.<em>디자인 매트릭스</em>. 예를 들어, 위에서 설명한 조합 실험의 경우 설계 매트릭스는 다음과 같습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-designmatrix"><span class="math display">\ [
\ begin {array} {c | c | c} x_0 &amp; x_1 &amp; x_2 \\
\ hline
1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 \\
1 &amp; 1 &amp; 1 \ end {array}
\ tag {8.4} \]</span></span></p>
<p>설계 매트릭스의 열은 실험 요소에 해당하며 그 행은 우리의 경우 4 개 실험 조건을 나타냅니다. 대신 조합 처리가 수행되지 않으면 설계 매트릭스는 처음 세 행으로 만 줄어 듭니다.<a class="quarto-xref" href="#eq-countdata-designmatrix"><span>8.4</span></a>.</p>
</section>
<section class="level3 page-columns page-full" data-number="8.7.2" id="what-about-noise-and-replicates">
<h3 class="anchored" data-anchor-id="what-about-noise-and-replicates" data-number="8.7.2"><span class="header-section-number">8.7.2</span>소음과 복제는 어떻습니까?</h3>
<p><a class="quarto-xref" href="#eq-countdata-basiclm">방정식<span>8.1</span></a>관측 된 데이터의 개념적 분해를 다른 실험 변수에 의해 야기하는 효과로 제공됩니다. 우리의 데이터 인 경우 (<span class="math inline">\(와이\)</span>s) 절대적으로 정확했고, 우리는 선형 방정식 시스템을 설정할 수 있으며,<span class="math inline">\(엑스\)</span>s, 그리고 해결<span class="math inline">\(\베타\)</span>에스.</p>
<p>물론, 우리는 일반적으로 소음의 영향을받는 실제 데이터를 분석하고자합니다. 그런 다음 소음 수준을 추정하고 추정의 불확실성을 평가하려면 복제가 필요합니다.<span class="math inline">\(\베타\)</span>에스. 그래야만 우리는 조건 사이의 관찰 된 변화가 실험적이거나 자연적인 변화로 인해 발생하는 것보다 상당히 큰지를 경험적으로 평가할 수 있습니다. 방정식을 약간 연장해야합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-lmwithnoise"><span class="math display">\ [
y_ {j} = x_ {j0} \; \ beta_0 + x_ {j1} \; \ beta_1 + x_ {j2} \; \ beta_2 + x_ {j1} \, x_ {j2} \; \ beta_ {12} + \ varepsilon_j.
\ tag {8.5} \]</span></span></p>
<p>인덱스를 추가했습니다<span class="math inline">\ (J \)</span>그리고 새로운 용어<span class="math inline">\ (\ varepsilon_j \)</span>. 색인<span class="math inline">\ (J \)</span>이제 우리의 개별 복제 실험을 명시 적으로 계산합니다. 예를 들어, 네 가지 조건 각각에 대해 세 번의 복제를 수행하면<span class="math inline">\ (J \)</span>1에서 12까지의 계산. 설계 매트릭스는 이제 12 행을 가지고 있으며<span class="math inline">\ (x_ {jk} \)</span>매트릭스의 값입니다<span class="math inline">\ (J \)</span>ROW와<span class="math inline">\(케이\)</span>Th 칼럼.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="imgs/devil.png" title="Remember that since \beta_0 is the intercept, x_{j0}=1 for all j."><img alt="Remember that since \beta_0 is the intercept, x_{j0}=1 for all j." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>그 이후로 기억하십시오<span class="math inline">\ (\ beta_0 \)</span>절편,<span class="math inline">\ (x_ {j0} = 1 \)</span>모두를 위해<span class="math inline">\ (J \)</span>.</figcaption>
</figure>
</div>
</div></div></div>
<p>추가 용어<span class="math inline" data-anchor-id="eq-countdata">\ (\ varepsilon_j \)</span>, 우리가 부르는<strong>잔차</strong>, 복제물 사이의 차이를 흡수 할 수 있습니다. 그러나 하나의 추가 모델링 구성 요소가 필요합니다. 12 개의 방정식 시스템<a class="quarto-xref" href="#eq-countdata-lmwithnoise"><span>8.5</span></a>이제는 방정식 (12 개, 각각 1 개, 하나는 하나씩)보다 더 많은 변수 (12 개의 엡실론 및 4 개의 베타)가 있기 때문에 더 많은 정보없이 소외됩니다.<span class="math inline">\ (J \)</span>). 이것을 고치려면 우리는 그것을 요구합니다<span class="math inline">\ (\ varepsilon_j \)</span>작습니다. 우리는 다른 사람들을 만나게 될 것입니다 - 이것을 극복하기 위해서는 제곱 잔차의 합을 최소화하는 것입니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-lss"><span class="math display">\ [
\ sum_j \ varepsilon_j^2 \ quad \ to \ quad \ text {min}.
\ tag {8.6} \]</span></span></p>
<p>이 요구 사항이 만족되면<span class="math inline">\(\베타\)</span>s를 대표한다<em>평균</em>각 실험 요소의 영향, 잔차는<span class="math inline">\ (\ varepsilon_j \)</span>복제물 사이의 평균 주위의 실험적 변동을 반영합니다. 이 접근법은<strong>제곱 피팅의 최소 합</strong>, 간단한 매트릭스 대수로 달성 할 수 있기 때문에 수학적으로 편리합니다. R 기능입니다<code>LM</code>하다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-moregeneral">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.5</div>
</div>
<div class="callout-body-container callout-body">
<p>대안적인 글을 쓰는 방법<a class="quarto-xref" href="#eq-countdata-lmwithnoise">방정식<span>8.5</span></a>~이다</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-generalizedlmwithnoise"><span class="math display">\ [
y_ {j} = \ sum_k x_ {jk} \; \ beta_k + \ varepsilon_j.
\ tag {8.7} \]</span></span></p>
<p>어떻게 매핑 할 수 있습니까?<a class="quarto-xref" href="#eq-countdata-lmwithnoise">방정식<span>8.5</span></a>, 즉, 상호 작용 용어는 무엇입니까?<span class="math inline">\ (x_ {j1} \, x_ {j2} \; \ beta_ {12} \)</span>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-12-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-12-contents callout-collapse collapse" id="callout-12">
<div class="callout-body-container callout-body">
<p>이것은 정말로 단지 사소한 표기법입니다. 합계가 연장됩니다.<span class="math inline" data-anchor-id="eq-countdata">\ (k = 0, ..., 3 \)</span>, 용어<span class="math inline">\ (k = 0,1,2 \)</span>우리가 이미 알고있는 것과 정확히 같습니다. 우리는 글을 씁니다<span class="math inline">\ (\ beta_ {3} \)</span>대신<span class="math inline">\ (\ beta_ {12} \)</span>, 그리고<span class="math inline">\ (x_ {j3} \)</span>정의됩니다<span class="math inline">\ (x_ {j1} x_ {j2} \)</span>. 일반적인 표기법<a class="quarto-xref" href="#eq-countdata-generalizedlmwithnoise"><span>8.7</span></a>선형 모델과 수학적 증거를 구현하는 컴퓨터 소프트웨어에서 사용하는 것이 실용적입니다. 또한 선형 모델의 "과학적 내용"이 설계 매트릭스에 응축되어 있음을 강조합니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>우리가 적합하다면 그것을 보여주십시오<a class="quarto-xref" href="#eq-countdata-lmwithnoise">방정식<span class="anchored-eq" data-anchor-id="eq-countdata">8.5</span></a>그러한 목표에 대한 데이터에<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>적합 잔차<span class="math inline">(\ Hat {\ varepsilon} _j \)</span>평균 0이 있습니다.</p>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="8.7.3" id="analysis-of-variance">
<h3 class="anchored" data-anchor-id="analysis-of-variance" data-number="8.7.3"><span class="header-section-number">8.7.3</span>분산 분석</h3>
<p>같은 모델<a class="quarto-xref" href="#eq-countdata-lmwithnoise"><span class="anchored-eq" data-anchor-id="eq-countdata">8.5</span></a>a<strong>선형 모델</strong>그리고 종종 그 기준이 암시됩니다<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>데이터에 맞는 데 사용됩니다. 이 접근법은 우아하고 강력하지만 초보자의 경우 모든면을 인정하는 데 약간의 시간이 걸릴 수 있습니다. 각각의 별개의 실험 조건에 대해 단순히 간단하게 복제 한 평균을 복제하고 조건에서 이러한 값을 비교하는 것보다 단순히 장점은 무엇입니까? 간단한 경우, 후자의 접근법은 직관적이고 효과적 일 수 있습니다. 그러나 복제 숫자가 다른 그룹에서 모두 동일하지 않거나 하나 이상의<span class="math inline">\(엑스\)</span>-변수는 연속 값입니다. 이 경우, 하나는 항상 피팅과 같은 것으로 끝날 것입니다.<a class="quarto-xref" href="#eq-countdata-lmwithnoise"><span>8.5</span></a>데이터에. 생각하는 유용한 방법<a class="quarto-xref" href="#eq-countdata-lmwithnoise"><span>8.5</span></a>용어에 포함되어 있습니다<strong>분산 분석</strong>, 약식 ANOVA. 사실, 뭐<a class="quarto-xref" href="#eq-countdata-lmwithnoise">방정식<span>8.5</span></a>변동성을 분해합니다<span class="math inline">\(와이\)</span>실험 과정에서 기본 구성 요소에 대한 실험에서 관찰 한 것 : 기준 가치<span class="math inline">\ (\ beta_0 \)</span>, 첫 번째 변수의 효과로 인한 변동성,<span class="math inline">\ (\ beta_1 \)</span>, 두 번째 변수의 효과로 인한 변동성,<span class="math inline">\ (\ beta_2 \)</span>, 상호 작용의 영향으로 인한 변동성,<span class="math inline">\ (\ beta_ {12} \)</span>, 그리고 비정상적인 변동성. 마지막으로 우리는 일반적으로 전화합니다<em>소음</em>, 다른 것들,<em>체계적인 변동성</em>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="imgs/devil.png" title="The distinction between noise and systematic variability is in the eye of the beholder, and depends on our model, not on reality."><img alt="The distinction between noise and systematic variability is in the eye of the beholder, and depends on our model, not on reality." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>소음과 체계적인 변동성의 구별은 보는 사람의 눈에 있으며 현실이 아닌 우리 모델에 달려 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level3 page-columns page-full" data-number="8.7.4" id="robustness">
<h3 class="anchored" data-anchor-id="robustness" data-number="8.7.4"><span class="header-section-number">8.7.4</span>견고성</h3>
<p>합<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>데이터의 특이 치에 민감합니다. 단일 측정<span class="math inline">\ (y_ {j} \)</span>외곽 가치를 가진 것은 다음을 그릴 수 있습니다<span class="math inline">\(\베타\)</span>다른 복제물이 암시 한 값에서 멀리 떨어진 추정. 이것은 제곱의 최소 합을 기반으로 한 방법이 낮다는 잘 알려진 사실입니다.<strong>고장 지점</strong>: 단일 데이터 포인트 만 외곽에 있더라도 전체 통계 결과에 크게 영향을 줄 수 있습니다. 예를 들어, 세트의 평균입니다<span class="math inline">\(N\)</span>숫자는 고장 지점이 있습니다<span class="math inline">\ (\ frac {1} {n} \)</span>, 숫자 중 하나만 변경하여 임의로 변경 될 수 있음을 의미합니다. 반면에, 중앙값은 훨씬 높은 고장 지점을 갖습니다. 단일 숫자를 변경하면 종종 전혀 영향을 미치지 않으며, 그렇다면 효과는 순위 중간에있는 데이터 포인트의 범위로 제한됩니다 (즉, 순위에 인접한 것<span class="math inline">\ (\ frac {n} {2} \)</span>). 중앙값을 임의로 많은 양으로 변경하려면 관찰의 절반을 변경해야합니다. 우리는 중앙값을 부릅니다<strong>건장한</strong>그리고 그 고장 지점은입니다<span class="math inline">\ (\ frac {1} {2} \)</span>. 숫자 세트의 중앙값을 기억하십시오<span class="math inline">\ (y_1, y_2, ... \)</span>합계를 최소화합니다<span class="math inline">\ (\ sum_j | y_j- \ beta_0 | \)</span>.</p>
<p>특이 치에 대한 더 높은 수준의 견고성을 달성하려면 사각형의 합계 이외의 다른 선택<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>최소화의 목표로 사용할 수 있습니다. 이 중에는 다음과 같습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-R"><span class="math display">\ [
\ 시작 {align}
r &amp; = \ sum_j | \ varepsilon_j |
  &amp; \ text {최소 절대 편차} \\
r &amp; = \ sum_j \ rho_s (\ varepsilon_j)
  &amp; \ text {m-estimation} \\
r &amp; = q _ {\ theta} \ left (\ {\ varepsilon_1^2, \ varepsilon_2^2, ... \} \ 오른쪽)
  &amp; \ text {lts, lqs} \\
r &amp; = \ sum_j w_j \ varepsilon_j^2
  &amp; \ text {일반 가중 회귀}
\ end {align}
\ tag {8.8} \]</span></span></p>
<p>여기,<span class="math inline" data-anchor-id="eq-countdata">\(아르 자형\)</span>최소화되는 수량입니다. 첫 번째 선택<a class="quarto-xref" href="#eq-countdata-R">방정식<span>8.8</span></a>호출됩니다<strong>최소 절대 편차</strong>회귀. 중앙값의 일반화로 볼 수 있습니다. 개념적으로 단순하고 첫눈에 매력적이지만 사각형의 합보다 최소화하기가 더 어렵고 데이터가 제한되어 있거나 모델에 맞지 않으면 안정적이고 효율적 일 수 있습니다.<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>. 두 번째 선택<a class="quarto-xref" href="#eq-countdata-R">방정식<span>8.8</span></a>, 또한<strong>m- 평가</strong>, 처벌 기능을 사용합니다<span class="math inline">\ (\ rho_s \)</span>(최소 제곱 회귀는 특별한 경우입니다<span class="math inline">\ (\ rho_s (\ varepsilon) = \ varepsilon^2 \)</span>) 제한된 범위의 2 차 기능처럼 보입니다.<span class="math inline">\ (\ varepsilon \)</span>그러나 절대 값을 위해 더 작은 경사면, 평평하거나 심지어 0으로 떨어진다.<span class="math inline">\ (| \ varepsilon | \)</span>스케일 매개 변수보다 큽니다<span class="math inline">\(에스\)</span>. 이것의 의도는 특이 치의 효과, 즉 큰 잔차가있는 데이터 포인트의 영향을 다운 웨이트 중 하나입니다.<span class="citation" data-cites="Huber:AMS:1964">(<a href="16-chap.html#ref-Huber:AMS:1964" role="doc-biblioref">허버 1964</a>))</span>. 선택<span class="math inline">\(에스\)</span>특이점이라고 불리는 것을 만들어야합니다. 요구 사항을 삭제할 수도 있습니다<span class="math inline">\ (\ rho_s \)</span>약 2 차 (2 차 파생물이 양수 인 한), 기능에 대한 다양한 선택<span class="math inline">\ (\ rho_s \)</span>문헌에서 제안되었습니다. 목표는 데이터가 모델에 적합한시기와 위치에 대한 추정기 바람직한 통계적 특성 (예 : 편향 및 효율성)을 제공하지만 그렇지 않은 데이터 포인트의 영향을 제한하거나 무효화하는 것입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>그만큼<a href="https://en.wikipedia.org/wiki/Least_absolute_deviations">위키 백과 기사</a>개요를 제공합니다.</p></div></div><div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-Huber">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.6</div>
</div>
<div class="callout-body-container callout-body">
<p>함수의 그래프를 플로팅하십시오<span class="math inline">\ (\ rho_s (\ varepsilon) \)</span>제안서<span class="citation" data-cites="Huber:AMS:1964">허버 (Huber)<a href="16-chap.html#ref-Huber:AMS:1964" role="doc-biblioref">1964</a>))</span>M- 평가자의 경우.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-15-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-15-contents callout-collapse collapse" id="callout-15">
<div class="callout-body-container callout-body">
<p>Huber의 논문은 75 페이지에 정의됩니다.</p>
<p><span class="math display">\ [
\ rho_s (\ varepsilon) = \ left \ {
  \ begin {array} {cc}
\ frac {1} {2} \ varepsilon^2, \ quad \ text {for} | \ varepsilon | &lt;s \\
s | \ varepsilon |-\ frac {1} {2} s^2, \ quad \ text {for} | \ varepsilon | \ ge s \\
  \ end {array}
\오른쪽.
\]</span></p>
<p>아래 코드에서 생성 된 그래프는 다음과 같습니다.<a class="quarto-xref" href="#fig-countdata-mestimator">수치<span>8.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a>Rho<span class="ot">=</span> <span class="cf">기능</span>(X, S)</span>
<span id="cb25-2"><a aria-hidden="true" href="#cb25-2" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">ABS</span>(엑스)<span class="sc">&lt;</span>s, x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>, s<span class="sc">*</span> <span class="fu">ABS</span>(엑스)<span class="sc">-</span>에스<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb25-3"><a aria-hidden="true" href="#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a aria-hidden="true" href="#cb25-4" tabindex="-1"></a>DF<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb25-5"><a aria-hidden="true" href="#cb25-5" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">서열</span>(<span class="sc">-</span><span class="dv">7</span>,,,<span class="dv">7</span>,,,<span class="at">length.out =</span> <span class="dv">100</span>),)</span>
<span id="cb25-6"><a aria-hidden="true" href="#cb25-6" tabindex="-1"></a>  <span class="at">포물선 =</span>엑스<span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>,,,</span>
<span id="cb25-7"><a aria-hidden="true" href="#cb25-7" tabindex="-1"></a>  <span class="at">Huber =</span> <span class="fu">Rho</span>(엑스,<span class="at">s =</span> <span class="dv">2</span>)))</span>
<span id="cb25-8"><a aria-hidden="true" href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a aria-hidden="true" href="#cb25-9" tabindex="-1"></a><span class="fu">ggplot</span>(reshape2<span class="sc">::</span><span class="fu">녹다</span>(df,<span class="at">id.vars =</span> <span class="st">"엑스"</span>),)</span>
<span id="cb25-10"><a aria-hidden="true" href="#cb25-10" tabindex="-1"></a>  <span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>값,<span class="at">col =</span>변하기 쉬운))<span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-mestimator">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-mestimator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="08-chap_files/figure-html/fig-countdata-mestimator-1.png" title="Figure 8.8: Graph of \rho_s(\varepsilon), for a choice of s=2."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-mestimator-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-mestimator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.8 : 그래프<span class="math inline">\ (\ rho_s (\ varepsilon) \)</span>, 선택을 위해<span class="math inline">\ (s = 2 \)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Choice Three in<a class="quarto-xref" href="#eq-countdata-R"><span>8.8</span></a>다른 방식으로 최소 제곱 방법을 일반화합니다. ~ 안에<strong>최소한의 사각형</strong>(LQS) 회귀, 제곱 잔차의 합계는 예를 들어 Quantile으로 대체됩니다.<span class="math inline">\ (Q_ {50} \)</span>, 중앙값 또는<span class="math inline">\ (Q_ {90} \)</span>, 90%-품위<span class="citation" data-cites="Rousseeuw:1987">(<a href="16-chap.html#ref-Rousseeuw:1987" role="doc-biblioref">Peter J. Rousseeuw 1987</a>))</span>. 그 변형에서<strong>사각형의 최소 요약</strong>(LTS) 회귀, 제곱 잔차의 합이 사용되지만 합은 모든 잔차에 따라 연장됩니다.<span class="math inline">\ (0 \ and \ leta \ le1 \)</span>가장 작은 잔차. 두 경우 모두 동기 부여는 외곽 데이터 포인트가 큰 잔차로 이어지고 드물면 양자 또는 트리밍 된 합에 영향을 미치지 않는다는 것입니다.</p>
<p>그러나 가격이 있습니다 : 최소한의 제곱 최적화는<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>간단한 선형 대수를 통해 수행 할 수 있으며, M- 평가, LQS 및 LTS 회귀 분석에는보다 복잡한 반복 최적화 알고리즘이 필요합니다.</p>
<p>최종 접근법<a class="quarto-xref" href="#eq-countdata-R"><span>8.8</span></a>특이 치가 더욱 복잡한 가중치를 나타냅니다. 그것은 우리가 어떤 무게를 결정하는 방법이 있다고 가정합니다<span class="math inline">\ (w_j \)</span>우리는 아마도 각 관찰, 아마도 다운 가중치 이상의 이상치를주고 싶습니다. 예를 들어,<a class="quarto-xref" href="#sec-countdata-dealingCooks"><span>섹션 8.10.3</span></a>, 우리는<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>추정 된 각 데이터의 레버리지가있는 패키지<span class="math inline">\(\베타\)</span>S는 Cook의 거리라는 측정 값을 사용하여 평가됩니다. 요리사의 거리는 너무 큰 것으로 간주되는 데이터의 경우 무게가<span class="math inline">\ (w_j \)</span>다른 데이터 포인트는 0으로 설정됩니다.<span class="math inline">\ (w_j = 1 \)</span>. 사실상 이것은 외곽 데이터 포인트가 폐기되고 일반적인 회귀가 다른 사람들에게 수행됨을 의미합니다. 가중치를 따라 가기위한 추가 계산 노력은 무시할 수 있으며 최적화는 여전히 선형 대수입니다.</p>
<p>이상적인 견고성에 대한 이러한 모든 접근 방식은 어느 정도의 주관성을 도입하고 충분한 복제에 의존합니다. 주관성은 다음을 수행 해야하는 매개 변수 선택에 의해 반영됩니다.<span class="math inline" data-anchor-id="eq-countdata">\(에스\)</span>~에<a class="quarto-xref" href="#eq-countdata-R"><span>8.8</span></a>(2),<span class="math inline">\ (\ theta \)</span>~에<a class="quarto-xref" href="#eq-countdata-R"><span>8.8</span></a>(3), 무게<a class="quarto-xref" href="#eq-countdata-R"><span>8.8</span></a>(4). 한 과학자의 특이 치는 다른 과학자의 이상일 수 있습니다. 다른 한편으로, 특이 치 제거는 조잡한 실험에 대한 치료법이 아니며 희망적인 사고에 대한 정당성은 없습니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>위의 강력한 회귀 방법의 구현을 위해 R 및 CRAN 패키지의 문서를 검색하십시오. 시작하기에 좋은 곳은<a href="https://cran.r-project.org/web/views/Robust.html">강력한 통계 방법에 대한 CRAN 작업보기</a>.</p>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="8.8" id="sec:glm">
<h2 class="anchored" data-anchor-id="sec:glm" data-number="8.8"><span class="header-section-number">8.8</span>일반화 된 선형 모델</h2>
<p>다음 응용 프로그램 예제로 진행하기 전에 두 가지 이론적 개념을 더 탐색해야합니다. 형태의 방정식<a class="quarto-xref" href="#eq-countdata-lmwithnoise"><span class="anchored-eq" data-anchor-id="eq-countdata">8.5</span></a>결과 변수의 예상 값을 모델링하고<span class="math inline">\(와이\)</span>, 설계 매트릭스의 선형 함수로서, 최소한의 제곱 기준에 따라 데이터에 적합합니다.<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>; 또는 강력한 변형. 우리는 이제 이러한 가정을 일반화하고 싶습니다.</p>
<section class="level3 page-columns page-full" data-number="8.8.1" id="modeling-the-data-on-a-transformed-scale">
<h3 class="anchored" data-anchor-id="modeling-the-data-on-a-transformed-scale" data-number="8.8.1"><span class="header-section-number">8.8.1</span>변환 된 규모로 데이터를 모델링합니다</h3>
<p>우리는 이미 우리가 얻은 척도가 아니라 일부 변환 후에 로그를 고려하는 것이 유익하다는 것을 이미 보았습니다. 이 아이디어는 상황에 따라 다른 변환이 유용하기 때문에 일반화 될 수 있습니다. 예를 들어, 선형 모델입니다<a class="quarto-xref" href="#eq-countdata-lmwithnoise"><span>8.5</span></a>예를 들어 간격 내에서 제한되는 결과를 모델링하는 데 직접적으로 유용하지 않을 것입니다.<span class="math inline">\ ([0,1] \)</span>질병 위험의 지표로서. 선형 모델에서는 값입니다<span class="math inline">\(와이\)</span>원칙적으로 전체 실제 축을 덮으십시오. 그러나 예를 들어 Sigmoid 함수로 오른손의 표현을 변환하면<span class="math inline">\ (f (y) = 1/(1+e^{-y}) \)</span>,이 기능의 범위<a class="footnote-ref" href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a>,는 0과 1 사이의 경계이며 그러한 결과를 모델링하는 데 사용될 수 있습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>이를 물류 함수라고합니다<span class="citation" data-cites="Verhulst:1845">(<a href="16-chap.html#ref-Verhulst:1845" role="doc-biblioref">Verhulst 1845</a>))</span>관련 회귀 모델이 호출됩니다<strong>로지스틱 회귀</strong>.</p></div></div></section>
<section class="level3 page-columns page-full" data-number="8.8.2" id="other-error-distributions">
<h3 class="anchored" data-anchor-id="other-error-distributions" data-number="8.8.2"><span class="header-section-number">8.8.2</span>다른 오류 분포</h3>
<p>다른 일반화는 최소화 기준을 고려합니다<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>. 실제로이 기준은 특정 확률 모델과<strong>최대 가능성</strong>원칙 (우리는 이미 이것을 만났습니다<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>). 이것을 보려면 확률 론적 모델을 고려하십시오</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-pnorm"><span class="math display">\ [
p (\ varepsilon_j) = \ frac {1} {\ sqrt {2 \ pi} \ sigma} \ exp \ left (-\ frac {\ varepsilon_j^2} {2 \ sigma^2} \ right),
\ tag {8.9} \]</span></span></p>
<p>즉, 우리는 잔차가 평균 0과 표준 편차를 가진 정규 분포를 따른다고 생각합니다.<span class="math inline">\ (\ sigma \)</span>. 그런 다음 좋은 모델 (즉, 좋은 세트에서 요구하는 것은 그럴듯합니다.<span class="math inline">\(\베타\)</span>s) 이러한 확률은 크다. 공식적으로</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-likelihood"><span class="math display">\ [
\ prod_j p (\ varepsilon_j) \ quad \ to \ quad \ text {max}.
\ tag {8.10} \]</span></span></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-mlls">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.7</div>
</div>
<div class="callout-body-container callout-body">
<p>가능성을 극대화한다는 것을 보여줍니다<a class="quarto-xref" href="#eq-countdata-likelihood"><span class="anchored-eq" data-anchor-id="eq-countdata">8.10</span></a>제곱 잔차의 합을 최소화하는 것과 같습니다<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-18-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-18-contents callout-collapse collapse" id="callout-18">
<div class="callout-body-container callout-body">
<p>끼워 넣다<a class="quarto-xref" href="#eq-countdata-pnorm"><span class="anchored-eq" data-anchor-id="eq-countdata">8.9</span></a>~ 안으로<a class="quarto-xref" href="#eq-countdata-likelihood"><span>8.10</span></a>로그를 가져 가십시오.</p>
</div>
</div>
</div>
<p>몇 가지 핵심 개념을 수정합시다 : 왼쪽<a class="quarto-xref" href="#eq-countdata-likelihood">방정식<span class="anchored-eq" data-anchor-id="eq-countdata">8.10</span></a>, 즉, 잔차 확률의 산물은 두 모델 매개 변수의 함수입니다.<span class="math inline">\ (\ beta_1, \ beta_2, ... \)</span>그리고 데이터<span class="math inline">\ (y_1, y_2, ... \)</span>; 전화하십시오<span class="math inline">\ (f (\ beta, y) \)</span>. 모델 매개 변수를 생각하면<span class="math inline">\(\베타\)</span>주어지고 고정 된대로 붕괴 된 기능<span class="math inline">\ (f (y) \)</span>단순히 데이터의 확률을 나타냅니다. 예를 들어 데이터를 시뮬레이션하는 데 사용할 수 있습니다. 반면에 데이터를 주어진대로 고려한다면<span class="math inline">\ (f (\ beta) \)</span>모델 매개 변수의 함수이며<em>있을 수 있는 일</em>. 두 번째보기는 우리가 최적화 할 때 취하는 것입니다.<a class="quarto-xref" href="#eq-countdata-lss"><span>8.6</span></a>(따라서<a class="quarto-xref" href="#eq-countdata-likelihood"><span>8.10</span></a>), 따라서<span class="math inline">\(\베타\)</span>이런 식으로 얻은 s는 불리는 것입니다<em>최대 불법 추정치</em>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="imgs/devil.png" title="It is good to remember that, while we can use the normal distribution as a convenient argument to motivate least sum of squares regression through the maximum likelihood principle, the data do not have to be distributed according to the normal for least sum of squares regression to provide a useful result. In fact, least sum of squares fitting often provides useful estimates for the \betas even when the data are non-normal, although that depends on the specific circumstances."><img alt="It is good to remember that, while we can use the normal distribution as a convenient argument to motivate least sum of squares regression through the maximum likelihood principle, the data do not have to be distributed according to the normal for least sum of squares regression to provide a useful result. In fact, least sum of squares fitting often provides useful estimates for the \betas even when the data are non-normal, although that depends on the specific circumstances." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>최대 가능성 원칙을 통해 최소한의 제곱 회귀를 동기를 부여하기 위해 정규 분포를 편리한 인수로 사용할 수 있지만, 유용한 결과를 제공하기 위해 최소한의 제곱 회귀에 대해 데이터를 분산시킬 필요는 없습니다. 실제로, 최소한의 제곱 피팅은 종종 유용한 추정치를 제공합니다.<span class="math inline">\(\베타\)</span>데이터가 정상이 아닌 경우에도 특정 상황에 따라 다릅니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리가 지금 만들 수있는 일반화는 다른 확률 론적 모델을 사용하는 것입니다. 우리는 대신 정상보다 다른 분포의 밀도를 사용할 수 있습니다.<a class="quarto-xref" href="#eq-countdata-pnorm">방정식<span>8.9</span></a>. 예를 들어, 카운트 데이터를 처리 할 수 ​​있으려면 Gamma-Poosson 분포를 사용합니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="8.8.3" id="sec-countdata-glmdeseq2">
<h3 class="anchored" data-anchor-id="sec-countdata-glmdeseq2" data-number="8.8.3"><span class="header-section-number">8.8.3</span>카운트 데이터에 대한 일반화 된 선형 모델</h3>
<p>차등 발현 분석<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>형식의 일반화 된 선형 모델을 사용합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-DESeq2-LM"><span class="math display">\ [[
\ 영국을 시작하십시오
k __ {ij} &amp; \ sim \ text {gp} (\ hex_ {ij}, \ alpha_i) \\
\ mu_ {ij} &amp; = s_j \, q_ {ij} \\
\ log_2 (q_ {ij}) &amp; = \ sum_k x_ {jk} \ beta_ {ik}.
\ england
\ tag {8.11} \]</span></span></p>
<!-- check with Wolfang and Susan if this is okay
{#eq-countdata-kij}
{#eq-countdata-muij}
{#eq-countdata-qij}-->
<p>이 단계를 단계별로 포장하겠습니다. 카운트<span class="math inline" data-anchor-id="eq-countdata">\ (k ___ xij} \)</span>유전자<span class="math inline">\(나\)</span>, 샘플<span class="math inline">\ (J \)</span>두 개의 매개 변수 인 Gamma-Pooisson (GP) 분포를 사용하여 모델링됩니다.<span class="math inline">\ (\ drink_ {free} \)</span>그리고 분산<span class="math inline">\ (\ alpha_i \)</span>. 기본적으로 분산은 각 유전자마다 다릅니다<span class="math inline">\(나\)</span>그러나 모든 샘플에서 동일하므로 색인이 없습니다.<span class="math inline">\ (J \)</span>. 두 번째 줄<a class="quarto-xref" href="#eq-countdata-DESeq2-LM">방정식<span>8.11</span></a>평균은 샘플 특이 적 크기 계수로 구성되어 있다고 말합니다.<span class="math inline">\ (s_j \)</span><a class="footnote-ref" href="#fn10" id="fnref10" role="doc-noteref"><sup>10</sup></a>그리고<span class="math inline">\ (e_ {ij} \)</span>, 유전자에 대한 단편의 실제 예상 농도에 비례합니다.<span class="math inline">\(나\)</span>샘플에서<span class="math inline">\ (J \)</span>. 의 가치<span class="math inline">\ (e_ {ij} \)</span>세 번째 줄의 선형 모델에 의해<em>링크 함수</em>,,,<span class="math inline">\ (\ log_2 \)</span>. 디자인 매트릭스<span class="math inline">\ ((x_ {jk}) \)</span>모든 유전자에 대해 동일합니다 (따라서 의존하지 않습니다.<span class="math inline">\(나\)</span>). 줄<span class="math inline">\ (J \)</span>샘플, 컬럼에 해당합니다<span class="math inline">\(케이\)</span>실험 요소에. 가장 간단한 경우, 쌍별 비교를 위해 설계 매트릭스에는 두 개의 열만이 있으며 그 중 하나는 1으로 채워진 모든 열이 있습니다 (<span class="math inline">\ (\ beta_0 \)</span>~의<a class="quarto-xref" href="#sec-countdata-lm"><span>섹션 8.7.1</span></a>) 및 샘플이 하나 또는 다른 그룹에 속하는지에 따라 0 또는 1을 포함하는 다른 하나. 계수<span class="math inline">\ (\ beta_ {i} \)</span>줘<span class="math inline">\ (\ log_2 \)</span>유전자의 변화<span class="math inline">\(나\)</span>설계 매트릭스의 각 열에 대해<span class="math inline">\(엑스\)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>모델은 샘플을 사용하도록 일반화 될 수 있습니다.<strong>그리고</strong>유전자 의존적 정규화 인자<span class="math inline">\ (s_ {ij} \)</span>. 이것은 문서에 설명되어 있습니다<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>패키지.</p></div></div></section>
</section>
<section class="level2 page-columns page-full" data-number="8.9" id="sec-countdata-pasillatwofac">
<h2 class="anchored" data-anchor-id="sec-countdata-pasillatwofac" data-number="8.9"><span class="header-section-number">8.9</span>파실라 데이터의 2 요인 분석</h2>
<p>우리가 이미 고려한 siRNA 로의 치료 외에<a class="quarto-xref" href="#sec-countdata-debasic"><span>섹션 8.5</span></a>,,<strong><a href="https://bioconductor.org/packages/pasilla/">패자</a></strong>데이터에는 또 다른 공변량이 있습니다.<code>유형</code>, 이는 수행 된 시퀀싱의 유형을 나타냅니다.</p>
<p>우리는 탐색 적 데이터 분석 (EDA) 플롯에서<a class="quarto-xref" href="#sec-countdata-explore"><span>섹션 8.5.3</span></a>후자는 데이터에 상당한 체계적인 영향을 미쳤다. 우리의 기본 분석<a class="quarto-xref" href="#sec-countdata-debasic"><span>섹션 8.5</span></a>이 설명을하지 않았지만 이제 그렇게 할 것입니다. 이를 통해 데이터의 차이가 치료에 기인하며 시퀀싱 유형에 따라 혼란스러워 지거나 마스킹되는보다 올바른 그림을 얻는 데 도움이됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a>Pasillatwofactor<span class="ot">=</span>패자</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a><span class="fu">설계</span>(Pasillatwofactor)<span class="ot">=</span> <span class="fu">공식</span>(<span class="sc">~</span>유형<span class="sc">+</span>상태)</span>
<span id="cb26-3"><a aria-hidden="true" href="#cb26-3" tabindex="-1"></a>Pasillatwofactor<span class="ot">=</span> <span class="fu">Deseq</span>(Pasillatwofactor)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>두 변수 중<code>유형</code>그리고<code>상태</code>, 주요 관심사 중 하나는입니다<code>상태</code>및에서<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>, 컨벤션은 공식의 끝에 그것을 넣는 것입니다. 이 컨벤션은 모델 피팅에 영향을 미치지 않지만 후속 결과보고 중 일부를 단순화하는 데 도움이됩니다. 다시, 우리는 그것을 사용하여 결과에 액세스합니다<code>결과</code>기능, 각 유전자의 통계와 함께 데이터 프레임을 반환합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a>res2<span class="ot">=</span> <span class="fu">결과</span>(Pasillatwofactor)</span>
<span id="cb27-2"><a aria-hidden="true" href="#cb27-2" tabindex="-1"></a><span class="fu">머리</span>(res2,<span class="at">n =</span> <span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Log2 Fold Change (MLE) : 처리 된 상태 대 처리되지 않은 상태 
Wald 테스트 P- 값 : 조건 처리 대 처리되지 않은 상태 
3 행과 6 개의 열이있는 데이터 프레임
             Basemean log2foldchange lfcse 통계 pvalue padj
            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
FBGN0000003 0.171569 0.6745518 3.871091 0.1742537 0.861666 NA
FBGN0000008 95.144079 -0.0406731 0.222215 -0.1830351 0.854770 0.951975
FBGN0000014 1.056572 -0.0849880 2.111821 -0.0402439 0.967899 NA</code></pre>
</div>
</div>
<p>검색하는 것도 가능합니다<span class="math inline">\ (\ log_2 \)</span>접기 변화, p- 값 및 조정 된 p- 값과 관련된<code>유형</code>변하기 쉬운. 기능<code>결과</code>논쟁을 취합니다<code>차이</code>이를 통해 사용자는 변수의 이름, 폴드 변경의 분자에 해당하는 레벨 및 폴드 변화의 분모에 해당하는 레벨을 지정할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a>레스트 타입<span class="ot">=</span> <span class="fu">결과</span>(Pasillatwofactor,</span>
<span id="cb29-2"><a aria-hidden="true" href="#cb29-2" tabindex="-1"></a>  <span class="at">대비 =</span> <span class="fu">기음</span>(<span class="st">"유형"</span>,,,<span class="st">"하나의"</span>,,,<span class="st">"페어링"</span>)))</span>
<span id="cb29-3"><a aria-hidden="true" href="#cb29-3" tabindex="-1"></a><span class="fu">머리</span>(Restype,<span class="at">n =</span> <span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Log2 Fold Change (MLE) : 단일 대 쌍을 입력하십시오 
Wald 테스트 p- 값 : 단일 대 쌍을 입력하십시오 
3 행과 6 개의 열이있는 데이터 프레임
             Basemean log2foldchange lfcse 통계 pvalue padj
            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
FBGN0000003 0.171569 -1.611546 3.871083 -0.416304 0.677188 NA
FBGN0000008 95.144079 -0.262255 0.220686 -1.188362 0.234691 0.543822
FBGN0000014 1.056572 3.290586 2.087243 1.576522 0.114905 NA</code></pre>
</div>
</div>
<p>그래서 우리는이 분석에서 무엇을 얻었습니까?<code>유형</code>성가신 요인으로서 (때로는 더 정중하게,<em>차단 계수</em>), 두 그룹 간의 간단한 비교와 비교<a class="quarto-xref" href="#sec-countdata-debasic"><span>섹션 8.5</span></a>? 서로에 대한 두 분석에서 p- 값을 플로팅합시다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a>trsf<span class="ot">=</span> <span class="cf">기능</span>(엑스)<span class="fu">ifelse</span>(<span class="fu">is.na</span>(엑스),<span class="dv">0</span>, (<span class="sc">-</span><span class="fu">log10</span>(엑스))<span class="sc">^</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)))</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">pone =</span>해안<span class="sc">$</span>프 베일,</span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a>              <span class="at">ptwo =</span>res2<span class="sc">$</span>PValue),</span>
<span id="cb31-4"><a aria-hidden="true" href="#cb31-4" tabindex="-1"></a>    <span class="fu">AES</span>(<span class="at">x =</span> <span class="fu">trsf</span>(Pone),<span class="at">y =</span> <span class="fu">trsf</span>(ptwo)))<span class="sc">+</span></span>
<span id="cb31-5"><a aria-hidden="true" href="#cb31-5" tabindex="-1"></a>    <span class="fu">GEOM_HEX</span>(<span class="at">빈 =</span> <span class="dv">75</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a aria-hidden="true" href="#cb31-6" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"단일 요인 분석 (조건)"</span>))<span class="sc">+</span></span>
<span id="cb31-7"><a aria-hidden="true" href="#cb31-7" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"두 요인 분석 (유형 + 조건)"</span>))<span class="sc">+</span></span>
<span id="cb31-8"><a aria-hidden="true" href="#cb31-8" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">col =</span> <span class="st">"주황색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-scpres1res2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-scpres1res2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-21" href="08-chap_files/figure-html/fig-countdata-scpres1res2-1.png" title="Figure 8.9: Comparison of p-values from the models with a single factor (condition) and with two factors (type + condition). The axes correspond to (-\log_{10}p)^{\frac{1}{6}}, an arbitrarily chosen monotonically decreasing transformation that compresses the dynamic range of the p-values for the purpose of visualization. We can see a trend for the joint distribution to lie above the bisector, indicating that the small p-values in the two-factor analysis are generally smaller than those in the one-factor analysis."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-scpres1res2-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-scpres1res2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.9 : 단일 요인 (조건)과 두 가지 요소 (유형 + 조건)를 가진 모델의 p- 값 비교. 축은 다음과 같습니다<span class="math inline">\ ((-\ log_ {10} p)^{\ frac {1} {6}} \)</span>, 시각화를 목적으로 p- 값의 동적 범위를 압축하는 임의로 선택된 단조로 감소하는 변환. 우리는 관절 분포가 이등분기 위에있는 경향을 볼 수 있으며, 이는 2 요인 분석에서 작은 p- 값이 일반적으로 1 요인 분석에서보다 작음을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리가 볼 수 있듯이<a class="quarto-xref" href="#fig-countdata-scpres1res2">수치<span>8.9</span></a>, 2 요인 분석의 P- 값은 1 요인 분석의 P- 값과 유사하지만 일반적으로 더 작습니다. 보다 정교한 분석으로 인해 전력이 겸손 해졌음에도 불구하고 전력이 증가했습니다. 우리는 또한 각 경우에 특정 유의 임계 값을 전달하는 유전자의 수를 계산하여 이것을 볼 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a>비교<span class="ot">=</span> <span class="fu">테이블</span>(</span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a>   <span class="st">`</span><span class="at">간단한 분석</span><span class="st">`</span> <span class="ot">=</span>해안<span class="sc">$</span>padj<span class="sc">&lt;</span> <span class="fl">0.1</span>,,,</span>
<span id="cb32-3"><a aria-hidden="true" href="#cb32-3" tabindex="-1"></a>   <span class="st">`</span><span class="at">두 가지 요인</span><span class="st">`</span> <span class="ot">=</span>res2<span class="sc">$</span>padj<span class="sc">&lt;</span> <span class="fl">0.1</span>))</span>
<span id="cb32-4"><a aria-hidden="true" href="#cb32-4" tabindex="-1"></a><span class="fu">AddMargins</span>(비교)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>두 가지 요인
간단한 분석 허위 참 합
          False 6973 289 7262
          True 25 1036 1061
          합계 6998 1325 8323</code></pre>
</div>
</div>
<p>2 요인 분석은 1325 개의 유전자가 10%의 FDR 임계 값으로 차별적으로 발현 된 반면, 1 요인 분석은 1061을 발견했다. 2 요인 분석은 검출 전력을 증가시켰다. 일반적으로, 게인은 데이터에 따라 훨씬 더 크거나 더 작을 수 있습니다. 모델의 적절한 선택은 실험 설계 및 데이터 품질에 대한 정보를 적응해야합니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-gain">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.8</div>
</div>
<div class="callout-body-container callout-body">
<p><em>왜</em>우리가 고려하지 않을 때 더 적은 유전자를 감지합니까?<code>유형</code>변하기 쉬운? 보다 일반적으로, 이것은 차단 요소를 고려하거나 그렇지 않은 이점에 대해 무엇을 의미합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-20-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-20-contents callout-collapse collapse" id="callout-20">
<div class="callout-body-container callout-body">
<p>차단 계수를 모델링하지 않으면 데이터가 흡수되어야하는 데이터의 변동성이<span class="math inline">\ (\ varepsilon \)</span>에스. 이것은 일반적으로 차단 계수가있는 모델보다 크다는 것을 의미합니다. 소음 수준이 높을수록 불확실성이 높아집니다.<span class="math inline">\(\베타\)</span>-추정. 반면에, 차단 계수가있는 모델에는 더 많은 매개 변수를 추정해야합니다. 통계적 용도에서, 적합은 "자유도"가 적습니다. 이 두 가지 효과는 모두 대응하고 있으며 그 중 어느 것이 우세하며, 모델링 선택 중 어느 것이 더 많은 중요한 결과가 데이터에 따라 다릅니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-confounding">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.9</div>
</div>
<div class="callout-body-container callout-body">
<p>혼란스러운 것은 무엇입니까? 할 수 있다<em>~ 아니다</em>차단 계수를 고려하여<em>더</em>유전자?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-22-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-22-contents callout-collapse collapse" id="callout-22">
<div class="callout-body-container callout-body">
<p>예. 변수를 상상해보십시오<code>상태</code>그리고<code>유형</code>그들만큼 멋지게 균형을 잡지 않았지만 부분적으로 또는 완전히 혼란 스러웠습니다. 이 경우, 그로 인한 데이터의 차이<code>유형</code>그에 기인 할 수 있습니다<code>상태</code>모델이 맞는 경우<code>유형</code>-효과. 과학적으로, 그러한 실험 (및 분석)은 상당히 당황 스러울 수 있습니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-paired">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.10</div>
</div>
<div class="callout-body-container callout-body">
<p>약물 치료 유무에 관계없이 각각 10 개의 다른 세포주를 한 쌍의 실험 설계를 고려하십시오. 이것은 어떻게 분석해야합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-24-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-24-contents callout-collapse collapse" id="callout-24">
<div class="callout-body-container callout-body">
<p>우리가 방금 간단한 2 그룹 비교 (처리 대 치료 대 처리)를 수행했다면 많은 처리 효과가 아마도 세포주의 강력한 세포주에서 세포주 변이에 걸릴 것입니다. 그러나 우리는 a를 설정할 수 있습니다<em>페어링</em>단순히 셀 라인 동일성을 차단 계수로 추가하여 분석합니다. (셀 라인은 실제로 r입니다<em>요인</em>지금까지 본 변수와 마찬가지로 0 대 1 표시기 변수가 아닌 10 개의 다른 레벨을 사용합니다. R의 선형 모델링 시설 및 또한<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>, 그 문제를 다루는 데 아무런 문제가 없습니다.)</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-sva">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.11</div>
</div>
<div class="callout-body-container callout-body">
<p>데이터에 영향을 미치는 "숨겨진"요소가 있다고 의심되지만 문서화되지 않은 경우 어떻게해야합니까? (때로는 문서화되지 않은 공변량도 호출됩니다<strong>배치 효과</strong>.))</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-26-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-26-contents callout-collapse collapse" id="callout-26">
<div class="callout-body-container callout-body">
<p>감독되지 않은 방식으로 차단 요소를 식별하려고하는 방법이 있습니다.<span class="citation" data-cites="LeekStorey:2007 Stegle:2010">부추와 층<a href="16-chap.html#ref-LeekStorey:2007" role="doc-biblioref">2007</a>; <a href="16-chap.html#ref-Stegle:2010" role="doc-biblioref">스티칭 et al. 2010 년</a>))</span>.</p>
</div>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="8.10" id="further-statistical-concepts">
<h2 class="anchored" data-anchor-id="further-statistical-concepts" data-number="8.10"><span class="header-section-number">8.10</span>추가 통계 개념</h2>
<section class="level3 page-columns page-full" data-number="8.10.1" id="sec-countdata-sharingInformation">
<h3 class="anchored" data-anchor-id="sec-countdata-sharingInformation" data-number="8.10.1"><span class="header-section-number">8.10.1</span>유전자에 대한 분산 정보 공유</h3>
<p>우리는 이미 베이지안 (또는 경험적 베이 즈) 분석에 대한 설명을 보았습니다.<a class="quarto-xref" href="06-chap.html#fig-testing-sunexplode">수치<span class="anchored-eq" data-anchor-id="eq-countdata">6.16</span></a>. 아이디어는 추가 정보를 사용하여 추정치를 개선하는 것입니다 (선험적으로 알고 있거나 다른 데이터를 분석 한 정보). 이 아이디어는 데이터 자체가 비교적 시끄러운 경우 특히 유용합니다.<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>분산 매개 변수의 추정을 위해 경험적 베이 즈 접근법을 사용합니다 (<span class="math inline">\ (\ alpha \)</span>세 번째 줄에 s<a class="quarto-xref" href="#eq-countdata-DESeq2-LM">방정식<span>8.11</span></a>)) 및 선택적으로 로그 폴드 (The<span class="math inline">\(\베타\)</span>에스). 우선권은 두 경우 모두 모든 유전자에 걸친 최대 불법 추정치 (MLE)의 분포에서 가져온 것입니다. 이 두 분포는 모두 모달이라는 것이 밝혀졌습니다. 의 경우<span class="math inline">\(\베타\)</span>s, 약 0의 피크가있는 경우<span class="math inline">\ (\ alpha \)</span>, 특정 값에서 일반적인 분산. 경험적 베이 기계 기계는 경험적 사전 분포의 선명도와 ML 추정치의 정밀도에 의존하는 양으로 각각의 유전자 MLE를 해당 피크를 향해 줄입니다 (후자가 좋을수록 줄어들 수 있습니다). 수학은 설명되어 있습니다<span class="citation" data-cites="LoveDESeq2">(<a href="16-chap.html#ref-LoveDESeq2" role="doc-biblioref">Michael I. Love, Huber 및 Anders 2014</a>))</span>, 그리고<a class="quarto-xref" href="#fig-countdata-posterior">수치<span>8.10</span></a>접근 방식을 시각화합니다<span class="math inline">\(\베타\)</span>에스.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>고급 : 생성되는 R 코드를 점검하십시오<a class="quarto-xref" href="#fig-countdata-posterior">수치<span>8.10</span></a>.</p>
</div>
</div>
<div class="quarto-layout-panel page-columns page-full" id="fig-countdata-posterior">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-countdata-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-countdata-posterior" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-posterior-1" width="240">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-countdata-posterior-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-countdata-posterior" href="08-chap_files/figure-html/fig-countdata-posterior-1.png" title="Figure 8.10 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-countdata-posterior" id="fig-countdata-posterior-1" src="08-chap_files/figure-html/fig-countdata-posterior-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-countdata-posterior-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-countdata-posterior" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-posterior-2" width="240">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-countdata-posterior-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-countdata-posterior" href="08-chap_files/figure-html/fig-countdata-posterior-2.png" title="Figure 8.10 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-countdata-posterior" id="fig-countdata-posterior-2" src="08-chap_files/figure-html/fig-countdata-posterior-2.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-countdata-posterior-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.10 : 경험적 사전 IN을 사용하여 로그 폴드 변화 추정치의 수축 추정<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>. 비슷한 평균 수와 MLE 로그 폴드 변화를 가진 두 유전자는 녹색과 파란색으로 강조됩니다. 이들 유전자에 대한 정규화 된 수는 (A)는 유전자에 대한 유전자에 대한 유전자에 대한 유전자에 대한 낮은 분산을 나타낸다. (b)에서, 밀도 플롯은 녹색과 파란색 유전자에 대한 정규화 된 우도 (실선) 및 포스터 (점선)에 도시되어있다. 또한, 고체 검은 선은 모든 유전자의 MLE로부터 추정 된 사전을 보여준다. 녹색 유전자의 더 높은 분산으로 인해, 그 가능성은 더 넓고 덜 날카 롭고 (정보가 적음을 나타냅니다), 이전은 푸른 유전자의 경우보다 후부에 더 많은 영향을 미칩니다.</figcaption>
</figure>
</div>
</section>
<section class="level3 page-columns page-full" data-number="8.10.2" id="sec-countdata-rnaseq">
<h3 class="anchored" data-anchor-id="sec-countdata-rnaseq" data-number="8.10.2"><span class="header-section-number">8.10.2</span>데이터 변환 계산</h3>
<p>차등 표현을 테스트하기 위해 우리는 원시 카운트에서 작동하고 개별 분포를 사용합니다. 그러나 다른 다운 스트림 분석 (예 : 시각화 또는 클러스터링)의 경우 변환 된 버전의 카운트 데이터로 작동하는 것이 유용 할 수 있습니다.</p>
<p>아마도 가장 분명한 변환 ​​선택은 로그 일 것입니다. 그러나 유전자의 수 값은 0이 될 수 있으므로 일부는 사용을 옹호합니다.<strong>의사 량</strong>, 즉, 형태의 변환</p>
<p><span class="anchored-eq" data-anchor-id="eq-countdata" id="eq-countdata-shiftedlog"><span class="math display">\ [
y = \ log_2 (n + 1) \ quad \ mbox {또는 더 일반적으로} \ quad y = \ log_2 (n + n_0),
\ tag {8.12} \]</span></span></p>
<p>어디<span class="math inline">\(N\)</span>카운트 값을 나타냅니다<span class="math inline">\ (n_0 \)</span>어떻게 든 긍정적 인 상수입니다.</p>
<p>보다 이론적 인 정당화를 제공하는 두 가지 대안 접근법과<span class="math inline">\ (n_0 \)</span>위에. 한 방법은 샘플 차이에 대한 사전을 통합하고 다른 방법은 분산 안정화 변환의 개념을 사용합니다.</p>
<section class="level4 unnumbered page-columns page-full" id="sec-countdata-varstab">
<h4 class="unnumbered anchored" data-anchor-id="sec-countdata-varstab">분산 안정화 변환</h4>
<p>우리는 이미 탐구했습니다<strong>분산 안정화 변환</strong>~에<a class="quarto-xref" href="04-chap.html#sec-mixtures-vst"><span>섹션 4.4.4</span></a>. 그곳에서 우리는 이산의 임의 변수 세트에 대한 조각 별 선형 변환을 계산했습니다.<a class="quarto-xref" href="04-chap.html#fig-pcwlin-1">수치<span>4.26</span></a>) 또한 미적분학을 사용하여 감마-포이슨 혼합물에 대한 부드러운 분산 안정화 변환을 도출하는 방법을 보았다. 이러한 계산은에서 구현됩니다<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>패키지<span class="citation" data-cites="Anders:2010:GB">(<a href="16-chap.html#ref-Anders:2010:GB" role="doc-biblioref">Anders와 Huber 2010</a>))</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a>VSP<span class="ot">=</span> <span class="fu">변동성 이행 변환</span>(파실라)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>첫 번째 샘플을 예제로 사용하여 데이터에 미치는 영향을 살펴보고이를<span class="math inline">\ (\ log_2 \)</span>변환; 줄거리가 표시됩니다<a class="quarto-xref" href="#fig-countdata-plotvst">수치<span>8.11</span></a>다음과 함께 만들어집니다.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="containing missing values">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>J.<span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb35-3"><a aria-hidden="true" href="#cb35-3" tabindex="-1"></a>  <span class="fu">티블</span>(</span>
<span id="cb35-4"><a aria-hidden="true" href="#cb35-4" tabindex="-1"></a>    <span class="at">counts =</span> <span class="fu">대표</span>(<span class="fu">시험</span>(Pasilla) [, J],<span class="dv">2</span>),)</span>
<span id="cb35-5"><a aria-hidden="true" href="#cb35-5" tabindex="-1"></a>    <span class="at">변환 =</span> <span class="fu">기음</span>(</span>
<span id="cb35-6"><a aria-hidden="true" href="#cb35-6" tabindex="-1"></a>      <span class="fu">시험</span>(vsp) [, j],</span>
<span id="cb35-7"><a aria-hidden="true" href="#cb35-7" tabindex="-1"></a>      <span class="fu">로그 2</span>(<span class="fu">시험</span>(Pasilla) [, J])</span>
<span id="cb35-8"><a aria-hidden="true" href="#cb35-8" tabindex="-1"></a>),)</span>
<span id="cb35-9"><a aria-hidden="true" href="#cb35-9" tabindex="-1"></a>    <span class="at">변환 =</span> <span class="fu">대표</span>(<span class="fu">기음</span>(<span class="st">"VST"</span>,,,<span class="st">"log2"</span>),)<span class="at">각 =</span> <span class="fu">nrow</span>(파실라)))</span>
<span id="cb35-10"><a aria-hidden="true" href="#cb35-10" tabindex="-1"></a>),)</span>
<span id="cb35-11"><a aria-hidden="true" href="#cb35-11" tabindex="-1"></a>  <span class="fu">AES</span>(<span class="at">x =</span>카운트,<span class="at">y =</span>변형,<span class="at">col =</span>변환))<span class="sc">+</span></span>
<span id="cb35-12"><a aria-hidden="true" href="#cb35-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">600</span>)))<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">9</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-plotvst">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-plotvst-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-24" href="08-chap_files/figure-html/fig-countdata-plotvst-1.png" title="Figure 8.11: Graph of variance-stabilizing transformation for the data of one of the samples, and for comparison also of the \log_2 transformation. The variance-stabilizing transformation has finite values and finite slope even for counts close to zero, whereas the slope of \log_2 becomes very steep for small counts and is undefined for counts of zero. For large counts, the two transformation are essentially the same."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-plotvst-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-plotvst-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.11 : 샘플 중 하나의 데이터에 대한 분산 안정화 변환 그래프 및 비교도<span class="math inline">\ (\ log_2 \)</span>변환. 분산 안정화 변환은 제로에 가까운 카운트에 대해서도 유한 값과 유한 경사를 가지며, 경사는<span class="math inline">\ (\ log_2 \)</span>소규모 수는 매우 가파르고 0의 수는 정의되지 않습니다. 큰 수의 경우 두 개의 변환은 본질적으로 동일합니다.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level4 unnumbered" id="sec-countdata-rlog">
<h4 class="unnumbered anchored" data-anchor-id="sec-countdata-rlog">정규화 된 로그 (RLOG) 변환</h4>
<p>데이터 변환을 생각해내는 두 번째 방법이 있습니다. 그것은 개념적으로 분산 안정화와 구별됩니다. 대신, 우리가 이미 탐구 한 수축 추정을 기반으로합니다.<a class="quarto-xref" href="#sec-countdata-sharingInformation"><span class="anchored-eq" data-anchor-id="eq-countdata">섹션 8.10.1</span></a>. 원래 카운트 데이터를<span class="math inline">\ (\ log_2 \)</span>-"사소한"모델을 각 샘플마다 별도의 항과 데이터로부터 추정되는 계수에 대한 사전 분포로 장착하여 스케일. 피팅은 우리가 논의한 것과 동일한 정규화를 사용합니다.<a class="quarto-xref" href="#sec-countdata-sharingInformation"><span>섹션 8.10.1</span></a>. 변환 된 데이터<span class="math inline">\ (e_ {ij} \)</span>세 번째 줄로 정의됩니다<a class="quarto-xref" href="#eq-countdata-DESeq2-LM">방정식<span>8.11</span></a>, 디자인 매트릭스<span class="math inline">\ (\ left (x_ {jk} \ 오른쪽) \)</span>크기입니다<span class="math inline">\(케이
\ times (k+1) \)</span>- 여기<span class="math inline">\(케이\)</span>샘플의 수 - 형태가 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-axvyntzijgqh" id="eq-axvyntzijgqh"><span class="math display">\ [
x = \ left (\ begin {array} {ccccc} 1 &amp; 1 &amp; 0 &amp; 0 &amp; \ cdot \\ 1 &amp; 0 &amp; 1 &amp; 0 &amp; \ cdot \\ 1 &amp; 0 &amp; 0 &amp; 1 &amp; \ cdot &amp; \ cdot &amp; \ cdot &amp; \ cdot &amp; \ cdot \ end}
\ tag {8.13} \]</span></span></p>
<p>사전이 없으면이 설계 매트릭스는 비 유니 퀴크 솔루션으로 이어질 것이지만, 상호 상호가 아닌 경우 이전의 추가<span class="math inline">\(\베타\)</span>S는 고유 한 솔루션을 찾을 수 있습니다.</p>
<p>~ 안에<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>이 기능은 기능에서 구현됩니다<code>rlogtransformation</code>. 실제로 RLOG 변환은 대략 분산 안정화이지만 분산 안정화 변환과 대조적으로 밝혀졌습니다.<a class="quarto-xref" href="#sec-countdata-rnaseq"><span>섹션 8.10.2</span></a>다른 샘플의 크기 요인이 매우 뚜렷한 데이터를 더 잘 다룹니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-meandsPlot">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.12</div>
</div>
<div class="callout-body-container callout-body">
<p>이동 된 로그에 대한 복제 간의 표준 편차에 대한 플롯<a class="quarto-xref" href="#eq-countdata-shiftedlog"><span>8.12</span></a>, 정규화 된 로그 변환 및 분산 안정화 변환.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-29-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-29-contents callout-collapse collapse" id="callout-29">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-countdata-meansd">수치<span>8.12</span></a>.</p>
<div class="cell" data-layout-align="center" data-warning.known='["rows containing missing values","rows containing non-finite"]'>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"vsn"</span>))</span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a>RLP<span class="ot">=</span> <span class="fu">rlogtransformation</span>(파실라)</span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a>MSD<span class="ot">=</span> <span class="cf">기능</span>(엑스)</span>
<span id="cb36-5"><a aria-hidden="true" href="#cb36-5" tabindex="-1"></a>  <span class="fu">평균 DPLOT</span>(엑스,<span class="at">플롯 =</span> <span class="cn">거짓</span>))<span class="sc">$</span>GG<span class="sc">+</span> <span class="fu">맨 위</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb36-6"><a aria-hidden="true" href="#cb36-6" tabindex="-1"></a>     <span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span> <span class="st">"없음"</span>))</span>
<span id="cb36-7"><a aria-hidden="true" href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a aria-hidden="true" href="#cb36-8" tabindex="-1"></a>gridextra<span class="sc">::</span><span class="fu">Grid.arrange</span>(</span>
<span id="cb36-9"><a aria-hidden="true" href="#cb36-9" tabindex="-1"></a>  <span class="fu">MSD</span>(<span class="fu">로그 2</span>(<span class="fu">계산</span>(파실라,<span class="at">정규화 =</span> <span class="cn">진실</span>))<span class="sc">+</span> <span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb36-10"><a aria-hidden="true" href="#cb36-10" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"SD (log2)"</span>),)</span>
<span id="cb36-11"><a aria-hidden="true" href="#cb36-11" tabindex="-1"></a>  <span class="fu">MSD</span>(<span class="fu">시험</span>(VSP))<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"SD (VST)"</span>),)</span>
<span id="cb36-12"><a aria-hidden="true" href="#cb36-12" tabindex="-1"></a>  <span class="fu">MSD</span>(<span class="fu">시험</span>(RLP))<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"SD (rlog)"</span>),)</span>
<span id="cb36-13"><a aria-hidden="true" href="#cb36-13" tabindex="-1"></a>  <span class="at">NCOL =</span> <span class="dv">3</span></span>
<span id="cb36-14"><a aria-hidden="true" href="#cb36-14" tabindex="-1"></a>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-meansd">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-meansd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-25" href="08-chap_files/figure-html/fig-countdata-meansd-1.png" title="Figure 8.12: Per-gene standard deviation (sd, taken across samples) against the rank of the mean, for the shifted logarithm \log_2(n+1), the variance-stabilizing transformation (vst) and the rlog. Note that for the leftmost \approx 2,500 genes, the counts are all zero, and hence their standard deviation is zero. The mean-sd dependence becomes more interesting for genes with non-zero counts. Note also the high value of the standard deviation for genes that are weakly detected (but not with all zero counts) when the shifted logarithm is used, and compare to the relatively flat shape of the mean-sd relationship for the variance-stabilizing transformation."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-meansd-1.png" width="800"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-meansd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.12 : 변속 된 로그에 대한 평균 순위에 대한 유전자 당 표준 편차 (SD, 샘플을 가로 질러 찍음)<span class="math inline">\ (\ log_2 (n+1) \)</span>, 분산 안정화 변환 (VST) 및 RLOG. 가장 왼쪽에 대해서는 주목하십시오<span class="math inline">\ (\ rase \)</span>2,500 개의 유전자, 수는 모두 0이므로 표준 편차는 0입니다. 평균 SD 의존성은 0이 아닌 카운트가있는 유전자에 대해 더 흥미로워집니다. 또한 이동 된 로그가 사용될 때 약하게 감지 된 유전자에 대한 표준 편차의 높은 값 (모든 0 카운트가 아닌)의 높은 값을 주목하고, 분산 안정화 변환에 대한 평균 SD 관계의 비교적 평평한 형태와 비교하십시오.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section class="level3" data-number="8.10.3" id="sec-countdata-dealingCooks">
<h3 class="anchored" data-anchor-id="sec-countdata-dealingCooks" data-number="8.10.3"><span class="header-section-number">8.10.3</span>특이 치를 다루는 것</h3>
<p>데이터는 때때로 실험 또는 연구 설계와 관련이 없으며 특이 치로 간주 될 수있는 매우 큰 수의 고립 된 인스턴스를 포함합니다. 드문 기술 또는 실험적 유물을 포함하여 특이 치가 발생할 수있는 많은 이유가 있습니다. 유전자가 다른 샘플의 경우, 진정한 생물학적 사건의 경우 매핑 문제를 읽습니다. 대부분의 경우, 사용자는 일관된 행동을 나타내는 유전자에 주로 관심이있는 것처럼 보이며, 이것이 기본적으로 그러한 특이 치가 영향을받는 유전자가<code>Deseq</code>. 이 기능은 모든 유전자와 모든 샘플에 대해 불리지에 대한 진단 테스트를 계산합니다.<strong>쿡의 거리</strong><span class="citation" data-cites="Cook1977Detection">(<a href="16-chap.html#ref-Cook1977Detection" role="doc-biblioref">Cook 1977</a>))</span>. Cook의 거리는 단일 샘플이 유전자의 장착 계수에 영향을 미치는 양의 척도이며, Cook의 거리의 많은 값은 이상치 수를 나타 내기위한 것입니다.<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>쿡의 거리가 컷오프 이상으로 유전자를 자동으로 표시하고 p- 값과 조정 된 p- 값을 설정합니다.<code>NA</code>.</p>
<p>기본 컷오프는 추정 할 샘플 크기 및 매개 변수 수에 따라 다릅니다.<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>사용<span class="math inline">\ (99 \%\)</span>Quantile<span class="math inline">\ (f (p, m-p) \)</span>분포 (와 함께<span class="math inline">\(피\)</span>인터셉트를 포함한 매개 변수 수<span class="math inline">\(중\)</span>샘플 수).</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-countdata-dealingCooks">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 8.13</div>
</div>
<div class="callout-body-container callout-body">
<p>기본 컷오프가 어떻게 변경 될 수 있는지, 그리고 특이 치 제거 기능을 완전히 비활성화 할 수있는 방법을 확인하려면 문서를 확인하십시오. 계산 된 쿡의 거리에 어떻게 접근 할 수 있습니까?</p>
</div>
</div>
<p>많은 자유도의 경우, 즉 추정 할 매개 변수 수보다 많은 샘플이 있습니다. 데이터에 단일 카운트 이상의 특이점이 포함되어 있기 때문에 분석에서 전체 유전자를 제거하는 것이 바람직하지 않을 수 있습니다. 대체 전략은 해당 샘플의 크기 계수로 조정 된 모든 샘플의 트림 된 평균으로 특이 치수를 트림 된 평균으로 대체하는 것입니다. 이 접근법은 보수적입니다. 특이점 값을 귀무 가설에 의해 예측 된 값으로 대체하기 때문에 오 탐지로 이어지지 않을 것입니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="8.10.4" id="sec-countdata-bandedtests">
<h3 class="anchored" data-anchor-id="sec-countdata-bandedtests" data-number="8.10.4"><span class="header-section-number">8.10.4</span>테스트<span class="math inline">\ (\ log_2 \)</span>임계 값 위 또는 아래로 변경을 접습니다</h3>
<p>우리가 자란 지점으로 돌아가 봅시다<a class="quarto-xref" href="#sec-countdata-critique"><span>섹션 8.6</span></a>: 테스트를 구축하는 방법 통계적으로 유의하지만 매우 작은 것과는 달리 충분한 크기를 가진 효과를 감지하려는 요구 사항. 두 가지 논쟁<code>결과</code>함수 임계 값 기반 Wald 테스트를 허용합니다.<code>lfcthreshold</code>, 이는 음성 임계 값의 숫자를 취하고<code>ALLYPOTHESIS</code>테스트의 종류를 지정합니다. 다음 4 가지 값 중 하나를 취할 수 있습니다.<span class="math inline">\(\베타\)</span>입니다<span class="math inline">\ (\ log_2 \)</span>접기 변경<code>이름</code>논쟁, 그리고<span class="math inline">\ (\ theta \)</span>대표합니다<code>lfcthreshold</code>:</p>
<ul>
<li><p><code>보다 큰</code>: <span class="math inline">\ (\ beta&gt; \ theta \)</span></p></li>
<li><p><code>더 적은</code>: <span class="math inline">\ (\ beta &lt;(-\ theta) \)</span></p></li>
<li><p><code>더 큰 브</code>: <span class="math inline">\ (\ left | \ beta \ right |&gt; \ theta \)</span>(양측 테스트)</p></li>
<li><p><code>Lessabs</code>: <span class="math inline">\ (| \ beta | &lt;\ theta \)</span>(p- 값은 상단 및 하부 테스트의 최대 값입니다)</p></li>
</ul>
<p>이들은 다음 코드에서 시각적으로 입증되며 MA-Plots에서 시각적으로<a class="quarto-xref" href="#fig-countdata-lfcThresh">수치<span>8.13</span></a>. (<code>음모</code>에 정의 된 메소드<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>패키지, 기본 그래픽을 사용합니다.)</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="fu">평가</span>(<span class="at">mfrow =</span> <span class="fu">기음</span>(<span class="dv">4</span>,,,<span class="dv">1</span>),)<span class="at">mar =</span> <span class="fu">기음</span>(<span class="dv">2</span>,,,<span class="dv">2</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>)))</span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a>마이마<span class="ot">=</span> <span class="cf">기능</span>(H, V,<span class="at">theta =</span> <span class="fl">0.5</span>) {</span>
<span id="cb37-3"><a aria-hidden="true" href="#cb37-3" tabindex="-1"></a>  <span class="fu">음모</span>(파실라,<span class="at">lfcthreshold =</span>theta,<span class="at">althypothesis =</span>시간,</span>
<span id="cb37-4"><a aria-hidden="true" href="#cb37-4" tabindex="-1"></a>         <span class="at">어퍼 =</span> <span class="fu">기음</span>(<span class="sc">-</span><span class="fl">2.5</span>,,,<span class="fl">2.5</span>)))</span>
<span id="cb37-5"><a aria-hidden="true" href="#cb37-5" tabindex="-1"></a>  <span class="fu">Abline</span>(<span class="at">h =</span>다섯<span class="sc">*</span>theta,<span class="at">col =</span> <span class="st">"다저 블루"</span>,,,<span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb37-6"><a aria-hidden="true" href="#cb37-6" tabindex="-1"></a>}</span>
<span id="cb37-7"><a aria-hidden="true" href="#cb37-7" tabindex="-1"></a><span class="fu">마이마</span>(<span class="st">"그레이터 아브스"</span>,,,<span class="fu">기음</span>(<span class="sc">-</span><span class="dv">1</span>,,,<span class="dv">1</span>)))</span>
<span id="cb37-8"><a aria-hidden="true" href="#cb37-8" tabindex="-1"></a><span class="fu">마이마</span>(<span class="st">"Lessabs"</span>,,,<span class="fu">기음</span>(<span class="sc">-</span><span class="dv">1</span>,,,<span class="dv">1</span>)))</span>
<span id="cb37-9"><a aria-hidden="true" href="#cb37-9" tabindex="-1"></a><span class="fu">마이마</span>(<span class="st">"보다 큰"</span>,,,<span class="dv">1</span>))</span>
<span id="cb37-10"><a aria-hidden="true" href="#cb37-10" tabindex="-1"></a><span class="fu">마이마</span>(<span class="st">"더 적은"</span>,,,<span class="sc">-</span><span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-lfcThresh">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-lfcThresh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-26" href="08-chap_files/figure-html/fig-countdata-lfcThresh-1.png" title='Figure 8.13: MA-plots of tests of \log_2 fold change with respect to a threshold value. From top to bottom, the tests are for altHypothesis = "greaterAbs", "lessAbs", "greater", and "less".'><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-lfcThresh-1.png" width="216"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-lfcThresh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.13 : 테스트의 MA- 플롯<span class="math inline">\ (\ log_2 \)</span>임계 값과 관련하여 변화를 접습니다. 위에서 아래로 테스트가 있습니다<code>althypothesis = "Greaterabs"</code>,,,<code>"Lessabs"</code>,,,<code>"보다 큰"</code>, 그리고<code>"더 적은"</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>MA 플롯 대신 결과 테이블을 생성하려면<code>음모</code>(제외하고<code>맨 위</code>)가 제공됩니다<code>결과</code>기능.</p>
</section>
</section>
<section class="level2" data-number="8.11" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="8.11"><span class="header-section-number">8.11</span>이 장의 요약</h2>
<p>차동성 풍부도를 위해 고 처리량 시퀀싱 (및 Analagous Data Type)에서 카운트 테이블을 분석하는 방법을 보았습니다. 우리는 선형 모델의 강력하고 우아한 프레임 워크를 기반으로했습니다. 이 프레임 워크에서, 우리는 기본 2 그룹 비교와보다 복잡한 다 인성 설계를 분석하거나 2 개 이상의 수준을 갖거나 연속적인 공변량을 사용한 실험을 분석 할 수 있습니다. 일반적인 선형 모델에서, 예상 값 주변의 데이터의 샘플링 분포는 평균 및 동일한 차이로 독립적이고 정상인 것으로 가정합니다. 카운트 데이터의 경우, 분포는 개별적이며 동적 범위에 걸쳐 매우 다른 차이로 비대칭 (비대칭)이 경향이 있습니다. 따라서 우리는 일반화 된 선형 모델 (GLMS)이라는 일반 선형 모델의 일반화를 사용했으며 특히 데이터에서 추정하는 데 필요한 분산 매개 변수가있는 Gamma-Poisson 분산 데이터를 고려했습니다.</p>
<p>샘플링 깊이는 일반적으로 시퀀싱 실행 (복제)에 대해 일반적으로 다르 ​​므로이 변수 매개 변수의 효과를 추정하고 모델에서 고려해야합니다. 우리는 크기 요인을 통해 이것을했습니다<span class="math inline">\(시\)</span>. 종종 분석 의이 부분을 호출합니다<em>표준화</em>(이 용어는 특히 설명 적이지는 않지만 불행히도 이제는 문헌에 잘 정착되어 있습니다).</p>
<p>설계된 실험의 경우, 복제 수는 일반적으로 너무 작아서 각 유전자 단독에 대한 데이터로부터 분산 파라미터 (및 모델 계수)를 추정하기에는 너무 작다. 따라서 우리는 수축 또는 경험적 베이 에스 기술을 사용하여 비교적 적은 편견 비용에 대한 정밀도의 큰 이익을 약속합니다.</p>
<p>GLMS는 원래 규모로 데이터를 모델링 할 수 있지만 때로는 데이터가 데이터를보다 호모 스케디티스티스틱으로 변환하고 데이터를 플로팅하거나 범용 클러스터링, 치수 감소 또는 학습 방법에 적용하는 데 데이터를 더 균일하게 채우는 것이 유용합니다. 이를 위해, 우리는 분산 안정화 변환을 보았다.</p>
<p>여기서 운동과 같은 차등 발현 테스트에 대한 주요하고 유효한 비판은 귀무 가설 - 효과 크기가 정확히 0이라는 점입니다. 따라서 우리의 접근 방식은 차별적으로 표현 된 유전자가 무엇인지에 대한 일관된 추정치를 제공하지 않습니다. 실제로, 이것은 효과 크기와 통계적 유의성을 고려함으로써 극복 될 수 있습니다. 또한, 우리는 "밴드 된"귀무 가설을 사용하는 방법을 보았습니다.</p>
</section>
<section class="level2" data-number="8.12" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="8.12"><span class="header-section-number">8.12</span>추가 독서</h2>
<ul>
<li><p>그만큼<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>방법은 논문에 설명되어 있습니다<span class="citation" data-cites="LoveDESeq2">Michael I. Love, Huber 및 Anders (<a href="16-chap.html#ref-LoveDESeq2" role="doc-biblioref">2014</a>))</span>패키지 비네팅에서 소프트웨어의 실질적인 측면. 참조<strong><a href="https://bioconductor.org/packages/edgeR/">에더</a></strong>패키지와 종이<span class="citation" data-cites="edgeR:Robinson:2009">(<a href="16-chap.html#ref-edgeR:Robinson:2009" role="doc-biblioref">Robinson, McCarthy 및 Smyth 2009</a>))</span>관련 접근법.</p></li>
<li><p>강력한 회귀 및 이상적인 탐지에 관한 고전적인 교과서는 다음과 같습니다.<span class="citation" data-cites="Rousseeuw:RobustBook:1987">Peter J. Rousseeuw와 Leroy (<a href="16-chap.html#ref-Rousseeuw:RobustBook:1987" role="doc-biblioref">1987</a>))</span>. 보다 최근의 발전을 위해<a href="https://cran.r-project.org/web/views/Robust.html">강력한 통계 방법에 대한 CRAN 작업보기</a>좋은 출발점입니다.</p></li>
<li><p>생체 전도체 RNA-Seq 워크 플로우<a class="uri" href="https://www.bioconductor.org/help/workflows/rnaseqGene">https://www.bioconductor.org/help/workflows/rnaseqgene</a> <span class="citation" data-cites="BiocRNASeqWorkflow">(<a href="16-chap.html#ref-BiocRNASeqWorkflow" role="doc-biblioref">Michael I. Love et al. 2015</a>))</span>RNA-Seq와 관련하여 특별히 관련된 여러 가지 문제를 다룹니다.</p></li>
<li><p>RNA-Seq 데이터로부터 대체 엑손 사용을 감지하기 위해 본 일반화 된 선형 모델의 확장이<strong><a href="https://bioconductor.org/packages/DEXSeq/">덱 세크</a></strong>종이<span class="citation" data-cites="Reyes:GnomeResearch:2012">(<a href="16-chap.html#ref-Reyes:GnomeResearch:2012" role="doc-biblioref">Anders, Reyes 및 Huber 2012</a>))</span>이러한 아이디어의 생물학적 발견에 대한 적용은 다음과 같이 설명했습니다.<span class="citation" data-cites="Reyes:PNAS:2013">Reyes et al. (<a href="16-chap.html#ref-Reyes:PNAS:2013" role="doc-biblioref">2013</a>))</span>그리고<span class="citation" data-cites="Reyes:NAR:2017">레예스와 후버 (Huber) (<a href="16-chap.html#ref-Reyes:NAR:2017" role="doc-biblioref">2017</a>))</span>.</p></li>
<li><p>RIP-Seq, Clip-Seq와 같은 일부 시퀀싱 기반 분석의 경우 생물학적 분석 목표는 비율을 테스트하는 것입니다.<em>입력</em>그리고<em>면역 침전</em>(IP) 조건간에 변경되었습니다. 바이오 컨덕터 포럼의 Mike Love의 게시물은 명확하고 빠른 방법을 제공합니다.<a class="uri" href="https://support.bioconductor.org/p/61509">https://support.bioconductor.org/p/61509</a>.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="8.13" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="8.13"><span class="header-section-number">8.13</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-countdata-batch">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 8.1</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>작은 p- 값의 고갈.</strong>작은 p- 값의 고갈을 보여주는 p- 값의 히스토그램에 대한 다음 간단한 생성 모델을 고려하십시오. ~ 안에<a class="quarto-xref" href="#fig-countdata-exbatch">수치<span>8.14</span></a>, p- 값은 차등 표현 분석에서 표시됩니다 (이 경우 간단<span class="math inline">\(티\)</span>-테스트) 테스트 된 2 단계 범주 변수와의 연관성이없는 경우<code>여러 떼</code>. 히스토그램은 대략 균일합니다<code>x1</code>, 작은 p- 값이 고갈됩니다<code>x2</code>. 이는 배치 (시조 변수에 의해 인코딩 됨)가<code>여러 떼</code>균형 잡힌 것은 시험 통계의 분모를 팽창시키는 추가 변동성을 도입한다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"magrittr"</span>))</span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a>~의<span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb38-3"><a aria-hidden="true" href="#cb38-3" tabindex="-1"></a>ns<span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb38-4"><a aria-hidden="true" href="#cb38-4" tabindex="-1"></a>x1<span class="ot">=</span>x2<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">rnorm</span>(ns<span class="sc">*</span>의),<span class="at">NCOL =</span>NS,<span class="at">nrow =</span>의)</span>
<span id="cb38-5"><a aria-hidden="true" href="#cb38-5" tabindex="-1"></a>그룹<span class="ot">=</span> <span class="fu">요인</span>(편지 [<span class="dv">1</span> <span class="sc">+</span> <span class="fu">seq_len</span>(NS)<span class="sc">%%</span> <span class="dv">2</span>])))<span class="sc">%t&gt;%</span>인쇄</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] b a b a b a b a b a b a
레벨 : a b</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" href="#cb40-1" tabindex="-1"></a>일괄<span class="ot">=</span> <span class="fu">요인</span>(<span class="fu">ifelse</span>(<span class="fu">seq_len</span>(NS)<span class="sc">&lt;=</span>ns<span class="sc">/</span><span class="dv">2</span>,,,<span class="st">"B1"</span>,,,<span class="st">"B2"</span>)))<span class="sc">%t&gt;%</span>인쇄</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] B1 B1 B1 B1 B1 B1 B2 B2 B2 B2 B2 B2
레벨 : B1 B2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a><span class="fu">테이블</span>(그룹, 배치)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>일괄
그룹 B1 B2
    A 3 3
    B 3 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a>x2 [, 배치<span class="sc">==</span><span class="st">"B2"</span>]]<span class="ot">=</span>x2 [, 배치<span class="sc">==</span><span class="st">"B2"</span>]]<span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">rnorm</span>(의)</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a>pvals<span class="ot">=</span> <span class="fu">rbind</span>(</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">유형 =</span> <span class="st">"x1"</span>, 유전자 필터<span class="sc">::</span><span class="fu">Rowttests</span>(x1,<span class="at">fac =</span>그룹)),</span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">유형 =</span> <span class="st">"x2"</span>, 유전자 필터<span class="sc">::</span><span class="fu">Rowttests</span>(x2,<span class="at">fac =</span>그룹)))</span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a><span class="fu">ggplot</span>(pvals,<span class="fu">AES</span>(<span class="at">x =</span>p.Value))<span class="sc">+</span> </span>
<span id="cb44-6"><a aria-hidden="true" href="#cb44-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.02</span>,,,<span class="at">경계 =</span> <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb44-7"><a aria-hidden="true" href="#cb44-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(유형<span class="sc">~</span>.))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>교체하십시오<span class="math inline">\(티\)</span>-선형 모델에 의해, 먼저, 하나만이 있습니다<code>그룹</code>두 번째로, 하나는 요인으로<code>그룹 + 배치</code>(R의 공식 언어). 계수에 대한 p- 값의 히스토그램을 보여줍니다.<code>그룹</code>두 경우 모두 균일하고<code>x1</code>그리고<code>x2</code>.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display callout-margin-content">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-countdata-exbatch">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-countdata-exbatch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-27" href="08-chap_files/figure-html/fig-countdata-exbatch-1.png" title="Figure 8.14: p-values for the tests performed on x1 and x2 (see code)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="08-chap_files/figure-html/fig-countdata-exbatch-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-countdata-exbatch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 8.14 : 수행 된 테스트의 P- 값<code>x1</code>그리고<code>x2</code>(코드 참조).</figcaption>
</figure>
</div>
</div></div><div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-countdata-edgeR">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 8.2</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>에더.</strong>분석을 수행하십시오<a class="quarto-xref" href="#sec-countdata-debasic"><span>섹션 8.5</span></a>함께<strong><a href="https://bioconductor.org/packages/edgeR/">에더</a></strong>패키지 및 결과를 비교하십시오.<span class="math inline">\ (\ log_ {10} \)</span>p- 값, 큰 차이가있는 일부 유전자를 선택하고 원시 데이터를 시각화하여 무슨 일이 일어나고 있는지 확인하십시오. 이를 바탕으로 차이점을 설명 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-countdata-robustness">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 8.3</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>견고성.</strong>a<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>예에서 선형 회귀를 수행하는 앱<span class="math inline">\ ((x, y) \)</span>데이터 세트 (예 :에서<code>mtcars</code>데이터) 및 적합선뿐만 아니라 데이터를 표시합니다. 포인트 중 하나를 움직일 수있는 위젯을 추가하십시오.<span class="math inline">\(엑스\)</span>-/또는<span class="math inline">\(와이\)</span>- 광범위한 방향 (원래 데이터 범위 외부에서 몇 번 연장). 선택할 수있는 라디오 버튼 위젯 추가<code>LM</code>,,,<code>RLM</code>그리고<code>LQS</code>다른 선택과 함께<code>방법</code>(후자는 두 사람이 있습니다<strong><a href="https://cran.r-project.org/web/packages/MASS/">대량의</a></strong>패키지). 보너스 :에서 기능을 추가하십시오<strong><a href="https://cran.r-project.org/web/packages/robustbase/">강한베이스</a></strong>패키지.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-34-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-34-contents callout-collapse collapse" id="callout-34">
<div class="callout-body-container callout-body">
<p>파일 코드<code>ui.r</code>앱에서 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"빛나는"</span>))</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a><span class="fu">신우</span>(<span class="fu">유체</span>(</span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a>  <span class="fu">TitlePanel</span>(<span class="st">"고장"</span>),)</span>
<span id="cb45-4"><a aria-hidden="true" href="#cb45-4" tabindex="-1"></a>  <span class="fu">사이드 볼 레이 아웃</span>(</span>
<span id="cb45-5"><a aria-hidden="true" href="#cb45-5" tabindex="-1"></a>    <span class="fu">Sidebarpanel</span>(     <span class="co"># Olier Shift를 선택합니다</span></span>
<span id="cb45-6"><a aria-hidden="true" href="#cb45-6" tabindex="-1"></a>      <span class="fu">SliderInput</span>(<span class="st">"옮기다"</span>,,,<span class="st">"국외자:"</span>,,,<span class="at">최소 =</span> <span class="dv">0</span>,,,<span class="at">최대 =</span> <span class="dv">100</span>,,,<span class="at">값 =</span> <span class="dv">0</span>),)</span>
<span id="cb45-7"><a aria-hidden="true" href="#cb45-7" tabindex="-1"></a>      <span class="fu">radiobuttons</span>(<span class="st">"방법"</span>,,,<span class="st">"방법:"</span>,,,</span>
<span id="cb45-8"><a aria-hidden="true" href="#cb45-8" tabindex="-1"></a>                   <span class="fu">기음</span>(<span class="st">"비 로스트 최소 제곱"</span> <span class="ot">=</span> <span class="st">"LM"</span>,,,</span>
<span id="cb45-9"><a aria-hidden="true" href="#cb45-9" tabindex="-1"></a>                     <span class="st">"M- 평가"</span> <span class="ot">=</span> <span class="st">"rlm"</span>)))</span>
<span id="cb45-10"><a aria-hidden="true" href="#cb45-10" tabindex="-1"></a>),)</span>
<span id="cb45-11"><a aria-hidden="true" href="#cb45-11" tabindex="-1"></a>    <span class="fu">메인 패넬</span>(       <span class="co"># Show Fit</span></span>
<span id="cb45-12"><a aria-hidden="true" href="#cb45-12" tabindex="-1"></a>      <span class="fu">PlotOutput</span>(<span class="st">"Regplot"</span>))</span>
<span id="cb45-13"><a aria-hidden="true" href="#cb45-13" tabindex="-1"></a>))</span>
<span id="cb45-14"><a aria-hidden="true" href="#cb45-14" tabindex="-1"></a>))</span>
<span id="cb45-15"><a aria-hidden="true" href="#cb45-15" tabindex="-1"></a>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>파일 코드<code>Server.r</code>앱에서 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"빛나는"</span>))</span>
<span id="cb46-2"><a aria-hidden="true" href="#cb46-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb46-3"><a aria-hidden="true" href="#cb46-3" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"대량의"</span>))</span>
<span id="cb46-4"><a aria-hidden="true" href="#cb46-4" tabindex="-1"></a><span class="fu">Shinyserver</span>(<span class="cf">기능</span>(입력, 출력) {</span>
<span id="cb46-5"><a aria-hidden="true" href="#cb46-5" tabindex="-1"></a>산출<span class="sc">$</span>Regplot<span class="ot">=</span> <span class="fu">렌더 플롯</span>({</span>
<span id="cb46-6"><a aria-hidden="true" href="#cb46-6" tabindex="-1"></a>WHPT<span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb46-7"><a aria-hidden="true" href="#cb46-7" tabindex="-1"></a>mtcars_new<span class="ot">=</span>mtcars</span>
<span id="cb46-8"><a aria-hidden="true" href="#cb46-8" tabindex="-1"></a>mtcars_new<span class="sc">$</span>mpg [whpt]<span class="ot">=</span>mtcars_new<span class="sc">$</span>mpg [whpt]<span class="sc">+</span>입력<span class="sc">$</span>옮기다</span>
<span id="cb46-9"><a aria-hidden="true" href="#cb46-9" tabindex="-1"></a>reg<span class="ot">=</span> <span class="cf">스위치</span>(입력<span class="sc">$</span>방법,</span>
<span id="cb46-10"><a aria-hidden="true" href="#cb46-10" tabindex="-1"></a>      <span class="at">lm =</span> <span class="fu">LM</span>(mpg<span class="sc">~</span>ist,<span class="at">데이터 =</span>mtcars_new),</span>
<span id="cb46-11"><a aria-hidden="true" href="#cb46-11" tabindex="-1"></a>      <span class="at">rlm =</span> <span class="fu">RLM</span>(mpg<span class="sc">~</span>ist,<span class="at">데이터 =</span>mtcars_new),</span>
<span id="cb46-12"><a aria-hidden="true" href="#cb46-12" tabindex="-1"></a>      <span class="fu">멈추다</span>(<span class="st">"구현되지 않은 방법 :"</span>, 입력<span class="sc">$</span>방법)</span>
<span id="cb46-13"><a aria-hidden="true" href="#cb46-13" tabindex="-1"></a>))</span>
<span id="cb46-14"><a aria-hidden="true" href="#cb46-14" tabindex="-1"></a>    <span class="fu">ggplot</span>(mtcars_new,<span class="fu">AES</span>(<span class="at">x =</span>ist,<span class="at">y =</span>MPG))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-15"><a aria-hidden="true" href="#cb46-15" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">인터셉트 =</span>reg<span class="sc">$</span>계수 [<span class="st">"(인터셉트)"</span>],,</span>
<span id="cb46-16"><a aria-hidden="true" href="#cb46-16" tabindex="-1"></a>                  <span class="at">경사 =</span>reg<span class="sc">$</span>계수 [<span class="st">"disp"</span>],,<span class="at">col =</span> <span class="st">"파란색"</span>))</span>
<span id="cb46-17"><a aria-hidden="true" href="#cb46-17" tabindex="-1"></a>  })</span>
<span id="cb46-18"><a aria-hidden="true" href="#cb46-18" tabindex="-1"></a>})</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>물론 더 많은 기능을 추가 할 수 있습니다.</p>
</div>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Anders:2010:GB" role="listitem">Anders, Simon 및 Wolfgang Huber. 2010 년.<span>"<span>디</span>시퀀스 카운트 데이터에 대한 ifferential 표현 분석.”</span> <em>게놈 생물학</em>11 : R106.<a href="http://genomebiology.com/2010/11/10/R106">http://genomebiology.com/2010/11/10/r106</a>.
</div>
<div class="csl-entry" id="ref-Reyes:GnomeResearch:2012" role="listitem">Anders, Simon, Alejandro Reyes 및 Wolfgang Huber. 2012.<span>"<span class="nocase"><span>디</span>엑손의 차별적 사용을 취소합니다<span>RNA</span>-seq 데이터</span>.”</span> <em>게놈 연구</em>22 (10) : 2008–17.</div>
<div class="csl-entry" id="ref-Brooks2010" role="listitem">Brooks, Angela N, Li Yang, Michael O Duff, Kasper D Hansen, Jung W Park, Sandrine Dudoit, Steven E Brenner 및 Brenton R Graveley. 2011.<span>“보존<span>RNA</span>사이의 규제지도<span>디</span>로오 필라와 포유류.”</span> <em>게놈 연구</em>, 193–202.<a href="https://doi.org/10.1101/gr.108662.110">https://doi.org/10.1101/gr.108662.110</a>.
</div>
<div class="csl-entry" id="ref-Cook1977Detection" role="listitem">Cook, R. Dennis. 1977.<span>"선형 회귀에서 영향력있는 관찰의 탐지."</span> <em>기술계</em>.
</div>
<div class="csl-entry" id="ref-Huber:AMS:1964" role="listitem">Huber, Peter J. 1964.<span>"위치 매개 변수의 강력한 추정."</span> <em>수학적 통계의 연대기</em>35 : 73–101.</div>
<div class="csl-entry" id="ref-LeekStorey:2007" role="listitem">Leek, Jeffrey T. 및 John D. Storey. 2007.<span>"<span class="nocase"><span>기음</span>대리 변수 분석에 의한 유전자 발현 연구에서의 적절한 이질성</span>.”</span> <em>PLOS 유전학</em>3 (9) : 1724–35.</div>
<div class="csl-entry" id="ref-BiocRNASeqWorkflow" role="listitem">사랑, Michael I., Simon Anders, Vladislav Kim 및 Wolfgang Huber. 2015.<span>"<span>RNA</span>-Seq 워크 플로 : 유전자 수준의 탐색 적 분석 및 차등 표현.”</span> <em>F1000Research</em>4 (1070).<a href="https://doi.org/10.12688/f1000research.7035.1">https://doi.org/10.12688/f1000research.7035.1</a>.
</div>
<div class="csl-entry" id="ref-LoveDESeq2" role="listitem">사랑, Michael I, Wolfgang Huber 및 Simon Anders. 2014.<span>“접힘 변화와 분산의 중재 된 추정<span class="nocase">RNA-seq</span>데이터<span>deseq2</span>.”</span> <em>그놈 생물학</em>15 (12) : 1–21.</div>
<div class="csl-entry" id="ref-OzsolakMilos" role="listitem">Ozsolak, Fatih 및 Patrice M Milos. 2011.<span>"<span class="nocase"><span>아르 자형</span><span>N</span><span>에이</span>시퀀싱 : 발전, 도전 및 기회</span>.”</span> <em>자연은 유전학을 검토합니다</em>12 : 87–98.</div>
<div class="csl-entry" id="ref-Reyes:PNAS:2013" role="listitem">Reyes, Alejandro, Simon Anders, Robert J. Weatheritt, Toby J. Gibson, Lars M. Steinmetz 및 Wolfgang Huber. 2013.<span>"영장류 종의 조직 전체에 걸친 차등 엑손 사용의 드리프트 및 보존."</span> <em>국립 과학 아카데미의 절차</em>110 (38) : 15377–82.<a href="https://doi.org/10.1073/pnas.1307202110">https://doi.org/10.1073/pnas.1307202110</a>.
</div>
<div class="csl-entry" id="ref-Reyes:NAR:2017" role="listitem">Reyes, Alejandro 및 Wolfgang Huber. 2017.<span>"전사의 대체 시작 및 종료 부위는 인간 조직의 대부분의 전 사체 이소 형 차이를 유도합니다."</span> <em>핵산 연구</em>46 (2) : 582–92.<a href="https://doi.org/10.1093/nar/gkx1165">https://doi.org/10.1093/nar/gkx1165</a>.
</div>
<div class="csl-entry" id="ref-edgeR:Robinson:2009" role="listitem">Robinson, M.D., D. J. McCarthy 및 G. K. Smyth. 2009 년.<span>"<span class="nocase">에더</span>: a<span>생체 전도체</span>디지털 유전자 발현 데이터의 차등 발현 분석 패키지.”</span> <em>생물 정보학</em>26 (1) : 139–40.<a href="https://doi.org/10.1093/bioinformatics/btp616">https://doi.org/10.1093/bioinformatics/btp616</a>.
</div>
<div class="csl-entry" id="ref-Rousseeuw:1987" role="listitem">Rousseeuw, Peter J. 1987.<span>"Silhouettes : 클러스터 분석의 해석 및 검증에 대한 그래픽 보조."</span> <em>전산 및 응용 수학 저널</em>20 : 53–65.</div>
<div class="csl-entry" id="ref-Rousseeuw:RobustBook:1987" role="listitem">Rousseeuw, Peter J. 및 Annick M. Leroy. 1987 년.<em>강력한 회귀 및 이상치 탐지</em>. 와일리.<a href="https://doi.org/10.1002/0471725382">https://doi.org/10.1002/0471725382</a>.
</div>
<div class="csl-entry" id="ref-Stegle:2010" role="listitem">Stegle, O., L. Parts, R. Durbin 및 J. Winn. 2010 년.<span>"<span class="nocase"><span>에이</span> <span>비</span>유전자 발현 수준에서 복잡한 비 유전자 인자를 설명하기위한 아야스 프레임 워크<span>큐</span><span>티</span><span>엘</span>연구</span>.”</span> <em>PLOS 계산 생물학</em>6 (5) : E1000770.</div>
<div class="csl-entry" id="ref-SteijgerBertone:2013" role="listitem">Steiijger, T., J.F. Abril, P. G. G. Engstrus, F. Kokocinski, T. J. Hubbard, R. Guigo, J. Harrow, et al. 2013.<span>"<span class="nocase"><span>에이</span>전 사체 재건 방법의 SSESSMENT<span class="nocase">RNA-seq</span></span>.”</span> <em>자연 방법</em>10 (12) : 1177–84.</div>
<div class="csl-entry" id="ref-Verhulst:1845" role="listitem">Verhulst, Pierre-François. 1845.<span>"연구<span class="nocase">수학</span>인구 증가의 법률에. "</span> <em>새로운<span>논문집</span>~에서<span>학원</span> <span>로얄</span>의<span>과학</span>et<span>종</span>-<span>lettres</span>~의<span>브루셀레스</span></em>18 : 1–42.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
