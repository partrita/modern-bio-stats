<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>11  Image data – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="11  Image data – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/11-chap_files/figure-html/fig-voronoiPaint-1.png" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="261" property="og:image:height"/>
<meta content="181" property="og:image:width"/>
<meta content="11  Image data – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/11-chap_files/figure-html/fig-voronoiPaint-1.png" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<meta content="261" name="twitter:image-height"/>
<meta content="181" name="twitter:image-width"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">11.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#loading-images" href="#loading-images" id="toc-loading-images"><span class="header-section-number">11.2</span>이미지로드</a></li>
<li><a class="nav-link" data-scroll-target="#displaying-images" href="#displaying-images" id="toc-displaying-images"><span class="header-section-number">11.3</span>이미지 표시</a></li>
<li><a class="nav-link" data-scroll-target="#how-are-images-stored-in-r" href="#how-are-images-stored-in-r" id="toc-how-are-images-stored-in-r"><span class="header-section-number">11.4</span>이미지는 R에 어떻게 저장됩니까?</a></li>
<li><a class="nav-link" data-scroll-target="#writing-images-to-file" href="#writing-images-to-file" id="toc-writing-images-to-file"><span class="header-section-number">11.5</span>파일에 이미지를 작성합니다</a></li>
<li><a class="nav-link" data-scroll-target="#sec-manip" href="#sec-manip" id="toc-sec-manip"><span class="header-section-number">11.6</span>이미지 조작</a></li>
<li><a class="nav-link" data-scroll-target="#spatial-transformations" href="#spatial-transformations" id="toc-spatial-transformations"><span class="header-section-number">11.7</span>공간 변형</a></li>
<li><a class="nav-link" data-scroll-target="#sec-linearfilters" href="#sec-linearfilters" id="toc-sec-linearfilters"><span class="header-section-number">11.8</span>선형 필터</a></li>
<li><a class="nav-link" data-scroll-target="#sec-images-adapthresh" href="#sec-images-adapthresh" id="toc-sec-images-adapthresh"><span class="header-section-number">11.9</span>적응 형 임계 값</a></li>
<li><a class="nav-link" data-scroll-target="#morphological-operations-on-binary-images" href="#morphological-operations-on-binary-images" id="toc-morphological-operations-on-binary-images"><span class="header-section-number">11.10</span>이진 이미지에 대한 형태 학적 작동</a></li>
<li><a class="nav-link" data-scroll-target="#sec-segbin" href="#sec-segbin" id="toc-sec-segbin"><span class="header-section-number">11.11</span>이진 이미지를 물체로 분할</a></li>
<li><a class="nav-link" data-scroll-target="#sec-voronoi" href="#sec-voronoi" id="toc-sec-voronoi"><span class="header-section-number">11.12</span>Voronoi Tessellation</a></li>
<li><a class="nav-link" data-scroll-target="#sec-bodies" href="#sec-bodies" id="toc-sec-bodies"><span class="header-section-number">11.13</span>세포체를 분할</a></li>
<li><a class="nav-link" data-scroll-target="#sec-featextract" href="#sec-featextract" id="toc-sec-featextract"><span class="header-section-number">11.14</span>기능 추출</a></li>
<li><a class="nav-link" data-scroll-target="#sec-spatstat" href="#sec-spatstat" id="toc-sec-spatstat"><span class="header-section-number">11.15</span>공간 통계 : 포인트 프로세스</a></li>
<li><a class="nav-link" data-scroll-target="#sec-intensity" href="#sec-intensity" id="toc-sec-intensity"><span class="header-section-number">11.16</span>첫 번째 주문 효과 : 강도</a></li>
<li><a class="nav-link" data-scroll-target="#second-order-effects-spatial-dependence" href="#second-order-effects-spatial-dependence" id="toc-second-order-effects-spatial-dependence"><span class="header-section-number">11.17</span>2 차 효과 : 공간 의존성</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">11.18</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">11.19</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">11.20</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-images"><span class="chapter-number">11</span>  <span class="chapter-title">이미지 데이터</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/chap13-colorLabelscellbodies.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/chap13-colorLabelscellbodies.png"/></a></p>
</figure>
</div>
</div></div></div>
<p>이미지는 풍부한 데이터 소스입니다. 이 장에서는 이미지에서 정량적 정보를 추출 할 수있는 방법과 통계 방법을 사용하여 데이터를 요약하고 이해하는 방법을 살펴 봅니다. 이 장의 목표는 이미지 데이터 작업을 시작하는 것이 쉽다는 것을 보여주는 것입니다. 기본 R 환경을 처리 할 수 ​​있다면 이미지 작업을 시작할 준비가되었습니다. 즉,이 장은 이미지 분석에 대한 일반적인 소개가 아닙니다. 필드는 광범위합니다. 신호 처리, 정보 이론, 수학, 공학 및 컴퓨터 과학의 많은 영역에 도달하며 체계적인 개요를 제시하는 훌륭한 책이 있습니다.</p>
<p>우리는 주로 2 차원 이미지, 특히 세포 이미지의 시리즈를 연구 할 것입니다. 우리는 세포의 위치와 모양을 식별하는 방법과 크기, 강도, 색상 분포 및 상대 위치와 같은 식별 된 모양 및 패턴의 특성을 정량적으로 측정하는 방법을 배웁니다. 그러한 정보는 다운 스트림 분석에 사용될 수 있습니다. 예를 들어, 우리는 다른 조건 사이의 세포, 다른 약물의 영향 하에서 또는 분화 및 성장의 다른 단계에서 세포를 비교할 수 있습니다. 또는 이미지의 객체가 서로 연결되는지, 예를 들어, 서로 클러스터링하거나 서로를 격퇴하는지 또는 특정 특성이 인접한 객체간에 공유되는 경향이 있는지, 셀-세포 통신을 나타내는지를 측정 할 수 있습니다. 유전학의 언어에서, 이것이 의미하는 바는 이미지를 복잡한 표현형 또는 다변량 정량적 특성으로 사용할 수 있다는 것입니다.</p>
<p>여기서는 두 가지 이상의 차원에서 이미지 분석에 대해서는 다루지 않을 것입니다. 3D 세분화 및 등록 또는 시간적 추적을 고려하지 않습니다. 이것들은 전문 소프트웨어 가이 장의 범위에서 조립할 수있는 것보다 더 나은 성능을 발휘할 수있는 정교한 작업입니다.</p>
<p>고 처리량 이미징의 데이터와 유전체학의 다른 고 처리량 데이터 사이에는 유사점이 있습니다. 배치 효과는 예를 들어 염색 효율, 조명 또는 기타 여러 요인의 변화로 인해 역할을하는 경향이 있습니다. 실험 설계 및 분석 선택에서 적절한 예방 조치를 취해야합니다. 원칙적으로, 이미지의 강도 값은 물리적 단위로 교정 될 수 있으며, 상응하는, 복사 에너지 또는 형광 단 농도와 관련하여; 그러나 이것은 항상 생물학적 영상에서 실제로 이루어진 것은 아니며 아마도 필요하지 않을 수도 있습니다. 달성하기가 더 쉽고 명확하게 가치가있는 것은 이미지의 공간 치수, 즉 픽셀 유닛과 메트릭 거리 간의 변환 계수의 교정입니다.</p>
<section class="level2" data-number="11.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="11.1"><span class="header-section-number">11.1</span>이 장의 목표</h2>
<p>이 장에서는 다음과 같습니다.</p>
<ul>
<li><p>R에서 이미지를 읽고 쓰고, 조작하는 방법을 알아보십시오.</p></li>
<li><p>필터와 이미지에 전환을 적용하는 방법을 이해하십시오.</p></li>
<li><p>이러한 기술을 결합하여 세분화 및 특징 추출을 수행하십시오. 우리는 셀 분할을 예로 사용합니다.</p></li>
<li><p>통계적 방법을 사용하여 공간 분포 및 종속성을 분석하는 방법을 알아보십시오.</p></li>
<li><p>공간 포인트 프로세스의 가장 기본적인 분포 인 균질 한 포아송 프로세스를 알아보십시오.</p></li>
<li><p>귀하의 데이터가 기본 가정에 적합한 지 또는 덩어리 또는 배제의 증거를 보여주는 지 여부를 인식하십시오.</p></li>
</ul>
</section>
<section class="level2" data-number="11.2" id="loading-images">
<h2 class="anchored" data-anchor-id="loading-images" data-number="11.2"><span class="header-section-number">11.2</span>이미지로드</h2>
<p>R에서 이미지를 처리하는 데 유용한 툴킷은 바이오 컨덕터 패키지입니다.<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong> <span class="citation" data-cites="EBImage">(<a href="16-chap.html#ref-EBImage" role="doc-biblioref">Paul et al. 2010 년</a>))</span>. 우리는 기본 기능을 보여주기 위해 간단한 그림을 읽음으로써 시작합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ebimage"</span>))</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>ImageFile<span class="ot">=</span> <span class="fu">System.file</span>(<span class="st">"이미지"</span>,,,<span class="st">"모기 .png"</span>,,,<span class="at">패키지 =</span> <span class="st">"MSMB"</span>))</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>MOSQ<span class="ot">=</span> <span class="fu">readimage</span>(ImageFile)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p><strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong>현재 세 가지 이미지 파일 형식을 지원합니다.<code>JPEG</code>,,,<code>PNG</code>그리고<code>사소한 말다툼</code>. 위의, 우리는 샘플 이미지를로드했습니다<strong><a href="https://bioconductor.org/packages/MSMB/">MSMB</a></strong>패키지. 자신의 데이터로 작업 할 때는 해당 패키지가 필요하지 않으며 파일의 이름을 제공합니다.<code>readimage</code>기능. 이 장의 뒷부분에서 볼 수 있듯이<code>readimage</code>한 번에 여러 이미지를 읽을 수 있으며, 모두 단일 이미지 데이터 객체로 조립됩니다. 이를 위해서는 이미지의 크기와 색상 모드가 필요합니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-RBioFormats">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.1</div>
</div>
<div class="callout-body-container callout-body">
<p>그만큼<strong>rbioformats</strong>패키지 (GitHub에서 사용 가능 :<a class="uri" href="https://github.com/aoles/RBioFormats">https://github.com/aoles/rbioformats</a>)는 더 많은 이미지 파일 형식을 읽고 쓰는 기능을 제공합니다. 얼마나 많은 다른 파일 형식이 지원됩니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-2-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-2-contents callout-collapse collapse" id="callout-2">
<div class="callout-body-container callout-body">
<p>의 매뉴얼 페이지를 참조하십시오<code>read.image</code>기능<strong>rbioformats</strong>패키지 (이것은 구별됩니다<code>ebimage :: readimage</code>) 및 Open Microscopy Environment 웹 사이트의 Bio-Formats 프로젝트의 온라인 문서,<a class="uri" href="http://www.openmicroscopy.org/site/support/bio-formats5.5/supported-formats.html">http://www.openmicroscopy.org/site/support/bio-formats5.5/supported-formats.html</a>.</p>
</div>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.3" id="displaying-images">
<h2 class="anchored" data-anchor-id="displaying-images" data-number="11.3"><span class="header-section-number">11.3</span>이미지 표시</h2>
<p>방금 읽은 이미지를 시각화합시다. 기본 기능은<code>ebimage :: 디스플레이</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a>에비지<span class="sc">::</span><span class="fu">표시하다</span>(MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>위의 명령은 웹 브라우저 창에서 이미지를 엽니 다 (<code>getOption ( "브라우저")</code>). 마우스 또는 키보드 바로 가기를 사용하면 이미지를 확대하거나 축소하고 여러 이미지 프레임을 통해 팬 및 순환 할 수 있습니다.</p>
<p>또는 전화를 통해 R의 내장 플롯을 사용하여 이미지를 표시 할 수도 있습니다.<code>표시하다</code>논쟁과 함께<code>메소드 = "래스터"</code>. 그런 다음 이미지는 현재 장치로 이동합니다. 이러한 방식으로 이미지 데이터를 다른 플로팅 기능과 결합하여 텍스트 레이블을 추가 할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a>에비지<span class="sc">::</span><span class="fu">표시하다</span>(MOSQ)</span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a><span class="fu">텍스트</span>(<span class="at">x =</span> <span class="dv">85</span>,,,<span class="at">y =</span> <span class="dv">800</span>,,,<span class="at">레이블 =</span> <span class="st">"모기"</span>,,,<span class="at">조정 =</span> <span class="dv">0</span>,,,<span class="at">col =</span> <span class="st">"주황색"</span>,,,<span class="at">cex =</span> <span class="fl">1.5</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mosquito">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosquito-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="11-chap_files/figure-html/fig-mosquito-1.jpeg" title="Figure 11.1: Mosquito discovered deceased in the suburbs of Decatur, Georgia (credit: CDC / Janice Haney Carr)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-mosquito-1.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosquito-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.1 : 모기는 조지아 디케 이터 교외에서 사망 한 것으로 밝혀졌습니다 (신용 : CDC / Janice Haney Carr).</figcaption>
</figure>
</div>
</div></div></div>
<p>결과 플롯이 표시됩니다<a class="quarto-xref" href="#fig-mosquito">수치<span>11.1</span></a>. 평소와 같이, R 장치에 표시되는 그래픽은<strong><a href="https://cran.r-project.org/web/packages/base/">베이스</a></strong>R 기능<code>Dev.Print</code>또는<code>dev.copy</code>.</p>
<p>컬러 이미지를 읽고 볼 수 있습니다.<a class="quarto-xref" href="#fig-hiv">수치<span>11.2</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a>ImageFile<span class="ot">=</span> <span class="fu">System.file</span>(<span class="st">"이미지"</span>,,,<span class="st">"hiv.png"</span>,,,<span class="at">패키지 =</span> <span class="st">"MSMB"</span>))</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a>HIVC<span class="ot">=</span> <span class="fu">readimage</span>(ImageFile)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a>에비지<span class="sc">::</span><span class="fu">표시하다</span>(HIVC,<span class="at">방법 =</span> <span class="st">"래스터"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-hiv">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hiv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="11-chap_files/figure-html/fig-hiv-1.jpeg" title="Figure 11.2: Scanning electron micrograph of HIV-1 virions budding from a cultured lymphocyte (credit: CDC / C. Goldsmith, P. Feorino, E.L. Palmer, W.R. McManus)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-hiv-1.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hiv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.2 : 배양 된 림프구에서 신진 HIV-1 비리 온의 스캐닝 전자 현미경 사진 (신용 : CDC / C. Goldsmith, P. Feorino, E.L. Palmer, W.R. McManus).</figcaption>
</figure>
</div>
</div></div></div>
<p>또한 이미지에 여러 프레임이있는 경우 기능 인수를 지정하여 그리드 배열로 한 번에 모두 표시 할 수 있습니다.<code>all = true</code> (<a class="quarto-xref" href="#fig-image-oneminus">수치<span>11.3</span></a>),)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a>핵<span class="ot">=</span> <span class="fu">readimage</span>(<span class="fu">System.file</span>(<span class="st">"이미지"</span>,,,<span class="st">"Nuclei.tif"</span>,,,<span class="at">패키지 =</span> <span class="st">"ebimage"</span>)))</span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2" tabindex="-1"></a>에비지<span class="sc">::</span><span class="fu">표시하다</span>(<span class="dv">1</span> <span class="sc">-</span>NUC,<span class="at">모두 =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-image-oneminus">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-image-oneminus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="11-chap_files/figure-html/fig-image-oneminus-1.png" title="Figure 11.3: Tiled display of four images of cell nuclei from the EBImage package."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-image-oneminus-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-image-oneminus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.3 : 세포 핵의 4 개의 이미지의 기울어 진 디스플레이<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong>패키지.</figcaption>
</figure>
</div>
</div>
</div>
<!-- #| fig-cap-location: margin -->
<p>또는 예를 들어 두 번째 프레임과 같은 단일 프레임 만 볼 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a>에비지<span class="sc">::</span><span class="fu">표시하다</span>(<span class="dv">1</span> <span class="sc">-</span>NUC,<span class="at">프레임 =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-oneminus">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.2</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 왜 논쟁을 통과 했습니까?<code>1- 핵</code>에<code>표시하다</code>코드의 기능<a class="quarto-xref" href="#fig-image-oneminus">수치<span>11.3</span></a>? 우리가 표시하면 어떻게 보입니까?<code>핵</code>곧장?</p>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.4" id="how-are-images-stored-in-r">
<h2 class="anchored" data-anchor-id="how-are-images-stored-in-r" data-number="11.4"><span class="header-section-number">11.4</span>이미지는 R에 어떻게 저장됩니까?</h2>
<p>이미지 객체의 클래스를 먼저 식별하여 무슨 일이 일어나고 있는지 파헤쳐 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" href="#cb8-1" tabindex="-1"></a><span class="fu">수업</span>(MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "이미지"
attr (, "패키지")
[1] "ebimage"</code></pre>
</div>
</div>
<p>그래서 우리는이 객체에 클래스가 있음을 알 수 있습니다<em>영상</em>. 이것은 기본 R 클래스 중 하나가 아니라 패키지에 의해 정의됩니다.<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong>. 도움말 브라우저 또는 타이핑을 통해이 클래스에 대한 자세한 내용을 확인할 수 있습니다.<code>수업 ? 영상</code>. 수업은 기본 R 클래스에서 파생됩니다<em>정렬</em>, 당신은 할 수 있습니다<em>영상</em>R 어레이로 할 수있는 모든 것을 객체; 또한 몇 가지 추가 기능과 행동이 있습니다<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>R 's Parlance에서는 추가 기능이 호출됩니다<strong>슬롯</strong>그리고 행동을 방법이라고합니다. 방법은 특별한 종류의 기능입니다.</p></div></div><div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-slotsmethods">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.3</div>
</div>
<div class="callout-body-container callout-body">
<p>어떤 슬롯이<em>영상</em>객체는 어떤 방법을 적용 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-5-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-5-contents callout-collapse collapse" id="callout-5">
<div class="callout-body-container callout-body">
<p>클래스 정의는 쉽고 액세스합니다<code>쇼 클래스 ( "이미지")</code>. 적용 가능한 모든 방법을 찾습니다<em>영상</em>R 기능에 대한 유사한 호출에 의한 클래스는 고통 스럽습니다. 가장 좋은 방법은 클래스의 매뉴얼 페이지를 참조하고 저자가 언급 한 방법을 확인하는 것입니다.</p>
</div>
</div>
</div>
<p>이미지의 치수는<code>어둑한</code>방법, 일반 배열과 마찬가지로.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a><span class="fu">어둑한</span>(MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1400 952</code></pre>
</div>
</div>
<p>그만큼<code>히스</code>메소드가 재정의되었습니다<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>평범한 것에 비해<code>히스</code>배열의 기능 : 다르고 유용한 기본값을 사용합니다 (<a class="quarto-xref" href="#fig-mosqhist">수치<span>11.4</span></a>).</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>객체 지향적 인 용어에서<em>과부하</em>.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a><span class="fu">히스</span>(MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mosqhist">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosqhist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="11-chap_files/figure-html/fig-mosqhist-1.png" title="Figure 11.4: Histogram of the pixel intensities in mosq. Note that the range is between 0 and 1."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-mosqhist-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosqhist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.4 : 픽셀 강도의 히스토그램<code>MOSQ</code>. 범위는 0과 1 사이입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>데이터 매트릭스에 직접 액세스하려면 r<em>정렬</em>, 우리는 액세서 기능을 사용할 수 있습니다<code>Imagedata</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a><span class="fu">Imagedata</span>(MOSQ) [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3] [, 4] [, 5] [, 6]
[1,] 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784
[2,] 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784
[3,] 0.1960784 0.1960784 0.2000000 0.2039216 0.2000000 0.1960784</code></pre>
</div>
</div>
<p>유용한 요약<em>영상</em>객체의 이름을 입력하면 객체가 인쇄됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a>MOSQ</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>영상 
  ColorMode : Grayscale 
  Storage.Mode : 이중 
  Dim : 1400 952 
  프레임 .Total : 1 
  프레임. 렌더 : 1 

Imagedata (Object) [1 : 5,1 : 6]
          [, 1] [, 2] [, 3] [, 4] [, 5] [, 6]
[1,] 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784
[2,] 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784 0.1960784
[3,] 0.1960784 0.1960784 0.2000000 0.2039216 0.2000000 0.1960784
[4,] 0.1960784 0.1960784 0.2039216 0.2078431 0.2000000 0.1960784
[5,] 0.1960784 0.2000000 0.2117647 0.2156863 0.2000000 0.1921569</code></pre>
</div>
</div>
<p>이제 색상 이미지를 살펴 보겠습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a>HIVC</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>영상 
  colormode : 색상 
  Storage.Mode : 이중 
  Dim : 1400 930 3 
  프레임 .Total : 3 
  프레임. 렌더 : 1 

Imagedata (Object) [1 : 5,1 : 6,1]
     [, 1] [, 2] [, 3] [, 4] [, 5] [, 6]
[1,] 0 0 0 0 0
[2,] 0 0 0 0 0
[3,] 0 0 0 0 0
[4,] 0 0 0 0 0
[5,] 0 0 0 0 0</code></pre>
</div>
</div>
<p>두 이미지는 재산에 따라 다릅니다<code>colormode</code>,<code>그레이 스케일</code>~을 위한<code>MOSQ</code>그리고<code>색상</code>~을 위한<code>HIVC</code>. 이 재산의 요점은 무엇입니까? 우리가 이미지 스택을 다룰 때 편리한 것으로 판명되었습니다. 만약에<code>colormode</code>~이다<code>그레이 스케일</code>, 배열의 세 번째 및 모든 더 높은 치수는 예를 들어 다른 것과 같은 별도의 이미지 프레임으로 간주됩니다.<span class="math inline">\(지\)</span>-위치, 시점, 복제 등<code>colormode</code>~이다<code>색상</code>, 3 차원은 다른 컬러 채널을 보유한다고 가정하며, 존재하는 경우 네 번째 및 더 높은 차원 만 여러 이미지 프레임에 사용됩니다. ~ 안에<code>HIVC</code>, 사진의 빨간색, 녹색 및 파란색 강도에 해당하는 3 개의 컬러 채널이 있습니다. 그러나 이것이 반드시 사실 일 필요는 없으며, 많은 색상 채널이있을 수 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-storenuc">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.4</div>
</div>
<div class="callout-body-container callout-body">
<p>R이 데이터를 저장하는 방법을 설명하십시오<code>핵</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-7-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-7-contents callout-collapse collapse" id="callout-7">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a>핵</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>영상 
  ColorMode : Grayscale 
  Storage.Mode : 이중 
  희미한 : 510 510 4 
  프레임 .Total : 4 
  프레임. 렌더 : 4 

Imagedata (Object) [1 : 5,1 : 6,1]
           [, 1] [, 2] [, 3] [, 4] [, 5] [, 6]
[1,] 0.06274510 0.07450980 0.07058824 0.08235294 0.10588235 0.09803922
[2,] 0.06274510 0.05882353 0.07843137 0.09019608 0.09019608 0.10588235
[3,] 0.06666667 0.06666667 0.08235294 0.07843137 0.09411765 0.09411765
[4,] 0.06666667 0.06666667 0.07058824 0.08627451 0.08627451 0.09803922
[5,] 0.05882353 0.06666667 0.07058824 0.08235294 0.09411765 0.10588235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a><span class="fu">어둑한</span>(<span class="fu">Imagedata</span>(핵))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 510 510 4</code></pre>
</div>
</div>
<p>우리는 총 4 개의 프레임이 있는데, 이는 4 개의 별도 이미지에 해당합니다 (<code>프레임. 렌더</code>).</p>
</div>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.5" id="writing-images-to-file">
<h2 class="anchored" data-anchor-id="writing-images-to-file" data-number="11.5"><span class="header-section-number">11.5</span>파일에 이미지를 작성합니다</h2>
<p>이전 섹션에서 본 배열 표현에서 이미지를 디스크에 직접 저장하면 대부분의 경우 불필요하게 큰 파일 크기로 이어집니다. 압축 알고리즘을 사용하여 스토리지 소비를 줄이는 것이 일반적입니다. 이미지의 두 가지 주요 유형이 있습니다<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>압축:</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>유사한 방식으로 이것은 영화와 음악에도 해당됩니다.</p></div></div><ul>
<li><p>무손실 압축 : 압축 파일에서 원본 이미지 데이터를 정확하게 재구성 할 수 있습니다. 무손실 압축의 간단한 프리언트는 다음과 같습니다. (i) 필요한 것보다 픽셀을 나타내는 데 더 많은 비트를 소비하지 않습니다 (예 :<code>MOSQ</code>이미지는 256 개의 회색 스케일 값을 가지며 8 비트로 표시 될 수 있습니다.<code>MOSQ</code>64 비트 숫자 형식으로 저장합니다<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>); (2) 패턴을 식별합니다 (예 : 인쇄 된 픽셀 값에서 위에서 본 것과 같은 패턴<code>MOSQ</code>그리고<code>HIVC</code>) 그리고 대신 규칙을 적어두기 위해 훨씬 짧게 대표하십시오.</p></li>
<li><p>손실 압축 : 인간 시청자가 어쨌든 눈에 띄지 않을 것이라는 세부 사항을 떨어 뜨려 무한 압축과 비교하여 추가 비용을 절약합니다.</p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>이것은 메모리가 다소 낭비되지만, 나머지 R이 작동하는 방식과 더 호환되며 최신 컴퓨터 하드웨어에서 제한적인 요소는 아닙니다.</p></div><div id="fn5"><p><sup>5</sup> <a class="uri" href="https://en.wikipedia.org/wiki/Portable_Network_Graphics">https://en.wikipedia.org/wiki/portable_network_graphics</a></p></div><div id="fn6"><p><sup>6</sup> <a class="uri" href="https://en.wikipedia.org/wiki/JPEG">https://en.wikipedia.org/wiki/jpeg</a></p></div></div><p>무손실 압축이있는 스토리지 형식의 예는 PNG입니다.<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>, 손실 압축의 예는 JPEG입니다<a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>체재. JPEG는 휴가 사진에 적합하지만 과학적 이미지를 무손실 형식으로 저장하는 것이 좋습니다.</p>
<p>우리는 이미지를 읽습니다<code>HIVC</code>PNG 형식의 파일에서 이제 JPEG 파일로 작성하겠습니다. 손실은<em>품질</em>1 (최악의)과 100 (최고) 사이에있을 수있는 매개 변수.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a>output_file<span class="ot">=</span> <span class="fu">file.path</span>(<span class="fu">Tempdir</span>(), <span class="st">"hivc.jpeg"</span>))</span>
<span id="cb23-2"><a aria-hidden="true" href="#cb23-2" tabindex="-1"></a><span class="fu">쓰기</span>(HIVC, output_file,<span class="at">품질 =</span> <span class="dv">85</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>마찬가지로, 우리는 이미지를 a로 쓸 수있었습니다<code>사소한 말다툼</code>여러 압축 알고리즘 중에서 파일을 선택하고 선택했습니다 (수동 페이지 참조<code>쓰기</code>그리고<code>WriteTiff</code>함수). 패키지<strong>rbioformats</strong>많은 이미지 파일 형식으로 쓸 수 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-size">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.5</div>
</div>
<div class="callout-body-container callout-body">
<p>얼마나 큰가요<code>HIVC</code>R의 기억에 객체? JPEG 파일은 얼마나 큰가요? 3 색, 16 메가 픽셀 이미지를 차지할 것을 얼마나 많이 기대하십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-9-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-9-contents callout-collapse collapse" id="callout-9">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a><span class="fu">객체. 크기</span>(HIVC)<span class="sc">|&gt;</span> <span class="fu">체재</span>(<span class="at">단위 =</span> <span class="st">"MB"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "29.8MB"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a>(<span class="fu">객체. 크기</span>(HIVC)<span class="sc">/</span> <span class="fu">찌르다</span>(<span class="fu">어둑한</span>(HIVC))))<span class="sc">|&gt;</span> <span class="fu">체재</span>() <span class="sc">|&gt;</span> <span class="fu">반죽</span>(<span class="st">"픽셀 당"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "픽셀 당 8 바이트"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a><span class="fu">file.info</span>(output_file)<span class="sc">$</span>크기</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 294904</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a><span class="dv">16</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">8</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 384</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.6" id="sec-manip">
<h2 class="anchored" data-anchor-id="sec-manip" data-number="11.6"><span class="header-section-number">11.6</span>이미지 조작</h2>
<p>이제 이미지가 r의 숫자 배열로 저장된다는 것을 알았으므로 이미지 조작 방법이 명확 해집니다. 간단한 대수! 예를 들어, 우리는 원래 이미지를 다시 표시 할 수 있습니다.<a class="quarto-xref" href="#fig-manip1">수치<span>11.5</span></a>A, 이미지를 -1로 곱하여 밝은 영역을 어둡고 그 반대를 뒤집습니다.<a class="quarto-xref" href="#fig-manip1">수치<span>11.5</span></a>비).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a>mosqinv<span class="ot">=</span> <span class="fu">정상화하십시오</span>(<span class="sc">-</span>MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-normalize">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.6</div>
</div>
<div class="callout-body-container callout-body">
<p>기능은 무엇을합니까<code>정상화하십시오</code>하다?</p>
</div>
</div>
<p>곱셈을 통해 대비를 조정할 수도 있습니다 (<a class="quarto-xref" href="#fig-manip1">수치<span>11.5</span></a>c) 지수를 통한 감마 요소<a class="quarto-xref" href="#fig-manip1">수치<span>11.5</span></a>디).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a>MOSQCONT<span class="ot">=</span>MOSQ<span class="sc">*</span> <span class="dv">3</span></span>
<span id="cb33-2"><a aria-hidden="true" href="#cb33-2" tabindex="-1"></a>mosqexp<span class="ot">=</span>MOSQ<span class="sc">^</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-layout-panel page-columns page-full" id="fig-manip1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-manip1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip1-1" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip1" href="11-chap_files/figure-html/fig-manip1-1.jpeg" title="Figure 11.5 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip1" id="fig-manip1-1" src="11-chap_files/figure-html/fig-manip1-1.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip1-2" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip1" href="11-chap_files/figure-html/fig-manip1-2.jpeg" title="Figure 11.5 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip1" id="fig-manip1-2" src="11-chap_files/figure-html/fig-manip1-2.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip1-3" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip1" href="11-chap_files/figure-html/fig-manip1-3.jpeg" title="Figure 11.5 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip1" id="fig-manip1-3" src="11-chap_files/figure-html/fig-manip1-3.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip1-4" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip1-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip1" href="11-chap_files/figure-html/fig-manip1-4.jpeg" title="Figure 11.5 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip1" id="fig-manip1-4" src="11-chap_files/figure-html/fig-manip1-4.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip1-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-manip1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.5 : 원래 모기 이미지 (a)와 세 가지 다른 이미지 변환 : (b) 뺄셈, (c) 곱셈, (d) 전력 변환.</figcaption>
</figure>
</div>
<p>또한, 우리는 매트릭스 작업으로 이미지를 자르고, 임계 값으로, 전환 할 수 있습니다 (<a class="quarto-xref" href="#fig-manip5">수치<span>11.6</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a>MOSQCROP<span class="ot">=</span>mosq [<span class="dv">100</span><span class="sc">:</span><span class="dv">438</span>,,,<span class="dv">112</span><span class="sc">:</span><span class="dv">550</span>]]</span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a>Mosqthresh<span class="ot">=</span>MOSQ<span class="sc">&gt;</span> <span class="fl">0.5</span></span>
<span id="cb34-3"><a aria-hidden="true" href="#cb34-3" tabindex="-1"></a>MOSQTRANSP<span class="ot">=</span> <span class="fu">바꾸어 놓다</span>(MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-manip5">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-manip5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip5" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip5-1" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip5" href="11-chap_files/figure-html/fig-manip5-1.png" title="Figure 11.6 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip5" id="fig-manip5-1" src="11-chap_files/figure-html/fig-manip5-1.png" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip5" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip5-2" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip5" href="11-chap_files/figure-html/fig-manip5-2.png" title="Figure 11.6 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip5" id="fig-manip5-2" src="11-chap_files/figure-html/fig-manip5-2.png" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-manip5" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-manip5-3" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-manip5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-manip5" href="11-chap_files/figure-html/fig-manip5-3.png" title="Figure 11.6 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-manip5" id="fig-manip5-3" src="11-chap_files/figure-html/fig-manip5-3.png" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-manip5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-manip5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.6 : 세 가지 추가 이미지 변환 : (a) 자르기, (b) 임계 값, (c) 전치.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-mosqthresh">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.7</div>
</div>
<div class="callout-body-container callout-body">
<p>어떤 데이터 유형입니다<code>Mosqthresh</code>, 임계 값의 결과?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-12-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-12-contents callout-collapse collapse" id="callout-12">
<div class="callout-body-container callout-body">
<p>그것은<em>영상</em>픽셀이 이진 값인 객체 유형 배열로 표시<em>논리적</em>. 콘솔에 이름을 입력하여 객체를 검사 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>Mosqthresh</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>영상 
  ColorMode : Grayscale 
  Storage.Mode : 논리적 
  Dim : 1400 952 
  프레임 .Total : 1 
  프레임. 렌더 : 1 

Imagedata (Object) [1 : 5.1 : 6]
      [, 1] [, 2] [, 3] [, 4] [, 5] [, 6]
[1,] false false false false false false
[2,] false false false false false
[3,] false false false false false false
[4,] false false false false false false
[5,] false false false false</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-transpose">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.8</div>
</div>
<div class="callout-body-container callout-body">
<p>대신<code>바꾸어 놓다</code>위와 같이 기능을 사용하면 R을 사용할 수 있습니다<strong><a href="https://cran.r-project.org/web/packages/base/">베이스</a></strong>기능<code>티</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-14-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-14-contents callout-collapse collapse" id="callout-14">
<div class="callout-body-container callout-body">
<p>이 경우의 값<code>t (mosq)</code>그리고<code>전환 (MOSQ)</code>동일하지만<code>바꾸어 놓다</code>색상 및 멀티 프레임 이미지와 함께 작동하므로 바람직합니다.</p>
</div>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.7" id="spatial-transformations">
<h2 class="anchored" data-anchor-id="spatial-transformations" data-number="11.7"><span class="header-section-number">11.7</span>공간 변형</h2>
<p>우리는 방금 한 유형의 공간 변환, 전치를 보았지만 더 많은 것이 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a>MOSQROT<span class="ot">=</span>에비지<span class="sc">::</span><span class="fu">회전</span>(MOSQ<span class="at">각도 =</span> <span class="dv">30</span>))</span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a>MOSQSHIFT<span class="ot">=</span>에비지<span class="sc">::</span><span class="fu">번역하다</span>(MOSQ<span class="at">v =</span> <span class="fu">기음</span>(<span class="dv">100</span>,,,<span class="dv">170</span>)))</span>
<span id="cb37-3"><a aria-hidden="true" href="#cb37-3" tabindex="-1"></a>mosqflip<span class="ot">=</span> <span class="fu">튀기다</span>(MOSQ)</span>
<span id="cb37-4"><a aria-hidden="true" href="#cb37-4" tabindex="-1"></a>mosqflop<span class="ot">=</span> <span class="fu">실패</span>(MOSQ)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-flipflop">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-flipflop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-flipflop" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-flipflop-1" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-flipflop-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-flipflop" href="11-chap_files/figure-html/fig-flipflop-1.jpeg" title="Figure 11.7 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-flipflop" id="fig-flipflop-1" src="11-chap_files/figure-html/fig-flipflop-1.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-flipflop-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-flipflop" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-flipflop-2" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-flipflop-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-flipflop" href="11-chap_files/figure-html/fig-flipflop-2.jpeg" title="Figure 11.7 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-flipflop" id="fig-flipflop-2" src="11-chap_files/figure-html/fig-flipflop-2.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-flipflop-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-flipflop" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-flipflop-3" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-flipflop-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-flipflop" href="11-chap_files/figure-html/fig-flipflop-3.jpeg" title="Figure 11.7 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-flipflop" id="fig-flipflop-3" src="11-chap_files/figure-html/fig-flipflop-3.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-flipflop-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-flipflop" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-flipflop-4" width="373.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-flipflop-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-flipflop" href="11-chap_files/figure-html/fig-flipflop-4.jpeg" title="Figure 11.7 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-flipflop" id="fig-flipflop-4" src="11-chap_files/figure-html/fig-flipflop-4.jpeg" width="373"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-flipflop-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-flipflop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.7 : 공간 변환 : (a) 회전, (b) 번역, (c) 중심 수평 축에 대한 반사 (<code>튀기다</code>), (d) 중앙 세로 축에 대한 반사 (<code>실패</code>).
</figcaption>
</figure>
</div>
</div>
<p>위의 코드에서는 기능이 있습니다<code>회전</code><a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>주어진 각도로 이미지를 시계 방향으로 회전시키고<code>번역하다</code>지정된 2 차원 벡터에 의해 이미지를 움직입니다 (이미지 영역 외부로 끝나는 픽셀은 자르고 이미지 영역으로 들어가는 픽셀은 0으로 설정됩니다). 기능<code>튀기다</code>그리고<code>실패</code>각각 중앙 수평 및 수직 축 주변의 이미지를 반영합니다. 이러한 작업의 결과는 표시됩니다<a class="quarto-xref" href="#fig-flipflop">수치<span>11.7</span></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>여기서 우리는 네임 스페이스 예선을 사용하여 기능을 호출합니다<code>ebimage ::</code>네임 스페이스에서 동일한 이름의 함수와의 혼란을 피하기 위해<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>나중에 첨부 할 패키지.</p></div></div></section>
<section class="level2 page-columns page-full" data-number="11.8" id="sec-linearfilters">
<h2 class="anchored" data-anchor-id="sec-linearfilters" data-number="11.8"><span class="header-section-number">11.8</span>선형 필터</h2>
<p>이제 Cell Biology의 응용 프로그램으로 전환합시다. 우리는 Laufer, Fischer 및 동료들에 의해 연구 된 인간 암 세포의 이미지를로드합니다.<span class="citation" data-cites="Laufer:NatMeth:2013">(<a href="16-chap.html#ref-Laufer:NatMeth:2013" role="doc-biblioref">Laufer et al. 2013</a>))</span>. 그들은 표시됩니다<a class="quarto-xref" href="#fig-LauferCells">수치<span>11.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a>ImageFiles<span class="ot">=</span> <span class="fu">System.file</span>(<span class="st">"이미지"</span>,,,<span class="fu">기음</span>(<span class="st">"image-dapi.tif"</span>,,,<span class="st">"image-fitc.tif"</span>,,,<span class="st">"image-cy3.tif"</span>),)<span class="at">패키지 =</span> <span class="st">"MSMB"</span>))</span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a>세포<span class="ot">=</span> <span class="fu">readimage</span>(imagefiles)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-LauferCells">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-LauferCells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="11-chap_files/figure-html/fig-LauferCells-1.png" title="Figure 11.8: Human colon cancer cells (HCT116). The four images show the same cells: the leftmost image corresponds to DAPI staining of the cells’ DNA, the second to immunostaining against alpha-tubulin, the third to actin. They are displayed as gray-scale images. The rightmost image is obtained by overlaying the three images as color channels of an RGB image (red: actin, green: alpha-tubulin, blue: DNA)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-LauferCells-1.png" width="666"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-LauferCells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.8 : 인간 결장암 세포 (HCT116). 4 개의 이미지는 동일한 세포를 보여줍니다. 가장 왼쪽 이미지는 세포의 DNA의 DAPI 염색에 해당하며, 두 번째는 알파-튜 불린에 대한 면역 염색에 해당하며, 세 번째는 액틴에서. 그들은 회색 규모 이미지로 표시됩니다. 가장 오른쪽 이미지는 RGB 이미지의 컬러 채널로 세 가지 이미지를 오버레이하여 얻습니다 (빨간색 : Actin, Green : Alpha-Tubulin, Blue : DNA).</figcaption>
</figure>
</div>
</div>
</div>
<p>그만큼<em>영상</em>물체<code>세포</code>크기 340의 3 차원 배열입니다<span class="math inline">\(\타임스\)</span>490<span class="math inline">\(\타임스\)</span>3, 여기서 마지막 치수는 세 개의 개별 회색 스케일 프레임이 있음을 나타냅니다. 우리의 목표는 이제 이러한 이미지에서 세포를 계산 및 정량적으로 특성화하는 것입니다. 그 자체로는 겸손한 목표가 될 것이지만 Laufer 등의 데이터 세트는 690,000 개가 넘는 이미지를 포함하며 각각 2,048 개가 있습니다.<span class="math inline">\(\타임스\)</span>2,048 픽셀. 여기에서 우리는이 중 세 가지를보고 있는데, 그 중 작은 지역이 자른다. 우리가 명시된 목표를 달성하는 방법을 알게되면, 우리의 능력을 큰 이미지 컬렉션에 적용 할 수 있으며, 이는 더 이상 겸손한 목표가 아닙니다!</p>
<section class="level3 page-columns page-full" data-number="11.8.1" id="interlude-the-intensity-scale-of-images">
<h3 class="anchored" data-anchor-id="interlude-the-intensity-scale-of-images" data-number="11.8.1"><span class="header-section-number">11.8.1</span>인터 루드 : 이미지의 강도 척도</h3>
<p>그러나 실제 작업으로 시작하기 전에 약간 평범한 데이터 변환 문제를 처리해야합니다. 물론 이것은 드문 일이 아닙니다. 이미지의 동적 범위 (최소 및 최대 값)를 검사하겠습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" href="#cb39-1" tabindex="-1"></a><span class="fu">적용하다</span>(세포,<span class="dv">3</span>, 범위)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Image-DAPI Image-FITC Image-Cy3
[1,] 0.001586938 0.002899214 0.001663233
[2,] 0.031204700 0.062485695 0.055710689</code></pre>
</div>
</div>
<p>우리는 최대 값이 적은 숫자가 1 미만이라는 것을 알 수 있습니다. 그 이유는<code>readimage</code>함수는 그것을 인식합니다<code>사소한 말다툼</code>이미지는 16 비트 정수를 사용하여 각 픽셀을 나타냅니다. 데이터를 반환합니다. R의 숫자 변수에서 일반적으로 데이터를 반환합니다. 정수 값 (이론적 범위는 0에서 ~ 0에서<span class="math inline">\ (2^{16} -1 = 65535 \)</span>) 부동 소수점 표현의 Mantissa에 저장된 지수와 이론적 범위가 간격에 매핑되도록 선택된 지수<span class="math inline">\ ([0,1] \)</span>. 그러나 이러한 이미지를 만드는 데 사용 된 스캐너는 11 ~ 12 비트 만 사용했으며 이미지의 작은 최대 값을 설명합니다. 우리는이 데이터를 레일링하여 범위를 대략 커버 할 수 있습니다.<span class="math inline">\ ([0,1] \)</span>다음과 같이<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>기능<code>정상화하십시오</code>이미지 스케일링에 대한보다 유연한 인터페이스를 제공합니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a>세포 [,,,<span class="dv">1</span>]]<span class="ot">=</span> <span class="dv">32</span> <span class="sc">*</span>세포 [,,,<span class="dv">1</span>]]</span>
<span id="cb41-2"><a aria-hidden="true" href="#cb41-2" tabindex="-1"></a>세포 [,,,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]]<span class="ot">=</span> <span class="dv">16</span> <span class="sc">*</span>세포 [,,,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]]</span>
<span id="cb41-3"><a aria-hidden="true" href="#cb41-3" tabindex="-1"></a><span class="fu">적용하다</span>(세포,<span class="dv">3</span>, 범위)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Image-DAPI Image-FITC Image-Cy3
[1,] 0.05078202 0.04638743 0.02661173
[2,] 0.99855039 0.99977111 0.89137102</code></pre>
</div>
</div>
<p>우리는 다중 2 개를 가진 이러한 곱셈이 저장된 데이터의 기본 정밀도에 영향을 미치지 않는다는 것을 명심할 수 있습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="11.8.2" id="sec-filter">
<h3 class="anchored" data-anchor-id="sec-filter" data-number="11.8.2"><span class="header-section-number">11.8.2</span>스무딩에 의한 노이즈 감소</h3>
<p>이제 우리는 이미지를 분석 할 준비가되었습니다. 첫 번째 목표는 개별 셀을 식별하기위한 이미지의 세분화이며, 스무딩을 통해 이미지에서 로컬 아티팩트 또는 소음을 제거하여 시작할 수 있습니다. 직관적 인 접근 방식은 각 픽셀 주위에서 선택된 크기의 창을 정의하고 해당 창의 값을 평균화하는 것입니다. 이 절차를 모든 픽셀에 적용한 후 새롭고 스무딩 된 이미지가 얻어집니다. 수학적으로, 우리는 이것을 다음과 같이 표현할 수 있습니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-scmdnhyxbglw" id="eq-scmdnhyxbglw"><span class="math display">\ [
f^*(x, y) = \ frac {1} {n} \ sum_ {s = -a}^{a} \ sum_ {t = -a}^{a} f (x+s, y+t),
\ tag {11.1} \]</span></span></p>
<p>어디<span class="math inline">\ (f (x, y) \)</span>위치에서 픽셀의 값입니다<span class="math inline">\(엑스\)</span>,,,<span class="math inline">\(와이\)</span>, 그리고<span class="math inline">\(에이\)</span>창 크기를 결정합니다<span class="math inline">\ (2A+1)</span>각 방향으로.<span class="math inline">\ (n = (2a+1)^2 \)</span>평균 픽셀의 수는<span class="math inline">\ (f^*\)</span>새롭고 매끄러운 이미지입니다.</p>
<p>보다 일반적으로 중량 기능을 사용하여 이동 평균을 가중 평균으로 대체 할 수 있습니다.<span class="math inline">\ (w \)</span>일반적으로 창 중간 점에서 가장 큰 무게를 갖는다 (<span class="math inline">\ (s = t = 0 \)</span>) 그리고 나서 가장자리를 향해 줄어 듭니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-linfilt" id="eq-linfilt"><span class="math display">\ [
(w * f) (x, y) = \ sum_ {s =-\ infty}^{+\ infty} \ sum_ {t =-\ infty}^{+\ infty} w (s, t) \, f (x+s, y+s)
\ tag {11.2} \]</span></span></p>
<p>표기 편의를 위해, 우리는 합산의 범위를 허용합니다<span class="math inline">\ (-\ infty \)</span>에게<span class="math inline">\ (\ (\ infty \)</span>실제로 합계는<span class="math inline">\ (w \)</span>제로가 아닌 값이 유한 한 유한 만 있습니다. 실제로, 우리는 무게 기능을 생각할 수 있습니다<span class="math inline">\ (w \)</span>다른 이미지 로서이 작업은<em>회선</em>이미지의<span class="math inline">\(에프\)</span>그리고<span class="math inline">\ (w \)</span>, 상징으로 표시됩니다<span class="math inline">\ (*\)</span>. ~ 안에<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong>, 2 차원 컨볼 루션은이 함수에 의해 구현됩니다<code>필터 2</code>보조 기능<code>Makebrush</code>중량 기능을 생성하는 데 사용할 수 있습니다<span class="math inline">\ (w \)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a>w<span class="ot">=</span> <span class="fu">Makebrush</span>(<span class="at">크기 =</span> <span class="dv">51</span>,,,<span class="at">모양 =</span> <span class="st">"가우시안"</span>,,,<span class="at">시그마 =</span> <span class="dv">7</span>))</span>
<span id="cb43-2"><a aria-hidden="true" href="#cb43-2" tabindex="-1"></a>핵무기<span class="ot">=</span> <span class="fu">필터 2</span>(<span class="fu">시든</span>(세포,<span class="dv">1</span>), w)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-nucSmooth">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nucSmooth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="11-chap_files/figure-html/fig-nucSmooth-1.png" title="Figure 11.9: nucSmooth, a smoothed version of the DNA channel in the image object cells (the original version is shown in the leftmost panel of Figure fig-LauferCells)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-nucSmooth-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nucSmooth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.9 :<code>핵무기</code>, 이미지 객체에서 DNA 채널의 부드러운 버전<code>세포</code>(원래 버전은 가장 왼쪽 패널에 표시됩니다.<a class="quarto-xref" href="#fig-LauferCells">수치<span>11.8</span></a>).
</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-brush">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.9</div>
</div>
<div class="callout-body-container callout-body">
<p>무게 매트릭스는 어떻습니까<code>w</code>보인다?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-16-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-16-contents callout-collapse collapse" id="callout-16">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-image-filter2">수치<span>11.10</span></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"tibble"</span>))</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a><span class="fu">티블</span>(<span class="at">w =</span>w [<span class="fu">nrow</span>(W)<span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span>,]))<span class="sc">|&gt;</span></span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">y =</span>w,<span class="at">x =</span> <span class="fu">서열</span>(<span class="at">함께 =</span>W)))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-image-filter2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-image-filter2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="11-chap_files/figure-html/fig-image-filter2-1.png" title="Figure 11.10: The middle row of the weight matrix, w[26, ]."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-image-filter2-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-image-filter2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.10 : 중량 매트릭스의 중간 행,<code>w [</code>26<code>,]</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>사실,<code>필터 2</code>함수는 표시된 요약을 직접 수행하지 않습니다<a class="quarto-xref" href="#eq-linfilt">방정식<span>11.2</span></a>. 대신, 수학적으로 동등하고 계산적으로 더 효율적인 방식으로 빠른 푸리에 변환을 사용합니다.</p>
<p>컨볼 루션<a class="quarto-xref" href="#eq-linfilt">방정식<span>11.2</span></a>a<em>선의</em>그 의미에서 작동<span class="math inline">\ (w*(c_1f_1+c_2f_2) =
c_1w*f_1 + c_2w*f_2 \)</span>두 이미지의 경우<span class="math inline">\ (f_1 \)</span>,,,<span class="math inline">\ (f_2 \)</span>그리고 숫자<span class="math inline">\ (C_1 \)</span>,,,<span class="math inline">\ (C_2 \)</span>. 선형 필터의 아름답고 강력한 이론이 있습니다<span class="citation" data-cites="FoundationSignalProcessing">(<a href="16-chap.html#ref-FoundationSignalProcessing" role="doc-biblioref">Vetterli, Kovačević 및 Goyal 2014</a>))</span>.</p>
<p>진행하기 위해 이제 우리가 표시 한 것보다 작은 스무딩 대역폭을 사용합니다.<a class="quarto-xref" href="#fig-nucSmooth">수치<span>11.9</span></a>데모를 위해. 사용합시다<code>시그마</code>DNA 채널의 경우 1 픽셀 및 액틴 및 튜 불린의 경우 3 픽셀.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a>CellsSmooth<span class="ot">=</span> <span class="fu">영상</span>(<span class="at">dim =</span> <span class="fu">어둑한</span>(세포))</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a>시그마<span class="ot">=</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">3</span>))</span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a><span class="cf">~을 위한</span>(나<span class="cf">~에</span> <span class="fu">seq_along</span>(시그마))</span>
<span id="cb45-4"><a aria-hidden="true" href="#cb45-4" tabindex="-1"></a>cellssmooth [,, i]<span class="ot">=</span> <span class="fu">필터 2</span>(세포 [,, i],</span>
<span id="cb45-5"><a aria-hidden="true" href="#cb45-5" tabindex="-1"></a>         <span class="at">필터 =</span> <span class="fu">Makebrush</span>(<span class="at">크기 =</span> <span class="dv">51</span>,,,<span class="at">모양 =</span> <span class="st">"가우시안"</span>,,,</span>
<span id="cb45-6"><a aria-hidden="true" href="#cb45-6" tabindex="-1"></a>                            <span class="at">시그마 =</span>시그마 [I]))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>평활화 된 이미지는 픽셀 노이즈를 줄 였지만 여전히 필요한 해상도입니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="11.9" id="sec-images-adapthresh">
<h2 class="anchored" data-anchor-id="sec-images-adapthresh" data-number="11.9"><span class="header-section-number">11.9</span>적응 형 임계 값</h2>
<p>적응 형 임계 값에 대한 아이디어는 우리가했던 것처럼 간단한 임계 값과 비교할 때<a class="quarto-xref" href="#fig-manip5">수치<span>11.6</span></a>b, 이미지의 다른 영역에서 임계 값이 다를 수 있습니다. 이런 식으로, 예를 들어, 고르지 않은 조명 또는 근처의 밝은 물체의 길 잃은 신호에 의해 발생한 기본 배경 신호의 공간 의존성을 예상 할 수 있습니다. 사실, 우리는 이미 오른쪽 하단 이미지에서 고르지 않은 배경에 대한 예를 보았습니다.<a class="quarto-xref" href="#fig-image-oneminus">수치<span>11.3</span></a>.</p>
<p>우리의 결장암 이미지 (<a class="quarto-xref" href="#fig-LauferCells">수치<span>11.8</span></a>) 그러한 인공물이 없지만 시연을 위해 2 차원 벨 기능으로 이미지에 이미지를 곱하여 고르지 않은 조명을 시뮬레이션합시다.<code>일루미네이션 그레이드</code>중간에서 가장 높은 가치를 지니고 측면으로 떨어집니다 (<a class="quarto-xref" href="#fig-illumination">수치<span>11.11</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a>파이<span class="ot">=</span> <span class="fu">서열</span>(<span class="sc">-</span><span class="dv">1</span>,,,<span class="sc">+</span><span class="dv">1</span>,,,<span class="at">length.out =</span> <span class="fu">어둑한</span>(Cellssmooth) [<span class="dv">1</span>])))</span>
<span id="cb46-2"><a aria-hidden="true" href="#cb46-2" tabindex="-1"></a>px<span class="ot">=</span> <span class="fu">서열</span>(<span class="sc">-</span><span class="dv">1</span>,,,<span class="sc">+</span><span class="dv">1</span>,,,<span class="at">length.out =</span> <span class="fu">어둑한</span>(Cellssmooth) [<span class="dv">2</span>])))</span>
<span id="cb46-3"><a aria-hidden="true" href="#cb46-3" tabindex="-1"></a>일루미네이션 그레이드<span class="ot">=</span> <span class="fu">영상</span>(<span class="fu">밖의</span>(PY, PX,<span class="cf">기능</span>(X, Y)<span class="fu">exp</span>(<span class="sc">-</span>(엑스<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span>와이<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb46-4"><a aria-hidden="true" href="#cb46-4" tabindex="-1"></a>뉴 바드 틸리 실 누화<span class="ot">=</span>CellsSmooth [,,,<span class="dv">1</span>]]<span class="sc">*</span>일루미네이션 그레이드</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 스무딩 창을 정의하고<code>디스크</code>크기는 21 픽셀이므로 우리가 감지하려는 핵보다 크지 만 조명 아티팩트의 길이 척도에 비해 작습니다. 우리는 그것을 사용하여 이미지를 계산합니다<code>로컬 백 그라운드</code>(그림에 표시됩니다<a class="quarto-xref" href="#fig-illumination-3">수치<span>11.11 (c)</span></a>) 및 임계 값 이미지<code>뉴 바드 스레 쉬</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" href="#cb47-1" tabindex="-1"></a>디스크<span class="ot">=</span> <span class="fu">Makebrush</span>(<span class="dv">21</span>,,,<span class="st">"디스크"</span>))</span>
<span id="cb47-2"><a aria-hidden="true" href="#cb47-2" tabindex="-1"></a>디스크<span class="ot">=</span>디스크<span class="sc">/</span> <span class="fu">합집합</span>(디스크)</span>
<span id="cb47-3"><a aria-hidden="true" href="#cb47-3" tabindex="-1"></a>로컬 백 그라운드<span class="ot">=</span> <span class="fu">필터 2</span>(NucbadlyIlluminated, 디스크)</span>
<span id="cb47-4"><a aria-hidden="true" href="#cb47-4" tabindex="-1"></a>오프셋<span class="ot">=</span> <span class="fl">0.02</span></span>
<span id="cb47-5"><a aria-hidden="true" href="#cb47-5" tabindex="-1"></a>뉴 바드 스레 쉬<span class="ot">=</span>(뉴 바드 틸리 실루 미네드<span class="sc">-</span>로컬 백 그라운드<span class="sc">&gt;</span>오프셋)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-layout-panel page-columns page-full" id="fig-illumination">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-illumination-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-illumination" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-illumination-1" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-illumination-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-illumination" href="11-chap_files/figure-html/fig-illumination-1.png" title="Figure 11.11 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-illumination" id="fig-illumination-1" src="11-chap_files/figure-html/fig-illumination-1.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-illumination-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-illumination" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-illumination-2" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-illumination-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-illumination" href="11-chap_files/figure-html/fig-illumination-2.png" title="Figure 11.11 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-illumination" id="fig-illumination-2" src="11-chap_files/figure-html/fig-illumination-2.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-illumination-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-illumination" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-illumination-3" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-illumination-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-illumination" href="11-chap_files/figure-html/fig-illumination-3.png" title="Figure 11.11 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-illumination" id="fig-illumination-3" src="11-chap_files/figure-html/fig-illumination-3.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-illumination-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-illumination" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-illumination-4" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-illumination-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-illumination" href="11-chap_files/figure-html/fig-illumination-4.png" title="Figure 11.11 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-illumination" id="fig-illumination-4" src="11-chap_files/figure-html/fig-illumination-4.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-illumination-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-illumination-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.11 : a :<code>일루미네이션 그레이드</code>, 중앙에 최대 값이 있고 측면을 향해 떨어지고 이미지에서 볼 수있는 불균일 한 조명을 시뮬레이션하는 함수. (비)<code>뉴 바드 틸리 실 누화</code>, DNA 채널을 곱한 이미지<code>CellsSmooth</code>~와 함께<code>일루미네이션 그레이드</code>. (기음)<code>로컬 백 그라운드</code>, 감지 할 물체보다 큰 대역폭이있는 선형 필터를 적용한 결과. (디)<code>뉴 바드 스레 쉬</code>, 적응성 임계 값의 결과. 이미지의 주변의 핵은 신호 강도의 하락에도 불구하고 합리적으로 잘 식별됩니다.</figcaption>
</figure>
</div>
<p>이것이 효과가 있다는 것을 알면 다음 단계에 필요한 실제 (인위적으로 저하되지 않은) 이미지에 대해 다시 동일하게합시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>Nucthresh<span class="ot">=</span>(CellsSmooth [,,,,<span class="dv">1</span>]]<span class="sc">-</span> <span class="fu">필터 2</span>(CellsSmooth [,,,,<span class="dv">1</span>], 디스크)<span class="sc">&gt;</span>오프셋)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>각 픽셀의 강도를 지역 동네의 값에서 결정한 배경과 비교함으로써, 우리는 객체가 이미지에 비교적 드문 분포되어있어 인근의 신호 분포가 배경에 의해 지배되도록 가정합니다. 우리의 이미지의 핵의 경우,이 가정은 의미가 있습니다. 다른 상황에서는 다른 가정을해야 할 수도 있습니다. 여기에서 수행 한 적응 형 임계 값은 선형 필터를 사용합니다.<code>필터 2</code>따라서 (가중치) 로컬 평균화에 해당합니다. 기타 배포 요약 (예 : 중앙값 또는 낮은 양자는 계산적으로 더 비싸더라도 바람직한 경향이 있습니다. 로컬 중간 필터링의 경우<strong><a href="https://bioconductor.org/packages/EBimage/">에비지</a></strong>기능을 제공합니다<code>중간 필터</code>.</p>
</section>
<section class="level2 page-columns page-full" data-number="11.10" id="morphological-operations-on-binary-images">
<h2 class="anchored" data-anchor-id="morphological-operations-on-binary-images" data-number="11.10"><span class="header-section-number">11.10</span>이진 이미지에 대한 형태 학적 작동</h2>
<p>임계 값 이미지<code>Nucthresh</code>(그림 [Morphop]의 왼쪽 패널에 표시되는 것은 아직 만족스럽지 않습니다. 핵의 경계는 약간 견고하고 단일 픽셀 수준에서 노이즈가 있습니다. 이러한 성가신을 제거하는 효과적이고 간단한 방법은 일련의 형태 학적 작업에 의해 제공됩니다.<span class="citation" data-cites="MathematicalMorphology">(<a href="16-chap.html#ref-MathematicalMorphology" role="doc-biblioref">세라 1983</a>))</span>.</p>
<p>이진 이미지 (값, 0 및 1, 후면 및 전경 픽셀을 나타내는 값 포함) 및 이진 마스크가 제공됩니다.<a class="footnote-ref" href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a>(때때로 구조화 요소라고도 함), 이러한 작업은 다음과 같이 작동합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>마스크의 예는 주어진 반경이있는 원 또는 더 정확하게는 중앙 픽셀로부터 특정 거리 내의 픽셀 세트입니다.</p></div></div><ul>
<li><p><code>좀먹다</code>: 모든 전경 픽셀에 대해 마스크를 그 주위에 놓고 마스크 아래의 픽셀이 배경에서 나오면이 모든 픽셀을 배경으로 설정하십시오.</p></li>
<li><p><code>넓히다</code>: 모든 배경 픽셀에 대해 마스크를 주위에 놓고 마스크 아래의 픽셀이 전경에서 나온 경우이 모든 픽셀을 전경으로 설정하십시오.</p></li>
<li><p><code>열려 있는</code>: 공연하다<code>좀먹다</code>그 뒤에<code>넓히다</code>.</p></li>
</ul>
<p>그러나 이러한 작업을 선형 필터와 달리 필터로 생각할 수도 있습니다.<a class="quarto-xref" href="#sec-linearfilters"><span>섹션 11.8</span></a>이진 이미지에서만 작동하며 선형성이 없습니다.</p>
<p>우리의 이미지에 형태 학적 개방을 적용합시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a>핵<span class="ot">=</span>에비지<span class="sc">::</span><span class="fu">열기</span>(Nucthresh,<span class="at">kern =</span> <span class="fu">Makebrush</span>(<span class="dv">5</span>,,,<span class="at">모양 =</span> <span class="st">"디스크"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이것의 결과는 미묘하며 이미지를 확대해야합니다.<a class="quarto-xref" href="#fig-morphop">수치<span>11.12</span></a>차이점을 발견하기 위해이 작업은 이진 이미지에서 응용 분야에서 바람직하지 않은 일부 픽셀 레벨 기능을 부드럽게합니다.</p>
</section>
<section class="level2 page-columns page-full" data-number="11.11" id="sec-segbin">
<h2 class="anchored" data-anchor-id="sec-segbin" data-number="11.11"><span class="header-section-number">11.11</span>이진 이미지를 물체로 분할</h2>
<p>이진 이미지<code>핵</code>이미지를 전경 및 배경 픽셀로 분할하지만 개별 핵으로는 그렇지 않습니다. 한 걸음 더 나아가 연결된 픽셀 세트로 정의 된 개별 객체를 추출 할 수 있습니다. ~ 안에<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong>,이 목적을위한 편리한 기능이 있습니다.<code>Bwlabel</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a>핵<span class="ot">=</span> <span class="fu">Bwlabel</span>(핵형)</span>
<span id="cb50-2"><a aria-hidden="true" href="#cb50-2" tabindex="-1"></a><span class="fu">테이블</span>(핵 신)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>핵
     0 1 2 3 4 5 6 7 8 9 10 
155408 511 330 120 468 222 121 125 159 116 520 
    11 12 13 14 15 16 17 18 19 20 20 21 
   115 184 179 116 183 187 303 226 164 309 194 
    22 23 24 25 26 27 28 29 30 31 32 
   148 345 287 203 379 371 208 222 320 443 409 
    33 34 35 36 37 38 39 40 41 42 43 
   493 256 169 225 376 214 228 341 269 119 315</code></pre>
</div>
</div>
<p>함수는 이미지를 반환하고<code>핵</code>, 정수 값의 0은 0이 배경을 나타내고, 1에서 43의 숫자는 다른 식별 된 객체를 색인화합니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-tablenucseed">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.10</div>
</div>
<div class="callout-body-container callout-body">
<p>위 표의 숫자는 얼마입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-18-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-18-contents callout-collapse collapse" id="callout-18">
<div class="callout-body-container callout-body">
<p>그것들은 각 물체의 영역 (픽셀)에 해당합니다. 우리는이 정보를 사용하여 우리가 기대하는 것과 비교하여 너무 크거나 작은 객체를 제거 할 수 있습니다.</p>
</div>
</div>
</div>
<p>이러한 이미지를 시각화하려면 기능이 있습니다<code>컬러 라벨</code>편리하며 (그레이 스케일) 정수 이미지를 각 객체에 대해 독특하고 임의로 선택한 색상을 사용하여 (그레이 스케일) 정수 이미지를 색상 이미지로 변환합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a>에비지<span class="sc">::</span><span class="fu">표시하다</span>(<span class="fu">컬러 라벨</span>(Nucseed)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이것은 중간 패널에 표시됩니다<a class="quarto-xref" href="#fig-morphop">수치<span>11.12</span></a>. 두 가지 유형의 오류를 발견 할 수 있지만 결과는 이미 고무적입니다.</p>
<ul>
<li><p>일부 인접한 물체는 제대로 분리되지 않았습니다.</p></li>
<li><p>일부 개체에는 구멍이 포함되어 있습니다.</p></li>
</ul>
<p>실제로 디스크 크기와 매개 변수를 사용하여 이들의 발생을 변경할 수 있습니다.<code>오프셋</code>~에<a class="quarto-xref" href="#sec-images-adapthresh"><span>섹션 11.9</span></a>: 오프셋을 더 높이기 위해 두 개의 인접한 물체가 터치하고 하나의 물체로 볼 수있는 확률이 줄어 듭니다.<code>Bwlabel</code>; 반면에, 그것은 훨씬 더 큰 구멍으로 이어집니다. 그 반대는 더 낮게 만들기위한 것입니다.</p>
<p>세분화는 많은 문헌, 소프트웨어 도구를 갖춘 풍부하고 다양한 연구 및 공학 분야입니다.<span class="citation" data-cites="schindelin2012fiji chaumont2012icy carpenter2006cellprofiler held2010cellcognition">(<a href="16-chap.html#ref-schindelin2012fiji" role="doc-biblioref">Schindelin et al. 2012</a>; <a href="16-chap.html#ref-chaumont2012icy" role="doc-biblioref">Chaumont et al. 2012</a>; <a href="16-chap.html#ref-carpenter2006cellprofiler" role="doc-biblioref">Carpenter et al. 2006</a>; <a href="16-chap.html#ref-held2010cellcognition" role="doc-biblioref">Hold et al. 2010 년</a>))</span>이미지 분석 및 기계 학습 커뮤니티의 실제 경험. 주어진 작업에 대한 적절한 접근 방식은 데이터와 기본 질문에 크게 의존하며 보편적으로 최상의 방법이 없습니다. 일반적으로 분석을 평가하기 위해 "지상 진실"또는 "금 표준"을 얻는 것은 어렵습니다. 선택한 이미지의 수동 주석에 의존하는 것은 드물지 않습니다. 어리석은 선택에도 불구하고 쉽게 갈 수 있으며, 우리는 간단한 솔루션으로 시작하는 것을 두려워 할 필요가 없습니다. 일반적으로 식별 할 물체 사이의 예상 형태, 크기 및 관계에 대한보다 사전 지식을 포함 할 수있는 방법으로부터 개선을 얻을 수 있습니다.</p>
<p>고 처리량 이미지의 통계 분석을 위해, 우리는 너무 많은 매개 변수 나 가정에 의존하지 않는 간단한 방법으로 만족할 수 있으며 아마도 차선이지만 빠르고 충분히 좋은 결과를 초래할 수 있습니다.<span class="citation" data-cites="PhenoRipper">(<a href="16-chap.html#ref-PhenoRipper" role="doc-biblioref">Rajaram et al. 2012</a>))</span>. 이 정신으로, 우리가 가진 것을 진행합시다. 우리는 핵 사이의 일부 영역을 덮더라도 모든 핵 염색 영역을 포함하는 관대 한 전경 마스크를 생성합니다. 그렇게하기 위해, 우리는 단순히 덜 엄격한 적응성 임계 값을 적용합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" href="#cb53-1" tabindex="-1"></a>Nucmask<span class="ot">=</span>CellsSmooth [,,,<span class="dv">1</span>]]<span class="sc">-</span> <span class="fu">필터 2</span>(CellsSmooth [,,,,<span class="dv">1</span>], 디스크)<span class="sc">&gt;</span> <span class="dv">0</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>또 다른 형태 학적 작동을 적용하십시오.<code>파일 홀</code>전경 픽셀로 둘러싸인 구멍을 채 웁니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a>Nucmask<span class="ot">=</span> <span class="fu">파일 홀</span>(Nucmask)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>향상<code>핵</code>, 우리는 이제 할 수 있습니다<em>전파</em>그들이 정의 된 마스크를 채울 때까지 세그먼트 된 물체<code>Nucmask</code>. 마스크가 연결된 장소에서 핵 사이의 경계는 기능에 구현 된 Voronoi Tessellation에 의해 그릴 수 있습니다.<code>전파</code>다음 섹션에서 설명됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a>핵<span class="ot">=</span> <span class="fu">전파</span>(CellsSmooth [,,,,<span class="dv">1</span>], 핵체,<span class="at">마스크 =</span>핵 마스크)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>결과는 가장 오른쪽 패널에 표시됩니다<a class="quarto-xref" href="#fig-morphop">수치<span>11.12</span></a>.</p>
<div class="quarto-layout-panel page-columns page-full" id="fig-morphop">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-morphop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-morphop" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-morphop-1" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-morphop-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-morphop" href="11-chap_files/figure-html/fig-morphop-1.png" title="Figure 11.12 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-morphop" id="fig-morphop-1" src="11-chap_files/figure-html/fig-morphop-1.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-morphop-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-morphop" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-morphop-2" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-morphop-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-morphop" href="11-chap_files/figure-html/fig-morphop-2.png" title="Figure 11.12 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-morphop" id="fig-morphop-2" src="11-chap_files/figure-html/fig-morphop-2.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-morphop-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-morphop" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-morphop-3" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-morphop-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-morphop" href="11-chap_files/figure-html/fig-morphop-3.png" title="Figure 11.12 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-morphop" id="fig-morphop-3" src="11-chap_files/figure-html/fig-morphop-3.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-morphop-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-morphop" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-morphop-4" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-morphop-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-morphop" href="11-chap_files/figure-html/fig-morphop-4.png" title="Figure 11.12 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-morphop" id="fig-morphop-4" src="11-chap_files/figure-html/fig-morphop-4.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-morphop-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-morphop" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-morphop-5" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-morphop-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-morphop" href="11-chap_files/figure-html/fig-morphop-5.png" title="Figure 11.12 (e): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-morphop" id="fig-morphop-5" src="11-chap_files/figure-html/fig-morphop-5.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-morphop-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(이자형)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-morphop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.12 : 핵 분할의 다른 단계. (a-e)에서 :<code>Nucthresh</code>,,,<code>핵</code>,,,<code>핵</code>,,,<code>Nucmask</code>,,,<code>핵</code>.
</figcaption>
</figure>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.12" id="sec-voronoi">
<h2 class="anchored" data-anchor-id="sec-voronoi" data-number="11.12"><span class="header-section-number">11.12</span>Voronoi Tessellation</h2>
<p>Voronoi Tessellation은 종자 지점 (또는 영역) 세트가 있고 공간의 각 지점이 가장 가까운 시드에 할당되는 방식 으로이 씨앗 사이에있는 공간을 분할하려는 경우 유용합니다. 이것은 직관적이고 강력한 아이디어 이므로이 섹션을 사용하여 짧은 파괴를 위해 사용하겠습니다. 기본 예를 고려해 봅시다. 우리는 이미지를 사용합니다<code>핵</code>씨앗으로. 기능을 호출합니다<code>전파</code>, 우리는 또한 다른 이미지를 지정해야합니다. 지금은 모든 0의 사소한 이미지를 제공하고 매개 변수를 설정합니다.<code>람다</code>큰 긍정적 가치로 (우리는 이러한 선택으로 돌아올 것입니다).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a>0<span class="ot">=</span> <span class="fu">영상</span>(<span class="at">dim =</span> <span class="fu">어둑한</span>(핵))</span>
<span id="cb56-2"><a aria-hidden="true" href="#cb56-2" tabindex="-1"></a>voronoiexamp<span class="ot">=</span> <span class="fu">전파</span>(<span class="at">씨앗 =</span>핵,<span class="at">x =</span>0,<span class="at">람다 =</span> <span class="dv">100</span>))</span>
<span id="cb56-3"><a aria-hidden="true" href="#cb56-3" tabindex="-1"></a>Voronoipaint<span class="ot">=</span> <span class="fu">PaintObjects</span>(voronoiexamp,<span class="dv">1</span> <span class="sc">-</span>핵형)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-voronoiPaint">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-voronoiPaint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="11-chap_files/figure-html/fig-voronoiPaint-1.png" title="Figure 11.13: Example of a Voronoi segmentation, indicated by the gray lines, using the nuclei (indicated by black regions) as seeds."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-voronoiPaint-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-voronoiPaint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.13 : 핵 (흑인 영역으로 표시)을 종자로 사용하여 회색 선으로 표시된 보로 노이 세분화의 예.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-voronoipart">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.11</div>
</div>
<div class="callout-body-container callout-body">
<p>Tessellation에서 파티션 요소를 어떻게 선택합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-20-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-20-contents callout-collapse collapse" id="callout-20">
<div class="callout-body-container callout-body">
<p>결과,<code>voronoiexamp</code>, 위의 전화의<code>전파</code>단순히 값이 다른 파티션을 나타내는 정수의 이미지입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a><span class="fu">머리</span>(<span class="fu">테이블</span>(voronoiexamp)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>voronoiexamp
   1 2 3 4 5 6 
5645 4735 370 5964 3333 1377</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a>인디<span class="ot">=</span> <span class="fu">어느</span>(voronoiexamp<span class="sc">==</span> <span class="dv">13</span>,,,<span class="at">arr.ind =</span> <span class="cn">진실</span>))</span>
<span id="cb59-2"><a aria-hidden="true" href="#cb59-2" tabindex="-1"></a><span class="fu">머리</span>(ind,<span class="dv">3</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>행 col
[1,] 112 100
[2,] 113 100
[3,] 114 100</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-voronoiPaint">수치<span>11.13</span></a>. 이것은 흥미로워 보이지만 이미지만큼 유용하지 않을 것입니다.<code>핵</code>그림 [Morphop]에서. 위에서 준 Voronoi Tessellation의 기본 정의는 두 가지 일반화를 허용합니다.</p>
<ul>
<li><p>기본적으로, 우리가 분할하는 공간은 전체 직사각형 이미지 영역이지만 실제로 우리는 임의의 하위 공간으로 제한 할 수 있습니다. 이것은 단순한 평평한 풍경이 아니라 호수와 강에 의해 산재 된 풍경 (교차 할 수없는)에서 각 지점에서 다음 씨앗까지의 가장 짧은 거리를 찾는 것과 유사합니다.<code>전파</code>이 일반화를 통해이 일반화를 허용합니다<code>마스크</code>매개 변수.</p></li>
<li><p>기본적으로, 우리는 공간을 평평하게 생각하지만 실제로는 언덕과 협곡이있을 수 있으므로 풍경의 두 지점 사이의 거리는 단지 그 공간이 있습니다.<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-위치뿐만 아니라 상승과 하강, 위아래로<span class="math inline">\(지\)</span>-방향, 그 사이에 있습니다. 우리는 생각할 수 있습니다<span class="math inline">\(지\)</span>"고도"로. 그러한 풍경을 지정할 수 있습니다<code>전파</code>그것을 통해<code>엑스</code>논쟁.</p></li>
</ul>
<p>수학적으로, 우리는 간단한 기본 케이스 (유클리드 메트릭이있는 평평한 사각형 또는 이미지) 대신에 특별한 모양과 특별한 지표를 가진 리만 매니 폴드에서 Voronoi 세분화를 수행한다고 말합니다. 표기법을 사용합시다<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>이미지의 열 및 행 좌표는<span class="math inline">\(지\)</span>고도를 위해. 좌표로 정의 된 두 개의 인접점<span class="math inline">\ ((x, y, z) \)</span>그리고<span class="math inline">\ ((x+\ text {d} x, y+\ text {d} y, z+\ text {d} z) \)</span>, 거리<span class="math inline">\ (\ text {d} s \)</span>따라서 2D 이미지의 일반적인 유클리드 메트릭으로는 얻지 못합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-eukldist" id="eq-eukldist"><span class="math display">\ [
\ text {d} s^2 = \ text {d} x^2 + \ text {d} y^2
\ tag {11.3} \]</span></span></p>
<p>그러나 대신</p>
<p><span class="anchored-eq" data-anchor-id="eq-riemandist" id="eq-riemandist"><span class="math display">\ [
\ text {d} s^2 = \ frac {2} {\ lambda + 1} \ left [\ lambda \ left (\ text {d} x^2 + \ text {d} y^2 \ right) + \ text {d} z^2 \ right],
\ tag {11.4} \]</span></span></p>
<p>매개 변수<span class="math inline">\ (\ lambda \)</span>실수입니다<span class="math inline">\ (\ ge0 \)</span>. 이를 이해하려면 몇 가지 중요한 사례를 살펴 보겠습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-Image" id="eq-Image-lambdaspecialcases"><span class="math display">\ [
\ begin {aligned}
\ lambda = 1 : &amp; \ quad \ text {d} s^2 = \ text {d} x^2 + \ text {d} y^2 + \ text {d} z^2 \\
\ lambda = 0 : &amp; \ quad \ text {d} s^2 = 2 \, \ text {d} z^2 \\
\ lambda \ to \ infty : &amp; \ quad \ text {d} s^2 = 2 \ left (\ text {d} x^2 + \ text {d} y^2 \ 오른쪽) \\
\ end {aligned}
\ tag {11.5} \]</span></span></p>
<p>을 위한<span class="math inline" data-anchor-id="eq-Image">\ (\ lambda = 1 \)</span>, 메트릭은 등방성 유클리드 메트릭, 즉 움직임이됩니다.<span class="math inline">\(지\)</span>-방향은 똑같이 "비싸거나"와 같이 "멀리"입니다<span class="math inline">\(엑스\)</span>- 또는<span class="math inline">\(와이\)</span>-방향. 극단적 인 경우<span class="math inline">\ (\ lambda = 0 \)</span>, 만<span class="math inline">\(지\)</span>-측면 움직임 (in<span class="math inline">\(엑스\)</span>- 또는<span class="math inline">\(와이\)</span>-방향) 거리에 기여하지 않습니다. 다른 극단적 인 경우,<span class="math inline">\ (\ lambda \ to \ infty \)</span>, 단지 측면의 움직임만이 중요하고 움직임<span class="math inline">\(지\)</span>-방향은 "무료"입니다. 더 멀리 떨어진 점 사이의 거리는 합산에 의해 얻어진다<span class="math inline">\ (\ text {d} s \)</span>그들 사이의 가장 짧은 경로를 따라. 매개 변수<span class="math inline">\ (\ lambda \)</span>옆으로 이동 사이의 상대 가중치를 편리하게 제어하는 ​​역할을합니다 (<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>축) 및 수직 이동. 직관적으로, 당신이 자신을 그러한 풍경에서 등산객으로 상상한다면<span class="math inline">\ (\ lambda \)</span>당신은 산을 극복하기 위해 위아래로 올라갈 준비가되어있는 것과 그 주위를 걷는 것을 지정할 수 있습니다. 우리가 사용할 때<code>람다 = 100</code>우리의 부름에서<code>전파</code>이 섹션이 시작될 때이 값은 효과적으로 무한했기 때문에 우리는 세 번째 경계 사례에있었습니다.<a class="quarto-xref" href="#eq-Image-lambdaspecialcases">방정식<span>11.5</span></a>.</p>
<p>세포 분할의 목적으로, 이러한 아이디어는 Thouis Jones et al.<span class="citation" data-cites="jones2005voronoi carpenter2006cellprofiler">(<a href="16-chap.html#ref-jones2005voronoi" role="doc-biblioref">Jones, Carpenter 및 Golland 2005</a>; <a href="16-chap.html#ref-carpenter2006cellprofiler" role="doc-biblioref">Carpenter et al. 2006</a>))</span>, 또한 사용하는 효율적인 알고리즘을 썼습니다.<code>전파</code>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>다른 사용의 효과를 시험해보십시오<span class="math inline">\ (\ lambda \)</span>에스.</p>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.13" id="sec-bodies">
<h2 class="anchored" data-anchor-id="sec-bodies" data-number="11.13"><span class="header-section-number">11.13</span>세포체를 분할</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-histcellbody-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histcellbody-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="11-chap_files/figure-html/fig-histcellbody-1-1.png" title="Figure 11.14: Histogram of the actin channel in cellsSmooth, after taking the logarithm."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-histcellbody-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histcellbody-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.14 : Actin 채널의 히스토그램<code>CellsSmooth</code>로그를 찍은 후.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-histcellbody-2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histcellbody-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="11-chap_files/figure-html/fig-histcellbody-2-1.png" title="Figure 11.15: Zoom into Figure fig-histcellbody-1."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-histcellbody-2-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histcellbody-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.15 : 확대<a class="quarto-xref" href="#fig-histcellbody-1">수치<span>11.14</span></a>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>이미지에서 세포질 영역의 마스크를 결정하려면 이번에는 혼합 모델을 데이터에 장착하여 찾은 글로벌 임계 값을 사용하여 다른 임계 값 방식을 탐색하겠습니다. 히스토그램은 액틴 이미지에서 픽셀 강도의 분포를 보여줍니다. 우리는 로그 척도의 데이터를보고<a class="quarto-xref" href="#fig-histcellbody-2">수치<span>11.15</span></a>대부분의 데이터가있는 지역으로 확대하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a aria-hidden="true" href="#cb61-1" tabindex="-1"></a><span class="fu">히스</span>(<span class="fu">통나무</span>(CellsSmooth [,,,,<span class="dv">3</span>])))</span>
<span id="cb61-2"><a aria-hidden="true" href="#cb61-2" tabindex="-1"></a><span class="fu">히스</span>(<span class="fu">통나무</span>(CellsSmooth [,,,,<span class="dv">3</span>]), <span class="at">xlim =</span> <span class="sc">-</span><span class="fu">기음</span>(<span class="fl">3.6</span>,,,<span class="fl">3.1</span>),)<span class="at">breaks =</span> <span class="dv">300</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>많은 이미지에 대해이 히스토그램을 살펴보면 세분화 목적으로 다음 모델을 설정할 수 있습니다.<em>영상</em> <code>세포</code>두 가지 분포의 혼합, 통나무 정상 배경 및 다른 분포, 지정되지 않은 다른 것, 다소 평평하지만 대부분의 겹치지 않는 분포와의 전경이 혼합 된 것입니다.<a class="footnote-ref" href="#fn10" id="fnref10" role="doc-noteref"><sup>10</sup></a>. 또한 대부분의 픽셀은 배경에서 나온 것입니다. 그런 다음 반 범위 모드 (패키지에서 구현 된 로그-정규 구성 요소의 위치 및 폭 매개 변수에 대한 강력한 추정치를 찾을 수 있습니다.<strong><a href="https://bioconductor.org/packages/genefilter/">genefilter</a></strong>) 그리고 모드에서 왼쪽에있는 값의 루트 평균 제곱에서.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>이것은 우리가 본 아이디어의 적용입니다.<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>혼합 모델에서.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Genefilter"</span>))</span>
<span id="cb62-2"><a aria-hidden="true" href="#cb62-2" tabindex="-1"></a>BGPARS<span class="ot">=</span> <span class="cf">기능</span>(x) {</span>
<span id="cb62-3"><a aria-hidden="true" href="#cb62-3" tabindex="-1"></a>엑스<span class="ot">=</span> <span class="fu">통나무</span>(엑스)</span>
<span id="cb62-4"><a aria-hidden="true" href="#cb62-4" tabindex="-1"></a>로 로치<span class="ot">=</span> <span class="fu">Half.range.Mode</span>(x)</span>
<span id="cb62-5"><a aria-hidden="true" href="#cb62-5" tabindex="-1"></a>왼쪽<span class="ot">=</span>(엑스<span class="sc">-</span>장소) [x<span class="sc">&lt;</span>도로]</span>
<span id="cb62-6"><a aria-hidden="true" href="#cb62-6" tabindex="-1"></a>wid<span class="ot">=</span> <span class="fu">sqrt</span>( <span class="fu">평균</span>(왼쪽<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb62-7"><a aria-hidden="true" href="#cb62-7" tabindex="-1"></a>  <span class="fu">기음</span>(<span class="at">loc =</span>엽서<span class="at">wid =</span>wid,<span class="at">thr =</span>로 로치<span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>wid)</span>
<span id="cb62-8"><a aria-hidden="true" href="#cb62-8" tabindex="-1"></a>}</span>
<span id="cb62-9"><a aria-hidden="true" href="#cb62-9" tabindex="-1"></a>Cellbg<span class="ot">=</span> <span class="fu">적용하다</span>(Cellssmooth,<span class="at">여백 =</span> <span class="dv">3</span>,,,<span class="at">재미 =</span>BGPARS)</span>
<span id="cb62-10"><a aria-hidden="true" href="#cb62-10" tabindex="-1"></a>Cellbg</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[, 1] [, 2] [, 3]
LOC -2.90176965 -2.94427499 -3.52191681
wid 0.00635322 0.01121337 0.01528207
Thr -2.86365033 -2.87699477 -3.43022437</code></pre>
</div>
</div>
<p>함수는 위치의 임계 값으로 정의됩니다<code>로 로치</code>더하기 6 폭<code>wid</code><a class="footnote-ref" href="#fn11" id="fnref11" role="doc-noteref"><sup>11</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>여기에서 숫자 6의 선택은 임시입니다. 우리는 두 혼합물 구성 요소의 가중치를 추정하고 혼합물 모델에 따른 후방 확률에 따라 각 픽셀을 앞쪽 또는 배경에 할당함으로써 임계 값을 더 객관적으로 선택할 수 있습니다. 보다 고급 세분화 방법은 이것이 실제로 분류 문제라는 사실을 사용하며 추가 기능과 더 복잡한 분류기를 분리하여 전경 및 배경 영역 (예 :<span class="citation" data-cites="ilastik:NatMeth:2019">(<a href="16-chap.html#ref-ilastik:NatMeth:2019" role="doc-biblioref">Berg et al. 2019</a>))</span>).</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a><span class="fu">히스</span>(<span class="fu">통나무</span>(CellsSmooth [,,,,<span class="dv">3</span>]), <span class="at">xlim =</span> <span class="sc">-</span><span class="fu">기음</span>(<span class="fl">3.6</span>,,,<span class="fl">3.1</span>),)<span class="at">breaks =</span> <span class="dv">300</span>))</span>
<span id="cb64-2"><a aria-hidden="true" href="#cb64-2" tabindex="-1"></a><span class="fu">Abline</span>(<span class="at">v =</span>cellbg [<span class="fu">기음</span>(<span class="st">"loc"</span>,,,<span class="st">"thr"</span>),)<span class="dv">3</span>],,<span class="at">col =</span> <span class="fu">기음</span>(<span class="st">"갈색"</span>,,,<span class="st">"빨간색"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-histcellbody-3">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histcellbody-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-32" href="11-chap_files/figure-html/fig-histcellbody-3-1.png" title="Figure 11.16: As in Figure fig-histcellbody-2, but with loc and thr shown by vertical lines."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-histcellbody-3-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histcellbody-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.16 :<a class="quarto-xref" href="#fig-histcellbody-2">수치<span>11.15</span></a>그러나<code>로 로치</code>그리고<code>thr</code>수직선으로 표시됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이제 정의 할 수 있습니다<code>Cytoplasmmask</code>액틴 또는 튜 불린 이미지의 임계 값 이상인 모든 픽셀의 결합에 의해 이미 이미지에서 핵으로 이미 분류 된<code>핵</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a>Cytoplasmmask<span class="ot">=</span>(CellsSmooth [,,,,<span class="dv">2</span>]]<span class="sc">&gt;</span> <span class="fu">exp</span>(Cellbg [<span class="st">"thr"</span>,,,<span class="dv">2</span>])))<span class="sc">|</span></span>
<span id="cb65-2"><a aria-hidden="true" href="#cb65-2" tabindex="-1"></a>핵<span class="sc">|</span>(CellsSmooth [,,,,<span class="dv">3</span>]]<span class="sc">&gt;</span> <span class="fu">exp</span>(Cellbg [<span class="st">"thr"</span>,,,<span class="dv">3</span>])))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>결과는 왼쪽 패널에 표시됩니다<a class="quarto-xref" href="#fig-cellbodies">수치<span class="anchored-eq" data-anchor-id="eq-riemandist">11.17</span></a>. 세포체를 정의하기 위해, 이제 우리는 이제 Voronoi Tessellation 기반 전파 알고리즘에 의해이 마스크 내의 핵 분할을 단순히 확장 할 수 있습니다.<a class="quarto-xref" href="#sec-voronoi"><span>섹션 11.12</span></a>. 이 방법은 각각의 핵에 대해 정확히 하나의 세포체가 있는지 확인하고, 세포 몸체는 세포 형태의 소형과 액틴과 액틴과 accin과 accin 사이에 타협에 도달하는 방식으로 묘사됩니다.<span class="math inline">\ (\ alpha \)</span>-이미지의 튜 불린 강도 신호. 의 용어에서<code>전파</code>알고리즘, 셀 모양은 콤팩트합니다<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>거리 메트릭의 구성 요소<a class="quarto-xref" href="#eq-riemandist"><span>11.4</span></a>및 액틴 신호는<span class="math inline">\(지\)</span>요소.<span class="math inline">\ (\ lambda \)</span>트레이드 오프를 제어합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" href="#cb66-1" tabindex="-1"></a>셀 바디<span class="ot">=</span> <span class="fu">전파</span>(<span class="at">x =</span>CellsSmooth [,,,<span class="dv">3</span>],,<span class="at">씨앗 =</span>핵,</span>
<span id="cb66-2"><a aria-hidden="true" href="#cb66-2" tabindex="-1"></a>                       <span class="at">람다 =</span> <span class="fl">1.0E-2</span>,,,<span class="at">마스크 =</span>cytoplasmmask)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>대안으로 표현합니다<code>컬러 라벨</code>플롯, 우리는 또한<code>PaintObjects</code>기능; 이미지<code>Nucsegonnuc</code>,,,<code>Nucsegonall</code>그리고<code>Cellsegonall</code>아래에 계산 된 것은 중간에서 오른쪽 패널에 표시됩니다.<a class="quarto-xref" href="#fig-cellbodies">수치<span>11.17</span></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a aria-hidden="true" href="#cb67-1" tabindex="-1"></a>CellScolor<span class="ot">=</span>에비지<span class="sc">::</span><span class="fu">rgbimeter</span>(<span class="at">빨간색 =</span>세포 [,,,<span class="dv">3</span>],,</span>
<span id="cb67-2"><a aria-hidden="true" href="#cb67-2" tabindex="-1"></a>                               <span class="at">녹색 =</span>세포 [,,,<span class="dv">2</span>],,</span>
<span id="cb67-3"><a aria-hidden="true" href="#cb67-3" tabindex="-1"></a>                               <span class="at">파란색 =</span>세포 [,,,<span class="dv">1</span>])))</span>
<span id="cb67-4"><a aria-hidden="true" href="#cb67-4" tabindex="-1"></a>Nucsegonnuc<span class="ot">=</span> <span class="fu">PaintObjects</span>(핵,<span class="at">tgt =</span>에비지<span class="sc">::</span><span class="fu">Torgb</span>(세포 [,,,<span class="dv">1</span>]), <span class="at">col =</span> <span class="st">"#ffff00"</span>))</span>
<span id="cb67-5"><a aria-hidden="true" href="#cb67-5" tabindex="-1"></a>Nucsegonall<span class="ot">=</span> <span class="fu">PaintObjects</span>(핵,<span class="at">tgt =</span>CellScolor,<span class="at">col =</span> <span class="st">"#ffff00"</span>))</span>
<span id="cb67-6"><a aria-hidden="true" href="#cb67-6" tabindex="-1"></a>Cellsegonall<span class="ot">=</span> <span class="fu">PaintObjects</span>(Cellbodies,<span class="at">tgt =</span>Nucsegonall,<span class="at">col =</span> <span class="st">"#FF0080"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-layout-panel page-columns page-full" id="fig-cellbodies">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-cellbodies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cellbodies" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cellbodies-1" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cellbodies-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-cellbodies" href="11-chap_files/figure-html/fig-cellbodies-1.png" title="Figure 11.17 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-cellbodies" id="fig-cellbodies-1" src="11-chap_files/figure-html/fig-cellbodies-1.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cellbodies-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cellbodies" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cellbodies-2" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cellbodies-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-cellbodies" href="11-chap_files/figure-html/fig-cellbodies-2.png" title="Figure 11.17 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-cellbodies" id="fig-cellbodies-2" src="11-chap_files/figure-html/fig-cellbodies-2.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cellbodies-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cellbodies" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cellbodies-3" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cellbodies-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-cellbodies" href="11-chap_files/figure-html/fig-cellbodies-3.png" title="Figure 11.17 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-cellbodies" id="fig-cellbodies-3" src="11-chap_files/figure-html/fig-cellbodies-3.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cellbodies-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cellbodies" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cellbodies-4" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cellbodies-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-cellbodies" href="11-chap_files/figure-html/fig-cellbodies-4.png" title="Figure 11.17 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-cellbodies" id="fig-cellbodies-4" src="11-chap_files/figure-html/fig-cellbodies-4.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cellbodies-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cellbodies" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-cellbodies-5" width="181.333333333333">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cellbodies-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-cellbodies" href="11-chap_files/figure-html/fig-cellbodies-5.png" title="Figure 11.17 (e): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-cellbodies" id="fig-cellbodies-5" src="11-chap_files/figure-html/fig-cellbodies-5.png" width="181"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cellbodies-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(이자형)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cellbodies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.17 : 세포체 세분화 단계. (A-D)에서 :<code>Cytoplasmmask</code>,,,<code>셀 바디</code>(파란색 : Dapi, Red : Actin, Green : Alpha-Tubulin),<code>Nucsegonnuc</code>,,,<code>Nucsegonall</code>,,,<code>Cellsegonall</code>.
</figcaption>
</figure>
</div>
</section>
<section class="level2" data-number="11.14" id="sec-featextract">
<h2 class="anchored" data-anchor-id="sec-featextract" data-number="11.14"><span class="header-section-number">11.14</span>기능 추출</h2>
<p>이제 우리는 분할이 있습니다<code>핵</code>그리고<code>셀 바디</code>원본 이미지 데이터와 함께<code>세포</code>, 우리는 각 셀에 대해 다양한 설명자 또는 기능을 계산할 수 있습니다. 우리는 이미 시작 부분에서 보았습니다<a class="quarto-xref" href="#sec-segbin"><span>섹션 11.11</span></a>기본 R 함수를 사용하는 방법<code>테이블</code>물체의 총 숫자와 크기를 결정합니다. 이제 이것을 추가로 가져 와서 DAPI 신호의 평균 강도를 계산합시다 (<code>세포 [,, 1]</code>) 세그먼트 핵에서, 평균 액틴 강도 (<code>세포 [,, 3]</code>) 세그먼트 된 핵 및 세포체의 평균 액틴 강도.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" href="#cb68-1" tabindex="-1"></a>평균<span class="ot">=</span> <span class="fu">apply</span>(세포 [,,,<span class="dv">1</span>], 핵, 평균)</span>
<span id="cb68-2"><a aria-hidden="true" href="#cb68-2" tabindex="-1"></a>MeanActIntinnuc<span class="ot">=</span> <span class="fu">apply</span>(세포 [,,,<span class="dv">3</span>], 핵, 평균)</span>
<span id="cb68-3"><a aria-hidden="true" href="#cb68-3" tabindex="-1"></a>Meanactintincell<span class="ot">=</span> <span class="fu">apply</span>(세포 [,,,<span class="dv">3</span>], 셀 바디, 평균)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>쌍별 산점도에서 기능을 시각화 할 수 있습니다 (<a class="quarto-xref" href="#fig-pairsint">수치<span>11.18</span></a>). 각 기능은 독립적 인 정보를 가지고 있지만 서로 상관 관계가 있음을 알 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a aria-hidden="true" href="#cb69-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Ggally"</span>))</span>
<span id="cb69-2"><a aria-hidden="true" href="#cb69-2" tabindex="-1"></a><span class="fu">ggpairs</span>(<span class="fu">티블</span>(Meannucint, Meanactintinnuc, Meanactintincell))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-pairsint">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pairsint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-38" href="11-chap_files/figure-html/fig-pairsint-1.png" title="Figure 11.18: Pairwise scatterplots of per-cell intensity descriptors."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-pairsint-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pairsint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.18 : 세포 당 강도 설명 자의 쌍별 산점도.</figcaption>
</figure>
</div>
</div>
</div>
<p>조금 더 작업하면보다 정교한 요약 통계를 계산할 수도 있습니다. 예를 들어 핵 영역 대 세포 신체 면적의 비율; 또는 세포 형태의 다소 추상적 측정으로서 각 세포체에서 상이한 형광 신호의 상호 정보 및 상호 정보 및 상관 관계. 예를 들어, 이러한 조치는 예를 들어 세포 구조의 미묘한 약물 유도 변화를 감지하기 위해 사용될 수있다.</p>
<p>비록<code>apply</code>위의 표현, 패키지<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong>또한 기능을 제공합니다<code>ComputeFeatures</code>문헌에서 일반적으로 사용 된 대규모 기능 모음을 효율적으로 계산합니다 (선구자 참조는 다음과 같습니다.<span class="citation" data-cites="BolandMurphy">볼랜드와 머피. (<a href="16-chap.html#ref-BolandMurphy" role="doc-biblioref">2001</a>))</span>). 이 기능에 대한 세부 사항은 수동 페이지에 설명되어 있으며 예제 응용 프로그램은<strong><a href="https://bioconductor.org/packages/HD2013SGI/">HD2013SGI</a></strong>삽화. 아래에서, 우리는 핵 분할을 사용하여 DAPI 채널의 각 셀에 대한 강도, 모양 및 질감에 대한 기능을 계산합니다.<code>핵</code>) 및 세포 신체 분할을 사용한 액틴 및 튜 불린 채널로부터 (<code>세포질</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" href="#cb70-1" tabindex="-1"></a>F1<span class="ot">=</span> <span class="fu">ComputeFeatures</span>(핵, 세포 [,,,,<span class="dv">1</span>],,<span class="at">xname =</span> <span class="st">"핵"</span>,,,<span class="at">refnames =</span> <span class="st">"핵"</span>))</span>
<span id="cb70-2"><a aria-hidden="true" href="#cb70-2" tabindex="-1"></a>F2<span class="ot">=</span> <span class="fu">ComputeFeatures</span>(세포, 세포 [,,,<span class="dv">2</span>],,<span class="at">xname =</span> <span class="st">"셀"</span>,,,<span class="at">refnames =</span> <span class="st">"통"</span>))</span>
<span id="cb70-3"><a aria-hidden="true" href="#cb70-3" tabindex="-1"></a>F3<span class="ot">=</span> <span class="fu">ComputeFeatures</span>(세포, 세포 [,,,<span class="dv">3</span>],,<span class="at">xname =</span> <span class="st">"셀"</span>,,,<span class="at">refnames =</span> <span class="st">"행동"</span>))</span>
<span id="cb70-4"><a aria-hidden="true" href="#cb70-4" tabindex="-1"></a><span class="fu">어둑한</span>(F1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43 89</code></pre>
</div>
</div>
<p><code>F1</code>43 개의 행 (각 셀마다 하나씩)과 89 개의 열이있는 매트릭스입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a>F1 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NUC.0.M.CX NUC.0.M.CY NUC.0.M. MAJORAXIS NUC.0.M.ECCANTRICITY NUC.0.M.THETA
1 119.5523 17.46895 44.86819 0.8372059 -1.314789
2 143.4511 15.83709 26.15009 0.6627672 -1.213444
3 336.5401 11.48175 18.97424 0.8564444 1.470913</code></pre>
</div>
</div>
<p>열 이름은 기능 유형뿐만 아니라 계산 된 컬러 채널 및 세분화 마스크를 인코딩합니다. 우리는 이제 다변량 분석 방법을 사용할 수 있습니다 - 장에서 본 것과 같이<a class="quarto-xref" href="05-chap.html"><span>5</span></a>,,,<a class="quarto-xref" href="07-chap.html"><span>7</span></a>그리고<a class="quarto-xref" href="09-chap.html"><span>9</span></a>- 많은 Dfferent 작업의 경우</p>
<ul>
<li><p>셀 하위 집단 감지 (클러스터링)</p></li>
<li><p>세포를 사전 정의 된 세포 유형 또는 표현형으로 분류 (분류)</p></li>
<li><p>소집단 또는 세포 유형의 절대 또는 상대 주파수가 다른 생물학적 조건에 해당하는 이미지간에 다른지 확인</p></li>
</ul>
<p>이러한 "일반적인"머신 러닝 작업 외에도 셀의 공간 위치를 알고 있으며 다음에서는 분석에서 이러한 방법을 사용할 수있는 몇 가지 방법을 탐색 할 것입니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>탐색 적 다변량 방법을 사용하여 행렬을 시각화하십시오<code>F1</code>,,,<code>F2</code>,,,<code>F3</code>: PCA, 히트 맵. "특이한"셀의 특별한 점은 무엇입니까?</p>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="11.15" id="sec-spatstat">
<h2 class="anchored" data-anchor-id="sec-spatstat" data-number="11.15"><span class="header-section-number">11.15</span>공간 통계 : 포인트 프로세스</h2>
<p>이전 섹션에서는 세포의 이미지를 사용하여 위치와 다양한 형태 및 형태 학적 특징을 추출하는 방법을 보았습니다. 이제 위치의 공간 분포를 탐색 할 것입니다. 흥미로운 데이터를 사용하려면 데이터 세트를 변경하고 유방암 림프절 생검을 살펴 봅니다.</p>
<section class="level3 page-columns page-full" data-number="11.15.1" id="a-case-study-interaction-between-immune-cells-and-cancer-cells">
<h3 class="anchored" data-anchor-id="a-case-study-interaction-between-immune-cells-and-cancer-cells" data-number="11.15.1"><span class="header-section-number">11.15.1</span>사례 연구 : 면역 세포와 암 세포 사이의 상호 작용</h3>
<p>림프절은 림프로 알려진 체액에 대한 면역 필터로서 기능한다. 항원은 림프절의 림프에서 여과되기 전에 순환으로 반환됩니다. 림프절은 신체 전체에서 발견되며 대부분 T 세포, B 세포, 수지상 세포 및 대 식세포로 구성됩니다. 노드는 대부분의 조직에서 액체를 배수합니다. 유방의 림프 덕트는 일반적으로 팔 아래의 나머지 림프절을 통해 배수하기 전에 보통 하나의 림프절로 배출됩니다. 첫 번째 림프절이라고합니다<em>보초</em>림프절. 비장과 유사한 방식으로, 항원을 포획하는 대 식세포 및 수지상 세포는 이들 외래 물질을 T 및 B 세포에 제시하여 면역 반응을 시작한다.</p>
<p>T 림프구는 일반적으로 기능적으로나 표현형 적으로 다른 두 개의 주요 서브 세트로 나뉩니다.</p>
<ul>
<li><p>CD4+ T- 세포 또는 T 헬퍼 세포 : 면역 조절의 관련 코디네이터입니다. T 헬퍼 세포의 주요 기능은 다른 백혈구를 활성화시키기 위해 감염과 싸우기 위해 특수한 요인의 분비에 의해 면역 반응을 강화하거나 강화시키는 것이다.</p></li>
<li><p>CD8+ T 세포, 또는 T 킬러/억제 세포 : 이들 세포는 특정 종양 세포, 바이러스 감염 세포 및 때로는 기생충을 직접 사멸시키는 데 중요하다. CD8+ T 세포는 또한 면역 반응의 하향 조절에 중요하다.</p></li>
</ul>
<p>두 유형의 T 세포는 신체 전체에서 발견 될 수 있습니다. 그들은 종종 활성화가 발생하는 사이트로서 2 차 림프 기관 (림프절 및 비장)에 의존한다.</p>
<p>수지상 세포 또는 CD1A 세포는 항원을 가공하고 T 세포에 펩티드를 제시하는 항원-제시 세포이다.</p>
<p>세포를 입력하는 것은 특정 시그니처를 제공하는 단백질 항체로 세포를 염색하여 수행 할 수 있습니다. 예를 들어, 상이한 유형의 면역 세포는 주로 세포막에서 발현 된 다른 단백질을 갖는다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-sixpanelslymphsmall">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-sixpanelslymphsmall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-39" href="imgs/SixPanelsLymphsmall.jpg" title="Figure 11.19: Biopsy of an enlarged lymph node revealed an intact capsule and obliterated sinuses (upper left panel, stained with hematoxylin and eosin, original magnification \times 100). The infiltrate was composed of an admixture of small lymphocytes, macrophages, and plasma cells (upper right panel, hematoxylin and eosin, original magnification \times 400). The infiltrate was composed of a mixture of CD3 positive T-cells (including both CD4 and CD8 positive cells) and CD20 positive B-cells. Numerous macrophages were also CD4 positive. (From: Hurley et al., Diagnostic Pathology (2008) 3:13)"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SixPanelsLymphsmall.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-sixpanelslymphsmall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.19 : 확대 된 림프절의 생검은 온전한 캡슐과 사망 한 부비동 (왼쪽 상단 패널, 헤 마톡 실린 및 에오신, 원래 배율로 염색했습니다.<span class="math inline">\(\타임스\)</span>100). 침윤은 작은 림프구, 대 식세포 및 혈장 세포의 혼합물로 구성되었다 (오른쪽 상단 패널, 헤 마톡 실린 및 에오신, 원래 배율<span class="math inline">\(\타임스\)</span>400). 침윤은 CD3 양성 T- 세포 (CD4 및 CD8 양성 세포 둘 다 포함) 및 CD20 양성 B- 세포의 혼합물로 구성되었다. 수많은 대 식세포는 또한 CD4 양성이었다. (출처 : Hurley et al., 진단 병리학 (2008) 3:13)</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-stainedlymphnode">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-stainedlymphnode-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-40" href="imgs/testscan_1_2_RGB99-4525D.jpg" title="Figure 11.20: A stained lymph node; this image is the basis for the spatial data in brcalymphnode."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/testscan_1_2_RGB99-4525D.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-stainedlymphnode-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.20 : 염색 된 림프절; 이 이미지는 공간 데이터의 기초입니다.<code>brcalymphnode</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>우리는 데이터를 볼 것입니다<span class="citation" data-cites="Setiadi2010">Setiadi et al. (<a href="16-chap.html#ref-Setiadi2010" role="doc-biblioref">2010 년</a>))</span>. 표시된 이미지를 세분화 한 후<a class="quarto-xref" href="#fig-stainedlymphnode">수치<span>11.20</span></a>세분화 방법을 사용합니다<em>배</em> <span class="citation" data-cites="Holmes2009">(<a href="16-chap.html#ref-Holmes2009" role="doc-biblioref">Holmes, Kapelner 및 Lee 2009</a>))</span>, 저자는 이미지의 모든 셀의 좌표와 유형을 얻었습니다. 우리는이 유형의 데이터를 호출합니다<em>표시된 포인트 프로세스</em>그리고 3 개의 열이있는 간단한 테이블로 볼 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"readr"</span>))</span>
<span id="cb74-2"><a aria-hidden="true" href="#cb74-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb74-3"><a aria-hidden="true" href="#cb74-3" tabindex="-1"></a>셀 클래스<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"t_cells"</span>,,,<span class="st">"종양"</span>,,,<span class="st">"DCS"</span>,,,<span class="st">"Other_Cells"</span>))</span>
<span id="cb74-4"><a aria-hidden="true" href="#cb74-4" tabindex="-1"></a>brcalymphnode<span class="ot">=</span> <span class="fu">lapply</span>(셀 클래스,<span class="cf">기능</span>(k) {</span>
<span id="cb74-5"><a aria-hidden="true" href="#cb74-5" tabindex="-1"></a>    <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">".."</span>,,,<span class="st">"데이터"</span>,,,<span class="fu">Sprintf</span>(<span class="st">"99_4525d-%s.txt"</span>, k)))<span class="sc">|&gt;</span></span>
<span id="cb74-6"><a aria-hidden="true" href="#cb74-6" tabindex="-1"></a>    <span class="fu">변하게 하다</span>(<span class="at">x =</span>GlobalX,<span class="at">y =</span>글로벌,<span class="at">클래스 =</span>케이)</span>
<span id="cb74-7"><a aria-hidden="true" href="#cb74-7" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> <span class="fu">돌연변이</span>(<span class="at">클래스 =</span> <span class="fu">요인</span>(수업))</span>
<span id="cb74-8"><a aria-hidden="true" href="#cb74-8" tabindex="-1"></a></span>
<span id="cb74-9"><a aria-hidden="true" href="#cb74-9" tabindex="-1"></a>brcalymphnode</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 209,462 × 3
       x y 클래스  
   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  
 1 6355 10382 t_cells
 2 6356 10850 t_cells
 3 6357 11070 T_CELLS
 4 6357 11082 T_CELLS
 5 6358 10600 T_CELLS
 6 6361 10301 t_cells
 7 6369 10309 t_cells
 8 6374 10395 t_cells
 9 6377 10448 t_cells
10 6379 10279 t_cells
# 209,452 행</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a><span class="fu">테이블</span>(brcalymphnode<span class="sc">$</span>수업)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DCS Other_Cells T_CELLS 종양 
        878 77081 103681 27822</code></pre>
</div>
</div>
<p>우리는 100,000 개 이상의 T 세포, 약 28,000 종의 종양 세포 및 수백 개의 수지상 세포 만 있음을 알 수 있습니다. 음모를 꾸미겠습니다<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-세포의 위치 (<a class="quarto-xref" href="#fig-brcalntcells">수치<span>11.21</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center" data-pointsize="24">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">필터</span>(brcalymphnode, 클래스<span class="sc">%안에%</span> <span class="fu">기음</span>(<span class="st">"t_cells"</span>,,,<span class="st">"종양"</span>)),</span>
<span id="cb78-2"><a aria-hidden="true" href="#cb78-2" tabindex="-1"></a>   <span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">col =</span>수업))<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">모양 =</span> <span class="st">"."</span>))<span class="sc">+</span></span>
<span id="cb78-3"><a aria-hidden="true" href="#cb78-3" tabindex="-1"></a>   <span class="fu">facet_grid</span>(.<span class="sc">~</span>수업)<span class="sc">+</span> <span class="fu">가이드</span>(<span class="at">col =</span> <span class="st">"없음"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-brcalntcells">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-brcalntcells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-41" href="11-chap_files/figure-html/fig-brcalntcells-1.png" title="Figure 11.21: Scatterplot of the x and y positions of the T- and tumor cells in brcalymphnode. The locations were obtained by a segmentation algorithm from a high resolution version of Figure fig-stainedlymphnode. Some rectangular areas in the T-cells plot are suspiciously empty, this could be because the corresponding image tiles within the overall composite image went missing, or were not analyzed."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-brcalntcells-1.png" width="640"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-brcalntcells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.21 : Scatterplot<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>T- 및 종양 세포의 위치<code>brcalymphnode</code>. 위치는 고해상도 버전의 세분화 알고리즘에 의해 얻어졌습니다.<a class="quarto-xref" href="#fig-stainedlymphnode">수치<span>11.20</span></a>. T- 세포 플롯의 일부 직사각형 영역은 의심스럽게 비어 있습니다. 전체 복합 이미지 내의 해당 이미지 타일이 누락되거나 분석되지 않았기 때문일 수 있습니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-axesinvert">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.12</div>
</div>
<div class="callout-body-container callout-body">
<p>수치를 비교하십시오<a class="quarto-xref" href="#fig-stainedlymphnode"><span>11.20</span></a>그리고<a class="quarto-xref" href="#fig-brcalntcells"><span>11.21</span></a>. 왜<span class="math inline">\(와이\)</span>-서로에 비해 반전 되는가?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-24-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-24-contents callout-collapse collapse" id="callout-24">
<div class="callout-body-container callout-body">
<p><a class="quarto-xref" href="#fig-stainedlymphnode">수치<span>11.20</span></a>원점이 이미지의 왼쪽 상단에있는 반면 이미지 데이터에 대한 협약을 따릅니다.<a class="quarto-xref" href="#fig-brcalntcells">수치<span>11.21</span></a>왼쪽 하단에 원점이있는 데카르트 음모 협약을 따릅니다.</p>
</div>
</div>
</div>
<p>기능을 사용합니다<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>패키지, 데이터를 변환하는 것이 편리합니다<code>brcalymphnode</code>수업 대상으로<em>PPP</em>; 우리는 시조 기능을 호출하여이를 수행합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Spat State"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a>ln<span class="ot">=</span> <span class="fu">~와 함께</span>(brcalymphnode,<span class="fu">PPP</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">마크 =</span>수업,</span>
<span id="cb80-2"><a aria-hidden="true" href="#cb80-2" tabindex="-1"></a>                             <span class="at">xrange =</span> <span class="fu">범위</span>(엑스),<span class="at">yrange =</span> <span class="fu">범위</span>(와이)))</span>
<span id="cb80-3"><a aria-hidden="true" href="#cb80-3" tabindex="-1"></a>ln</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>표시된 평면 지점 패턴 : 209462 포인트
레벨 = DCS, 기타_Cells, T_CELLS, 종양이있는 MultityPe 
창 : 사각형 = [3839, 17276] x [6713, 23006] 단위</code></pre>
</div>
</div>
<p><em>PPP</em>객체는 a의 실현을 캡처하도록 설계되었습니다<strong>공간 포인트 프로세스</strong>즉, 수학적 공간에 위치한 고립 된 점 세트; 우리의 경우 위에서 볼 수 있듯이 공간은 2 차원 사각형입니다.<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-코디네스. 또한 포인트가 될 수 있습니다<em>두드러진</em>특정 속성으로. ~ 안에<code>ln</code>, 마크는 단순히입니다<em>요인</em>변하기 쉬운<code>수업</code>. 보다 일반적으로 몇 가지 속성, 시간 또는 정량적 데이터 일 수도 있습니다. 표시된 포인트 프로세스와 이미지 사이에는 유사점이 있지만, 전자의 경우 포인트는 공간 내 어디에나있을 수 있지만 이미지에서는 픽셀이 공간을 일반적이고 직사각형으로 덮고 있습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="11.15.2" id="sec-chull">
<h3 class="anchored" data-anchor-id="sec-chull" data-number="11.15.2"><span class="header-section-number">11.15.2</span>볼록한 선체</h3>
<p>위에서, 우리는 (암시 적으로) 사각형에있는 포인트 프로세스를 제한했습니다. 실제로, 데이터 생성 프로세스는 조직 섹션의 형태에 따라 더 제한됩니다. 우리는 이것을 근사하고 포인트의 볼록한 선체에서 더 단단한 영역을 계산할 수 있습니다.<a class="footnote-ref" href="#fn12" id="fnref12" role="doc-noteref"><sup>12</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn12"><p><sup>12</sup>당신은 사용할 수 있습니다<code>str (cvxhul)</code>이 S3 객체의 내부 구조를 보려면.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a>탱커<span class="ot">=</span> <span class="fu">convexhull.xy</span>(<span class="fu">cbind</span>(ln<span class="sc">$</span>x, ln<span class="sc">$</span>와이))</span>
<span id="cb82-2"><a aria-hidden="true" href="#cb82-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(cvxhul<span class="sc">$</span>bdry [[<span class="dv">1</span>]]), <span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이))<span class="sc">+</span></span>
<span id="cb82-3"><a aria-hidden="true" href="#cb82-3" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="cn">NA</span>,,,<span class="at">col =</span> <span class="st">"검은색"</span>))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-convhull">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-convhull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-42" href="11-chap_files/figure-html/fig-convhull-1.png" title="Figure 11.22: Polygon describing the convex hull of the points in ln."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-convhull-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-convhull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.22 : 포인트의 볼록 헐을 설명하는 다각형<code>ln</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는 다각형을 볼 수 있습니다<a class="quarto-xref" href="#fig-convhull">수치<span>11.22</span></a>그리고 이제 전화하십시오<code>PPP</code>다시, 이번에는 다각형과 함께.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a aria-hidden="true" href="#cb83-1" tabindex="-1"></a>ln<span class="ot">=</span> <span class="fu">~와 함께</span>(brcalymphnode,<span class="fu">PPP</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">마크 =</span>수업,</span>
<span id="cb83-2"><a aria-hidden="true" href="#cb83-2" tabindex="-1"></a>                             <span class="at">폴리 =</span>탱커<span class="sc">$</span>bdry [[<span class="dv">1</span>]])))</span>
<span id="cb83-3"><a aria-hidden="true" href="#cb83-3" tabindex="-1"></a>ln</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>표시된 평면 지점 패턴 : 209462 포인트
레벨 = DCS, 기타_Cells, T_CELLS, 종양이있는 MultityPe 
창 : 다각형 경계
사각형을 둘러싸고있다 : [3839, 17276] x [6713, 23006] 단위</code></pre>
</div>
</div>
</section>
<section class="level3" data-number="11.15.3" id="sec-space">
<h3 class="anchored" data-anchor-id="sec-space" data-number="11.15.3"><span class="header-section-number">11.15.3</span>포인트 프로세스를위한 공간을 정의하는 다른 방법</h3>
<p>포인트 프로세스가 고려되는 공간을 정의하기 위해 볼록한 선체를 사용할 필요가 없습니다. 또는 이미지 마스크를 제공 할 수있었습니다<code>PPP</code>그것은 사전 지식을 기반으로 공간을 정의합니다. 또는 샘플링 된 지점에서 밀도 추정을 사용하여 산발적 특이 치를 무시하고 충분한 점 밀도가 높은 영역 만 식별 할 수 있습니다. 이러한 선택은 공간 포인트 프로세스를 고려할 때 분석가의 업무의 일부입니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="11.16" id="sec-intensity">
<h2 class="anchored" data-anchor-id="sec-intensity" data-number="11.16"><span class="header-section-number">11.16</span>첫 번째 주문 효과 : 강도</h2>
<p>공간 통계의 가장 기본적인 질문 중 하나는 인접한 포인트가 "클러스터링"인지, 즉“우연히”예상하는 것보다 서로 더 가까운 지 여부와 어느 정도인지 여부입니다. 또는 아마도 그들이 서로를 격퇴하는 것처럼 보이는지 그 반대 일 것입니다. 예를 들어, 이런 종류의 질문을 물을 수있는 많은 예가 있습니다.</p>
<ul>
<li><p>도시 내의 범죄 패턴,</p></li>
<li><p>한 국가 내 질병 패턴,</p></li>
<li><p>지역의 토양 측정.</p></li>
</ul>
<p>그러한 패턴이 존재하는 이유를 찾기가 어렵지 않습니다. 선과 나쁜 이웃, 생활 양식 또는 환경 노출의 지역적 변화, 토양의 일반적인 지질 역사. 때로는 관찰 된 사건이 ​​서로 끌어들이거나 격퇴하는 메커니즘이있을 수 있습니다 - 이웃의 속담“깨진 창문”또는 많은 세포 유형이 다른 세포에 가까이 붙어있는 경향이있을 수 있습니다.</p>
<p>셀 예제는 공간 클러스터링 (또는 반 클러스터링)이 객체의 속성 (또는 공간 포인트 프로세스의 말)에 의존 할 수 있음을 강조합니다. 또한 대답은 고려 된 길이 척도에 따라 다를 수 있음을 강조합니다. 세포가 서로를 끌어들이더라도 유한 한 크기를 가지고 있으며 같은 공간을 차지할 수 없습니다. 따라서 그들 사이에 약간의 거리가있을 것이며, 그 규모는 본질적으로 서로를 격퇴하지만 더 멀리 떨어져있는 동안 그들은 끌어냅니다.</p>
<p>이러한 질문을보다 정량적으로 공격하려면 우리가 기대하는 것에 대한 확률 론적 모델을 정의해야합니다.<em>우연히</em>. 하위 지역에있는 포인트 수를 세겠습니다.<span class="math inline">\(에이\)</span>한 지점 주위<span class="math inline">\ (p = (x, y) \)</span>; 이것을 불러주세요<span class="math inline">\ (n (p, a) \)</span><a class="footnote-ref" href="#fn13" id="fnref13" role="doc-noteref"><sup>13</sup></a>평균 및 공분산<span class="math inline">\(N\)</span>1 차 및 2 차 속성을 제공합니다. 첫 번째 순서는 프로세스의 강도입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn13"><p><sup>13</sup>평소와 같이 대문자 표기법을 사용합니다<span class="math inline" data-anchor-id="eq-omdpsghrjzyn">\ (n (p, a) \)</span>랜덤 변수 및 소문자의 경우<span class="math inline">\ (n (p, a) \)</span>실현 또는 샘플.</p></div></div><p><span id="eq-omdpsghrjzyn"><span class="math display">\ [
\ lambda (p) = \ lim_ {a \ rightarrow 0} \ frac {e [n (p, a)]} {a}.
\ tag {11.6} \]</span></span></p>
<p>여기서 우리는 무한한 미적분학을 사용하여 국소 강도를 정의했습니다.<span class="math inline">\ (\ lambda (p) \)</span>. 시계열의 경우 고정 프로세스는 우리가 지역 전체에 동질성을 가진 곳, 즉,<span class="math inline">\ (\ lambda (p) = \ text {const.} \)</span>; 그런 다음 지역의 강도<span class="math inline">\(에이\)</span>해당 지역에 비례합니다.<span class="math inline">\ (e [n (\ cdot, a)] = \ lambda a \)</span>. 나중에 공간 공분산과 같은 고차 통계도 살펴 보겠습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-crwopheibgjt" id="eq-crwopheibgjt"><span class="math display">\ [
\ gamma (p_1, p_2) = \ lim_ {a \ rightarrow 0}
\ frac {e \ left [\ left (n (p_1, a) - e [n (p_1, a)] \ 오른쪽)
\ left (n (p_2, a) - e [n (p_2, a)] \ 오른쪽) \ 오른쪽]} {a^2}.
\ tag {11.7} \]</span></span></p>
<p>프로세스가 고정 된 경우, 이는 두 지점의 상대 위치 (그들 사이의 벡터)에만 의존합니다. 거리에만 의존하는 경우, 즉 길이 만 있지만 벡터의 방향에만 있지 않은 경우 2 차 등방성이라고합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-raindrops">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-raindrops-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-43" href="imgs/Rain-Drops-small.jpg" title="Figure 11.23: Rain drops falling on the floor are modelled by a Poisson process. The number of drops falling on a particular spot only depends on the rate \lambda (and on the size of the spot), but not on what happens at other spots."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Rain-Drops-small.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-raindrops-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.23 : 바닥에 떨어지는 비가 떨어지는 것은 포아송 과정에 의해 모델링됩니다. 특정 지점에서 떨어지는 드롭의 수는 요율에만 해당됩니다.<span class="math inline">\ (\ lambda \)</span>(그리고 지점의 크기에) 그러나 다른 지점에서 일어나는 일에는 없습니다.</figcaption>
</figure>
</div>
</div></div></div>
<section class="level3" data-number="11.16.1" id="poisson-process">
<h3 class="anchored" data-anchor-id="poisson-process" data-number="11.16.1"><span class="header-section-number">11.16.1</span>포아송 프로세스</h3>
<p>가장 간단한 공간 프로세스는 포아송 프로세스입니다. 우리는 데이터를 데이터를 비교할 수있는 널 모델로 사용할 것입니다. 강도가 고정되어 있습니다<span class="math inline">\ (\ lambda \)</span>공간의 비 겹치는 영역에서 점수 발생 사이에는 더 이상 종속성이 없습니다. 또한, 지역 지역의 지점 수<span class="math inline">\(에이\)</span>요금으로 포아송 분포를 따릅니다<span class="math inline">\ (\ lambda a \)</span>.</p>
</section>
<section class="level3 page-columns page-full" data-number="11.16.2" id="estimating-the-intensity">
<h3 class="anchored" data-anchor-id="estimating-the-intensity" data-number="11.16.2"><span class="header-section-number">11.16.2</span>강도 추정</h3>
<p>강도를 추정하려면 영역을 하위 지역으로 나누고 잠재적 인 국소 변화를 볼 수있을 정도로 작습니다.<span class="math inline">\ (\ lambda (p) \)</span>, 그러나 충분한 포인트 샘플을 포함하기에 충분히 큽니다. 이것은 2D 밀도 추정과 유사하며, 하드 영역 경계 대신 부드러운 커널 기능을 사용할 수 있습니다.<span class="math inline">\(케이\)</span>.</p>
<p><span class="anchored-eq" data-anchor-id="eq-density" id="eq-density-ppp"><span class="math display">\ [
\ hat {\ lambda} (p) = \ sum_i e (p_i) k (p-p_i).
\ tag {11.8} \]</span></span></p>
<p>커널 함수는 스무딩 매개 변수에 따라 다릅니다.<span class="math inline" data-anchor-id="eq-density">\ (\ sigma \)</span>, 더 클수록, 우리가 각각에 대한 로컬 견적을 계산하는 영역이 클수록<span class="math inline">\(피\)</span>. <span class="math inline">\ (E (P) \)</span>에지 보정 계수이며 커널 ( "스무딩 창"의 지지대가 포인트 프로세스가 정의되는 공간 밖으로 나올 때 발생하는 추정 바이어스를 고려합니다. 기능<code>밀도</code>, 이는 정의됩니다<em>PPP</em>객체<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>패키지, 구현<a class="quarto-xref" href="#eq-density-ppp">방정식<span>11.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a aria-hidden="true" href="#cb85-1" tabindex="-1"></a>디<span class="ot">=</span> <span class="fu">밀도</span>(<span class="fu">서브 세트</span>(LN, 마크<span class="sc">==</span> <span class="st">"종양"</span>),)<span class="at">가장자리 =</span><span class="cn">진실</span>,,,<span class="at">Diggle =</span><span class="cn">진실</span>))</span>
<span id="cb85-2"><a aria-hidden="true" href="#cb85-2" tabindex="-1"></a><span class="fu">구성</span>(디)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-densityppp1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-densityppp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-44" href="11-chap_files/figure-html/fig-densityppp1-1.png" title="Figure 11.24: Intensity estimate for the cells marked Tumor in ppp. The support of the estimate is the polygon that we specified earlier on (Figure fig-convhull)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-densityppp1-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-densityppp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.24 : 표시된 셀의 강도 추정치<code>종양</code>~에<code>PPP</code>. 추정치의 지원은 앞에서 언급 한 다각형입니다.<a class="quarto-xref" href="#fig-convhull">수치<span>11.22</span></a>).
</figcaption>
</figure>
</div>
</div></div></div>
<p>줄거리가 표시됩니다<a class="quarto-xref" href="#fig-densityppp1">수치<span>11.24</span></a>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-diggle">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.13</div>
</div>
<div class="callout-body-container callout-body">
<p>추정치는 에지 수정없이 어떻게 보입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-26-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-26-contents callout-collapse collapse" id="callout-26">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" href="#cb86-1" tabindex="-1"></a>D0<span class="ot">=</span> <span class="fu">밀도</span>(<span class="fu">서브 세트</span>(LN, 마크<span class="sc">==</span> <span class="st">"종양"</span>),)<span class="at">가장자리 =</span> <span class="cn">거짓</span>))</span>
<span id="cb86-2"><a aria-hidden="true" href="#cb86-2" tabindex="-1"></a><span class="fu">구성</span>(D0)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-densityppp0">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-densityppp0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-45" href="11-chap_files/figure-html/fig-densityppp0-1.png" title="Figure 11.25: As Figure fig-densityppp1, but without edge correction."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-densityppp0-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-densityppp0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.25 : AS<a class="quarto-xref" href="#fig-densityppp1">수치<span>11.24</span></a>그러나 가장자리 보정이 없습니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>이제 추정 된 강도는 공간의 가장자리를 향해 더 작습니다.<a class="quarto-xref" href="#fig-densityppp0">수치<span>11.25</span></a>).</p>
</div>
</div>
</div>
<p><code>밀도</code>우리에게 추정치를 제공합니다<em>강함</em>포인트 프로세스의. 관련이지만 다른 작업은 (조건부)의 추정입니다.<em>개연성</em>특정 셀 클래스가되는 것. 기능<code>relary</code>특정 이벤트 유형의 공간적으로 다양한 위험에 대한 비모수 적 추정치를 계산합니다. 우리는 특정 공간 위치에 존재하는 세포가 종양 세포가 될 확률에 관심이 있습니다 (<a class="quarto-xref" href="#fig-relrisk">수치<span>11.26</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a aria-hidden="true" href="#cb87-1" tabindex="-1"></a>RR<span class="ot">=</span> <span class="fu">relary</span>(ln,<span class="at">시그마 =</span> <span class="dv">250</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a aria-hidden="true" href="#cb88-1" tabindex="-1"></a><span class="fu">구성</span>(RR)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-relrisk">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-relrisk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-46" href="11-chap_files/figure-html/fig-relrisk-1.png" title="Figure 11.26: Estimates of the spatially varying probability of each of the cell classes, conditional on there being cells."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-relrisk-1.png" width="560"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-relrisk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.26 : 세포가있는 경우 각 세포 클래스의 공간적으로 다양한 확률 추정치.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="11.17" id="second-order-effects-spatial-dependence">
<h2 class="anchored" data-anchor-id="second-order-effects-spatial-dependence" data-number="11.17"><span class="header-section-number">11.17</span>2 차 효과 : 공간 의존성</h2>
<p>공간 과정에서 무작위로 포인트를 선택하면 거리는 얼마입니까?<span class="math inline">\ (w \)</span>가장 가까운 이웃에게? 균질 한 포아송 프로세스의 경우이 거리의 누적 분포 함수는 다음과 같습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-GPP" id="eq-GPP"><span class="math display">\ [
g (w) = p (w q \ leq w) = 1 -by ^ - ^ - \ labda ^ 2}.
\ tag {11 11.9} \]</span></span></p>
<p>음모<span class="math inline">\(G\)</span>균질 한 포아송 과정에서 출발하는 것을 알아 차리는 방법을 제공합니다. 의 추정기<span class="math inline">\(G\)</span>또한 에지 효과를 고려합니다<span class="citation" data-cites="Baddeley1998 RipleySISS1988">(<a href="16-chap.html#ref-Baddeley1998" role="doc-biblioref">A. J. Baddeley 1998</a>; <a href="16-chap.html#ref-RipleySISS1988" role="doc-biblioref">리플리 1988</a>))</span>기능에 의해 제공됩니다<code>게스트</code>의<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>패키지.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a aria-hidden="true" href="#cb89-1" tabindex="-1"></a>GLN<span class="ot">=</span> <span class="fu">게스트</span>(LN)</span>
<span id="cb89-2"><a aria-hidden="true" href="#cb89-2" tabindex="-1"></a>GLN</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>함수 값 객체 (클래스 'fv')
함수 r-&gt; g (r)
..............................................................................................................................
        Math.Label 설명                                  
R r 거리 인수 r                          
Theo G [Pois] (R) 이론적 Poisson G (R)                     
한 모자 (G) [한] (R) g의 Hanisch 추정치 (R)                     
RS HAT (G) [BORD] (R) 국경 수정 G의 추정치 (R)            
km Hat (g) [km] (r) kaplan-meier g of g (r)                
위험 모자 (H) [km] (R) 위험 기능 H (R)의 Kaplan-Meier 추정
Theohaz H [Pois] (R) 이론적 Poisson 위험 기능 H (R)     
..............................................................................................................................
기본 플롯 공식 :. ~ r
어디 "." 'km', 'rs', 'han', 'theo'를 나타냅니다.
권장 인수 범위 r : [0, 20.998]
사용 가능한 인수 범위 r : [0, 52.443]</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a aria-hidden="true" href="#cb91-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rcolorbrewer"</span>))</span>
<span id="cb91-2"><a aria-hidden="true" href="#cb91-2" tabindex="-1"></a><span class="fu">구성</span>(GLN,<span class="at">xlim =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">10</span>),)<span class="at">lty =</span> <span class="dv">1</span>,,,<span class="at">col =</span> <span class="fu">브루어</span>(<span class="dv">4</span>,,,<span class="st">"set1"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Gest">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Gest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-47" href="11-chap_files/figure-html/fig-Gest-1.png" title="Figure 11.27: Estimates of G, using three different edge effect corrections –which here happen to essentially lie on top of each other– and the theoretical distribution for a homogenous Poisson process."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-Gest-1.png" width="340"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Gest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.27 : 추정치<span class="math inline">\(G\)</span>, 여기에서 본질적으로 서로 위에 놓여있는 세 가지 에지 효과 보정과 균질 한 포아송 과정의 이론적 분포를 사용합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>객체의 인쇄 요약<code>GLN</code>계산 된 추정치에 대한 개요를 제공합니다. 추가 설명은 수동 페이지에 있습니다<code>게스트</code>. ~ 안에<a class="quarto-xref" href="#fig-Gest">수치<span>11.27</span></a>우리는 경험적 분포 기능과 우리의 NULL 모델의 기능, 적절하게 선택된 강도가있는 균질 한 포아송 프로세스 인 약 4.5 단위로 교차합니다. 이 값보다 짧은 세포에서 세포 거리는 Null 모델보다 적은 가능성이 낮으며, 특히, 본질적으로 약 2 아래의 거리가 없습니다. 물론 이것은 우리 셀의 크기가 유한하고 같은 공간과 겹칠 수 없다는 사실을 반영합니다. 포아송 프로세스와 비교하여 매우 먼 거리를 피하는 경향이있는 것 같습니다.</p>
<section class="level3 page-columns page-full" data-number="11.17.1" id="ripleys-k-function">
<h3 class="anchored" data-anchor-id="ripleys-k-function" data-number="11.17.1"><span class="header-section-number">11.17.1</span>리플리<span class="math inline">\(케이\)</span>기능</h3>
<p>균질 한 공간 Poisson 프로세스에서, 우리가 무작위로 어떤 점을 선택하고 최대 거리 내에서 포인트 수를 세면<span class="math inline">\(아르 자형\)</span>, 우리는이 숫자가 원의 영역으로 성장할 것으로 기대합니다.<span class="math inline">\ (\ pi r^2 \)</span>. 주어진 데이터 세트의 경우이 기대치를 먼 거리 내에서 관찰 된 이웃 수와 비교할 수 있습니다.<span class="math inline">\(아르 자형\)</span>, 모든 지점에서 평균.</p>
<p>그만큼<span class="math inline">\(케이\)</span>기능 (다양하게 호출됩니다<em>리플리<span class="math inline">\(케이\)</span>-기능</em>또는<em>두 번째 순간 기능 감소</em>) 고정 점 프로세스의 경우<span class="math inline">\ (\ lambda k (r) \)</span>거리 내의 예상 (추가) 포인트 수입니다.<span class="math inline">\(아르 자형\)</span>주어진 무작위로 선택된 지점의. 기억하십시오<span class="math inline">\ (\ lambda \)</span>프로세스의 강도, 즉 단위 영역 당 예상 포인트 수입니다. 그만큼<span class="math inline">\(케이\)</span>기능은 프로세스의 2 차 모멘트 속성입니다.</p>
<p>의 정의<span class="math inline">\(케이\)</span>불균일 한 지점 과정으로 일반화되고<span class="citation" data-cites="Baddeley2000">(<a href="16-chap.html#ref-Baddeley2000" role="doc-biblioref">A. Baddeley, Moller 및 Waagepetersen 2000</a>))</span>,,,</p>
<p><span class="anchored-eq" data-anchor-id="eq-kinhom" id="eq-kinhom"><span class="math display">\ [
k _ {\ scriptsize {mbox {inersom}} (r) = \ sum_ {i, j} {d (p_i, p_j) \ le r} \ times \ frac {e (p_i, p_j, r)} {\ lambda (x_i) \ lambda (x_j)},
\ tag {11.10} \]</span></span></p>
<p>어디<span class="math inline">\ (d (p_i, p_j) \)</span>점 사이의 거리입니다<span class="math inline">\ (p_i \)</span>그리고<span class="math inline">\ (P_J \)</span>, 그리고<span class="math inline">\ (e (p_i, p_j, r) \)</span>에지 수정 계수입니다<a class="footnote-ref" href="#fn14" id="fnref14" role="doc-noteref"><sup>14</sup></a>. 추정 및 시각화를 위해<span class="math inline">\(케이\)</span>(그리고 유사하게<span class="math inline">\ (k _ {\ scriptsize \ mbox {inhom}} \)</span>), 소위<span class="math inline">\(엘\)</span>기능.</p>
<div class="no-row-height column-margin column-container"><div id="fn14"><p><sup>14</sup>수동 페이지를 참조하십시오<code>Kinhom</code>자세한 내용.</p></div></div><p><span class="anchored-eq" data-anchor-id="eq-Lest" id="eq-Lest"><span class="math display">\ [
l (r) = \ sqrt {\ frac {k (r)} {\ pi}}.
\ tag {11.11} \]</span></span></p>
<p>균질 한 공간 포아송 과정의 경우 이론적 가치는 다음과 같습니다.<span class="math inline" data-anchor-id="eq-Lest">\ (l (r) = r \)</span>. 이를 추정치와 비교함으로써<span class="math inline">\(엘\)</span>데이터 세트의 경우 포인트 간 의존성 및 공간 클러스터링에 대해 배울 수 있습니다. 제곱근<a class="quarto-xref" href="#eq-Lest">방정식<span>11.11</span></a>추정기의 분산을 안정화시키는 효과가 있으므로<span class="math inline">\(케이\)</span>,,,<span class="math inline">\(엘\)</span>데이터 분석 및 시뮬레이션에 더 적합합니다. 함수의 계산<code>리놈</code>의<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>패키지 데이터에 몇 분이 걸립니다 (<a class="quarto-xref" href="#fig-images-Lln">수치<span>11.28</span></a>).</p>
<div class="cell" data-layout-align="center" data-warning.known="fvlabels truncated the function name">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a aria-hidden="true" href="#cb92-1" tabindex="-1"></a>lln<span class="ot">=</span> <span class="fu">리놈</span>(<span class="fu">서브 세트</span>(LN, 마크<span class="sc">==</span> <span class="st">"t_cells"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a aria-hidden="true" href="#cb93-1" tabindex="-1"></a>lln</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>함수 값 객체 (클래스 'fv')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>함수 r-&gt; l [insom] (r)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>........................................................................................
           Math.Label                
r r                         
Theo l [pois] (r)                
Border {Hat (l) [inhom]^{bord}} (r) 
bord.modif {Hat (l) [inhom]^{bordm}} (r)
           설명                                      
R 거리 인수 r                              
Theo 이론 Poisson L [inhom] (R)                  
L [Inhom] (R)의 국경 경계 수정 추정치         
Bord.Modif L [inhom] (r)의 Bordif 수정 경계 수정 추정치
........................................................................................
기본 플롯 공식 :. ~ .x
어디 "." 'Bord.Modif', 'Border', 'Theo'의 약자
권장 인수 범위 r : [0, 694.7]
사용 가능한 인수 범위 r : [0, 694.7]</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="fvlabels truncated the function name">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a aria-hidden="true" href="#cb97-1" tabindex="-1"></a><span class="fu">구성</span>(lln,<span class="at">lty =</span> <span class="dv">1</span>,,,<span class="at">col =</span> <span class="fu">브루어</span>(<span class="dv">3</span>,,,<span class="st">"set1"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-images-Lln">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-images-Lln-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-48" href="11-chap_files/figure-html/fig-images-Lln-1.png" title="Figure 11.28: Estimate of L_{\scriptsize \mbox{inhom}}, Equations eq-kinhom and eq-Lest, of the T cell pattern."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-images-Lln-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-images-Lln-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.28 : 추정치<span class="math inline" data-anchor-id="eq-Lest">\ (l _ {\ scriptsize \ mbox {inhom}} \)</span>, 방정식<a class="quarto-xref" href="#eq-kinhom"><span>11.10</span></a>그리고<a class="quarto-xref" href="#eq-Lest"><span>11.11</span></a>, T 세포 패턴의.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는 이제 그것을 살펴볼 수 있습니다<span class="math inline">\(엘\)</span>다른 세포 유형과 다른 종양뿐만 아니라 건강한 림프절에도 기능합니다. 이것이 Setiadi와 동료들이 보고서에서 한 일입니다.<span class="citation" data-cites="Setiadi2010">(<a href="16-chap.html#ref-Setiadi2010" role="doc-biblioref">Setiadi et al. 2010 년</a>))</span>여기서, 건강 및 유방암 림프절 사이의 T 및 B 세포의 공간 그룹화 패턴을 비교함으로써, 그들은 B 세포가 일부 종양에서 림프절의 외피 적 영역에서 정상 국소화를 잃는 것으로 나타났다.</p>
<section class="level4 unnumbered page-columns page-full" id="the-pair-correlation-function">
<h4 class="unnumbered anchored" data-anchor-id="the-pair-correlation-function">쌍의 상관 관계 기능</h4>
<p>포인트 밀도가 기준점으로부터의 거리의 함수에 따라 어떻게 변하는 지 설명합니다. 그것은 공간 클러스터링을 보는 물리학에서 영감을 얻은 관점을 제공합니다. 고정 점 프로세스의 경우 다음과 같이 정의됩니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-pcf" id="eq-pcf"><span class="math display">\ [
g (r) = \ frac {1} {2 \ pi r} \ frac {dk} {dr} (r).
\ tag {11.12} \]</span></span></p>
<p>고정식 포아송 프로세스의 경우 쌍 상관 함수는 동일한 1과 동일합니다. 값<span class="math inline">\ (g (r) &lt;1 \)</span>점 사이의 억제를 제안합니다. 1보다 큰 값은 클러스터링을 제안합니다.</p>
<p>그만큼<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>패키지는 추정치를 컴퓨팅 할 수 있습니다<span class="math inline" data-anchor-id="eq-pcf">\(g\)</span>불균일 한 과정에서도 우리가 전화하면<code>PCF</code>아래와 같이 정의<a class="quarto-xref" href="#eq-pcf"><span>11.12</span></a>추정치에 적용됩니다<span class="math inline">\ (k _ {\ scriptsize \ mbox {inhom}} \)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a aria-hidden="true" href="#cb98-1" tabindex="-1"></a>PCFLN<span class="ot">=</span> <span class="fu">PCF</span>(<span class="fu">Kinhom</span>(<span class="fu">서브 세트</span>(LN, 마크<span class="sc">==</span> <span class="st">"t_cells"</span>))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a aria-hidden="true" href="#cb99-1" tabindex="-1"></a><span class="fu">구성</span>(PCFLN,<span class="at">lty =</span> <span class="dv">1</span>))</span>
<span id="cb99-2"><a aria-hidden="true" href="#cb99-2" tabindex="-1"></a><span class="fu">구성</span>(PCFLN,<span class="at">lty =</span> <span class="dv">1</span>,,,<span class="at">xlim =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">10</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-images-pcf">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-images-pcf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-images-pcf" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-images-pcf-1" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-images-pcf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-images-pcf" href="11-chap_files/figure-html/fig-images-pcf-1.png" title="Figure 11.29 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-images-pcf" id="fig-images-pcf-1" src="11-chap_files/figure-html/fig-images-pcf-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-images-pcf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-images-pcf" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-images-pcf-2" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-images-pcf-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-images-pcf" href="11-chap_files/figure-html/fig-images-pcf-2.png" title="Figure 11.29 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-images-pcf" id="fig-images-pcf-2" src="11-chap_files/figure-html/fig-images-pcf-2.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-images-pcf-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-images-pcf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.29 : 쌍 상관 함수의 추정치,<a class="quarto-xref" href="#eq-pcf">방정식<span>11.12</span></a>, T 세포 패턴의.</figcaption>
</figure>
</div>
<p>우리가 볼 수 있듯이<a class="quarto-xref" href="#fig-images-pcf">수치<span>11.29</span></a>, T 세포 클러스터는 매우 짧은 거리에 있지만 회피에 대한 증거도 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-images-samplingpcf">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 11.14</div>
</div>
<div class="callout-body-container callout-body">
<p>하단 패널에서 쌍 상관 함수의 플롯에서 샘플링 해상도<a class="quarto-xref" href="#fig-images-pcf">수치<span>11.29</span></a>낮습니다. 어떻게 증가 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-28-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-28-contents callout-collapse collapse" id="callout-28">
<div class="callout-body-container callout-body">
<p>대답은<code>아르 자형</code>의 주장<code>Kinhom</code>기능; 보다<a class="quarto-xref" href="#fig-samplingpcf">수치<span>11.30</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a aria-hidden="true" href="#cb100-1" tabindex="-1"></a>PCFLN2<span class="ot">=</span> <span class="fu">PCF</span>(<span class="fu">Kinhom</span>(<span class="fu">서브 세트</span>(LN, 마크<span class="sc">==</span> <span class="st">"t_cells"</span>),)</span>
<span id="cb100-2"><a aria-hidden="true" href="#cb100-2" tabindex="-1"></a>                    <span class="at">r =</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">10</span>,,,<span class="at">by =</span> <span class="fl">0.2</span>))))</span>
<span id="cb100-3"><a aria-hidden="true" href="#cb100-3" tabindex="-1"></a><span class="fu">구성</span>(PCFLN2,<span class="at">lty =</span> <span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-samplingpcf">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-samplingpcf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-51" href="11-chap_files/figure-html/fig-samplingpcf-1.png" title="Figure 11.30: Answer to Question wrn-images-samplingpcf: as in the bottom panel of Figure fig-images-pcf, but with denser sampling."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-samplingpcf-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-samplingpcf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.30 : 답변<a class="quarto-xref" href="#wrn-images-samplingpcf">질문<span>11.14</span></a>: 하단 패널에서와 같이<a class="quarto-xref" href="#fig-images-pcf">수치<span>11.29</span></a>그러나 더 밀도가 높은 샘플링.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="level2" data-number="11.18" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="11.18"><span class="header-section-number">11.18</span>이 장의 요약</h2>
<p>우리는 R의 이미지 데이터로 작업하는 법을 배웠습니다. 이미지는 기본적으로 배열 일 뿐이며 친숙한 관용구를 사용하여 조작 할 수 있습니다. 우리는 이미지에서 정량적 기능을 추출 할 수 있으며, 많은 분석 질문은 다른 고 처리량 데이터와는 다릅니다. 수단 및 차이와 같은 통계로 기능을 요약하고 조건 간의 차이에 대한 가설 테스트, 분산 분석 수행, 클러스터링 및 분류 적용을 수행합니다.</p>
<p>종종 우리는 종종 전체 이미지가 아니라 이미지에 표시된 개별 객체에 대해 그러한 정량적 특징을 계산하고, 먼저 관심있는 객체의 경계를 구분하기 위해 이미지를 세그먼트해야합니다. 우리는 핵과 세포의 이미지를 위해 이것을하는 방법을 보았습니다.</p>
<p>관심이 물체의 위치와 이러한 위치가 서로 어떻게 관련되는지에 대한 관심이있는 경우, 우리는의 영역에 들어갑니다.<em>공간 통계</em>. 우리는 그 기능 중 일부를 탐색했습니다<strong><a href="https://cran.r-project.org/web/packages/spatstat/">스 패트 상태</a></strong>패키지, 포인트 프로세스 클래스를 만났으며 Ripley 's와 같은 포인트 패턴에 사용되는 특정 진단 통계를 배웠습니다.<span class="math inline">\(케이\)</span>기능.</p>
</section>
<section class="level2" data-number="11.19" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="11.19"><span class="header-section-number">11.19</span>추가 독서</h2>
<ul>
<li><p>이미지 분석에 대한 방대한 양의 문헌이 있습니다. 이를 탐색 할 때 필드가 두 가지 힘의 세력에 의해 구동된다는 것을 인식하는 것이 도움이됩니다 : 특정 응용 분야 (고 처리량 셀 기반 분석법 분석을 보았음) 및 사용 가능한 컴퓨터 하드웨어. 1970 년대에 개발 된 일부 알고리즘과 개념은 여전히 ​​관련이 있으며, 다른 알고리즘은보다 체계적이고 계산적으로 더 집중적 인 방법에 의해 대체되었습니다. 많은 알고리즘은 데이터의 특성 및 묻는 과학적 질문에 대한 특정 가정을 암시합니다. 고전적인 소개입니다<em>이미지 처리 핸드북</em> <span class="citation" data-cites="RussImageProcessingHandbook">(<a href="16-chap.html#ref-RussImageProcessingHandbook" role="doc-biblioref">Russ and Neal 2015</a>))</span>지금은 제 7 판입니다.</p></li>
<li><p>공간 포인트 패턴 분석을 위해<span class="citation" data-cites="DiggleSPP RipleySISS1988 CressieSSD1991 MeckeSG2013">디글 (Diggle) (<a href="16-chap.html#ref-DiggleSPP" role="doc-biblioref">2013</a>; <a href="16-chap.html#ref-RipleySISS1988" role="doc-biblioref">리플리 1988</a>; <a href="16-chap.html#ref-CressieSSD1991" role="doc-biblioref">CRESSION 1991</a>; <a href="16-chap.html#ref-MeckeSG2013" role="doc-biblioref">Chiu et al. 2013</a>))</span>.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="11.20" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="11.20"><span class="header-section-number">11.20</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-images-selfies">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 11.1</div>
</div>
<div class="callout-body-container callout-body">
<p>개인 사진 라이브러리의 일부 이미지를 R에로드하고 조작을 시도하십시오.<a class="quarto-xref" href="#sec-manip"><span>섹션 11.6</span></a>그들에게.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-images-propagate">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 11.2</div>
</div>
<div class="callout-body-container callout-body">
<p>매개 변수의 효과를 탐색하십시오<code>람다</code>에서<code>전파</code>기능 (섹션<a class="quarto-xref" href="#sec-voronoi"><span>11.12</span></a>,,,<a class="quarto-xref" href="#sec-bodies"><span>11.13</span></a>) 사용 a<strong><a href="https://cran.r-project.org/web/packages/shiny">빛나는</a></strong>표시하는 앱<code>셀 바디</code>에서와 같이 이미지<a class="quarto-xref" href="#fig-cellbodies">수치<span>11.17</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled page-columns page-full" id="imp-images-autocorr">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 11.3</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<p>2 차원 경험적 자기 상관 함수를 고려하십시오.</p>
<p><span class="anchored-eq" data-anchor-id="eq-autocorr1" id="eq-autocorr1"><span class="math display">\ [
a (v_x, v_y) = \ frac {1} {| i |} \ sum _ {(x, y) \ in i} b (x, y) \; b (x+v_x, \, y+v_y),
\ tag {11.13} \]</span></span></p>
<p>어디<span class="math inline">\(비\)</span>이미지, 즉 픽셀 세트의 함수입니다.<span class="math inline">\(나\)</span>, 튜플<span class="math inline">\ ((x, y) \)</span>모든 픽셀 좌표를 통해 실행됩니다<span class="math inline">\ (v = (v_x, v_y) \)</span>오프셋 벡터입니다. 사용<a href="https://mathworld.wolfram.com/Wiener-KhinchinTheorem.html">Wiener – Khinchin 정리</a>빠른 푸리에 변환을 사용 하여이 기능을 효율적으로 계산할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a aria-hidden="true" href="#cb101-1" tabindex="-1"></a>autocorr2d<span class="ot">=</span> <span class="cf">기능</span>(x) {</span>
<span id="cb101-2"><a aria-hidden="true" href="#cb101-2" tabindex="-1"></a>와이<span class="ot">=</span> <span class="fu">FFT</span>(엑스<span class="sc">/</span><span class="fu">합집합</span>(엑스))</span>
<span id="cb101-3"><a aria-hidden="true" href="#cb101-3" tabindex="-1"></a>  <span class="fu">ABS</span>(Gsignal<span class="sc">::</span><span class="fu">fftshift</span>(<span class="fu">FFT</span>(와이<span class="sc">*</span> <span class="fu">결합</span>(와이),<span class="at">역 =</span> <span class="cn">진실</span>),)<span class="at">여백 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))</span>
<span id="cb101-4"><a aria-hidden="true" href="#cb101-4" tabindex="-1"></a>}</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>아래에서는이 작은 헬퍼 기능을 사용합니다. 매트릭스를 히트 맵으로 표시합니다.<strong><a href="https://cran.r-project.org/web/packages/ggplot2">ggplot2</a></strong>(기본 R과 유사합니다<code>영상</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a aria-hidden="true" href="#cb102-1" tabindex="-1"></a>matrix_as_heatmap<span class="ot">=</span> <span class="cf">기능</span>(중)</span>
<span id="cb102-2"><a aria-hidden="true" href="#cb102-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(reshape2<span class="sc">::</span><span class="fu">녹다</span>(중),<span class="fu">AES</span>(<span class="at">x =</span>var1,<span class="at">y =</span>var2,<span class="at">fill =</span>값))<span class="sc">+</span> </span>
<span id="cb102-3"><a aria-hidden="true" href="#cb102-3" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb102-4"><a aria-hidden="true" href="#cb102-4" tabindex="-1"></a>    <span class="fu">scale_fill_continuous</span>(<span class="at">유형 =</span> <span class="st">"Viridis"</span>))<span class="sc">+</span></span>
<span id="cb102-5"><a aria-hidden="true" href="#cb102-5" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))<span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">확장 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 신청합시다<code>autocorr2d</code>세 가지 컬러 채널 각각에 별도로. 결과가 표시됩니다<a class="quarto-xref" href="#fig-autocorr2d">수치<span>11.31</span></a>.</p>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a aria-hidden="true" href="#cb103-1" tabindex="-1"></a>nm<span class="ot">=</span> <span class="fu">Dimnames</span>(세포) [[<span class="dv">3</span>]]]]</span>
<span id="cb103-2"><a aria-hidden="true" href="#cb103-2" tabindex="-1"></a>AC<span class="ot">=</span> <span class="fu">lapply</span>(nm,<span class="cf">기능</span>(나)<span class="fu">autocorr2d</span>(세포 [, i])))<span class="sc">|&gt;</span> <span class="fu">setNames</span>(<span class="fu">보결</span>(<span class="st">"^image-"</span>,,,<span class="st">"" "</span>, nm))</span>
<span id="cb103-3"><a aria-hidden="true" href="#cb103-3" tabindex="-1"></a></span>
<span id="cb103-4"><a aria-hidden="true" href="#cb103-4" tabindex="-1"></a><span class="cf">~을 위한</span>(w<span class="cf">~에</span> <span class="fu">이름</span>(AC))</span>
<span id="cb103-5"><a aria-hidden="true" href="#cb103-5" tabindex="-1"></a>  <span class="fu">인쇄</span>(<span class="fu">matrix_as_heatmap</span>(AC [[W]])<span class="sc">+</span> <span class="fu">ggtitle</span>(W))</span>
<span id="cb103-6"><a aria-hidden="true" href="#cb103-6" tabindex="-1"></a></span>
<span id="cb103-7"><a aria-hidden="true" href="#cb103-7" tabindex="-1"></a>CY<span class="ot">=</span> <span class="fu">어둑한</span>(세포) [<span class="dv">1</span>]]<span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb103-8"><a aria-hidden="true" href="#cb103-8" tabindex="-1"></a>CX<span class="ot">=</span> <span class="fu">어둑한</span>(세포) [<span class="dv">2</span>]]<span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb103-9"><a aria-hidden="true" href="#cb103-9" tabindex="-1"></a>아르 자형<span class="ot">=</span> <span class="fu">둥근</span>(<span class="fu">sqrt</span>(<span class="fu">안부</span>(세포 [,,,<span class="dv">1</span>])))<span class="sc">-</span>CX)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="fu">열</span>(세포 [,,,<span class="dv">1</span>])))<span class="sc">-</span>CY)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb103-10"><a aria-hidden="true" href="#cb103-10" tabindex="-1"></a></span>
<span id="cb103-11"><a aria-hidden="true" href="#cb103-11" tabindex="-1"></a><span class="fu">matrix_as_heatmap</span>(아르 자형)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"반경 R"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-autocorr2d">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-autocorr2d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-autocorr2d" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-autocorr2d-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-autocorr2d-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-autocorr2d" href="11-chap_files/figure-html/fig-autocorr2d-1.png" title="Figure 11.31 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-autocorr2d" id="fig-autocorr2d-1" src="11-chap_files/figure-html/fig-autocorr2d-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-autocorr2d-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-autocorr2d" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-autocorr2d-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-autocorr2d-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-autocorr2d" href="11-chap_files/figure-html/fig-autocorr2d-2.png" title="Figure 11.31 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-autocorr2d" id="fig-autocorr2d-2" src="11-chap_files/figure-html/fig-autocorr2d-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-autocorr2d-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-autocorr2d" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-autocorr2d-3" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-autocorr2d-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-autocorr2d" href="11-chap_files/figure-html/fig-autocorr2d-3.png" title="Figure 11.31 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-autocorr2d" id="fig-autocorr2d-3" src="11-chap_files/figure-html/fig-autocorr2d-3.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-autocorr2d-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-autocorr2d" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-autocorr2d-4" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-autocorr2d-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-autocorr2d" href="11-chap_files/figure-html/fig-autocorr2d-4.png" title="Figure 11.31 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-autocorr2d" id="fig-autocorr2d-4" src="11-chap_files/figure-html/fig-autocorr2d-4.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-autocorr2d-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-autocorr2d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.31 : 3 개의 컬러 채널의 자기 상관 기능<code>세포</code>히트 맵으로 표시된 이미지. 중심의 피크는 단거리에 대한 신호 상관 관계에 해당합니다. 방사형 좌표도 표시됩니다<code>아르 자형</code>.
</figcaption>
</figure>
</div>
<p>이미지는 등방성, 즉 선호되는 방향이 없기 때문에 각도 좌표보다 평균화 할 수 있습니다. 결과가 표시됩니다<a class="quarto-xref" href="#fig-autocorr1d">수치<span>11.32</span></a>. 다른 컬러 채널의 신호의 길이 스케일이 다르다는 것을 알 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a aria-hidden="true" href="#cb104-1" tabindex="-1"></a>Aggregate_by_Radius<span class="ot">=</span> <span class="cf">기능</span>(X, R)</span>
<span id="cb104-2"><a aria-hidden="true" href="#cb104-2" tabindex="-1"></a>  <span class="fu">티블</span>(<span class="at">x =</span> <span class="fu">as.vector</span>(엑스),</span>
<span id="cb104-3"><a aria-hidden="true" href="#cb104-3" tabindex="-1"></a>         <span class="at">r =</span> <span class="fu">as.vector</span>(아르 자형))<span class="sc">|&gt;</span></span>
<span id="cb104-4"><a aria-hidden="true" href="#cb104-4" tabindex="-1"></a>  <span class="fu">Group_by</span>(아르 자형)<span class="sc">|&gt;</span></span>
<span id="cb104-5"><a aria-hidden="true" href="#cb104-5" tabindex="-1"></a>  <span class="fu">요약</span>(<span class="at">값 =</span> <span class="fu">평균</span>(엑스))</span>
<span id="cb104-6"><a aria-hidden="true" href="#cb104-6" tabindex="-1"></a></span>
<span id="cb104-7"><a aria-hidden="true" href="#cb104-7" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">이름</span>(AC),<span class="cf">기능</span>(W)</span>
<span id="cb104-8"><a aria-hidden="true" href="#cb104-8" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">채널 =</span>w,</span>
<span id="cb104-9"><a aria-hidden="true" href="#cb104-9" tabindex="-1"></a>        <span class="fu">Aggregate_by_Radius</span>(AC [W], R))</span>
<span id="cb104-10"><a aria-hidden="true" href="#cb104-10" tabindex="-1"></a>))<span class="sc">|&gt;</span> </span>
<span id="cb104-11"><a aria-hidden="true" href="#cb104-11" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb104-12"><a aria-hidden="true" href="#cb104-12" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">필터</span>(아르 자형<span class="sc">&lt;=</span> <span class="dv">50</span>))<span class="sc">|&gt;</span></span>
<span id="cb104-13"><a aria-hidden="true" href="#cb104-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">x =</span>아르 자형,<span class="at">y =</span>값,<span class="at">col =</span>채널))<span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb104-14"><a aria-hidden="true" href="#cb104-14" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">값 =</span> <span class="fu">기음</span>(<span class="st">`</span><span class="at">cy3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"빨간색"</span>,,,<span class="st">`</span><span class="at">FITC</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"녹색"</span>,,,<span class="st">`</span><span class="at">dapi</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"파란색"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>확장<code>autocorr2d</code>기능도 다른 채널 간의 상호 상관을 계산합니다.</p>
<ul>
<li>뒤에 동기 부여는 무엇입니까?<code>합집합</code>위 구현에서 정규화<code>autocorr2d</code>?</li>
<li>평균을 빼는 것이 합리적입니까?<code>엑스</code>다른 계산 전에?</li>
<li>이 기능과 일반적인 경험적 분산 또는 상관 관계의 관계, 즉 함수<code>우리의</code>그리고<code>SD</code>기본 R에서?</li>
<li>다음과 같은 음모는 어떻게 될 수 있습니다<a class="quarto-xref" href="#fig-autocorr1d">수치<span>11.32</span></a>고 처리량 스크리닝 환경에서 품질 메트릭을 구성하는 데 사용됩니다.</li>
<li>3- 또는<span class="math inline">\(N\)</span>-차원 확장<code>autocorr2d</code>보인다? 무엇에 좋을까요?</li>
</ul>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display callout-margin-content">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-autocorr1d">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-autocorr1d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-56" href="11-chap_files/figure-html/fig-autocorr1d-1.png" title="Figure 11.32: Autocorrelation functions of the three color channels of the cells image, aggregated by radius."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="11-chap_files/figure-html/fig-autocorr1d-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-autocorr1d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 11.32 : 3 개의 컬러 채널의 자기 상관 기능<code>세포</code>반경으로 집계 된 이미지.</figcaption>
</figure>
</div>
</div></div><div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-images-working-with-image-data">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 11.4</div>
</div>
<div class="callout-body-container callout-body">
<p>워크숍 "이미지 데이터 작업"을 살펴보십시오.<a class="uri" href="https://github.com/wolfganghuber/WorkingWithImageData">https://github.com/wolfganghuber/workingwithimagedata</a>이 장과 동일한 컨텐츠 중 일부를 거치지 만 다른 이미지에서도 세분화 및 광학 흐름에 대한 추가 예제가 있습니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-images-voronoi">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 11.5</div>
</div>
<div class="callout-body-container callout-body">
<p>우크라이나 도시의 Voronoi Tessellation을 계산하고 표시<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>. 유클리드 거리가있는 2D 평면에서 MDS- 코디네이트를 사용하거나 큰 원 거리 (Haversine Formula)를 사용하여 위도 및 종단을 사용하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-images-3d">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 11.6</div>
</div>
<div class="callout-body-container callout-body">
<p>라이트 시트 현미경에서 3D 이미지 데이터를 다운로드하십시오<a class="footnote-ref" href="#fn15" id="fnref15" role="doc-noteref"><sup>15</sup></a>, 그것을로드하십시오<strong><a href="https://bioconductor.org/packages/EBImage/">에비지</a></strong> <em>영상</em>데이터를 반대하고 탐색하십시오.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup>예를 들어,<a class="uri" href="http://www.digital-embryo.org">http://www.digital-embryo.org</a></p></div></div><div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Baddeley2000" role="listitem">Baddeley, Adrain, Jesper Moller 및 Rasmus Waagepetersen. 2000.<span>"불균일 포인트 패턴에서 상호 작용의 비 및 반 입력 추정."</span> <em>Neerlandic 통계</em>54 : 329–50.</div>
<div class="csl-entry" id="ref-Baddeley1998" role="listitem">Baddeley, Adrian J. 1998.<span>"공간 샘플링 및 검열."</span>~ 안에<em>확률 론적 형상 : 가능성과 계산</em>, O. E. Barndorff-Nielsen, W. S. Kendall 및 M. N. M. Van Lieshout, 37–78에 의해 편집 됨. 행상인; 홀.</div>
<div class="csl-entry" id="ref-ilastik:NatMeth:2019" role="listitem">Berg, Stuart, Dominik Kutra, Thorben Kroeger, Christoph N Straehle, Bernhard X Kausler, Carsten Haubold, Martin Schiegg 등. 2019.<span>"Ilastik : (BIO) 이미지 분석을위한 대화식 머신 러닝."</span> <em>자연 방법</em>16 (12) : 1226–32.</div>
<div class="csl-entry" id="ref-BolandMurphy" role="listitem">Boland, Michael V. 및 Robert F. Murphy. 2001.<span>"<span class="nocase">형광 현미경 이미지에서 모든 주요 세포체 구조의 패턴을 인식 할 수있는 신경망 분류기<span>헬라</span>세포</span>.”</span> <em>생물 정보학</em>17 (12) : 1213–23.</div>
<div class="csl-entry" id="ref-carpenter2006cellprofiler" role="listitem">카트 팀은 Theouispe r Joules, Michaa, Man Frab에서 다른 팀으로, Fash, Robert 및 Lindon Whobeat를 주었다. 2006.<span>"<span>셀 프로파일</span>: 세포 표현형을 식별하고 정량화하기위한 이미지 분석 소프트웨어.”</span> <em>게놈 생물학</em>7 : R100.</div>
<div class="csl-entry" id="ref-chaumont2012icy" role="listitem">Chaumont, Fabrice DE, Stéphane Dallongeville, Nicolas Chenotard, Nicolas Hervé, Sorin Pop, Thomas Provoost, Vannary Meas-Yedid 등. 2012.<span>"<span class="nocase"><span>나</span>Cy : 확장 된 재현 가능한 연구를위한 오픈 바이오 이미지 정보학 플랫폼</span>.”</span> <em>자연 방법</em>9 : 690–96.</div>
<div class="csl-entry" id="ref-MeckeSG2013" role="listitem">Chiu, Sung Nok, Dietrich Stoyan, Wilfrid S. Kendall 및 Joseph Mecke. 2013.<em>확률 론적 형상 및 응용 분야</em>. 뛰는 것.</div>
<div class="csl-entry" id="ref-CressieSSD1991" role="listitem">Cressie, Noel A. 1991.<em>공간 데이터에 대한 통계</em>. 존 와일리; 자제.</div>
<div class="csl-entry" id="ref-DiggleSPP" role="listitem">Diggle, Peter J. 2013.<em>공간 및 시공간 지점 패턴의 통계 분석</em>. 행상인; 홀/CRC.</div>
<div class="csl-entry" id="ref-held2010cellcognition" role="listitem">Hold, M., M. H. A. Schmitz, B. Fischer, T. Walter, B. Neumann, M. H. Olma, M. Peter, J. Ellenberg 및 D. W. Gerlich. 2010 년.<span>"<span>세포인지</span>: 고 처리량 라이브 셀 이미징에서 시간 분해 표현형 주석.”</span> <em>자연 방법</em>7 : 747.</div>
<div class="csl-entry" id="ref-Holmes2009" role="listitem">Holmes, Susan, Adam Kapelner 및 Peter P Lee. 2009 년.<span>“대화식<span>자바</span>통계 이미지 분할 시스템 :<span>배</span>.”</span> <em>통계 소프트웨어 저널</em>30 (10).</div>
<div class="csl-entry" id="ref-jones2005voronoi" role="listitem">Jones, T., A. Carpenter 및 P. Golland. 2005.<span>"이미지 매니 폴드에서 셀의 Voronoi 기반 세분화."</span> <em>생의학 이미지 응용 프로그램에 대한 컴퓨터 비전</em>, 535.</div>
<div class="csl-entry" id="ref-Laufer:NatMeth:2013" role="listitem">Laufer, Christina, Bernd Fischer, Maximilian Billmann, Wolfgang Huber 및 Michael Boutros. 2013.<span>"<span class="nocase"><span>중</span>인간 암 세포에서 유전자 상호 작용을 적용합니다<span>아르 자형</span><span>N</span><span>에이</span>I 및 다가변 표현형</span>.”</span> <em>자연 방법</em>10 : 427–31.</div>
<div class="csl-entry" id="ref-EBImage" role="listitem">Pau, Grégoire, Florian Fuchs, Oleg Sklyar, Michael Boutros 및 Wolfgang Huber. 2010 년.<span>"<span>에비</span>마술사<span>아르 자형</span>세포 표현형에 대한 응용 프로그램을 사용한 이미지 처리 패키지.”</span> <em>생물 정보학</em>26 (7) : 979–81.</div>
<div class="csl-entry" id="ref-PhenoRipper" role="listitem">Rajaram, S., B. Pavie, L. F. Wu 및 S. J. Altschuler. 2012.<span>"<span class="nocase"><span>피</span>숙녀<span>아르 자형</span>IPPER : 현미경을 빠르게 프로파일 링하는 소프트웨어</span>.”</span> <em>자연 방법</em>9 : 635–37.</div>
<div class="csl-entry" id="ref-RipleySISS1988" role="listitem">Ripley, B. D. 1988.<em>공간 공정에 대한 통계적 추론.</em>케임브리지 대학교 출판부.</div>
<div class="csl-entry" id="ref-RussImageProcessingHandbook" role="listitem">Russ, John C. 및 F. Brent Neal. 2015.<em>이미지 처리 핸드북</em>. 7th ed. CRC 프레스;</div>
<div class="csl-entry" id="ref-schindelin2012fiji" role="listitem">Schindelin, Johannes, Ignacio Arganda-Carreras, Erwin Frize, Verena Kaynig, Mark Longair, Tobias Pietzsch, Stephan Preibisch 등 2012.<span>"<span class="nocase"><span>에프</span>IJI : 생물학 이미지 분석을위한 오픈 소스 플랫폼</span>.”</span> <em>자연 방법</em>9 : 676–82.</div>
<div class="csl-entry" id="ref-MathematicalMorphology" role="listitem">세라, 진. 1983.<em>이미지 분석 및 수학적 형태</em>. 학업 언론.</div>
<div class="csl-entry" id="ref-Setiadi2010" role="listitem">Setia, Francis, Nelson C Ray, Kohrt의 Holbrook, Adam Kapelner, Carcamo-Cavasus Valeria, Edina B Levic, China, China 및 Al. 2010 년.<span>"유방암 환자와 건강한 림프절의 종양-배수 림프절에서 면역 세포 서브 세트의 양적, 건축 분석."</span> <em>plos one</em>5 (8) : E12420.</div>
<div class="csl-entry" id="ref-FoundationSignalProcessing" role="listitem">Vetterli, Martin, Jelena Kovačević 및 Vivek Goyal. 2014.<em>신호 처리의 기초</em>. 케임브리지 대학교 출판부.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
