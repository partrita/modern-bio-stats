<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>3  Data visualization – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="3  Data visualization – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/03-chap_files/figure-html/fig-graphics-onedridge4-1.png" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="480" property="og:image:height"/>
<meta content="560" property="og:image:width"/>
<meta content="3  Data visualization – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/03-chap_files/figure-html/fig-graphics-onedridge4-1.png" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<meta content="480" name="twitter:image-height"/>
<meta content="560" name="twitter:image-width"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">3.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#base-r-plotting" href="#base-r-plotting" id="toc-base-r-plotting"><span class="header-section-number">3.2</span>베이스 r 플로팅</a></li>
<li><a class="nav-link" data-scroll-target="#sec-graphics-exampledata" href="#sec-graphics-exampledata" id="toc-sec-graphics-exampledata"><span class="header-section-number">3.3</span>예제 데이터 세트</a></li>
<li><a class="nav-link" data-scroll-target="#sec-graphics-ggplot" href="#sec-graphics-ggplot" id="toc-sec-graphics-ggplot"><span class="header-section-number">3.4</span>ggplot2</a></li>
<li><a class="nav-link" data-scroll-target="#the-grammar-of-graphics" href="#the-grammar-of-graphics" id="toc-the-grammar-of-graphics"><span class="header-section-number">3.5</span>그래픽의 문법</a></li>
<li><a class="nav-link" data-scroll-target="#sec-graphics-univar" href="#sec-graphics-univar" id="toc-sec-graphics-univar"><span class="header-section-number">3.6</span>1d에서 데이터 시각화</a></li>
<li><a class="nav-link" data-scroll-target="#sec-graphics-2d" href="#sec-graphics-2d" id="toc-sec-graphics-2d"><span class="header-section-number">3.7</span>2D에서 데이터 시각화 : ScatterPlots</a></li>
<li><a class="nav-link" data-scroll-target="#sec-graphics-facets" href="#sec-graphics-facets" id="toc-sec-graphics-facets"><span class="header-section-number">3.8</span>두 가지 이상의 차원을 시각화합니다</a></li>
<li><a class="nav-link" data-scroll-target="#sec-graphics-color" href="#sec-graphics-color" id="toc-sec-graphics-color"><span class="header-section-number">3.9</span>색상</a></li>
<li><a class="nav-link" data-scroll-target="#heatmaps" href="#heatmaps" id="toc-heatmaps"><span class="header-section-number">3.10</span>히트 맵</a></li>
<li><a class="nav-link" data-scroll-target="#data-transformations" href="#data-transformations" id="toc-data-transformations"><span class="header-section-number">3.11</span>데이터 변환</a></li>
<li><a class="nav-link" data-scroll-target="#mathematical-symbols-and-other-fonts" href="#mathematical-symbols-and-other-fonts" id="toc-mathematical-symbols-and-other-fonts"><span class="header-section-number">3.12</span>수학적 기호 및 기타 글꼴</a></li>
<li><a class="nav-link" data-scroll-target="#genomic-data" href="#genomic-data" id="toc-genomic-data"><span class="header-section-number">3.13</span>게놈 데이터</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">3.14</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">3.15</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">3.16</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-graphics"><span class="chapter-number">3</span>  <span class="chapter-title">데이터 시각화</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/xkcd-plotting.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/xkcd-plotting.png"/></a></p>
</figure>
</div>
</div></div></div>
<p>적어도 두 가지 유형의 데이터 시각화가 있습니다. 첫 번째는 과학자가 데이터를 탐색하고 직장에서 복잡한 프로세스에 대해 발견 할 수있게합니다. 다른 유형의 시각화는 그녀가 다른 사람들에게 보여줄 수 있고 결국 출판물에 포함시킬 수있는 유익하고 명확하며 시각적으로 매력적인 삽화를 제공합니다.</p>
<p>이러한 유형의 시각화는 모두 R을 사용하여 만들 수 있습니다. 실제로 R은 여러 그래픽 시스템을 제공합니다. R은 확장 가능하기 때문에 수년에 걸친 R 그래픽의 진행이 기존 기능을 대체하는 것이 아니라 패키지를 추가함으로써 진행 되었기 때문입니다. 각기 다른 그래픽 시스템에는 장점과 한계가 있습니다. 이 장에서는 두 가지를 알게 될 것입니다. 먼저, 우리는 기본 플로팅 함수에 대한 경의를 보입니다.<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>. 그 후 우리는 전환 할 것입니다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>그들은에 살고 있습니다<strong><a href="https://cran.r-project.org/web/packages/graphics/">제도법</a></strong>모든 기본 R 설치와 함께 제공되는 패키지.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-plotter">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-plotter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="imgs/Automatisches_Zeichengeraet_ZUSE_Z64_ubt_web.jpg" title="Figure 3.1: The ZUSE Plotter Z64 (presented in 1961). Source: https://en.wikipedia.org/wiki/Plotter."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Automatisches_Zeichengeraet_ZUSE_Z64_ubt_web.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-plotter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.1 : Zuse Plotter Z64 (1961 년에 제시됨). 원천:<a href="https://en.wikipedia.org/wiki/Plotter">https://en.wikipedia.org/wiki/plotter</a>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>기본 그래픽은 역사적으로 우선적으로 나왔습니다 : 간단하고 절차 적이며 개념적으로 캔버스를 그리는 동기가 있습니다. 다양한 유형의 플롯에 대한 특수 기능이 있습니다. 이것들은 전화하기 쉽지만 - 당신이 그것들을 결합하여 더 복잡한 음모를 만들거나 서로 교환하고 싶을 때, 이것은 빨리 지저분하거나 불가능 해집니다. 사용자 음모 (단어는 첫 번째 그래픽 장치로 돌아갑니다.<a class="quarto-xref" href="#fig-graphics-plotter">수치<span>3.1</span></a>) (개념적) 캔버스에 직접. 그녀는 여백, 축 레이블, 타이틀, 전설, 서브 패널에 할당 할 공간과 같은 결정을 명시 적으로 처리해야합니다. 일단 무언가가“음모”되면 움직이거나 지워질 수 없습니다.</p>
<p>보다 높은 수준의 접근법이 있습니다<em>그래픽의 문법</em>, 그래픽은 모듈 식 논리 조각에서 구축되므로 인간 언어로 문장의 일부를 전환 및 배제 할 수있는 것처럼 직관적이고 쉽게 해독 할 수있는 방식으로 데이터에 대한 다양한 시각화 유형을 쉽게 시도 할 수 있습니다. 캔버스 나 플로터라는 개념이 없으며 오히려 사용자가<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>R 객체의 형태로 그녀가 원하는 플롯에 대한 높은 수준의 설명과 렌더링 엔진은 장면에서 전적으로 볼 수 있도록 그래픽을 배치하여 출력 장치에서 렌더링합니다.</p>
<section class="level2" data-number="3.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="3.1"><span class="header-section-number">3.1</span>이 장의 목표</h2>
<p>이 장에서는 다음과 같습니다.</p>
<ul>
<li><p>시각화를 통해 데이터 세트를 빠르고 유연하게 탐색하는 방법을 알아보십시오.</p></li>
<li><p>과학적 프리젠 테이션 및 출판물을위한 아름답고 직관적 인 음모를 만드십시오.</p></li>
<li><p>기본 플롯의 기본 사항을 검토하십시오.</p></li>
<li><p>뒤에있는 논리를 이해하십시오<em>그래픽의 문법</em>개념.</p></li>
<li><p>소개하다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>'에스<code>ggplot</code>기능.</p></li>
<li><p>데이터를 1, 2 또는 3 ~ 5 차원으로 플로팅하는 방법을 확인하고 패싯을 탐색하십시오.</p></li>
<li><p>분자 생물학 데이터 (또는 다른 서열, 예를 들어 펩티드)에 대한 "Genome"플롯을 만듭니다.</p></li>
<li><p>대화식 그래픽의 옵션 중 일부에 대해 토론하십시오.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="3.2" id="base-r-plotting">
<h2 class="anchored" data-anchor-id="base-r-plotting" data-number="3.2"><span class="header-section-number">3.2</span>베이스 r 플로팅</h2>
<p>가장 기본적인 기능은입니다<code>구성</code>. 아래 코드에서 출력이 표시됩니다.<a class="quarto-xref" href="#fig-graphics-basicplotting1">수치<span>3.2</span></a>, 이는 효소-연결 면역 흡착 분석 (ELISA) 분석으로부터 데이터를 플로팅하는데 사용된다. 분석을 사용하여 DNA를 분해하는 효소 데 옥시 리보 뉴 클레아 제 (DNase)의 활성을 정량화 하였다. 데이터는 r 객체에 조립됩니다<code>dnase</code>Base R과 함께 편리하게 제공됩니다<code>dnase</code>열이있는 데이터 프레임입니다<code>달리다</code>, 분석 실행;<code>conc</code>, 사용 된 단백질 농도; 그리고<code>밀도</code>측정 된 광학 밀도.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="fu">머리</span>(DNase)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conc 밀도를 실행하십시오
1 1 0.0482812 0.017
2 1 0.0482812 0.018
3 1 0.19531250 0.121
4 1 0.19531250 0.124
5 1 0.39062500 0.206
6 1 0.39062500 0.215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="fu">구성</span>(DNase<span class="sc">$</span>conc, dnase<span class="sc">$</span>밀도)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-basicplotting1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-basicplotting1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="03-chap_files/figure-html/fig-graphics-basicplotting1-1.png" title="Figure 3.2: Plot of concentration vs. density for an ELISA assay of DNase."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-basicplotting1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-basicplotting1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.2 : DNase의 ELISA 분석에 대한 농도 대 밀도의 플롯.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 기본 플롯은 예를 들어 매개 변수를 사용하여 플롯 기호 및 축 레이블을 변경하여 사용자 정의 할 수 있습니다.<code>xlab</code>,,,<code>ylab</code>그리고<code>PCH</code>(플롯 캐릭터)에 표시된대로<a class="quarto-xref" href="#fig-graphics-basicplotting2">수치<span>3.3</span></a>. 변수에 대한 정보는 객체에 저장됩니다<code>dnase</code>그리고 우리는 그것을 사용하여 액세스 할 수 있습니다<code>att</code>기능.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a><span class="fu">구성</span>(DNase<span class="sc">$</span>conc, dnase<span class="sc">$</span>밀도,</span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a>  <span class="at">뭉치</span> <span class="fu">att</span>(dnase,<span class="st">"라벨"</span>))<span class="sc">$</span>와이,</span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">반죽</span>(<span class="fu">att</span>(dnase,<span class="st">"라벨"</span>))<span class="sc">$</span>엑스,<span class="fu">att</span>(dnase,<span class="st">"단위"</span>))<span class="sc">$</span>엑스),</span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">3</span>,,,</span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"파란색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-basicplotting2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-basicplotting2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="03-chap_files/figure-html/fig-graphics-basicplotting2-1.png" title="Figure 3.3: Same data as in Figure fig-graphics-basicplotting1 but with better axis labels and a different plot symbol."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-basicplotting2-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-basicplotting2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.3 : IN과 동일한 데이터<a class="quarto-xref" href="#fig-graphics-basicplotting1">수치<span>3.2</span></a>더 나은 축 레이블과 다른 플롯 기호로.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-metadata">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.1</div>
</div>
<div class="callout-body-container callout-body">
<p>더 긴 설명, 물리적 단위, 출처 정보 등과 같은 "메타 데이터"로 데이터 프레임 열을 주석을 달하는 것은 유용한 기능처럼 보입니다. 이러한 정보를 저장하는이 방법은 다음과 같습니다.<code>dnase</code>R 생태계 전반에 걸쳐 표준화되거나 일반적인 물체? 이 작업을 수행하는 다른 표준화 된 또는 일반적인 방법이 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-2-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-2-contents callout-collapse collapse" id="callout-2">
<div class="callout-body-container callout-body">
<p>정기적 인 R에는 좋거나 널리 사용되는 인프라가 없습니다.<em>데이터. 프레임</em>이것에 대한 s, 또는 깔끔한 사람 (<em>data_frame</em>,,,<em>티블</em>). 그러나<em>데이터 프레임</em>바이오 컨덕터 패키지의 클래스<strong><a href="https://bioconductor.org/packages/S4Vectors/">s4vectors</a></strong>. 무엇보다도 그것은 행과 열에 주석을 달고 사용됩니다.<em>요약 경험</em>.</p>
</div>
</div>
</div>
<p>ScatterPlot 외에도 내장 기능을 사용하여 히스토그램 및 박스 플롯을 만들 수도 있습니다.<a class="quarto-xref" href="#fig-graphics-basicplotting3">수치<span>3.4</span></a>).</p>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="fu">히스</span>(DNase<span class="sc">$</span>밀도,<span class="at">breaks =</span><span class="dv">25</span>,,,<span class="at">메인 =</span> <span class="st">"" "</span>))</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a><span class="fu">BoxPlot</span>(밀도<span class="sc">~</span>달리다,<span class="at">데이터 =</span>DNase)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-basicplotting3">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-basicplotting3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-basicplotting3" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-basicplotting3-1" width="240">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-basicplotting3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-basicplotting3" href="03-chap_files/figure-html/fig-graphics-basicplotting3-1.png" title="Figure 3.4 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-basicplotting3" id="fig-graphics-basicplotting3-1" src="03-chap_files/figure-html/fig-graphics-basicplotting3-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-basicplotting3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-basicplotting3" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-basicplotting3-2" width="240">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-basicplotting3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-basicplotting3" href="03-chap_files/figure-html/fig-graphics-basicplotting3-2.png" title="Figure 3.4 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-basicplotting3" id="fig-graphics-basicplotting3-2" src="03-chap_files/figure-html/fig-graphics-basicplotting3-2.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-basicplotting3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-basicplotting3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.4 : (a) ELISA 분석으로부터의 밀도의 히스토그램 및 (b) 분석 실행에 의해 계층화 된 이들 값의 박스 플롯. 런은 텍스트 문자열로 저장 되었기 때문에 상자는 축을 따라 사전 순서대로 주문됩니다. R의 유형 변환 기능을 사용하여 수치 순서를 달성 할 수 있습니다.</figcaption>
</figure>
</div>
<p>BoxPlots는 소형 공간에서 서로 여러 분포를 보여주기에 편리합니다. 우리는 여러 개의 일 변량 분포를 플로팅하는 것에 대해 더 많이 볼 것입니다.<a class="quarto-xref" href="#sec-graphics-univar"><span>섹션 3.6</span></a>.</p>
<p>기본 플로팅 기능은 빠른 대화식 데이터 탐색에 적합합니다. 그러나보다 정교한 디스플레이를 만들려면 곧 제한 사항을 제한합니다. 우리는 패키지에 구현 된 The Grammar of Grammar라는 시각화 프레임 워크를 사용할 것입니다.<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>이를 통해 논리적이고 우아한 방식으로 고품질 그래픽을 단계별로 구성 할 수 있습니다. 먼저 예제 데이터 세트를 소개하고로드하겠습니다.</p>
</section>
<section class="level2 page-columns page-full" data-number="3.3" id="sec-graphics-exampledata">
<h2 class="anchored" data-anchor-id="sec-graphics-exampledata" data-number="3.3"><span class="header-section-number">3.3</span>예제 데이터 세트</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-cells">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-cells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="imgs/Yusukecells-2_web.jpg" title="Figure 3.5: Single-section immunofluorescence image of the E3.5 mouse blastocyst stained for Serpinh1, a marker of primitive endoderm (blue), Gata6 (red) and Nanog (green)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Yusukecells-2_web.jpg"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-cells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.5 : Primitive endoderm (파란색), Gata6 (빨간색) 및 Nanog (녹색)의 마커 인 Serpinh1에 대해 염색 된 E3.5 마우스 배반포의 단일 섹션 면역 형광 이미지.</figcaption>
</figure>
</div>
</div></div></div>
<p>올바르게 테스트를 받으려면<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>기능적, 우리는 충분히 큰 데이터 세트가 필요하고 약간의 다른 각도에서 슬라이스하고 볼 수 있도록 약간의 데이터 세트가 필요합니다. 우리는 초기 발달에서 다른 시점에서 마우스 배아에서 약 100 개의 개별 세포의 전 사체를보고하는 유전자 발현 마이크로 어레이 데이터 세트를 사용합니다. 포유류 배아는 단일 세포, 수정란으로 시작됩니다. 세포 분열의 동기화 된 파도를 통해, 계란은 세포 덩어리에 곱해 처음에는 그들 사이에 눈에 띄는 차이가 없음을 보여줍니다. 그러나 어느 시점에서 세포는 다른 계통을 선택합니다. 추가 및 추가 사양에 의해, 전체 유기체에 필요한 상이한 세포 유형 및 조직이 발생한다. 실험의 목표<span class="citation" data-cites="Ohnishi2014">Ohnishi et al. (<a href="16-chap.html#ref-Ohnishi2014" role="doc-biblioref">2014</a>))</span>, 배아의 첫 번째 대칭 파괴 사건과 관련된 유전자 발현 변화를 조사하는 것이었다. 우리는 데이터를 더 설명 할 것입니다. 자세한 내용은 논문 및 Bioconductor 데이터 패키지의 문서에서 확인할 수 있습니다.<strong><a href="https://bioconductor.org/packages/Hiiragi2013/">Hiiragi2013</a></strong>. 먼저 데이터를로드합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="imgs/devil.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">데이터 객체에 다소 일반적인 이름이있는 것은 불행한 일입니다.<code>엑스</code>더 설명적인 이름보다는. 이름 충돌을 피하기 위해 가장 실용적인 솔루션은 다음과 같은 코드를 실행하는 것일 수 있습니다.<code>eshiiragi = x; rm (list = "x")</code>.</span></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Hiiragi2013"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="warning">
<pre class="knitr r">청크 'loadhiiragi'에서 : 경고 : 'gtools :: logit'의 이전 가져 오기 'boot :: logit'을 대체 할 때 'Hiiragi2013'.</pre>
</div>
<div class="warning">
<pre class="knitr r">청크 'loadhiiragi'에서 : 경고 : 이전 가져 오기 'boot :: inv.logit'을 'gtools :: inv.logit''hoading'hiiragi2013 '으로 대체합니다.</pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"엑스"</span>))</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a><span class="fu">어둑한</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45101 101</code></pre>
</div>
</div>
<p>더 자세한 요약을 인쇄 할 수 있습니다.<em>ExpressionSet</em>물체<code>엑스</code>타이핑하여<code>엑스</code>R 프롬프트에서. 데이터 매트릭스의 101 열 (위에서<code>exprs</code>기능<strong><a href="https://bioconductor.org/packages/Biobase/">바이오베이스</a></strong>패키지)은 샘플 (각각 이들 각각은 단일 셀), 45101 행은 어레이에 의해 프로브 된 유전자, Affymetrix Mouse4302 어레이에 해당합니다. RMA 방법을 사용하여 데이터를 정규화 하였다<span class="citation" data-cites="Irizarry:Biostat:2003">(<a href="16-chap.html#ref-Irizarry:Biostat:2003" role="doc-biblioref">Irizarry et al. 2003</a>))</span>. 원시 데이터는 패키지에서도 사용할 수 있습니다 (데이터 개체에서<code>에이</code>) 및 가입 코드 E-MTAB-1681에 따른 Embl-Ebi의 Arrayexpress 데이터베이스.</p>
<p>샘플에 대해 어떤 정보를 사용할 수 있는지 살펴 보겠습니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>#CAB2D6 표기법은 색상의 RGB 좌표의 16 진수 표현입니다. 이것에 대해 더<a class="quarto-xref" href="#sec-graphics-colorspaces"><span>섹션 3.10.2</span></a>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="fu">머리</span>(<span class="fu">PDATA</span>(엑스),<span class="at">n =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>File.Name Embryonic.day Total.number.of.cells 계보 유전자형
1 E3.25 1_C32_IN E3.25 32 WT
2 E3.25 2_C32_IN E3.25 32 WT
          스캔이트 샘플 그룹 샘플 리콜러
1 E3.25 2011-03-16 E3.25 #CAB2D6
2 E3.25 2011-03-16 E3.25 #CAB2D6</code></pre>
</div>
</div>
<p>제공된 정보는 세포 (즉, 입수 한 배아의 연령, 크기 및 유전자형) 및 기술 정보 (스캔 날짜, 원시 데이터 파일 이름)에 대한 정보가 혼합되어 있습니다. 컨벤션에 의해, 마우스 배아의 발달 시간은 며칠 내에 측정되며, 예를 들어,<code>E3.5</code>. 또한, 논문에서 저자는 세포를 8 개의 생물학적 그룹으로 나누었다 (<code>샘플 그룹</code>), 연령, 유전자형 및 계보에 기초하여, 그들은 이들 그룹을 나타내는 색 구성표를 정의했다.<code>SampleColour</code><a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>). 다음 코드를 사용하여 (설명은 아래 참조) 작은 데이터 프레임을 정의합니다.<code>여러 떼</code>여기에는 각 그룹에 대한 요약 정보가 포함되어 있습니다 : 세포 수와 바람직한 색상.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>데이터 세트 의이 식별자는 영국 맞춤법을 사용합니다. 이 책의 다른 곳에서는 미국 철자법 (컬러)을 사용합니다. 그만큼<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>패키지는 일반적으로 두 맞춤법을 모두 허용합니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>여러 떼<span class="ot">=</span> <span class="fu">Group_by</span>(<span class="fu">PDATA</span>(x), 샘플 그룹)<span class="sc">|&gt;</span></span>
<span id="cb11-3"><a aria-hidden="true" href="#cb11-3" tabindex="-1"></a>  <span class="fu">요약</span>(<span class="at">n =</span> <span class="fu">N</span>(), <span class="at">색상 =</span> <span class="fu">고유한</span>(SampleColour))</span>
<span id="cb11-4"><a aria-hidden="true" href="#cb11-4" tabindex="-1"></a>여러 떼</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 8 × 3
  샘플 그룹 n 색상  
  &lt;chr&gt; &lt;int&gt; &lt;chr&gt;  
1 E3.25 36 #CAB2D6
2 E3.25 (FGF4-KO) 17 #FDBF6F
3 E3.5 (EPI) 11 #A6CEE3
4 E3.5 (FGF4-KO) 8 #FF7F00
5 E3.5 (PE) 11 #B2DF8A
6 E4.5 (EPI) 4 #1F78B4
7 E4.5 (FGF4-KO) 10 #e31A1C
8 E4.5 (PE) 4 #33A02C</code></pre>
</div>
</div>
<p>이름이 포함 된 그룹의 세포<code>FGF4-KO</code>세포 분화의 중요한 조절제 인 FGF4 유전자가 녹아웃 된 배아에서 나온 것입니다. E3.5에서 시작하여, 야생형 세포 (FGF4 녹아웃없이)는 첫 번째 대칭 파괴 이벤트를 겪고 다 능성 에피 블라스트 (EPI) 및 원시 내배엽 (PE)이라고하는 다른 세포 계통으로 구별됩니다.</p>
<p>위의 코드 덩어리가 파이프 연산자와 만나는 첫 번째 인스턴스이므로<code>|&gt;</code>그리고 기능<code>Group_by</code>그리고<code>요약</code>에서<strong><a href="https://cran.r-project.org/web/packages/dplyr/">dplyr</a></strong>패키지, 코드를 풀겠습니다. 먼저 파이프<code>|&gt;</code><a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>. 일반적으로 파이프는 중첩 된 기능 호출을 인간에게 쉽게 읽을 수 있도록하는 데 유용합니다. 다음 두 줄의 코드는 R과 같습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup> <code>|&gt;</code>2021 년에 출시 된 버전 4.1 이후 기본 R과 함께 제공 된 파이프 연산자입니다. 패키지<strong><a href="https://cran.r-project.org/web/packages/magrittr/">magrittr</a></strong>제공했습니다<code>%&gt;%</code>동일한 의미론이 아니지만 비슷하지만 이미 오랜 세월 이후부터 비슷하지만 다른 여러 배관 관련 운영자와 같은 운영자<code>%&lt;&gt;%</code>그리고<code>%t&gt;%</code>. 이 책의 대부분은 2021 년 이전에 쓰여졌습니다.<strong><a href="https://cran.r-project.org/web/packages/magrittr/">magrittr</a></strong>'에스<code>%&gt;%</code>운영자는 여러 곳에서 사용됩니다. 우리는 때때로 업데이트하고 있습니다<code>%&gt;%</code>에게<code>|&gt;</code>책을 유지하는 동안 여기에 표시된 코드에서와 같이.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a><span class="fu">에프</span>(엑스)<span class="sc">|&gt;</span> <span class="fu">g</span>(와이)<span class="sc">|&gt;</span> <span class="fu">시간</span>()</span>
<span id="cb13-2"><a aria-hidden="true" href="#cb13-2" tabindex="-1"></a><span class="fu">시간</span>(<span class="fu">g</span>(<span class="fu">에프</span>(x), y))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>“평가하십시오<code>f (x)</code>그런 다음 결과를 전달하여 작동합니다<code>g</code>첫 번째 논쟁으로<code>와이</code>전달됩니다<code>g</code>두 번째 논쟁으로. 그런 다음 출력을 전달합니다<code>g</code>기능에<code>시간</code>.” 특히 논쟁이있는 경우이 광고를 반복 할 수 있습니다<code>엑스</code>그리고<code>와이</code>복잡한 표현 자체이거나 관련된 기능이 관련되어 있다면 첫 번째 버전은 읽기 쉬운 경향이 있습니다.</p>
<p>그만큼<code>Group_by</code>함수는 단순히 모든 후속 작업이 한 번에 전체 데이터 프레임에 적용되지 않고<code>샘플 그룹</code>요인. 마지막으로,<code>요약</code>요약 통계를 계산합니다. 예를 들어<code>평균</code>,,,<code>합집합</code>; 이 경우 각 블록의 행 수를 계산하고<code>N()</code>, 그리고 널리 퍼진 색.</p>
</section>
<section class="level2 page-columns page-full" data-number="3.4" id="sec-graphics-ggplot">
<h2 class="anchored" data-anchor-id="sec-graphics-ggplot" data-number="3.4"><span class="header-section-number">3.4</span>ggplot2</h2>
<p><strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>Hadley Wickham의 패키지입니다<span class="citation" data-cites="ggplot2">(<a href="16-chap.html#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>))</span>그것은 아이디어를 구현합니다<strong>그래픽의 문법</strong>- Leland Wilkinson이 그의 시조 책에서 만든 개념<span class="citation" data-cites="GrofGrbook">(<a href="16-chap.html#ref-GrofGrbook" role="doc-biblioref">Wilkinson 2005</a>))</span>. 우리는이 장에서 그 기능 중 일부를 탐색 할 것이며,이 책의 나머지 부분에서 어떻게 사용될 수 있는지에 대한 많은 예를 보게 될 것입니다. 패키지에 대한 포괄적 인 문서를 찾을 수 있습니다<a href="https://ggplot2.tidyverse.org">웹 사이트에서</a>. 온라인 문서에는이 장에서 소개 된 각 그래픽 유형에 대한 예제 사용 사례가 포함되어 있으며 수치를 만들 때 귀중한 리소스입니다.</p>
<p>패키지를로드하고 간단한 플롯을 다시 시작하는 것으로 시작하겠습니다.<a class="quarto-xref" href="#fig-graphics-basicplotting1">수치<span>3.2</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" href="#cb14-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb14-2"><a aria-hidden="true" href="#cb14-2" tabindex="-1"></a><span class="fu">ggplot</span>(dnase,<span class="fu">AES</span>(<span class="at">x =</span>conc,<span class="at">y =</span>밀도))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-figredobasicplottingwithggplot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-figredobasicplottingwithggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="03-chap_files/figure-html/fig-graphics-figredobasicplottingwithggplot-1.png" title="Figure 3.6: Our first ggplot2 figure, similar to the base graphics Figure fig-graphics-basicplotting1."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-figredobasicplottingwithggplot-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-figredobasicplottingwithggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.6 : 첫 번째<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>기본 그래픽과 유사한 그림<a class="quarto-xref" href="#fig-graphics-basicplotting1">수치<span>3.2</span></a>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는 그래픽의 문법을 사용하여 첫 번째 "문장"을 썼습니다. 이 문장을 해체합시다. 먼저 데이터가 포함 된 데이터 프레임을 지정했습니다.<code>dnase</code>. 그만큼<code>AES</code>(이것은<strong>미적인</strong>) 인수는 우리가보고 싶은 변수를<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-각각. 마지막으로, 우리는 기능을 호출 한 결과를 추가하여 줄거리를 사용하기를 원한다고 말했습니다.<code>geom_point</code>.</p>
<p>이제 마우스 단일 셀 데이터를 사용하여<code>ggplot</code>기능. 결과가 표시됩니다<a class="quarto-xref" href="#fig-graphics-qplot1">수치<span>3.7</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(여러 떼,<span class="fu">AES</span>(<span class="at">x =</span>샘플 그룹,<span class="at">y =</span>N))<span class="sc">+</span></span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">통계 =</span> <span class="st">"신원"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-qplot1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-qplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="03-chap_files/figure-html/fig-graphics-qplot1-1.png" title="Figure 3.7: A barplot, produced with the ggplot function from the table of group sizes in the mouse single cell data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-qplot1-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-qplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.7 : Barplot,<code>ggplot</code>마우스 단일 셀 데이터의 그룹 크기 표에서 기능.</figcaption>
</figure>
</div>
</div></div></div>
<p>와 함께<code>geom_bar</code>우리는 이제 말했습니다<code>ggplot</code>우리는 각 데이터 항목을 원합니다 (각 행<code>여러 떼</code>) 바로 표현됩니다. 막대는 기하학적 물체의 한 예입니다.<strong>geom</strong>에서<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>패키지의 관점)<code>ggplot</code>알고 있습니다. 우리는 이미 또 다른 물체를 보았습니다<a class="quarto-xref" href="#fig-graphics-figredobasicplottingwithggplot">수치<span>3.6</span></a>: 포인트,<code>geom_point</code>기능. 우리는 나중에 다른 많은 geoms를 만나게 될 것입니다. 우리는 사용했습니다<code>AES</code>우리는<span class="math inline">\(엑스\)</span>-축과 크기<span class="math inline">\(와이\)</span>-중심선. 마지막으로, 우리는 논쟁을 제공했습니다<code>stat = "Identity"</code>다시 말해서 아무것도하지 않습니다<code>geom_bar</code>함수, 그렇지 않으면 데이터의 히스토그램을 계산하려고합니다 (기본값<code>통계</code>~이다<code>"세다"</code>). <code>통계</code>짧습니다<em>통계량</em>이것이 우리가 데이터의 모든 기능이라고 부르는 것입니다. 정체성과 카운트 통계 외에도 스무딩, 평균화, 비닝 또는 다른 방식으로 데이터를 줄이는 기타 작업과 같은 다른 작업이 있습니다.</p>
<p>이러한 개념 - 데이터, 기하학적 물체, 통계는 명사, 동사 및 부사가 영어 문장의 성분과 마찬가지로 그래픽 문법의 성분 중 일부입니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>뒤집어<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-수평 바 플로트를 생성하는 공장학.</p>
</div>
</div>
<p>음모<a class="quarto-xref" href="#fig-graphics-qplot1">수치<span>3.7</span></a>나쁘지는 않지만 몇 가지 잠재적 인 개선이 있습니다. 우리는 바에 색상을 사용하여 어떤 막대가 어떤 그룹에 해당하는지 빠르게 확인할 수 있습니다. 이것은 여러 플롯에서 동일한 색 구성표를 사용하는 경우 특히 유용합니다. 이를 위해 명명 된 벡터를 정의해 봅시다<code>GroupColor</code>가능한 각각의 가능한 값에 대해 원하는 색상이 포함되어 있습니다.<code>샘플 그룹</code>.<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>정보는 정보와 완전히 같습니다<code>샘플 그룹</code>그리고<code>색상</code>데이터 프레임의 열<code>여러 떼</code>; 우리는 그 사실에 적응하고 있습니다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>이 정보는 이름이 지정된 벡터 형태로 기대합니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a>GroupColor<span class="ot">=</span> <span class="fu">setNames</span>(여러 떼<span class="sc">$</span>색상, 그룹<span class="sc">$</span>샘플 그룹)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리가 해결해야 할 또 다른 것<a class="quarto-xref" href="#fig-graphics-qplot1">수치<span>3.7</span></a>막대 레이블의 가독성입니다. 지금 그들은 서로가 달려 있습니다. 설명 이름이있을 때 일반적인 문제입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(여러 떼,<span class="fu">AES</span>(<span class="at">x =</span>샘플 그룹,<span class="at">y =</span>N,<span class="at">fill =</span>샘플 그룹))<span class="sc">+</span></span>
<span id="cb17-2"><a aria-hidden="true" href="#cb17-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">통계 =</span> <span class="st">"신원"</span>))<span class="sc">+</span></span>
<span id="cb17-3"><a aria-hidden="true" href="#cb17-3" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">값 =</span>groupcolor,<span class="at">이름 =</span> <span class="st">"여러 떼"</span>))<span class="sc">+</span></span>
<span id="cb17-4"><a aria-hidden="true" href="#cb17-4" tabindex="-1"></a>  <span class="fu">주제</span>(<span class="at">axis.text.x =</span> <span class="fu">요소 _text</span>(<span class="at">각도 =</span> <span class="dv">90</span>,,,<span class="at">hjust =</span> <span class="dv">1</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-qplot2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-qplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="03-chap_files/figure-html/fig-graphics-qplot2-1.png" title="Figure 3.8: Similar to Figure fig-graphics-qplot1, but with colored bars and better bar labels."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-qplot2-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-qplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.8 : 유사합니다<a class="quarto-xref" href="#fig-graphics-qplot1">수치<span>3.7</span></a>그러나 색조와 더 나은 바 레이블이 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이것은 이제 이미 더 길고 더 복잡한 문장입니다. 해부합시다. 우리는 논쟁을 추가했습니다.<code>채우다</code>에<code>AES</code>우리가 바를 기준으로 채색 (채워진)을 원한다고 말하는 기능<code>샘플 그룹</code>(이 경우 공동 우연히<code>엑스</code>논쟁이지만 항상 그렇게 될 필요는 없습니다). 또한 우리는 전화를 추가했습니다<code>scale_fill_manual</code>함수는 컬러 맵을 입력하는 것으로 간주됩니다. 즉, 변수의 가능한 값에서 관련 색상으로의 맵핑 - 명명 벡터. 우리는 또한이 컬러 맵에 제목을 주었다 (더 복잡한 플롯에서는 몇 가지 다른 색 맵이 포함될 수 있음). 우리가 전화를 생략했다면<code>scale_fill_manual</code>,,,<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>기본 색상의 선택을 사용했을 것입니다. 우리는 또한 전화를 추가했습니다<code>주제</code>우리가 원한다고 말합니다<span class="math inline">\(엑스\)</span>-Axis 레이블은 90도 회전하고 오른쪽으로 정렬됩니다 (<code>이든</code>; 기본값은 중앙에 있습니다).</p>
<section class="level3 page-columns page-full" data-number="3.4.1" id="data-flow">
<h3 class="anchored" data-anchor-id="data-flow" data-number="3.4.1"><span class="header-section-number">3.4.1</span>데이터 흐름</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="imgs/devil.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p>기능<code>ggplot</code>데이터 프레임에서 데이터를 기대합니다. 매트릭스, 별도의 벡터 또는 다른 유형의 객체에있는 경우 변환해야합니다. 패키지<strong><a href="https://cran.r-project.org/web/packages/dplyr/">dplyr</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/broom/">비</a></strong>무엇 보다도이 목적으로 시설을 제공합니다. 우리는 이것을 더 논의 할 것입니다<a class="quarto-xref" href="13-chap.html#sec-design-datarep"><span>섹션 13.10</span></a>그리고 당신은 책 전체에서 그러한 전환의 예를 보게 될 것입니다.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">여기에는 기본 r이 포함됩니다<em>데이터. 프레임</em>뿐만 아니라<em>티블</em>(동의어<em>data_frame</em>) 수업<strong><a href="https://cran.r-project.org/web/packages/tibble/">티블</a></strong>Tidyverse의 패키지.</span></div></div>
<p>전화의 결과<code>ggplot</code>a<em>ggplot</em>물체. 위의 코드를 기억하겠습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a>GG<span class="ot">=</span> <span class="fu">ggplot</span>(dnase,<span class="fu">AES</span>(<span class="at">x =</span>conc,<span class="at">y =</span>밀도))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 이제 출력을 할당했습니다<code>ggplot</code>대상에<code>GG</code>, 콘솔로 직접 보내는 대신 "인쇄"되어 생산되었습니다.<a class="quarto-xref" href="#fig-graphics-figredobasicplottingwithggplot">수치<span>3.6</span></a>. 상황은 R 콘솔 작업을 통해 사용되는 것과 완전히 유사합니다.<code>1+1</code>그리고“Enter”를 누르면 결과가 인쇄됩니다. 표현이 다음과 같은 과제 인 경우<code>s = 1+1</code>부작용이 이루어집니다 (이름<code>"에스"</code>값을 나타내는 메모리의 객체에 바인딩됩니다.<code>1+1</code>), 그러나 아무것도 인쇄되지 않습니다. 마찬가지로, 표현이 호출 된 스크립트의 일부로 평가 될 때<code>원천</code>, 인쇄되지 않았습니다. 따라서 위의 코드는 또한 그래픽 출력을 생성하지 않습니다.<code>인쇄</code>메소드가 호출됩니다. 인쇄<code>GG</code>, 이름 (대화식 세션)을 입력하거나<code>인쇄</code>그것에 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a>GG</span>
<span id="cb19-2"><a aria-hidden="true" href="#cb19-2" tabindex="-1"></a><span class="fu">인쇄</span>(GG)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="level3" data-number="3.4.2" id="saving-figures">
<h3 class="anchored" data-anchor-id="saving-figures" data-number="3.4.2"><span class="header-section-number">3.4.2</span>수치를 저장합니다</h3>
<p><strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>내장 플롯 저장 기능이 호출됩니다<code>GGSAVE</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">GGSAVE</span>(<span class="st">"dnase-histogram-demo.pdf"</span>,,,<span class="at">플롯 =</span>GG)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>플롯을 저장하는 두 가지 주요 방법은 벡터 그래픽과 래스터 (픽셀) 그래픽이 있습니다. 벡터 그래픽에서 플롯은 점, 선, 곡선, 모양 및 타이포그래피 문자와 같은 일련의 기하학적 프리미티브로 저장됩니다. 플롯을 벡터 그래픽 형식으로 저장하기 위해 R의 선호되는 형식은 PDF입니다. 래스터 그래픽에서 플롯은 도트 매트릭스 데이터 구조에 저장됩니다. 래스터 형식의 주요 제한은 제한된 해상도이며, 이는 사용 가능한 픽셀 수에 따라 다릅니다. R에서 래스터 그래픽 출력에 가장 일반적으로 사용되는 장치는 다음과 같습니다.<code>PNG</code>. 일반적으로 벡터 그래픽 파일을 원하는 해상도의 래스터 형식으로 변환 할 수 있기 때문에 일반적으로 플롯을 벡터 그래픽 형식으로 저장하는 것이 좋습니다. 그리고 당신은 당신의 대화 나 논문의 인물이 픽셀 화 인공물 때문에 가난 해 보이는 것을 원하지 않습니다!</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="3.5" id="the-grammar-of-graphics">
<h2 class="anchored" data-anchor-id="the-grammar-of-graphics" data-number="3.5"><span class="header-section-number">3.5</span>그래픽의 문법</h2>
<p>의 구성 요소<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>그래픽의 문법입니다</p>
<ol type="1">
<li><p>하나 이상의 데이터 세트,</p></li>
<li><p>데이터의 시각적 표현 역할을하는 하나 이상의 기하학적 물체 - 예를 들어 포인트, 선, 사각형, 윤곽,</p></li>
<li><p>데이터의 변수가 기하학적 객체의 시각적 특성 (미학)에 어떻게 매핑되는지에 대한 설명 및 관련 척도 (예 : 선형, 로그, 순위),</p></li>
<li><p>하나 이상의 좌표 시스템,</p></li>
<li><p>통계 요약 규칙,</p></li>
<li><p>패싯 사양, 즉 동일한 데이터의 서브 세트를보기 위해 여러 유사한 서브 플로트를 사용하여</p></li>
<li><p>레이아웃 및 렌더링, 그러한 텍스트 크기, 글꼴 및 정렬, 범례 위치에 영향을 미치는 선택적 매개 변수.</p></li>
</ol>
<p>위의 예에서는 그림입니다<a class="quarto-xref" href="#fig-graphics-qplot1"><span>3.7</span></a>그리고<a class="quarto-xref" href="#fig-graphics-qplot2"><span>3.8</span></a>, 데이터 세트였습니다<code>그룹화</code>, 변수는 숫자 값과 이름이었습니다.<code>그룹화</code>우리는 미학에 매핑했습니다<span class="math inline">\(와이\)</span>-축 및<span class="math inline">\(엑스\)</span>각각, 스케일은 각각의 선형이었다<span class="math inline">\(와이\)</span>그리고 순위 기반<span class="math inline">\(엑스\)</span>-축 (막대는 영숫자로 주문되고 각각이 같은 너비를 갖는다), 기하학적 물체는 직사각형 막대였습니다.</p>
<p>위 목록의 항목 4–7은 선택 사항입니다. 당신이 그것들을 지정하지 않으면, 직교는 좌표계로 사용되며, 통계 요약은 사소한 것 (즉, 정체성)이며, 패싯이나 서브 플로트가 만들어지지 않습니다 (나중에 예제를 볼 수 있습니다.<a class="quarto-xref" href="#sec-graphics-facets"><span>섹션 3.8</span></a>). 처음 세 항목이 필요합니다 : 유효합니다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>“문장”은 그들 각각 중 하나 이상을 포함해야합니다.</p>
<p>사실은,<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>그래픽 문법을 구현하면 동일한 유형의 구성 요소를 여러 번 사용할 수 있습니다.<strong>레이어</strong> <span class="citation" data-cites="Wickham:LayeredGrammar">(<a href="16-chap.html#ref-Wickham:LayeredGrammar" role="doc-biblioref">Wickham 2010</a>))</span>. 예를 들어, 아래 코드는 동일한 플롯의 세 가지 유형의 기하학적 객체를 사용합니다. 동일한 데이터는 점, 라인 및 신뢰 대역입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a>DFTX<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)),<span class="fu">PDATA</span>(엑스))</span>
<span id="cb21-2"><a aria-hidden="true" href="#cb21-2" tabindex="-1"></a><span class="fu">ggplot</span>(dftx,<span class="fu">AES</span>( <span class="at">x =</span>x1426642_at,<span class="at">y =</span>x1418765_at)))<span class="sc">+</span></span>
<span id="cb21-3"><a aria-hidden="true" href="#cb21-3" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">모양 =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb21-4"><a aria-hidden="true" href="#cb21-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>( <span class="at">방법 =</span> <span class="st">"뢰스"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-scp2layers1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-scp2layers1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="03-chap_files/figure-html/fig-graphics-scp2layers1-1.png" title="Figure 3.9: A scatterplot with three layers that show different statistics of the same data: points (geom_point), a smooth regression line and a confidence band (the latter two from geom_smooth)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-scp2layers1-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-scp2layers1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.9 : 동일한 데이터의 다른 통계를 보여주는 세 개의 계층이있는 산점도 : 점 (포인트)<code>geom_point</code>), 부드러운 회귀 라인 및 자신감 밴드 (후자<code>geom_smooth</code>).
</figcaption>
</figure>
</div>
</div></div></div>
<p>여기서 우리는 표현 데이터의 사본을 조립해야했다 (<code>바이오베이스 :: exprs (x)</code>) 및 샘플 주석 데이터 (<code>PDATA (X)</code>) 모두 데이터 프레임으로 함께<code>DFTX</code>- 이것은 데이터 형식이므로<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>가장 쉽게 입력으로 취하는 기능 (자세한 내용은<a class="quarto-xref" href="13-chap.html#sec-design-datarep"><span>섹션 13.10</span></a>).</p>
<p>각 지점이<a class="quarto-xref" href="#fig-graphics-scp2layers1">수치<span>3.9</span></a>하나의 샘플에 해당하면 사용하는 것이 좋습니다.<code>SampleColour</code>대상의 정보<code>엑스</code>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" href="#cb22-1" tabindex="-1"></a><span class="fu">ggplot</span>(dftx,<span class="fu">AES</span>(<span class="at">x =</span>x1426642_at,<span class="at">y =</span>x1418765_at)))<span class="sc">+</span></span>
<span id="cb22-2"><a aria-hidden="true" href="#cb22-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>샘플 그룹),<span class="at">모양 =</span> <span class="dv">19</span>))<span class="sc">+</span></span>
<span id="cb22-3"><a aria-hidden="true" href="#cb22-3" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">값 =</span>groupcolor,<span class="at">가이드 =</span> <span class="st">"없음"</span>))<span class="sc">+</span></span>
<span id="cb22-4"><a aria-hidden="true" href="#cb22-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">방법 =</span> <span class="st">"뢰스"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-scp2layers2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-scp2layers2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="03-chap_files/figure-html/fig-graphics-scp2layers2-1.png" title="Figure 3.10: As Figure fig-graphics-scp2layers1, but in addition with points colored by the time point and cell lineage (as defined in Figure fig-graphics-qplot2). We can now see that the expression values of the gene Timd2 (targeted by the probe 1418765_at, along the y-axis) are consistently high in the early time points, whereas its expression goes down in the EPI samples at days 3.5 and 4.5. In the FGF4-KO, this decrease is delayed - at E3.5, its expression is still high. Conversely, the gene Fn1 (1426642_at, x-axis) is off in the early timepoints and then goes up at days 3.5 and 4.5. The PE samples (green) show a high degree of cell-to-cell variability."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-scp2layers2-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-scp2layers2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.10 : AS<a class="quarto-xref" href="#fig-graphics-scp2layers1">수치<span>3.9</span></a>그러나 시점과 세포 계통에 의해 색상이있는 점과 더불어 (정의 된대로<a class="quarto-xref" href="#fig-graphics-qplot2">수치<span>3.8</span></a>). 우리는 이제 유전자 TIMD2의 발현 값 (y 축을 따라 프로브 1418765_AT에 의해 표적화 된)이 초기 시점에서 일관되게 높다는 것을 알 수 있지만, 그 발현은 3.5 일 및 4.5 일에 EPI 샘플에서 내려갑니다. FGF4 -KO에서, 이러한 감소는 지연됩니다. E3.5에서는 그 발현이 여전히 높습니다. 반대로, 유전자 FN1 (1426642_AT, X 축)은 초기 시점에서 꺼져서 3.5 일 및 4.5 일에 올라갑니다. PE 샘플 (녹색)은 높은 수준의 세포 간 변동성을 나타낸다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-layers">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.2</div>
</div>
<div class="callout-body-container callout-body">
<p>위의 코드에서 우리는<code>색상</code>미학 (<code>AES</code>) 만<code>geom_point</code>우리가 정의하는 동안<code>엑스</code>그리고<code>와이</code>모든 층에 대한 미학. 우리가 설정하면 어떻게됩니다<code>색상</code>모든 계층에 대한 미학, 즉 인수 목록으로 이동<code>ggplot</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-scpsmoothline">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.3</div>
</div>
<div class="callout-body-container callout-body">
<p>그림에서와 같이 회귀선과 함께 ScatterPlot 데이터를 시각화하는 것이 항상 의미가 있습니까?<a class="quarto-xref" href="#fig-graphics-scp2layers1"><span>3.9</span></a>그리고<a class="quarto-xref" href="#fig-graphics-scp2layers2"><span>3.10</span></a>?</p>
</div>
</div>
<p>제쳐두고, 우리 가이 프로브 식별자에 의해 어떤 유전자가 목표로하는지, 그리고 그들이 할 수있는 일을 알고 싶다면 다음을 호출 할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="imgs/devil.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">다음은 원래의 기능 식별자 (예 :“x”가없는“1426642_at”)를 사용해야합니다. 이것은 마이크로 어레이 제조업체, 바이오 컨덕터 주석 패키지 및 개체 내부에서 사용하는 표기법입니다.<code>엑스</code>. 우리가 함께 일할 때 위에서 사용한 주요 "X"<code>DFTX</code>생성 중에 삽입되었습니다<code>DFTX</code>생성자 함수에 의해<code>데이터. 프레임</code>그 주장 이후<code>check.names</code>설정되었습니다<code>진실</code>기본적으로. 또는 설정하여 원래 식별자 표기법을 유지할 수있었습니다.<code>check.names = false</code>그러나 우리의 코드 (예 : 전화로<code>aes ()</code>)은 식별자 주변의 백 티크를 사용하여 R이 올바르게 해석하도록해야합니다.</span></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">사용에 유의하십시오<code>::</code>연산자에게 전화하십시오<code>선택하다</code>패키지를 포함하여 자격을 갖춘 이름으로 기능합니다. 우리는 이미 이것을 만났습니다<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>.</span></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"마우스 4302.db"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a>AnnotationDbi<span class="sc">::</span><span class="fu">선택하다</span>(Mouse4302.db,</span>
<span id="cb24-2"><a aria-hidden="true" href="#cb24-2" tabindex="-1"></a>   <span class="at">키 =</span> <span class="fu">기음</span>(<span class="st">"1426642_at"</span>,,,<span class="st">"1418765_at"</span>),)<span class="at">keytype =</span> <span class="st">"샘플렛"</span>,,,</span>
<span id="cb24-3"><a aria-hidden="true" href="#cb24-3" tabindex="-1"></a>   <span class="at">열 =</span> <span class="fu">기음</span>(<span class="st">"상징"</span>,,,<span class="st">"GeneName"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>probeid 기호 geneName
1 1426642_at fn1 피브로넥틴 1
2 1418765_at Timd2 T 세포 면역 글로불린 및 뮤신 도메인 2</code></pre>
</div>
</div>
<p>종종 사용할 때<code>ggplot</code>데이터, 미학 및 기하학적 객체 만 지정하면됩니다. 대부분의 기하학적 개체는 데이터의 적절한 기본 통계 요약을 암시 적으로 호출합니다. 예를 들어, 사용중인 경우<code>geom_smooth</code>, 그 다음에<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>용도<code>STAT = "Smooth"</code>기본적으로 라인을 표시합니다. 사용하는 경우<code>geom_histogram</code>, 데이터는 비틀어지고 결과는 BarPlot 형식으로 표시됩니다. 예는 다음과 같습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a>DFX<span class="ot">=</span> <span class="fu">as.data.frame</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스))</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a><span class="fu">ggplot</span>(DFX,<span class="fu">AES</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">20 E3.25</span><span class="st">`</span>)))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-hists">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-hists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="03-chap_files/figure-html/fig-graphics-hists-1.png" title="Figure 3.11: Histogram of probe intensities for one particular sample, cell number 20, which was from day E3.25."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-hists-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-hists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.11 : E.3.25 일에 시작된 하나의 특정 샘플 인 셀 번호 20에 대한 프로브 강도의 히스토그램.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-dftxvsdftx2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.4</div>
</div>
<div class="callout-body-container callout-body">
<p>물체의 차이점은 무엇입니까?<code>DFX</code>그리고<code>DFTX</code>? 우리는 왜 둘 다 만들어야 했습니까?</p>
</div>
</div>
<p>위의 바 플로트 예로 돌아가 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a>PB<span class="ot">=</span> <span class="fu">ggplot</span>(여러 떼,<span class="fu">AES</span>(<span class="at">x =</span>샘플 그룹,<span class="at">y =</span>N))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이것은 플롯 객체를 만듭니다<code>PB</code>. 우리가 그것을 표시하려고한다면, 우리는 사용하려는 기하학적 객체를 지정하지 않았기 때문에 빈 줄거리를 만듭니다. 우리가 가진 모든 것<code>PB</code>지금까지의 객체는 데이터와 미학입니다 (<a class="quarto-xref" href="#fig-graphics-figbpempty">수치<span>3.12</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a><span class="fu">수업</span>(PB)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gg" "ggplot"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a>PB</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-figbpempty">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-figbpempty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="03-chap_files/figure-html/fig-graphics-figbpempty-1.png" title="Figure 3.12: pb: without a geometric object (a geom), the plot area remains empty. With the default style parameters, the tick labels on the x-axis are not legible."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-figbpempty-1.png" width="256"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-figbpempty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.12 :<code>PB</code>: 기하학적 물체없이 (a<code>geom</code>), 줄거리 영역은 비어 있습니다. 기본 스타일 매개 변수를 사용하면 진드기 라벨이<span class="math inline">\(엑스\)</span>-축은 읽을 수 없다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이제 우리는<code>+</code>연산자 (<a class="quarto-xref" href="#fig-graphics-bpgg3">수치<span>3.13</span></a>) : :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a>PB<span class="ot">=</span>PB<span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">통계 =</span> <span class="st">"신원"</span>))</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a>PB<span class="ot">=</span>PB<span class="sc">+</span> <span class="fu">AES</span>(<span class="at">fill =</span>샘플 그룹)</span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a>PB<span class="ot">=</span>PB<span class="sc">+</span> <span class="fu">주제</span>(<span class="at">axis.text.x =</span> <span class="fu">요소 _text</span>(<span class="at">각도 =</span> <span class="dv">90</span>,,,<span class="at">휠 =</span> <span class="dv">1</span>)))</span>
<span id="cb31-4"><a aria-hidden="true" href="#cb31-4" tabindex="-1"></a>PB<span class="ot">=</span>PB<span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">값 =</span>groupcolor,<span class="at">이름 =</span> <span class="st">"여러 떼"</span>))</span>
<span id="cb31-5"><a aria-hidden="true" href="#cb31-5" tabindex="-1"></a>PB</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-bpgg3">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-bpgg3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="03-chap_files/figure-html/fig-graphics-bpgg3-1.png" title="Figure 3.13: The graphics object bp in its full glory."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-bpgg3-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-bpgg3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.13 : 그래픽 객체<code>BP</code>완전한 영광으로.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 단계별 빌드 업-이미 어떤 방식으로 생성 된 그래픽 객체를 만들고이를 더 정제하는 것은 그래픽을 생성하는 단일 함수 호출에 대한 모든 지침을 제공하는 것보다 더 편리하고 관리하기 쉽습니다.</p>
<p>우리는 처음부터 매번 플롯을 재구성하지 않고도 다른 시각화 아이디어를 빠르게 시도 할 수 있지만 부분적으로 완성 된 객체를 저장 한 다음 다른 방식으로 수정할 수 있습니다. 예를 들어, 우리는 플롯을 극지 좌표로 전환하여 Barplot의 대체 시각화를 만들 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a>pb.polar<span class="ot">=</span>PB<span class="sc">+</span> <span class="fu">coord_polar</span>() <span class="sc">+</span></span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a>  <span class="fu">주제</span>(<span class="at">axis.text.x =</span> <span class="fu">요소 _text</span>(<span class="at">각도 =</span> <span class="dv">0</span>,,,<span class="at">휠 =</span> <span class="dv">1</span>),)</span>
<span id="cb32-3"><a aria-hidden="true" href="#cb32-3" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">요소 _blank</span>(),</span>
<span id="cb32-4"><a aria-hidden="true" href="#cb32-4" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">요소 _blank</span>()) <span class="sc">+</span></span>
<span id="cb32-5"><a aria-hidden="true" href="#cb32-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"" "</span>))<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"" "</span>))</span>
<span id="cb32-6"><a aria-hidden="true" href="#cb32-6" tabindex="-1"></a>pb.polar</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-bpgg7">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-bpgg7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="03-chap_files/figure-html/fig-graphics-bpgg7-1.png" title="Figure 3.14: A barplot in a polar coordinate system."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-bpgg7-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-bpgg7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.14 : 극지 좌표계의 Barplot.</figcaption>
</figure>
</div>
</div></div></div>
<p>위의 참고 이전에 설정할 수 있습니다<code>주제</code>단순히 새로운 값으로 설정하여 매개 변수 - 재생성으로 돌아갈 필요가 없습니다.<code>PB</code>, 우리가 원래 그들을 설정하는 곳.</p>
</section>
<section class="level2 page-columns page-full" data-number="3.6" id="sec-graphics-univar">
<h2 class="anchored" data-anchor-id="sec-graphics-univar" data-number="3.6"><span class="header-section-number">3.6</span>1d에서 데이터 시각화</h2>
<p>생물학적 데이터 분석에서 일반적인 작업은 일 변량 측정의 여러 샘플 간의 비교입니다. 이 섹션에서는 이러한 샘플을 시각화하고 비교할 수있는 몇 가지 가능성을 살펴 보겠습니다. 예를 들어, 우리는 FGF4, GATA4, GATA6 및 SOX2의 4 가지 유전자 세트의 강도를 사용합니다.<a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>. 마이크로 어레이에서는 다음과 같습니다</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>이 유전자에 대한 자세한 내용을 읽을 수 있습니다<span class="citation" data-cites="Ohnishi2014">(<a href="16-chap.html#ref-Ohnishi2014" role="doc-biblioref">Ohnishi et al. 2014</a>))</span>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a>선택된 프로브<span class="ot">=</span> <span class="fu">기음</span>( <span class="at">fgf4 =</span> <span class="st">"1420085_at"</span>,,,<span class="at">gata4 =</span> <span class="st">"1418863_at"</span>,,,</span>
<span id="cb33-2"><a aria-hidden="true" href="#cb33-2" tabindex="-1"></a>                   <span class="at">gata6 =</span> <span class="st">"1425463_at"</span>,,,<span class="at">sox2 =</span> <span class="st">"1416967_at"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이 표현에서 데이터를 추출하여 데이터 프레임으로 변환하려면 기능을 사용합니다.<code>녹다</code>에서<strong><a href="https://cran.r-project.org/web/packages/reshape2/">reshape2</a></strong>패키지<a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>다양한 데이터 표현의 개념과 역학에 대해 더 많이 이야기 할 것입니다.<a class="quarto-xref" href="13-chap.html#sec-design-datarep"><span>섹션 13.10</span></a>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"reshape2"</span>))</span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a>유전자<span class="ot">=</span> <span class="fu">녹다</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(x) [selectedProbes],</span>
<span id="cb34-3"><a aria-hidden="true" href="#cb34-3" tabindex="-1"></a>             <span class="at">varnames =</span> <span class="fu">기음</span>(<span class="st">"조사"</span>,,,<span class="st">"견본"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>양호한 측정을 위해 프로브 식별자와 함께 유전자 기호를 제공하는 열을 추가합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>유전자<span class="sc">$</span>유전자<span class="ot">=</span></span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a>  <span class="fu">이름</span>(selectedProbes) [<span class="fu">성냥</span>(유전자<span class="sc">$</span>프로브, SelectedProbes)]</span>
<span id="cb35-3"><a aria-hidden="true" href="#cb35-3" tabindex="-1"></a><span class="fu">머리</span>(유전자)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>프로브 샘플 값 유전자
1 1420085_AT 1 E3.25 3.027715 FGF4
2 1418863_AT 1 E3.25 4.843137 GATA4
3 1425463_at 1 E3.25 5.500618 Gata6
4 1416967_AT 1 E3.25 1.731217 SOX2
5 1420085_AT 2 E3.25 9.293016 FGF4
6 1418863_AT 2 E3.25 5.530016 GATA4</code></pre>
</div>
</div>
<section class="level3 page-columns page-full" data-number="3.6.1" id="sec-graphics-univar-bar">
<h3 class="anchored" data-anchor-id="sec-graphics-univar-bar" data-number="3.6.1"><span class="header-section-number">3.6.1</span>바 플로트</h3>
<p>데이터 프레임과 같은 데이터를 표시하는 인기있는 방법<code>유전자</code>Barplots를 통해 (<a class="quarto-xref" href="#fig-graphics-onedbp1">수치<span>3.15</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>(<span class="at">x =</span>유전자,<span class="at">y =</span>값))<span class="sc">+</span></span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a>  <span class="fu">STAT_SUMMARY</span>(<span class="at">재미 =</span>평균,<span class="at">geom =</span> <span class="st">"술집"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedbp1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedbp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="03-chap_files/figure-html/fig-graphics-onedbp1-1.png" title="Figure 3.15: Barplots showing the means of the distributions of expression measurements from four probes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedbp1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedbp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.15 : 4 개의 프로브로부터의 발현 측정 분포의 평균을 보여주는 바 플로트.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="#fig-graphics-onedbp1">수치<span>3.15</span></a>, 각 막대는 해당 유전자의 값의 평균을 나타냅니다. 이러한 음모는 일반적으로 생물 과학뿐만 아니라 대중 매체에서 사용됩니다. 그러나 데이터를 단일 숫자로만 요약하면 평균은 많은 정보를 잃고, 공간의 양을 감안할 때 Barplot은 데이터를 시각화하는 방법이 좋지 않습니다.<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>실제로, 평균이 비뚤어 지거나 멀티 모달 분포 또는 규모가 큰 데이터 세트와 같은 적절한 요약이 아닌 경우, 이러한 종류의 시각화는 완전히 오해의 소지가있을 수 있습니다.</p></div></div><p>때때로 우리는 오류 막대를 추가하고이를 달성하는 한 가지 방법을 원합니다.<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>다음과 같습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"HMISC"</span>))</span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a><span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>( <span class="at">x =</span>유전자,<span class="at">y =</span>값,<span class="at">fill =</span>유전자))<span class="sc">+</span></span>
<span id="cb38-3"><a aria-hidden="true" href="#cb38-3" tabindex="-1"></a>  <span class="fu">STAT_SUMMARY</span>(<span class="at">재미 =</span>평균,<span class="at">geom =</span> <span class="st">"술집"</span>))<span class="sc">+</span></span>
<span id="cb38-4"><a aria-hidden="true" href="#cb38-4" tabindex="-1"></a>  <span class="fu">STAT_SUMMARY</span>(<span class="at">fun.data =</span>Mean_cl_normal,<span class="at">geom =</span> <span class="st">"ErrorBar"</span>,,,</span>
<span id="cb38-5"><a aria-hidden="true" href="#cb38-5" tabindex="-1"></a>               <span class="at">너비 =</span> <span class="fl">0.25</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedbp2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedbp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-21" href="03-chap_files/figure-html/fig-graphics-onedbp2-1.png" title="Figure 3.16: Barplots with error bars indicating standard error of the mean."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedbp2-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedbp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.16 : 평균의 표준 오차를 나타내는 오류 막대가있는 바 플로트.</figcaption>
</figure>
</div>
</div></div></div>
<p>여기서 우리는 계층화 된 그래픽의 원리를 다시 볼 수 있습니다. 우리는 두 가지 요약 기능을 사용합니다.<code>평균</code>그리고<code>평균 _cl_normal</code>, 두 개의 관련 기하학적 물체,<code>술집</code>그리고<code>errrorbar</code>. 기능<code>평균 _cl_normal</code>.부터<strong><a href="https://cran.r-project.org/web/packages/Hmisc/">HMISC</a></strong>패키지 및 표준 오류 (또는<strong>기음</strong>신뢰<strong>엘</strong>평균의 모방); 간단한 기능이며, 원한다면 기본 R 표현식을 사용하여 스스로 계산할 수도 있습니다. 우리는 또한 줄거리를 채색하여 음모를 더 시각적으로 즐겁게 만들었습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="3.6.2" id="boxplots">
<h3 class="anchored" data-anchor-id="boxplots" data-number="3.6.2"><span class="header-section-number">3.6.2</span>박스 플롯</h3>
<p>Boxplots는 바플 로트와 비슷한 양의 공간을 차지하지만 훨씬 더 유익합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" href="#cb39-1" tabindex="-1"></a>피<span class="ot">=</span> <span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>( <span class="at">x =</span>유전자,<span class="at">y =</span>값,<span class="at">fill =</span>유전자))</span>
<span id="cb39-2"><a aria-hidden="true" href="#cb39-2" tabindex="-1"></a>피<span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedboxpl">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedboxpl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-22" href="03-chap_files/figure-html/fig-graphics-onedboxpl-1.png" title="Figure 3.17: Boxplots."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedboxpl-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedboxpl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.17 : 박스 플롯.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="#fig-graphics-onedboxpl">수치<span>3.17</span></a>우리는 두 유전자 (GATA4, GATA6)가 비교적 집중된 분포를 가지고 있으며, 몇 가지 데이터 포인트 만 더 높은 값의 방향으로 배출됩니다. FGF4의 경우, 분포가 오른쪽으로 쇠약해진다는 것을 알 수 있습니다. 상자 내의 수평 검은 색 막대로 표시된 중앙값은 상자의 하단 (또는 왼쪽)에 더 가깝습니다. 반대로, Sox2의 경우 분포가 왼쪽으로 늘어납니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="3.6.3" id="dot-plots-and-beeswarm-plots">
<h3 class="anchored" data-anchor-id="dot-plots-and-beeswarm-plots" data-number="3.6.3"><span class="header-section-number">3.6.3</span>도트 플롯 및 꿀벌 따뜻함</h3>
<p>데이터 포인트 수가 너무 크지 않으면 데이터 포인트를 직접 표시 할 수 있으며 위에서 본 요약과 비교하여 그렇게하는 것이 좋습니다. 그러나 데이터를 직접 플로팅하면 종종 겹치는 포인트로 이어질 수 있으며, 이는 시각적으로 불쾌하거나 데이터를 가릴 수도 있습니다. 우리는 포인트를 배치하여 겹치지 않고 적절한 위치에 가능한 한 가까이 있도록 노력할 수 있습니다.<span class="citation" data-cites="Wilkinson:DotPlots:1999">(<a href="16-chap.html#ref-Wilkinson:DotPlots:1999" role="doc-biblioref">Wilkinson 1999</a>))</span>.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" href="#cb40-1" tabindex="-1"></a>피<span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"와이"</span>,,,<span class="at">binwidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,,,</span>
<span id="cb40-2"><a aria-hidden="true" href="#cb40-2" tabindex="-1"></a>       <span class="at">stackdir =</span> <span class="st">"센터"</span>,,,<span class="at">stackratio =</span> <span class="fl">0.75</span>,,,</span>
<span id="cb40-3"><a aria-hidden="true" href="#cb40-3" tabindex="-1"></a>       <span class="fu">AES</span>(<span class="at">색상 =</span>유전자))</span>
<span id="cb40-4"><a aria-hidden="true" href="#cb40-4" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggbeeswarm"</span>))</span>
<span id="cb40-5"><a aria-hidden="true" href="#cb40-5" tabindex="-1"></a>피<span class="sc">+</span> <span class="fu">geom_beeswarm</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>유전자))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-oneddot">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-oneddot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-oneddot" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-oneddot-1" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-oneddot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-oneddot" href="03-chap_files/figure-html/fig-graphics-oneddot-1.png" title="Figure 3.18 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-oneddot" id="fig-graphics-oneddot-1" src="03-chap_files/figure-html/fig-graphics-oneddot-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-oneddot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-oneddot" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-oneddot-2" width="400">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-oneddot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-oneddot" href="03-chap_files/figure-html/fig-graphics-oneddot-2.png" title="Figure 3.18 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-oneddot" id="fig-graphics-oneddot-2" src="03-chap_files/figure-html/fig-graphics-oneddot-2.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-oneddot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-oneddot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.18 : (a) 도트 플롯, 사용<code>geom_dotplot</code>~에서<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>. (b) 꿀벌 따뜻한 음모를 사용하여 만들어졌습니다<code>geom_beeswarm</code>~에서<strong><a href="https://cran.r-project.org/web/packages/ggbeeswarm/">Ggbeeswarm</a></strong>.
</figcaption>
</figure>
</div>
</div>
<p>패널 (a)의 플롯<a class="quarto-xref" href="#fig-graphics-oneddot">수치<span>3.18</span></a>. 그만큼<span class="math inline">\(와이\)</span>-포인트의 코디네스는 쓰레기통으로 분산되어 있습니다 (위의 빈 크기는 1/6을 선택했습니다).</p>
<p>패키지에서 대안이 제공됩니다<strong><a href="https://cran.r-project.org/web/packages/ggbeeswarm/">Ggbeeswarm</a></strong>, 제공하는<code>geom_beeswarm</code>. 플롯은 패널 (b)에 표시됩니다<a class="quarto-xref" href="#fig-graphics-oneddot">수치<span>3.18</span></a>. 레이아웃 알고리즘은 포인트 간의 중첩을 피하는 것을 목표로합니다. 포인트가 기존 지점을 겹치면<span class="math inline">\(엑스\)</span>-겹치는 것을 피하기에 충분한 소량으로 축. 레이아웃 매개 변수의 일부 조정은 일반적으로 각각의 새로운 데이터 세트마다 도트 플롯이나 꿀벌 수백 플롯을보기 좋게 만들기 위해 필요합니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="3.6.4" id="sec-graphics-univar:dens">
<h3 class="anchored" data-anchor-id="sec-graphics-univar:dens" data-number="3.6.4"><span class="header-section-number">3.6.4</span>밀도 플롯</h3>
<p>동일한 데이터를 나타내는 또 다른 방법은 밀도 플롯에 의한 것입니다. 여기서, 우리는 데이터 포인트를 평활화하여 기본 데이터 생성 밀도를 추정하려고 노력합니다.<a class="quarto-xref" href="#fig-graphics-oneddens">수치<span>3.19</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a><span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>( <span class="at">x =</span>값,<span class="at">색상 =</span>유전자))<span class="sc">+</span> <span class="fu">geom_density</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-oneddens">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-oneddens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-25" href="03-chap_files/figure-html/fig-graphics-oneddens-1.png" title="Figure 3.19: Density plots."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-oneddens-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-oneddens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.19 : 밀도 플롯.</figcaption>
</figure>
</div>
</div></div></div>
<p>당신이 그림에서 볼 수 있듯이<a class="quarto-xref" href="#fig-graphics-onedboxpl"><span>3.17</span></a>-<a class="quarto-xref" href="#fig-graphics-oneddens"><span>3.19</span></a>, BoxPlots는 단단한 데이터에 대해 상당히 잘 작동하지만 데이터 배포가 멀티 모달이라면 오도 할 수 있으며 항상 긴 꼬리 분포에 대한 공정한 인상을주는 것은 아닙니다. 데이터 포인트 또는 밀도를 직접 표시하여 그림<a class="quarto-xref" href="#fig-graphics-oneddot"><span>3.18</span></a>-<a class="quarto-xref" href="#fig-graphics-oneddens"><span>3.19</span></a>) 그러한 기능에 대한 더 나은 인상을줍니다. 예를 들어, 우리는 FGF4 및 SOX2에 대한 데이터가 바이 모달이라는 것을 알 수 있지만 Gata4 및 Gata6은 대부분의 값이 기준선 주위에 집중되어 있지만 특정 부분의 셀은 광범위한 값에 걸쳐 발현 수준이 높아졌습니다.</p>
<p>그러나 밀도 추정에는 여러 가지 합병증, 특히 스무딩 윈도우를 선택해야 할 필요성이 있습니다. 데이터의 조밀 한 영역에서 피크를 캡처하기에 충분히 작은 창 크기는 다른 곳에서 불안정 ( "Wiggly") 추정치로 이어질 수 있습니다. 반면에, 창이 더 커지면 날카로운 피크와 같은 밀도의 뚜렷한 특징이 부드럽게 될 수 있습니다. 또한 밀도 라인은 데이터를 추정하는 데 얼마나 많은 데이터가 사용되었는지에 대한 정보를 전달하지 않으며<a class="quarto-xref" href="#fig-graphics-oneddens">수치<span>3.19</span></a>곡선의 샘플 크기가 다른 경우 특히 문제가 될 수 있습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="3.6.5" id="violin-plots">
<h3 class="anchored" data-anchor-id="violin-plots" data-number="3.6.5"><span class="header-section-number">3.6.5</span>바이올린 음모</h3>
<p>다음과 같은 밀도 플롯<a class="quarto-xref" href="#fig-graphics-oneddens">수치<span>3.19</span></a>밀도가 여러 개있는 경우 붐비는 것처럼 보이며 한 가지 아이디어는 BoxPlots에서 영감을 얻은 레이아웃에 밀도를 배열하는 것입니다.<a class="quarto-xref" href="#fig-graphics-onedviolin">수치<span>3.20</span></a>). 여기서 밀도 추정치는 대칭 모양을 그리는 데 사용되며 때로는 바이올린을 시각적으로 상기시킵니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a>피<span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedviolin">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedviolin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-26" href="03-chap_files/figure-html/fig-graphics-onedviolin-1.png" title="Figure 3.20: Violin plots."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedviolin-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedviolin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.20 : 바이올린 플롯.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level3 page-columns page-full" data-number="3.6.6" id="sec-graphics-univar:ridge">
<h3 class="anchored" data-anchor-id="sec-graphics-univar:ridge" data-number="3.6.6"><span class="header-section-number">3.6.6</span>리 게 라인 플롯</h3>
<p>밀도 플롯에 대한 또 다른 연극은 능선 플롯입니다 (<a class="quarto-xref" href="#fig-graphics-onedridge4">수치<span>3.21</span></a>) : :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Ggridges"</span>))</span>
<span id="cb43-2"><a aria-hidden="true" href="#cb43-2" tabindex="-1"></a><span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>(<span class="at">x =</span>값,<span class="at">y =</span>유전자,<span class="at">fill =</span>유전자))<span class="sc">+</span> </span>
<span id="cb43-3"><a aria-hidden="true" href="#cb43-3" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedridge4">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedridge4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-27" href="03-chap_files/figure-html/fig-graphics-onedridge4-1.png" title="Figure 3.21: Ridgeline plots."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedridge4-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedridge4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.21 : Ridgeline Plots.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 유형의 디스플레이는 표시된 밀도의 수가 수십 개로 들어가면 가장 적합합니다.</p>
<div class="cell" data-layout-align="center" data-warning.known="rows containing non-finite values">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a>Top42<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">Rowmeans</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">42</span>]]</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a>G42<span class="ot">=</span> <span class="fu">녹다</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)[<span class="fu">회전</span>(Top42),],<span class="at">varnames =</span> <span class="fu">기음</span>(<span class="st">"조사"</span>,,,<span class="st">"견본"</span>)))</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a><span class="fu">ggplot</span>(G42,<span class="fu">AES</span>(<span class="at">x =</span>값,<span class="at">y =</span>조사))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="rows containing non-finite outside">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedridge42">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedridge42-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-28" href="03-chap_files/figure-html/fig-graphics-onedridge42-1.png" title="Figure 3.22: Like Figure fig-graphics-onedridge4, with more genes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedridge42-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedridge42-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.22 : 좋아요<a class="quarto-xref" href="#fig-graphics-onedridge4">수치<span>3.21</span></a>더 많은 유전자가 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level3 page-columns page-full" data-number="3.6.7" id="sec-graphics-ecdf">
<h3 class="anchored" data-anchor-id="sec-graphics-ecdf" data-number="3.6.7"><span class="header-section-number">3.6.7</span>ECDF 플롯</h3>
<p>1 차원 랜덤 변수의 분포를 설명하는 수학적으로 가장 편리한 방법<span class="math inline">\(엑스\)</span>그것입니다<strong>누적 분포 함수</strong> (<strong>CDF</strong>), 즉, 정의 된 함수</p>
<p><span class="anchored-eq" data-anchor-id="eq-graphics" id="eq-graphics-def-cdf"><span class="math display">"
f (x) = p (x \ le x),
\ 완료 {3.1} \]</span></span></p>
<p>어디<span class="math inline" data-anchor-id="eq-graphics">\(엑스\)</span>실제 축을 따라 모든 값을 취합니다. 밀도<span class="math inline">\(엑스\)</span>그런 다음의 미분입니다<span class="math inline">\(에프\)</span>존재하는 경우<a class="footnote-ref" href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a>. 확률의 유한 샘플 버전<a class="quarto-xref" href="#eq-graphics-def-cdf"><span>3.1</span></a>is called the<strong>경험적 누적 분포 기능</strong> (<strong>ECDF</strong>),)</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>정의에 의해<span class="math inline" data-anchor-id="eq-xvbrnqszojec">\(에프\)</span>작은 경우 0 경향이 있습니다<span class="math inline">\(엑스\)</span> (<span class="math inline">\ (x \ to- \ infty \)</span>) 그리고 큰 경우 1<span class="math inline">\(엑스\)</span> (<span class="math inline">\ (x \ to+\ infty \)</span>).</p></div></div><p><span id="eq-xvbrnqszojec"><span class="math display">\ [
f_ {n} (x) = \ frac {\ text {who} x_i \ le x} {n} = \ frac {1} {n} \ sum_ {i = 1}^n 𝟙 ({x \ le x_i}),
\ tag {3.2} \]</span></span></p>
<p>어디<span class="math inline">\ (x_1, ..., x_n \)</span>샘플을 나타냅니다<span class="math inline">\(N\)</span>그려집니다<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\ (\ \)</span>인수의 표현이 참이면 값을 취하는 함수, 그렇지 않으면 0이 표시됩니다. 이것이 추상적으로 들리면 다음 예에서 더 직관적 인 이해를 얻을 수 있습니다.<a class="quarto-xref" href="#fig-graphics-ecdfexample">수치<span>3.23</span></a>) : :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a>심다타<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">70</span>))</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a><span class="fu">티블</span>(<span class="at">색인 =</span> <span class="fu">서열</span>(<span class="at">함께 =</span>simdata),</span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a>          <span class="at">sx =</span> <span class="fu">종류</span>(Simdata))<span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a aria-hidden="true" href="#cb45-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">AES</span>(<span class="at">x =</span>SX,<span class="at">y =</span>색인))<span class="sc">+</span> <span class="fu">geom_step</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-ecdfexample">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-ecdfexample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="03-chap_files/figure-html/fig-graphics-ecdfexample-1.png" title="Figure 3.23: Sorted values of simdata versus their index. This is the empirical cumulative distribution function of simdata."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-ecdfexample-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-ecdfexample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.23 : 정렬 된 값<code>심다타</code>그들의 지수와 비교합니다. 이것은 경험적 누적 분포 함수입니다<code>심다타</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>정렬 된 값을 자신의 순위에 플로팅하면 ECDF의 필수 기능이 제공됩니다.<a class="quarto-xref" href="#fig-graphics-ecdfexample">수치<span>3.23</span></a>). 실제로, 우리는 위의 코드의 정렬 및 다른 단계를 수동으로 수행 할 필요가 없으며 오히려 사용합니다.<code>stat_ecdf ()</code>기하학적 물체. 데이터의 ECDF가 표시됩니다<a class="quarto-xref" href="#fig-graphics-onedecdf">수치<span>3.24</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>( <span class="at">x =</span>값,<span class="at">색상 =</span>유전자))<span class="sc">+</span> <span class="fu">STAT_ECDF</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedecdf">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-onedecdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="03-chap_files/figure-html/fig-graphics-onedecdf-1.png" title="Figure 3.24: Empirical cumulative distribution functions (ECDF)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-onedecdf-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-onedecdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.24 : 경험적 누적 분포 함수 (ECDF).</figcaption>
</figure>
</div>
</div></div></div>
<p>ECDF에는 몇 가지 좋은 속성이 있습니다.</p>
<ul>
<li><p>무손실 : ECDF입니다<span class="math inline">\ (f_ {n} (x) \)</span>원래 샘플에 포함 된 모든 정보가 포함되어 있습니다<span class="math inline">\ (x_1, ..., x_n \)</span>, 값의 순서를 제외하고는 중요하지 않은 것으로 가정합니다.</p></li>
<li><p>처럼<span class="math inline">\(N\)</span>ECDF가 자랍니다<span class="math inline">\ (f_ {n} (x) \)</span>진정한 CDF로 수렴합니다<span class="math inline">\ (f (x) \)</span>. 제한된 샘플 크기의 경우에도<span class="math inline">\(N\)</span>, 두 기능의 차이는 작은 경향이 있습니다. 이것은 경험적 밀도의 경우가 아닙니다! 스무딩없이, 유한 샘플의 경험적 밀도는 Dirac Delta 함수의 합계이며, 이는 시각화하기가 어렵고 기본 매끄럽고 실제 밀도와는 상당히 다릅니다. 스무딩을 사용하면 차이가 덜 두드러 질 수 있지만 위에서 논의한 것처럼 제어하기가 어렵습니다.</p></li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-graphics-Lawrence-TCGA-Nature-2013-Fig1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-Lawrence-TCGA-Nature-2013-Fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="imgs/Lawrence-TCGA-Nature-2013-Fig1.png" title="Figure 3.25: Part of Figure 1 from @Lawrence:Nature:2013. Each dot corresponds to a tumour-normal pair, with vertical position indicating the total frequency of somatic mutations in the exome. The resulting curves are, in essence, ECDF plots, and conceptually this plot is similar to Figure fig-graphics-onedecdf, just that the graphs are rotated by 90 degrees (i.e., the roles of x- and y-axis are exchanged) and the curves for the individual tumor types are horizontally displaced to keep them better apart."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Lawrence-TCGA-Nature-2013-Fig1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-Lawrence-TCGA-Nature-2013-Fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.25 : 그림 1의 일부<span class="citation" data-cites="Lawrence:Nature:2013">로렌스 et al. (<a href="16-chap.html#ref-Lawrence:Nature:2013" role="doc-biblioref">2013</a>))</span>. 각 점은 종양-정규 쌍에 해당하며, 수직 위치는 엑솜의 체세포 돌연변이의 총 빈도를 나타냅니다. 결과 곡선은 본질적으로 ECDF 플롯이며 개념적 으로이 플롯은<a class="quarto-xref" href="#fig-graphics-onedecdf">수치<span>3.24</span></a>, 그래프가 90도 (즉, 역할)<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-축이 교환되고 개별 종양 유형의 곡선은 수평으로 변위되어 더 나은 분리를 유지합니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>티블.</strong>위의 코드에서 우리는<code>티블</code>처음으로. Vignette를 살펴보십시오<strong><a href="https://cran.r-project.org/web/packages/tibble/">티블</a></strong>그것이하는 일을위한 패키지.</p>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="3.6.8" id="the-effect-of-transformations-on-densities">
<h3 class="anchored" data-anchor-id="the-effect-of-transformations-on-densities" data-number="3.6.8"><span class="header-section-number">3.6.8</span>밀도에 대한 변환의 영향</h3>
<p>히스토그램이나 밀도 플롯을보고 증거를 검사하려는 유혹이 있습니다.<strong>이분권</strong>일부 기본 생물학적 현상의 표시로서 (또는 다중 양태). 그렇게하기 전에 밀도의 모드 수는 데이터의 스케일 변환에 달려 있음을 기억하는 것이 중요합니다.<strong>체인 규칙</strong>. 예를 들어, Hiiragi 데이터 세트의 배열 중 하나의 데이터를 살펴 보겠습니다 (<a class="quarto-xref" href="#fig-graphics-onedtrsf">수치<span>3.26</span></a>) : :</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1" data-warning.known='["rows containing non-finite outside","rows containing missing values"]'>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" href="#cb47-1" tabindex="-1"></a><span class="fu">ggplot</span>(DFX,<span class="fu">AES</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">64 E4.5 (EPI)</span><span class="st">`</span>)))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">100</span>))</span>
<span id="cb47-2"><a aria-hidden="true" href="#cb47-2" tabindex="-1"></a><span class="fu">ggplot</span>(DFX,<span class="fu">AES</span>(<span class="at">x =</span> <span class="dv">2</span> <span class="sc">^</span> <span class="st">`</span><span class="at">64 E4.5 (EPI)</span><span class="st">`</span>)))<span class="sc">+</span> </span>
<span id="cb47-3"><a aria-hidden="true" href="#cb47-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">20</span>))<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,,,<span class="dv">1500</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-onedtrsf">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-onedtrsf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-onedtrsf" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedtrsf-1" width="280">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-onedtrsf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-onedtrsf" href="03-chap_files/figure-html/fig-graphics-onedtrsf-1.png" title="Figure 3.26 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-onedtrsf" id="fig-graphics-onedtrsf-1" src="03-chap_files/figure-html/fig-graphics-onedtrsf-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-onedtrsf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-onedtrsf" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-onedtrsf-2" width="280">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-onedtrsf-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-onedtrsf" href="03-chap_files/figure-html/fig-graphics-onedtrsf-2.png" title="Figure 3.26 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-onedtrsf" id="fig-graphics-onedtrsf-2" src="03-chap_files/figure-html/fig-graphics-onedtrsf-2.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-onedtrsf-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-onedtrsf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.26 : 로그 변환이 있거나없는 동일한 데이터의 히스토그램. (a) 데이터는 데이터 객체에 저장된 규모로 표시됩니다.<code>엑스</code>, 로그 (기본 2) 마이크로 어레이 형광 강도의 변환으로 인한 것<span class="citation" data-cites="Irizarry:Biostat:2003">(<a href="16-chap.html#ref-Irizarry:Biostat:2003" role="doc-biblioref">Irizarry et al. 2003</a>))</span>; (b) 다시 설계 한 후 형광 척도로 다시. 공간을 더 잘 사용하기 위해 우리는<span class="math inline">\(엑스\)</span>-축 범위는 1500입니다.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-trsfsmodes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.5</div>
</div>
<div class="callout-body-container callout-body">
<p>(고급 :) 임의 변수를 고려하십시오<span class="math inline">\(엑스\)</span>및 비선형 1 : 1 변환<span class="math inline">\ (f : x \ mapsto y \)</span>변환 된 랜덤 변수를 정의합니다<span class="math inline">\ (y = f (x) \)</span>. 밀도 함수를 가정하십시오<span class="math inline">\(와이\)</span>~이다<span class="math inline">\ (p (y) \)</span>. 밀도는 얼마입니까?<span class="math inline">\(엑스\)</span>? 모드는 어떻습니까 (또는 모드)<span class="math inline">\(엑스\)</span>의 모드와 관련이 있습니다<span class="math inline">\(와이\)</span>?<br/>힌트 : 함수 모드입니다<span class="math inline">\(피\)</span>파생물의 뿌리입니다<span class="math inline">\ (p '= dp/dx \)</span>. 일반적으로 그렇습니다<span class="math inline">\ (x_0 \)</span>모드입니다<span class="math inline">\(엑스\)</span>, 그 다음에<span class="math inline">\ (y_0 = f (x_0) \)</span>모드입니다<span class="math inline">\(와이\)</span>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-9-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-9-contents callout-collapse collapse" id="callout-9">
<div class="callout-body-container callout-body">
<p>체인 규칙에 따르면<span class="math inline">\ (p (y) \, to = p (x)) \) \, f '(x) \, dx \)</span>, 그래서 밀도<span class="math inline">\(엑스\)</span>~이다<span class="math inline">\ (\ tilde {p} (x) = p (f (x)) \, f '(x) \)</span>. 의 모드<span class="math inline">\ (\ tilde {p} \)</span>파생물의 뿌리입니다<span class="math inline">\ (d \ tilde {p}/dx \)</span>, 즉, 그들은 순종합니다<span class="math inline">\ (p '(f (x)) \, f'^2 (x) + p (f (x)) f "(x) = 0 \)</span>. 합의 두 번째 용어는 IF가 사라집니다<span class="math inline">\(에프\)</span>Affine 선형입니다 (<span class="math inline">\ (f "\ equiv0 \)</span>),하지만 일반적으로 두 밀도의 뿌리와 그 모드 사이에는 간단한 관계가 없습니다.<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="3.7" id="sec-graphics-2d">
<h2 class="anchored" data-anchor-id="sec-graphics-2d" data-number="3.7"><span class="header-section-number">3.7</span>2D에서 데이터 시각화 : ScatterPlots</h2>
<p>ScatterPlots는 치료 - 응답 비교를 시각화하는 데 유용합니다<a class="quarto-xref" href="#fig-graphics-basicplotting2">수치<span>3.3</span></a>), 변수 간의 연관성 (in<a class="quarto-xref" href="#fig-graphics-scp2layers2">수치<span>3.10</span></a>) 또는 쌍을 이루는 데이터 (예 : 치료 전후 몇몇 환자에서 질병 바이오 마커). 우리는 두 가지 변수를 나타 내기 위해 플로팅 용지 또는 화면의 두 차원을 사용합니다. 야생형과 FGF4-KO 샘플 사이의 차이 표현을 살펴 보겠습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>SCP<span class="ot">=</span> <span class="fu">ggplot</span>(DFX,<span class="fu">AES</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">59 E4.5 (PE)</span><span class="st">`</span>,,,</span>
<span id="cb48-2"><a aria-hidden="true" href="#cb48-2" tabindex="-1"></a>                      <span class="at">y =</span> <span class="st">`</span><span class="at">92 E4.5 (FGF4-KO)</span><span class="st">`</span>)))</span>
<span id="cb48-3"><a aria-hidden="true" href="#cb48-3" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-twodsp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-34" href="03-chap_files/figure-html/fig-graphics-twodsp1-1.png" title="Figure 3.27: Scatterplot of 45101 expression measurements for two of the samples."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-twodsp1-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-twodsp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.27 : 두 샘플에 대한 45101 표현 측정의 산점도.</figcaption>
</figure>
</div>
</div></div></div>
<p>레이블 59 E4.5 (PE) 및 92 E4.5 (FGF4-KO) 데이터 프레임에서 열 이름 (샘플 이름)을 참조하십시오.<code>DFX</code>우리가 위에서 만든 것. 특수 문자 (공백, 괄호, 하이픈)를 포함하고 숫자로 시작하기 때문에 R에 대해 구문 적으로 소화 할 수 있도록 하향 경 사진 따옴표와 함께 동봉해야합니다.<a class="quarto-xref" href="#fig-graphics-twodsp1">수치<span>3.27</span></a>. 우리는 클라우드 외곽에서 시도하고 해석 할 수있는 밀도가 높은 포인트 클라우드를 얻지 만 플롯의 밀도가 높은 영역 내에 데이터가 어떻게 분포되는지 시각적으로 전혀 알 수 없습니다.</p>
<p>오버 플로팅을 개선하는 쉬운 방법 중 하나는<code>알파</code>매개 변수<code>geom_point</code> (<a class="quarto-xref" href="#fig-graphics-twodsp2">수치<span>3.28</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">알파 =</span> <span class="fl">0.1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-twodsp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-35" href="03-chap_files/figure-html/fig-graphics-twodsp2-1.png" title="Figure 3.28: As Figure fig-graphics-twodsp1, but with semi-transparent points to resolve some of the overplotting."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-twodsp2-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-twodsp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.28 : AS<a class="quarto-xref" href="#fig-graphics-twodsp1">수치<span>3.27</span></a>그러나 반 트랜스 펜트 포인트로 일부 오버 플롯팅을 해결합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이것은 이미보다 낫습니다<a class="quarto-xref" href="#fig-graphics-twodsp1">수치<span>3.27</span></a>그러나 더 빽빽한 지역에서는 반도당 지점조차도 특징이없는 검은 덩어리로 빠르게 기타로 튀어 나오는 반면, 더 고립 된 외곽 지점은 희미 해지고 있습니다. 대안은 2D 밀도의 윤곽 줄거리이며, 이는 플롯의 모든 점을 렌더링하지 않는 이점이 추가됩니다.<a class="quarto-xref" href="#fig-graphics-twodsp3">수치<span>3.29</span></a>.</p>
<p>그러나 우리는 볼 수 있습니다<a class="quarto-xref" href="#fig-graphics-twodsp3">수치<span>3.29</span></a>오른쪽 하단의 포인트 클라우드 (상대적으로 적은 수의 포인트를 포함 함)는 더 이상 표시되지 않습니다. 우리는 대역폭을 조정하고 바이닝 매개 변수를 조정함으로써 이것을 다소 극복 할 수 있습니다.<code>geom_density2d</code> (<a class="quarto-xref" href="#fig-graphics-twodsp4">수치<span>3.30</span></a>, 왼쪽 패널).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">geom_density2d</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp3">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-twodsp3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-36" href="03-chap_files/figure-html/fig-graphics-twodsp3-1.png" title="Figure 3.29: As Figure fig-graphics-twodsp1, but rendered as a contour plot of the 2D density estimate."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-twodsp3-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-twodsp3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.29 : AS<a class="quarto-xref" href="#fig-graphics-twodsp1">수치<span>3.27</span></a>, 그러나 2D 밀도 추정치의 윤곽 플롯으로 렌더링됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">h =</span> <span class="fl">0.5</span>,,,<span class="at">빈 =</span> <span class="dv">60</span>))</span>
<span id="cb51-2"><a aria-hidden="true" href="#cb51-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rcolorbrewer"</span>))</span>
<span id="cb51-3"><a aria-hidden="true" href="#cb51-3" tabindex="-1"></a>컬러 스케일<span class="ot">=</span> <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb51-4"><a aria-hidden="true" href="#cb51-4" tabindex="-1"></a>    <span class="at">색상 =</span> <span class="fu">회전</span>(<span class="fu">브루어</span>(<span class="dv">9</span>,,,<span class="st">"ylgnbu"</span>)),</span>
<span id="cb51-5"><a aria-hidden="true" href="#cb51-5" tabindex="-1"></a>    <span class="at">값 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="fu">exp</span>(<span class="fu">서열</span>(<span class="sc">-</span><span class="dv">5</span>,,,<span class="dv">0</span>,,,<span class="at">length.out =</span> <span class="dv">100</span>))))</span>
<span id="cb51-6"><a aria-hidden="true" href="#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a aria-hidden="true" href="#cb51-7" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">h =</span> <span class="fl">0.5</span>,,,<span class="at">빈 =</span> <span class="dv">60</span>,,,</span>
<span id="cb51-8"><a aria-hidden="true" href="#cb51-8" tabindex="-1"></a>          <span class="fu">AES</span>( <span class="at">fill =</span> <span class="fu">후_stat</span>(수준)),<span class="at">geom =</span> <span class="st">"다각형"</span>))<span class="sc">+</span></span>
<span id="cb51-9"><a aria-hidden="true" href="#cb51-9" tabindex="-1"></a>컬러 스케일<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-graphics-twodsp4">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-twodsp4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-twodsp4" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp4-1" width="280">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-twodsp4-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-twodsp4" href="03-chap_files/figure-html/fig-graphics-twodsp4-1.png" title="Figure 3.30 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-twodsp4" id="fig-graphics-twodsp4-1" src="03-chap_files/figure-html/fig-graphics-twodsp4-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-twodsp4-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-twodsp4" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp4-2" width="280">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-twodsp4-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-twodsp4" href="03-chap_files/figure-html/fig-graphics-twodsp4-2.png" title="Figure 3.30 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-twodsp4" id="fig-graphics-twodsp4-2" src="03-chap_files/figure-html/fig-graphics-twodsp4-2.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-twodsp4-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-twodsp4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.30 : 2D 밀도 플롯. (a) AS<a class="quarto-xref" href="#fig-graphics-twodsp3">수치<span>3.29</span></a>그러나 더 작은 스무딩 대역폭과 윤곽선에 대한 더 단단한 비닝. (b) 색상 충전.</figcaption>
</figure>
</div>
</div>
<p>기능을 명시 적으로 호출하여 점의 상대 밀도로 윤곽선 사이의 각 공간을 채울 수 있습니다.<code>stat_density2d</code>(무엇을 위해<code>geom_density2d</code>래퍼) 및 기하학적 물체를 사용합니다<em>다각형</em>오른쪽 패널에서와 같이<a class="quarto-xref" href="#fig-graphics-twodsp4">수치<span>3.30</span></a>.</p>
<p>우리는 기능을 사용했습니다<code>브루어</code>패키지에서<strong><a href="https://cran.r-project.org/web/packages/RColorBrewer/">rcolorbrewer</a></strong>색상 스케일을 정의하기 위해 전화를 추가했습니다.<code>coord_fixed</code>플롯의 종횡비를 고정하려면 데이터의 매핑이<span class="math inline">\(엑스\)</span>- 그리고<span class="math inline">\(와이\)</span>-코디네이트는 두 변수에 대해 동일합니다. 이 두 가지 문제는 모두 더 깊은 모습을 보이며, 우리는 음모 모양에 대해 더 많이 이야기 할 것입니다.<a class="quarto-xref" href="#sec-graphics-banking"><span>섹션 3.7.1</span></a>그리고 색상에 대해<a class="quarto-xref" href="#sec-graphics-color"><span>섹션 3.9</span></a>.</p>
<p>밀도 기반 플로팅 방법<a class="quarto-xref" href="#fig-graphics-twodsp4">수치<span>3.30</span></a>그림의 과도한 지점 구름보다 시각적으로 매력적이고 해석 가능합니다.<a class="quarto-xref" href="#fig-graphics-twodsp1"><span>3.27</span></a>그리고<a class="quarto-xref" href="#fig-graphics-twodsp2"><span>3.28</span></a>, 우리는 줄거리의 스파이저 영역의 특이 치 지점에 대한 정보를 많이 잃어 버릴 때 조심해야하지만, 우리는 그것들을 사용해야합니다. 한 가지 가능성이 사용됩니다<code>geom_point</code>그러한 지점을 다시 추가합니다.</p>
<p>그러나 스무딩의 한계를 피하는 최선의 대안은 육각형 비닝입니다.<span class="citation" data-cites="Carr1987hexbin">(<a href="16-chap.html#ref-Carr1987hexbin" role="doc-biblioref">Carr et al. 1987</a>))</span>.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">GEOM_HEX</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb52-2"><a aria-hidden="true" href="#cb52-2" tabindex="-1"></a>SCP<span class="sc">+</span> <span class="fu">GEOM_HEX</span>(<span class="at">binwidth =</span> <span class="fu">기음</span>(<span class="fl">0.2</span>,,,<span class="fl">0.2</span>)))<span class="sc">+</span>컬러 스케일<span class="sc">+</span></span>
<span id="cb52-3"><a aria-hidden="true" href="#cb52-3" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-twodsp6">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-twodsp6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-twodsp6" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp6-1" width="280">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-twodsp6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-twodsp6" href="03-chap_files/figure-html/fig-graphics-twodsp6-1.png" title="Figure 3.31 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-twodsp6" id="fig-graphics-twodsp6-1" src="03-chap_files/figure-html/fig-graphics-twodsp6-1.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-twodsp6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-twodsp6" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-twodsp6-2" width="280">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-twodsp6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-twodsp6" href="03-chap_files/figure-html/fig-graphics-twodsp6-2.png" title="Figure 3.31 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-twodsp6" id="fig-graphics-twodsp6-2" src="03-chap_files/figure-html/fig-graphics-twodsp6-2.png" width="280"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-twodsp6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-twodsp6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.31 : 육각형 비닝. (a) 기본 매개 변수. (b) 더 미세한 빈 크기와 맞춤형 색상 스케일.</figcaption>
</figure>
</div>
</div>
<section class="level3 page-columns page-full" data-number="3.7.1" id="sec-graphics-banking">
<h3 class="anchored" data-anchor-id="sec-graphics-banking" data-number="3.7.1"><span class="header-section-number">3.7.1</span>그림 모양</h3>
<p>정보가 잘 전달되도록하는 것이 줄거리의 적절한 모양을 선택하는 것이 중요합니다. 기본적으로 모양 매개 변수, 즉 그래프 높이와 너비 사이의 비율은<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>현재 플로팅 장치에서 사용 가능한 공간을 기반으로합니다. 장치의 너비와 높이는 장치가 R에서 열면 명시 적으로 또는 기본 매개 변수를 통해 지정됩니다.<a class="footnote-ref" href="#fn10" id="fnref10" role="doc-noteref"><sup>10</sup></a>. 또한 그래프 치수는 또한 컬러 스케일 바와 같은 추가 장식의 유무에 따라 다릅니다.<a class="quarto-xref" href="#fig-graphics-twodsp6">수치<span>3.31</span></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>예를 들어의 수동 페이지를 참조하십시오<code>PDF</code>그리고<code>PNG</code>기능.</p></div></div><p>ScatterPlots에 신청할 수있는 두 가지 간단한 규칙이 있습니다.</p>
<ul>
<li><p>두 축의 변수가 동일한 단위로 측정되는 경우 데이터 공간에 대한 동일한 데이터 공간 매핑이 사용되는지 확인하십시오.<code>coord_fixed</code>. 위의 산포도에서, 두 축 모두 표현 수준 측정의 기본 2에 대한 로그입니다. 즉, 한 단위에 의한 변화는 두 축에서 동일한 의미를 갖습니다 (표현 수준의 두 배). 또 다른 사례는 PCA (Principal Component Analysis)입니다<span class="math inline">\(엑스\)</span>-Axis는 일반적으로 구성 요소 1을 나타냅니다<span class="math inline">\(와이\)</span>-축 성분 2. 축은 입력 데이터 공간의 직교 정상 회전에서 발생하므로 스케일이 일치하는지 확인하려고합니다. 데이터의 분산은 (정의에 따라) 첫 번째 구성 요소보다 두 번째 구성 요소를 따라 더 작기 때문에 잘 만들어진 PCA 플롯은 일반적으로 높이보다 큰 폭을 갖습니다.</p></li>
<li><p>두 축의 변수가 다른 단위로 측정되면 차원을 비교하여 서로 관련 될 수 있습니다. R을 포함한 많은 플롯 루틴의 기본값<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>, 데이터의 범위를보고 사용 가능한 플로팅 영역에 매핑하는 것입니다. 그러나 특히 데이터가 라인을 따라가는 경우 라인의 일반적인 기울기를 보는 것이 유용 할 수 있습니다. 이것을 불립니다<strong>은행업</strong> <span class="citation" data-cites="Cleveland:1988:Banking">(<a href="16-chap.html#ref-Cleveland:1988:Banking" role="doc-biblioref">William S. Cleveland, McGill 및 McGill 1988</a>))</span>.</p></li>
</ul>
<p>뱅킹을 설명하기 위해 클리블랜드 논문의 고전적인 선 흑점 데이터를 사용해 봅시다.</p>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" href="#cb53-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggthemes"</span>))</span>
<span id="cb53-2"><a aria-hidden="true" href="#cb53-2" tabindex="-1"></a>태양<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">연도 =</span> <span class="fu">시간</span>(Sunspot.year),</span>
<span id="cb53-3"><a aria-hidden="true" href="#cb53-3" tabindex="-1"></a>               <span class="at">번호 =</span> <span class="fu">as.numeric</span>(Sunspot.year)))</span>
<span id="cb53-4"><a aria-hidden="true" href="#cb53-4" tabindex="-1"></a>sp<span class="ot">=</span> <span class="fu">ggplot</span>(Sunsp,<span class="fu">AES</span>(<span class="at">x =</span>년도,<span class="at">y =</span>숫자))<span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb53-5"><a aria-hidden="true" href="#cb53-5" tabindex="-1"></a>sp</span>
<span id="cb53-6"><a aria-hidden="true" href="#cb53-6" tabindex="-1"></a>비율<span class="ot">=</span> <span class="fu">~와 함께</span>(Sunsp,<span class="fu">bank_slopes</span>(연도, 번호)))</span>
<span id="cb53-7"><a aria-hidden="true" href="#cb53-7" tabindex="-1"></a>sp<span class="sc">+</span> <span class="fu">coord_fixed</span>(<span class="at">비율 =</span>비율)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-banking">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-banking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-banking" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-banking-1" width="300">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-banking-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-banking" href="03-chap_files/figure-html/fig-graphics-banking-1.png" title="Figure 3.32 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-banking" id="fig-graphics-banking-1" src="03-chap_files/figure-html/fig-graphics-banking-1.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-banking-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-banking" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-banking-2" width="300">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-banking-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-banking" href="03-chap_files/figure-html/fig-graphics-banking-2.png" title="Figure 3.32 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-banking" id="fig-graphics-banking-2" src="03-chap_files/figure-html/fig-graphics-banking-2.png" width="300"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-banking-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-banking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.32 : 태양 흑점 데이터. (a)에서, 플롯 모양은 대략 2 차이며 빈번한 기본 선택이다. (b)에서, 기술이 불리는 기술<strong>은행업</strong>줄거리 모양을 선택하는 데 사용되었습니다. (참고 : 진드기 라벨의 배치는이 플롯에서는 좋지 않으며 사용자 정의의 혜택을 누릴 수 있습니다.)</figcaption>
</figure>
</div>
<p>결과 플롯은 상단 패널에 표시됩니다.<a class="quarto-xref" href="#fig-graphics-banking">수치<span>3.32</span></a>. 우리는 1700 년대 초, 1800 년대 초반, 그리고 20 번의 턴에 특히 최대 활동이 낮아서 일광 흑점 활동주기의 진폭에서 장기 변동을 분명히 볼 수 있습니다.<span class="math inline">\ (^\ text {th} \)</span>세기. 그러나 이제 은행을 시도해 볼 수 있습니다.</p>
<p>알고리즘은 어떻게 작동합니까? 그것은 곡선의 경사면을 주위에 두는 것을 목표로합니다. 특히,<code>bank_slopes</code>중간 절대 경사를 계산 한 다음<code>coord_fixed</code>이 수량이 1이되도록 플롯의 종횡비를 설정합니다. 결과는 하부 패널에 표시됩니다.<a class="quarto-xref" href="#fig-graphics-banking">수치<span>3.32</span></a>. 상당히 직관적으로, 음모가 훨씬 작은 공간을 차지하더라도 더 많은 것을 볼 수 있습니다! 특히, 우리는 날카로운 상승과 느린 감소로 태양 흑점주기의 톱니 모양을 볼 수 있습니다.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="3.8" id="sec-graphics-facets">
<h2 class="anchored" data-anchor-id="sec-graphics-facets" data-number="3.8"><span class="header-section-number">3.8</span>두 가지 이상의 차원을 시각화합니다</h2>
<p>때때로 우리는 두 가지 이상의 변수 사이의 관계를 보여주기를 원합니다. 추가 치수를 포함시키기위한 명백한 선택은 플롯 기호 모양과 색상입니다. 그만큼<code>geom_point</code>기하학적 물체는 다음과 같은 미학을 제공합니다 (그 이상<code>엑스</code>그리고<code>와이</code>) : :</p>
<ul>
<li><p><code>채우다</code></p></li>
<li><p><code>색상</code></p></li>
<li><p><code>모양</code></p></li>
<li><p><code>크기</code></p></li>
<li><p><code>알파</code></p></li>
</ul>
<p>그들은 수동 페이지에서 탐색됩니다<code>geom_point</code>기능.<code>채우다</code>그리고<code>색상</code>물체의 채우기 및 개요 색상을 참조하고<code>알파</code>투명성 수준으로. 위의 그림에서<a class="quarto-xref" href="#fig-graphics-twodsp2"><span>3.28</span></a>그리고 다음으로, 우리는 색상 또는 투명성을 사용하여 점 밀도를 반영하고 오버 플롯팅의 모호한 영향을 피했습니다. 이러한 속성을 사용하여 데이터의 다른 차원을 표시 할 수도 있습니다. 원칙적으로, 우리는 위에 나열된 5 개의 미학을 동시에 사용하여 최대 7 차원 데이터를 나타낼 수 있습니다. 그러나 그러한 음모는 해독하기가 어려울 것입니다. 일반적으로 우리는 이러한 미학 중 하나 또는 두 개만 선택하고 데이터에 하나 또는 두 개의 추가 차원을 보여주기 위해 스스로를 제한하는 것이 좋습니다.</p>
<section class="level3 page-columns page-full" data-number="3.8.1" id="faceting">
<h3 class="anchored" data-anchor-id="faceting" data-number="3.8.1"><span class="header-section-number">3.8.1</span>페이스 팅</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-43" href="imgs/devil.png" title="Sometimes this is also called trellis or lattice graphics, in an allusion to how these arrays of plots look like. The first major R package to implement faceting was lattice. In this book, we’ll use the faceting functionalities provided through ggplot2."><img alt="Sometimes this is also called trellis or lattice graphics, in an allusion to how these arrays of plots look like. The first major R package to implement faceting was lattice. In this book, we’ll use the faceting functionalities provided through ggplot2." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>때때로 이것은 또한 호출됩니다<em>격자</em>또는<em>격자</em>그래픽, 이러한 플롯 배열의 모양에 대한 암시에서. 패싯을 구현하는 첫 번째 주요 R 패키지는 다음과 같습니다<strong><a href="https://cran.r-project.org/web/packages/lattice/">격자</a></strong>. 이 책에서는 우리는<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>.</figcaption>
</figure>
</div>
</div></div></div>
<p>데이터의 추가 치수를 보여주는 또 다른 방법은 변수의 하나 (또는 ​​그 이상)를 기반으로 데이터를 반복적으로 서브 세트 (또는 "슬라이싱")로 인한 여러 플롯을 표시하여 각 부품을 개별적으로 시각화 할 수 있도록하는 것입니다. 이것을 불립니다<strong>페이스 팅</strong>또한 최대 4 ~ 5 차원으로 데이터를 시각화 할 수 있습니다. 예를 들어, 다른 변수들 사이에서 관찰 된 패턴이 측면 변수의 범위에 걸쳐 동일하거나 다른지 여부를 조사 할 수 있습니다. 예를 살펴 보겠습니다.</p>
<!-- TODO: skipped to avoid overlap;
could put this as a comment in the code?


::: {.cell .column-margin layout-align="center"}
::: {.cell-output-display}
![The first three lines of this code chunk are not strictly necessary – they're just reformatting the `lineage` column of the `dftx` dataframe to make it more concise.](imgs/devil.png){fig-align='center' width=123}
:::
:::

-->
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"magrittr"</span>))</span>
<span id="cb54-2"><a aria-hidden="true" href="#cb54-2" tabindex="-1"></a>DFTX<span class="sc">$</span>혈통<span class="sc">%&lt;&gt;%</span> <span class="fu">보결</span>(<span class="st">"^$"</span>,,,<span class="st">"아니요"</span>,.)</span>
<span id="cb54-3"><a aria-hidden="true" href="#cb54-3" tabindex="-1"></a>DFTX<span class="sc">$</span>혈통<span class="sc">%&lt;&gt;%</span> <span class="fu">요인</span>(<span class="at">레벨 =</span> <span class="fu">기음</span>(<span class="st">"아니요"</span>,,,<span class="st">"에피"</span>,,,<span class="st">"PE"</span>,,,<span class="st">"FGF4-KO"</span>)))</span>
<span id="cb54-4"><a aria-hidden="true" href="#cb54-4" tabindex="-1"></a></span>
<span id="cb54-5"><a aria-hidden="true" href="#cb54-5" tabindex="-1"></a><span class="fu">ggplot</span>(dftx,<span class="fu">AES</span>(<span class="at">x =</span>x1426642_at,<span class="at">y =</span>x1418765_at)))<span class="sc">+</span></span>
<span id="cb54-6"><a aria-hidden="true" href="#cb54-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>계보)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-graphics-facet1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-facet1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-44" href="03-chap_files/figure-html/fig-graphics-facet1-1.png" title="Figure 3.33: An example of faceting: the same data as in Figure fig-graphics-scp2layers1, but now split by the categorical variable lineage."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-facet1-1.png" width="640"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-facet1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.33 : 예제<strong>페이스 팅</strong>:에서와 동일한 데이터<a class="quarto-xref" href="#fig-graphics-scp2layers1">수치<span>3.9</span></a>그러나 이제는 범주 형 변수로 분리됩니다<code>혈통</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-graphics-facet1">수치<span>3.33</span></a>. R의 공식 언어를 사용하여 데이터를 분할하려는 변수를 지정하고 별도의 패널은 다른 열에 있어야합니다.<code>facet_grid (. ~ 혈통)</code>. 실제로, 우리는 다음과 같이 두 가지면 변수를 지정할 수 있습니다. 결과가 표시됩니다<a class="quarto-xref" href="#fig-graphics-facet2">수치<span>3.34</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a><span class="fu">ggplot</span>(dftx,</span>
<span id="cb55-2"><a aria-hidden="true" href="#cb55-2" tabindex="-1"></a>  <span class="fu">AES</span>(<span class="at">x =</span>x1426642_at,<span class="at">y =</span>x1418765_at)))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-3"><a aria-hidden="true" href="#cb55-3" tabindex="-1"></a>   <span class="fu">facet_grid</span>(배아 .day<span class="sc">~</span>계보)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-graphics-facet2">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-facet2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-45" href="03-chap_files/figure-html/fig-graphics-facet2-1.png" title="Figure 3.34: Faceting: the same data as in Figure fig-graphics-scp2layers1, split by the categorical variables Embryonic.day (rows) and lineage (columns)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-facet2-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-facet2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.34 :<strong>페이스 팅</strong>:에서와 동일한 데이터<a class="quarto-xref" href="#fig-graphics-scp2layers1">수치<span>3.9</span></a>, 범주 형 변수로 분할<code>배아</code>(행) 및<code>혈통</code>(열).</figcaption>
</figure>
</div>
</div>
</div>
<p>또 다른 유용한 기능입니다<code>facet_wrap</code>: 패싯 변수에 모든 플롯이 한 행 또는 한 열에 맞지 않기에 너무 많은 레벨이있는 ​​경우이 함수를 사용하여 지정된 수의 열이나 행으로 래핑 할 수 있습니다. 지금까지 우리는 범주 형 변수에 의한 측면을 보았지만 레벨로 이산화되어 연속 변수와 함께 사용할 수도 있습니다. 기능<code>자르다</code>이 목적에 유용합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">돌연변이</span>(dftx,<span class="at">tdgf1 =</span> <span class="fu">자르다</span>(x1450989_at,<span class="at">breaks =</span> <span class="dv">4</span>)),</span>
<span id="cb56-2"><a aria-hidden="true" href="#cb56-2" tabindex="-1"></a>   <span class="fu">AES</span>(<span class="at">x =</span>x1426642_at,<span class="at">y =</span>x1418765_at)))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-3"><a aria-hidden="true" href="#cb56-3" tabindex="-1"></a>   <span class="fu">facet_wrap</span>( <span class="sc">~</span>tdgf1,<span class="at">NCOL =</span> <span class="dv">2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-facet3">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-facet3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-46" href="03-chap_files/figure-html/fig-graphics-facet3-1.png" title="Figure 3.35: Faceting: the same data as in Figure fig-graphics-scp2layers1, split by the continuous variable X1450989_at and arranged by facet_wrap."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-facet3-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-facet3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.35 :<strong>페이스 팅</strong>:에서와 동일한 데이터<a class="quarto-xref" href="#fig-graphics-scp2layers1">수치<span>3.9</span></a>, 연속 변수로 분할<code>x1450989_at</code>그리고 주선<code>facet_wrap</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는<a class="quarto-xref" href="#fig-graphics-facet3">수치<span>3.35</span></a>4 개의 패널의 포인트 수는 다릅니다. 이건 때문입니다<code>자르다</code>같은 포인트가 아닌 동일한 길이의 빈으로 분할됩니다. 후자를 원한다면 사용할 수 있습니다<code>양자</code>함께<code>자르다</code>또는 변수 값의 순위를 줄입니다.</p>
<section class="level4 unnumbered" id="axes-scales">
<h4 class="unnumbered anchored" data-anchor-id="axes-scales">축 스케일</h4>
<p>그림에서<a class="quarto-xref" href="#fig-graphics-facet1"><span>3.33</span></a>-<a class="quarto-xref" href="#fig-graphics-facet3"><span>3.35</span></a>축 스케일은 모든 패널에서 동일합니다. 또는, 우리는 그것을 설정함으로써 그것들을 변화시킬 수 있습니다<code>저울</code>의 주장<code>facet_grid</code>그리고<code>facet_wrap</code>기능. 이 주장을 통해 당신은 당신이 여부를 제어 할 수 있습니다<span class="math inline">\(엑스\)</span>-축 및<span class="math inline">\(와이\)</span>-각 패널의 축은 동일한 규모 또는 각 패널의 데이터 범위에 적응하는지 여부가 동일합니다. 트레이드 오프가 있습니다. 적응 형 축 스케일을 사용하면 더 자세한 내용을 볼 수 있습니다. 반면에 패널은 그룹 전체에 걸쳐 덜 비교할 수 있습니다.</p>
</section>
<section class="level4 unnumbered" id="implicit-faceting">
<h4 class="unnumbered anchored" data-anchor-id="implicit-faceting">암시 적 얼굴</h4>
<p>당신은 또한 당신의 음모를 파괴 할 수 있습니다 (명백한 전화없이<code>facet_grid</code>그리고<code>facet_wrap</code>) 미학을 지정함으로써. 암시 적 패싯의 매우 간단한 버전은 요인을 귀하의<span class="math inline">\(엑스\)</span>그림과 같은 축<a class="quarto-xref" href="#fig-graphics-onedbp1"><span>3.15</span></a>-<a class="quarto-xref" href="#fig-graphics-oneddot"><span>3.18</span></a>.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="3.8.2" id="interactive-graphics">
<h3 class="anchored" data-anchor-id="interactive-graphics" data-number="3.8.2"><span class="header-section-number">3.8.2</span>대화식 그래픽</h3>
<p>지금까지 생성 된 플롯은 정적 이미지입니다. 음모를 대화식으로 만들어 엄청난 양의 정보와 표현성을 추가 할 수 있습니다. 우리는 여기서 대화식 시각화를 깊이로 전달하려고 노력하지는 않지만 몇 가지 중요한 리소스에 포인터를 제공합니다. 이것은 역동적 인 공간이므로 독자는 최근 개발을위한 생태계를 탐색해야합니다.</p>
<section class="level4 unnumbered" id="shiny">
<h4 class="unnumbered anchored" data-anchor-id="shiny">빛나는</h4>
<p>rstudio 's<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>인터랙티브 요소가 플롯을 생성하는 r 코드로 직접 호출하기 때문에 슬라이더, 선택기 및 기타 제어 요소로 대화 형 디스플레이를 쉽게 만들 수 있습니다. 참조<a href="https://shiny.posit.co/r/gallery">반짝이는 갤러리</a>훌륭한 예를 위해.</p>
<p>그래픽 엔진으로<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>-기반 대화 형 시각화를 사용할 수 있습니다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>실제로 기본 그래픽 또는 기타 그래픽 패키지. 여기서 조금 어색한 것은 대화식 옵션을 설명하는 데 사용되는 언어가 그래픽 생산과 분리되어 있다는 것입니다.<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>그리고 그래픽의 문법. 그만큼<strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong>패키지는이 제한을 극복하는 것을 목표로합니다.</p>
</section>
<section class="level4 unnumbered page-columns page-full" id="ggvis">
<h4 class="unnumbered anchored" data-anchor-id="ggvis">주어진</h4>
<p><strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong><a class="footnote-ref" href="#fn11" id="fnref11" role="doc-noteref"><sup>11</sup></a>좋은 기능을 확장하려는 시도입니다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>대화식 그래픽의 영역으로. 대조적으로<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>R의 기존 그래픽 장치 (PDF, PNG 등)에 그래픽을 생성하는,<strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong>호출 된 JavaScript 인프라를 기반으로합니다<a href="https://github.com/trifacta/vega">베가</a>및 그 음모는 HTML 브라우저에서 볼 수 있습니다. 좋다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>,,<strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong>패키지는 그래픽 개념의 문법에서 영감을 받았지만 별개의 구문을 사용합니다. 활용됩니다<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>상호 작용에 필요한 계산을 수행하기 위해 R에 연결하는 인프라. 저자가 말한대로<a class="footnote-ref" href="#fn12" id="fnref12" role="doc-noteref"><sup>12</sup></a>, 목표는 R의 최고 (예 : 상상할 수있는 모든 모델링 기능)와 웹 (모두가 웹 브라우저가 있음)을 결합하는 것입니다. 데이터 조작 및 변환은 R에서 수행되며 그래픽은 Vega를 사용하여 웹 브라우저에서 렌더링됩니다. "</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>글을 쓰는 시점 (2017 년 여름)에서 초기 운동량이<strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong>개발이 유지되고 현재 기능과 성숙도는 아직 일치하지 않습니다.<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>.</p></div><div id="fn12"><p><sup>12</sup>https://ggvis.rstudio.com</p></div></div><p>상호 작용의 결과로<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong>, 그래픽을 보면서 사용자의 동작에 응답하기 위해 기본 데이터와 코드가있는 R 통역사가 있어야합니다. 이 통역사는 로컬 컴퓨터 또는 서버에있을 수 있습니다. 두 경우 모두보기 애플리케이션은 웹 브라우저이고 R과의 상호 작용은 웹 프로토콜 (HTTP 또는 HTTP)을 통과합니다. 즉, 자체 포함 된 파일에 저장된 그래픽과는 다르며, R에 의해 한 번 생성되며 R의 실행중인 인스턴스에 연결되지 않고 PDF 또는 HTML 뷰어에서 볼 수 있습니다.</p>
</section>
<section class="level4 unnumbered page-columns page-full" id="plotly">
<h4 class="unnumbered anchored" data-anchor-id="plotly">줄거리</h4>
<p>대화식 그래픽 생성을위한 훌륭한 웹 기반 도구입니다<strong>줄거리</strong>. 온라인에서 대화식 그래픽의 몇 가지 예를 볼 수 있습니다.<a class="uri" href="https://plot.ly/r">https://plot.ly/r</a>. R에서 나만의 대화 형 플롯을 만들려면 다음과 같은 코드를 사용할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"줄거리"</span>))</span>
<span id="cb57-2"><a aria-hidden="true" href="#cb57-2" tabindex="-1"></a><span class="fu">plot_ly</span>(경제학,<span class="at">x =</span> <span class="sc">~</span>날짜,<span class="at">y =</span> <span class="sc">~</span>실업자<span class="sc">/</span>팝)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>와 마찬가지로<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/ggvis/">주어진</a></strong>그래픽은 HTML 브라우저에서 볼 수 있습니다. 그러나 실행 R 세션이 필요하지 않습니다. 그래픽은 "로직"이 JavaScript 또는 D3.JS 시스템에서 코딩 된 자체 포함 HTML 문서입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-rglvolcano">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-rglvolcano-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-47" href="imgs/chap3-rglvolcano.png" title="Figure 3.36: rgl rendering of the volcano data, the topographic information for Maunga Whau (Mt Eden), one of about 50 volcanos in the Auckland volcanic field."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/chap3-rglvolcano.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-rglvolcano-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.36 :<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>렌더링<code>화산</code>데이터, 오클랜드 화산 분야의 약 50 개의 화산 중 하나 인 Maunga Ghau (Mt Eden)의 지형 정보.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level4 unnumbered page-columns page-full" id="rgl-webgl">
<h4 class="unnumbered anchored" data-anchor-id="rgl-webgl">rgl, webgl</h4>
<p>3D 객체 (예 : 기하학적 구조)를 시각화하려면 패키지가 있습니다.<strong><a href="https://cran.r-project.org/web/packages/rgl/">rgl</a></strong>. 인터랙티브 뷰어 Windows (화면의 특수 그래픽 장치 또는 웹 브라우저를 통해)를 생성하는 장면, 줌 및 아웃 등을 회전시킬 수 있습니다. 아래 코드에서 생성 된 장면의 스크린 샷은 다음에 표시됩니다.<a class="quarto-xref" href="#fig-graphics-rglvolcano">수치<span>3.36</span></a>; 이러한 스크린 샷은 기능을 사용하여 생성 할 수 있습니다<code>Snapshot3d</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"화산"</span>))</span>
<span id="cb58-2"><a aria-hidden="true" href="#cb58-2" tabindex="-1"></a>볼카노다타<span class="ot">=</span> <span class="fu">목록</span>(</span>
<span id="cb58-3"><a aria-hidden="true" href="#cb58-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(화산)),</span>
<span id="cb58-4"><a aria-hidden="true" href="#cb58-4" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fu">seq_len</span>(<span class="fu">NCOL</span>(화산)),</span>
<span id="cb58-5"><a aria-hidden="true" href="#cb58-5" tabindex="-1"></a>  <span class="at">z =</span>화산,</span>
<span id="cb58-6"><a aria-hidden="true" href="#cb58-6" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">지형 .colors</span>(<span class="dv">500</span>) [) [<span class="fu">자르다</span>(화산,<span class="at">breaks =</span> <span class="dv">500</span>))]]</span>
<span id="cb58-7"><a aria-hidden="true" href="#cb58-7" tabindex="-1"></a>))</span>
<span id="cb58-8"><a aria-hidden="true" href="#cb58-8" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rgl"</span>))</span>
<span id="cb58-9"><a aria-hidden="true" href="#cb58-9" tabindex="-1"></a><span class="fu">~와 함께</span>(볼카노다타,<span class="fu">persp3d</span>(X, Y, Z,<span class="at">색상 =</span>안부))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>위의 코드에서 기본 R 기능<code>자르다</code>값 범위에서 매핑을 계산합니다<code>화산</code>1에서 500 사이의 정수에 대한 데이터<a class="footnote-ref" href="#fn13" id="fnref13" role="doc-noteref"><sup>13</sup></a>, 우리는 색상 스케일을 색인화하는 데 사용하고<code>지형. 콜로르 (500)</code>. 자세한 내용은 패키지의 우수한 비네팅을 참조하십시오.</p>
<div class="no-row-height column-margin column-container"><div id="fn13"><p><sup>13</sup>더 정확하게는, 그것은 수준만의 요인을 반환하여, 우리는 정수를 정수로 옮길 수있게한다.</p></div></div></section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="3.9" id="sec-graphics-color">
<h2 class="anchored" data-anchor-id="sec-graphics-color" data-number="3.9"><span class="header-section-number">3.9</span>색상</h2>
<p>음모를 만들 때 중요한 고려 사항은 우리가 사용하는 색칠입니다. 대부분의 R 사용자는 다음과 같이 Base R 그래픽에서 사용하는 내장 R 색 구성표에 익숙 할 것입니다.<a class="quarto-xref" href="#fig-graphics-simplecolorpie">수치<span>3.37</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a><span class="fu">파이</span>(<span class="fu">대표</span>(<span class="dv">1</span>,,,<span class="dv">8</span>),)<span class="at">col =</span><span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-simplecolorpie">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-simplecolorpie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-48" href="03-chap_files/figure-html/fig-graphics-simplecolorpie-1.png" title="Figure 3.37: The first eight colors in the base R color palette."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-simplecolorpie-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-simplecolorpie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.37 : 기본 r 색상 팔레트의 처음 8 가지 색상.</figcaption>
</figure>
</div>
</div></div></div>
<p>이 컬러 팔레트의 기원은 1980 년대 하드웨어로 거슬러 올라갑니다. 여기서 각 픽셀이 캐소드 레이 튜브의 세 가지 기본 색상 채널 (빨간색, 녹색 및 파란색) (RGB)의 세 가지 기본 색상 채널을 사용하거나 사용하지 않도록 그래픽 카드가 색상을 처리했습니다. 이것은 그로 이어졌습니다<span class="math inline">\ (2^3 = 8 \)</span>RGB 컬러 큐브의 8 구석에있는 조합<a class="footnote-ref" href="#fn14" id="fnref14" role="doc-noteref"><sup>14</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn14"><p><sup>14</sup>따라서,<span class="math inline">\ (8^\ text {th} \)</span>색상<a class="quarto-xref" href="#fig-graphics-simplecolorpie">수치<span>3.37</span></a>흰색이어야하고 대신 회색입니다.</p></div></div><p>범주 형 변수의 첫 8 가지 색상<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>표시됩니다<a class="quarto-xref" href="#fig-graphics-ggplot2colorpie">수치<span>3.38</span></a>:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" href="#cb60-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">u =</span> <span class="fu">요인</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>),)<span class="at">v =</span> <span class="dv">1</span>),)</span>
<span id="cb60-2"><a aria-hidden="true" href="#cb60-2" tabindex="-1"></a>       <span class="fu">AES</span>(<span class="at">x =</span> <span class="st">"" "</span>,,,<span class="at">y =</span>다섯,<span class="at">fill =</span>유))<span class="sc">+</span></span>
<span id="cb60-3"><a aria-hidden="true" href="#cb60-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">통계 =</span> <span class="st">"신원"</span>,,,<span class="at">너비 =</span> <span class="dv">1</span>))<span class="sc">+</span> </span>
<span id="cb60-4"><a aria-hidden="true" href="#cb60-4" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"와이"</span>,,,<span class="at">시작 =</span> <span class="dv">0</span>))<span class="sc">+</span> <span class="fu">테마_void</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-ggplot2colorpie">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-ggplot2colorpie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-49" href="03-chap_files/figure-html/fig-graphics-ggplot2colorpie-1.png" title="Figure 3.38: The first eight colors in the ggplot2 color palette."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-ggplot2colorpie-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-ggplot2colorpie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.38 : 처음 8 가지 색상<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>색상 팔레트.</figcaption>
</figure>
</div>
</div></div></div>
<p>이러한 기본값은 간단한 사용 사례에 적합하지만 종종 우리는 우리 자신의 선택을 원할 것입니다. ~ 안에<a class="quarto-xref" href="#sec-graphics-2d"><span>섹션 3.7</span></a>우리는 이미 기능을 보았습니다<code>scale_fill_gradientn</code>, 우리는 그림에 사용되는 매끄러운 색상 그라디언트를 만들었습니다.<a class="quarto-xref" href="#fig-graphics-twodsp4"><span>3.30</span></a>그리고<a class="quarto-xref" href="#fig-graphics-twodsp6"><span>3.31</span></a>함수가 제공하는 일련의 색상 단계를 보간하여<code>브루어</code>에서<strong><a href="https://cran.r-project.org/web/packages/RColorBrewer/">rcolorbrewer</a></strong>패키지. 이 패키지는 목적이 디자인 된 컬러 팔레트 세트를 정의합니다. 우리는 그들 모두를 기능으로 한눈에 볼 수 있습니다.<code>display.brewer.all</code> (<a class="quarto-xref" href="#fig-graphics-RColorBrewer">수치<span>3.39</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a aria-hidden="true" href="#cb61-1" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-RColorBrewer">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-RColorBrewer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-50" href="03-chap_files/figure-html/fig-graphics-RColorBrewer-1.png" title="Figure 3.39: RColorBrewer palettes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-RColorBrewer-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-RColorBrewer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.39 : Rcolorbrewer 팔레트.</figcaption>
</figure>
</div>
</div></div></div>
<p>사용 가능한 컬러 팔레트에 대한 정보를 얻을 수 있습니다.<code>Brewer.pal.info</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a><span class="fu">머리</span>(Brewer.pal.info)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MaxColors 카테고리 Colorblind
BRBG 11 Div True
piyg 11 div true
PRGN 11 DIV TRUE
Puor 11 Div True
RDBU 11 Div True
rdgy 11 div false</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a><span class="fu">테이블</span>(Brewer.pal.info<span class="sc">$</span>범주)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Div Qual seq 
   9 8 18</code></pre>
</div>
</div>
<p>팔레트는 세 가지 범주로 나뉩니다.</p>
<ul>
<li><p>질적 : 본질적인 순서가없는 범주 특성의 경우. 그만큼<code>페어링</code>팔레트는 매번 두 가지 하위 범주로 떨어지는 최대 6 개의 범주를 지원합니다.<em>~ 전에</em>그리고<em>~ 후에</em>,,,<em>~와 함께</em>그리고<em>없이</em>치료 등</p></li>
<li><p>순차적 :에서 나오는 정량적 특성<em>낮은</em>에게<em>높은</em></p></li>
<li><p>분기 : 자연적인 중간 점 또는 중립 값이 있고 값이 상향 및 아래로 벗어날 수있는 정량적 특성의 경우; 우리는 예를 들어 보겠습니다<a class="quarto-xref" href="#fig-graphics-heatmap">수치<span>3.41</span></a>.</p></li>
</ul>
<p>특정 팔레트에서 색상을 얻으려면 기능을 사용합니다.<code>브루어</code>. 첫 번째 논쟁은 우리가 원하는 색상 수입니다 (사용 가능한 최대 수보다 적을 수 있습니다.<code>Brewer.pal.info</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" href="#cb66-1" tabindex="-1"></a><span class="fu">브루어</span>(<span class="dv">4</span>,,,<span class="st">"rdylgn"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#d7191c" "#fdae61" "#a6d96a" "#1a9641"</code></pre>
</div>
</div>
<p>사용 가능한 사전 설정 색상 수보다 더 많은 것을 원한다면 (예 : 연속 색상으로 히트 맵을 플로팅 할 수 있음)<code>colormppalette</code>기능<a class="footnote-ref" href="#fn15" id="fnref15" role="doc-noteref"><sup>15</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup> <code>colormppalette</code>하나의 매개 변수 인 정수의 함수를 반환합니다. 표시된 코드에서는 인수와 함께 해당 기능을 호출합니다.<code>100</code>.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" href="#cb68-1" tabindex="-1"></a>MyPalette<span class="ot">=</span> <span class="fu">colormppalette</span>(</span>
<span id="cb68-2"><a aria-hidden="true" href="#cb68-2" tabindex="-1"></a>    <span class="fu">기음</span>(<span class="st">"Darkorange3"</span>,,,<span class="st">"하얀색"</span>,,,<span class="st">"다크 블루"</span>))</span>
<span id="cb68-3"><a aria-hidden="true" href="#cb68-3" tabindex="-1"></a>) (<span class="dv">100</span>))</span>
<span id="cb68-4"><a aria-hidden="true" href="#cb68-4" tabindex="-1"></a><span class="fu">머리</span>(myPalette)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#CD6600" "#CE6905" "#CF6C0A" "#D06F0F" "#D17214" "#D27519"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" href="#cb70-1" tabindex="-1"></a><span class="fu">영상</span>(<span class="fu">행렬</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,,,<span class="at">nrow =</span> <span class="dv">100</span>,,,<span class="at">NCOL =</span> <span class="dv">10</span>),)<span class="at">col =</span>MyPalette,</span>
<span id="cb70-2"><a aria-hidden="true" href="#cb70-2" tabindex="-1"></a>        <span class="at">xaxt =</span> <span class="st">"N"</span>,,,<span class="at">요트 =</span> <span class="st">"N"</span>,,,<span class="at">useraster =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-colorRampPalette">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-colorRampPalette-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-51" href="03-chap_files/figure-html/fig-graphics-colorRampPalette-1.png" title="Figure 3.40: A quasi-continuous color palette derived by interpolating between the colors darkorange3, white and darkblue."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-colorRampPalette-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-colorRampPalette-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.40 : 색상 사이를 보간하여 파생 된 준 연속 색상 팔레트<code>DARKORANGE3</code>,,,<code>하얀색</code>그리고<code>다크 블루</code>.
</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level2 page-columns page-full" data-number="3.10" id="heatmaps">
<h2 class="anchored" data-anchor-id="heatmaps" data-number="3.10"><span class="header-section-number">3.10</span>히트 맵</h2>
<p>히트 맵은 대형 매트릭스와 같은 데이터 세트를 시각화하고 데이터에있을 수있는 패턴에 대한 빠른 개요를 제공하는 강력한 방법입니다. r에는 다수의 히트 맵 드로잉 기능이 있습니다. 편리하고 잘 생긴 출력을 생성하는 것은 기능입니다.<code>pheatmap</code>시조 패키지에서<a class="footnote-ref" href="#fn16" id="fnref16" role="doc-noteref"><sup>16</sup></a>. 아래 코드에서 먼저 데이터 세트에서 상위 500 개의 가장 가변 유전자를 선택합니다.<code>엑스</code>함수를 정의합니다<code>교구</code>이는 컬럼에서 평균을 빼서 각 유전자 (행)를 중심으로합니다. 기본적으로<code>pheatmap</code>사용<em>rdylbu</em>컬러 팔레트<strong><a href="https://cran.r-project.org/web/packages/RcolorBrewer/">rcolorbrewer</a></strong>The와 함께<code>colormppalette</code>11 개의 색상을 부드러운 팔레트로 보간하는 기능 (<a class="quarto-xref" href="#fig-graphics-heatmap">수치<span>3.41</span></a>).</p>
<div class="no-row-height column-margin column-container"><div id="fn16"><p><sup>16</sup>매우 다재다능하고 모듈 식 대안은 다음과 같습니다<strong><a href="https://bioconductor.org/packages/ComplexHeatmap/">복합체</a></strong>패키지.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a aria-hidden="true" href="#cb71-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"pheatmap"</span>))</span>
<span id="cb71-2"><a aria-hidden="true" href="#cb71-2" tabindex="-1"></a>Topgenes<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">Rowvars</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>]]</span>
<span id="cb71-3"><a aria-hidden="true" href="#cb71-3" tabindex="-1"></a>교구<span class="ot">=</span> <span class="cf">기능</span>(x) {x<span class="sc">-</span> <span class="fu">Rowmeans</span>(x)}</span>
<span id="cb71-4"><a aria-hidden="true" href="#cb71-4" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">교구</span>(dfx [topgenes,]),</span>
<span id="cb71-5"><a aria-hidden="true" href="#cb71-5" tabindex="-1"></a>  <span class="at">show_rownames =</span> <span class="cn">거짓</span>,,,</span>
<span id="cb71-6"><a aria-hidden="true" href="#cb71-6" tabindex="-1"></a>  <span class="at">show_colnames =</span> <span class="cn">거짓</span>,,,</span>
<span id="cb71-7"><a aria-hidden="true" href="#cb71-7" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">서열</span>(<span class="sc">-</span><span class="dv">5</span>,,,<span class="sc">+</span><span class="dv">5</span>,,,<span class="at">길이 =</span> <span class="dv">101</span>),)</span>
<span id="cb71-8"><a aria-hidden="true" href="#cb71-8" tabindex="-1"></a>  <span class="at">annotation_col =</span> <span class="fu">PDATA</span>(엑스)[,<span class="fu">기음</span>(<span class="st">"샘플 그룹"</span>,,,<span class="st">"배아 .day"</span>,,,<span class="st">"스캔이트"</span>,,,<span class="st">"유전자형"</span>)],</span>
<span id="cb71-9"><a aria-hidden="true" href="#cb71-9" tabindex="-1"></a>  <span class="at">annotation_colors =</span> <span class="fu">목록</span>(</span>
<span id="cb71-10"><a aria-hidden="true" href="#cb71-10" tabindex="-1"></a>    <span class="at">SampleGroup =</span>groupcolor,</span>
<span id="cb71-11"><a aria-hidden="true" href="#cb71-11" tabindex="-1"></a>    <span class="at">유전자형 =</span> <span class="fu">기음</span>(<span class="st">`</span><span class="at">FGF4-KO</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"초콜릿 1"</span>,,,<span class="st">`</span><span class="at">wt</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Azure2"</span>),)</span>
<span id="cb71-12"><a aria-hidden="true" href="#cb71-12" tabindex="-1"></a>    <span class="at">배아 .day =</span> <span class="fu">setNames</span>(<span class="fu">브루어</span>(<span class="dv">9</span>,,,<span class="st">"블루스"</span>) [) [<span class="fu">기음</span>(<span class="dv">3</span>,,,<span class="dv">6</span>,,,<span class="dv">9</span>)], <span class="fu">기음</span>(<span class="st">"e3.25"</span>,,,<span class="st">"e3.5"</span>,,,<span class="st">"e4.5"</span>)),</span>
<span id="cb71-13"><a aria-hidden="true" href="#cb71-13" tabindex="-1"></a>    <span class="at">스캔이트 =</span> <span class="fu">setNames</span>(<span class="fu">브루어</span>(<span class="fu">nlevels</span>(엑스<span class="sc">$</span>스캔이트),<span class="st">"ylgn"</span>),)<span class="fu">레벨</span>(엑스<span class="sc">$</span>스캔이트)))</span>
<span id="cb71-14"><a aria-hidden="true" href="#cb71-14" tabindex="-1"></a>))</span>
<span id="cb71-15"><a aria-hidden="true" href="#cb71-15" tabindex="-1"></a>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-graphics-heatmap">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-52" href="03-chap_files/figure-html/fig-graphics-heatmap-1.png" title="Figure 3.41: A heatmap of relative expression values, i.e., logarithmic fold change compared to the average expression of that gene (row) across all samples (columns). The color scale uses a diverging palette whose midpoint is at 0."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-heatmap-1.png" width="560"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.41 : 상대 발현 값의 열도, 즉 모든 샘플 (열)에 걸쳐 해당 유전자 (행)의 평균 발현과 비교하여 로그 폴드 변화. 색상 스케일은 중간 점이 0 인 분기 팔레트를 사용합니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>잠시 시간을 내어이 거대한 거대한 전화를 해체하자.<code>pheatmap</code>. 옵션<code>show_rownames</code>그리고<code>show_colnames</code>행 및 열 이름이 행렬 측면에 인쇄되어 있는지 제어하십시오. 우리의 매트릭스는 사용 가능한 플로팅 공간과 관련하여 크기 때문에 레이블을 읽을 수 없으므로 우리는 그것들을 억제 할 수 있습니다. 그만큼<code>annotation_col</code>인수는 샘플에 대한 추가 정보를 전달하는 데이터 프레임을 가져옵니다. 정보는 히트 맵 위에있는 컬러 바에 표시됩니다. 비슷한 것도 있습니다<code>annotation_row</code>우리가 여기서 사용하지 않은 인수는 옆에 색 바가있는 행 (유전자)에 주석을 달았습니다. 논쟁<code>annotation_colors</code>주석 막대에 대한 기본 색상 선택을 무시할 수있는 명명 된 벡터 목록입니다. 그만큼<code>pheatmap</code>기능에는 많은 추가 옵션이 있으며 자체 데이터 시각화에 사용하려면 공부하는 것이 좋습니다.</p>
<section class="level3 page-columns page-full" data-number="3.10.1" id="dendrogram-ordering">
<h3 class="anchored" data-anchor-id="dendrogram-ordering" data-number="3.10.1"><span class="header-section-number">3.10.1</span>덴드로 그램 주문</h3>
<p>~ 안에<a class="quarto-xref" href="#fig-graphics-heatmap">수치<span>3.41</span></a>, 왼쪽과 상단의 나무는 계층 적 클러스터링 알고리즘의 결과를 나타냅니다.<strong>덴드로 그램</strong>. 행과 열의 순서는 덴드로 그램을 기반으로합니다. 히트 맵의 시각적 영향에 큰 영향을 미칩니다. 그러나 명백한 패턴 중 어느 것이 실제인지 결정하기가 어려울 수 있으며 임의의 트리 레이아웃 결정의 결과<a class="footnote-ref" href="#fn17" id="fnref17" role="doc-noteref"><sup>17</sup></a>. 다음을 명심하겠습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn17"><p><sup>17</sup>클러스터링 및 클러스터 중요성을 평가하는 방법에 대해 배웁니다.<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>.</p></div></div><ul>
<li><p>클러스터 덴드로 그램으로 행과 열을 주문 (<a class="quarto-xref" href="#fig-graphics-heatmap">수치<span>3.41</span></a>)는 임의의 선택이며, 다른 사람들도 만들 수 있습니다.</p></li>
<li><p>덴드로 그램 주문에 정착하더라도 각 지점에서는 본질적으로 임의의 선택이 있습니다. 각 지점에서 트리의 토폴로지를 변경하지 않고 뒤집을 수 있습니다 (또한 참조하십시오.<a class="quarto-xref" href="05-chap.html#fig-mobile">수치<span>5.21</span></a>).</p></li>
</ul>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-pheatmapbranches">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.6</div>
</div>
<div class="callout-body-container callout-body">
<p>어떻게<code>pheatmap</code>기능은 하위 트리의 어떤 지점을 왼쪽과 오른쪽으로 선택하는 방법에 대한 결정을 처리합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-11-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-11-contents callout-collapse collapse" id="callout-11">
<div class="callout-body-container callout-body">
<p>이것은 수동 페이지에 설명되어 있습니다<code>HCLUST</code>기능<strong><a href="https://cran.r-project.org/web/packages/stats/">통계</a></strong>기본적으로 패키지가 사용됩니다<code>pheatmap</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-pheatmaporder">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.7</div>
</div>
<div class="callout-body-container callout-body">
<p>다른 주문 방법을 생각할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-13-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-13-contents callout-collapse collapse" id="callout-13">
<div class="callout-body-container callout-body">
<p>제안 된 방법 중에는 여행 판매원 문제가 있습니다<span class="citation" data-cites="McCormick:1972:MatrixClustering">(<a href="16-chap.html#ref-McCormick:1972:MatrixClustering" role="doc-biblioref">McCormick Jr, Schweitzer 및 White 1972</a>))</span>또는 첫 번째 주요 구성 요소에 대한 투영 (예 : 수동 페이지의 예를 참조하십시오.<code>pheatmap</code>).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-pheatmapcallback">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.8</div>
</div>
<div class="callout-body-container callout-body">
<p>논쟁을 확인하십시오<code>clustering_callback</code>의<code>pheatmap</code>기능.</p>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="3.10.2" id="sec-graphics-colorspaces">
<h3 class="anchored" data-anchor-id="sec-graphics-colorspaces" data-number="3.10.2"><span class="header-section-number">3.10.2</span>컬러 스페이스</h3>
<p>인간의 색 인식<span class="citation" data-cites="Helmholtz:1867">(<a href="16-chap.html#ref-Helmholtz:1867" role="doc-biblioref">Helmholtz 1867</a>))</span>3 차원입니다<a class="footnote-ref" href="#fn18" id="fnref18" role="doc-noteref"><sup>18</sup></a>. 이 공간을 매개 변수화하는 방법에는 여러 가지가 있습니다. 위에서 우리는 이미 [0,1]의 세 값을 사용하는 RGB 색상 모델을 이미 만났습니다.<a class="quarto-xref" href="#sec-graphics-ggplot"><span>섹션 3.4</span></a>, 우리가 내용을 인쇄하는 곳<code>GroupColor</code>:</p>
<div class="no-row-height column-margin column-container"><div id="fn18"><p><sup>18</sup>물리적으로, 무한한 수의 파장의 빛과 무한한 수의 혼합 방법이 있으므로 다른 종이나 로봇의 경우 색상 공간이 더 적은 차원을 가질 수 있습니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a>groupcolor [<span class="dv">1</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E3.25 
"#cab2d6"</code></pre>
</div>
</div>
<p>여기서, Ca는 적색 수로의 강도, 녹색의 B2 및 파란색 채널의 D6에 ​​대한 16 진수 표현입니다. 소수점에서는이 숫자가 202, 178 및 214입니다.이 값의 범위는 0에서 255로 이동 하므로이 최대 값으로 나누어 RGB 트리플렛은 3 차원 단위 큐브의 점으로 생각할 수 있습니다.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-hcl">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-hcl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-hcl" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-hcl-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-hcl-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-hcl" href="03-chap_files/figure-html/fig-graphics-hcl-1.png" title="Figure 3.42 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-hcl" id="fig-graphics-hcl-1" src="03-chap_files/figure-html/fig-graphics-hcl-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-hcl-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-hcl" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-hcl-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-hcl-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-hcl" href="03-chap_files/figure-html/fig-graphics-hcl-2.png" title="Figure 3.42 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-hcl" id="fig-graphics-hcl-2" src="03-chap_files/figure-html/fig-graphics-hcl-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-hcl-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-hcl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.42 : HCL 색상 공간의 원. (a) 휘도<span class="math inline">\(엘\)</span>고정<span class="math inline">\ (75 \)</span>각도 좌표가 있습니다<span class="math inline">\(시간\)</span>(Hue)는 0에서 360까지 다양하며 방사형 좌표<span class="math inline">\(기음\)</span>값을 취합니다<span class="math inline">\ (0, 10, ..., 60 \)</span>. (b) 일정한 크로마<span class="math inline">\(기음\)</span>~에<span class="math inline">\ (50 \)</span>,,,<span class="math inline">\(시간\)</span>위와 같이, 방사형 좌표는 휘도이다<span class="math inline">\(엘\)</span>값에서<span class="math inline">\ (10, 20, ..., 90 \)</span>.
</figcaption>
</figure>
</div>
</div>
<p>기능<code>HCL</code>다른 좌표계를 사용합니다. 다시 이것은 세 가지 좌표로 구성됩니다 : Hue<span class="math inline">\(시간\)</span>, 범위의 각도<span class="math inline">\ ([0, 360] \)</span>, 크로마<span class="math inline">\(기음\)</span>, 양수 및 휘도<span class="math inline">\(엘\)</span>, 값<span class="math inline">\ ([0, 100] \)</span>. 상한<span class="math inline">\(기음\)</span>색조와 휘도에 따라 다릅니다.</p>
<p>그만큼<code>HCL</code>함수는 CIE-LUV의 극성 좌표에 해당합니다<a class="footnote-ref" href="#fn19" id="fnref19" role="doc-noteref"><sup>19</sup></a>지역 채우기를 위해 설계되었습니다. Chroma 및 Luminance 조정을 일정하고 다양한 색조 만 유지함으로써 조화로운 색상 팔레트를 쉽게 생산하고 밝은 색상의 영역보다 어두운 색상보다 더 크게 보이게하는 방사선 화상을 피할 수 있습니다. 우리의 관심은 또한 큰 색상으로 끌리는 경향이 있으며 Chroma의 가치를 고정하면 색상이 눈에 똑같이 매력적입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn19"><p><sup>19</sup>CIE : 국제 조명위원회 - 예 : 이에 대한 자세한 내용은 Wikipedia입니다.</p></div></div><p>컬러 휠에서 색상을 선택하는 방법에는 여러 가지가 있습니다.<em>트라이어드</em>컬러 휠 주위에 똑같이 간격을 두는 세 가지 색상입니다. 예를 들어,<span class="math inline">\ (H = 0,120,240 \)</span>빨간색, 녹색 및 파란색을 제공합니다.<em>사트라드</em>컬러 휠 주위에 4 개의 똑같이 간격이있는 색상이며, 일부 그래픽 아티스트는 효과를 "동적"으로 묘사합니다.<em>난색</em>노란색에 가까운 똑같이 간격이있는 색상 세트입니다.<em>멋진 색상</em>파란색에 가까운 똑같이 간격 한 색상 세트.<em>유사한 색</em>세트에는 컬러 휠의 작은 세그먼트 (예 : 노란색, 주황색 및 빨간색 또는 녹색, 청록색 및 파란색)의 색상이 포함되어 있습니다.<em>보완적인 색상</em>컬러 휠에서 색상이 서로 반대쪽으로 반대입니다. 사면체는 두 쌍의 상보자입니다.<em>보완적인 분할</em>예를 들어, 한 파트너가 양쪽에 똑같이 나누는 한 쌍의 상보성으로 구성된 세 가지 색상입니다.<span class="math inline">\ (h = 60, \, 240-30, \, 240+30 \)</span>. 이것은 유사한 범주와 세 번째 다른 범주의 차이를 강조하는 데 유용합니다. 참고 문헌에서보다 철저한 토론이 제공됩니다<span class="citation" data-cites="Mollon:1995 IhakaColorPres">(<a href="16-chap.html#ref-Mollon:1995" role="doc-biblioref">Mollon 1995</a>; <a href="16-chap.html#ref-IhakaColorPres" role="doc-biblioref">2003 년</a>))</span>.</p>
<section class="level4 unnumbered" id="lines-versus-areas">
<h4 class="unnumbered anchored" data-anchor-id="lines-versus-areas">라인 대 영역</h4>
<p>선과 지점의 경우, 우리는 배경과 강한 대비를 원하므로 흰색 배경에서는 비교적 어두워지기를 원합니다 (낮은 휘도<span class="math inline">\(엘\)</span>). 면적 채우기의 경우, 더 가볍고 파스텔 유형이 낮거나 중간 정도의 색소 함량을 가진 색상이 일반적으로 더 쾌적합니다.</p>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="3.11" id="data-transformations">
<h2 class="anchored" data-anchor-id="data-transformations" data-number="3.11"><span class="header-section-number">3.11</span>데이터 변환</h2>
<p>대부분의 포인트가 한 영역에서 모여있는 음모, 사용 가능한 공간의 많은 부분이 드물게 인구가 많기 때문에 읽기가 어렵습니다. 변수의 한계 분포의 히스토그램이 급격한 피크가 있고 긴 꼬리가 한쪽 또는 양쪽으로 긴 꼬리가 있으면 데이터를 변환하는 것이 도움이 될 수 있습니다. 이러한 고려 사항은 두 가지 모두에 적용됩니다<code>엑스</code>그리고<code>와이</code>미학 및 색상 스케일. 마이크로 어레이 데이터와 관련된이 장의 플롯에서 우리는 로그 변환을 사용했습니다.<a class="footnote-ref" href="#fn20" id="fnref20" role="doc-noteref"><sup>20</sup></a>- 산점도에서만이 아닙니다<a class="quarto-xref" href="#fig-graphics-twodsp1">수치<span>3.27</span></a>for the<span class="math inline">\(엑스\)</span>그리고<span class="math inline">\(와이\)</span>-코디네이션뿐만 아니라<a class="quarto-xref" href="#fig-graphics-heatmap">수치<span>3.41</span></a>표현식 폴드 변화를 나타내는 색상 스케일의 경우. 로그 변환은 결정적인 의미를 갖기 때문에 매력적입니다. 로그 변환 된 척도에서 동일한 양으로 위 또는 아래로 이동하면 원래 척도에서 동일한 곱셈 변경에 해당합니다.<span class="math inline">\ (\ log (ax) = \ log a+\ log x \)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn20"><p><sup>20</sup>우리는 데이터의 데이터 이후 암시 적으로 사용했습니다<em>ExpressionSet</em>물체<code>엑스</code>이미 로그 변환되었습니다.</p></div></div><p>예를 들어, 데이터에 0 또는 음수 값이 포함되거나 로그 척도에서도 데이터 분포가 매우 고르지 않은 경우 로그가 충분하지 않습니다. 상단 패널에서<a class="quarto-xref" href="#fig-graphics-MA">수치<span>3.43</span></a>,<code>중</code>의존합니다<code>에이</code>더 높은 차이가 더 낮습니다<code>에이</code>. 그러나 하부 패널에서 확인한 것처럼 이것은 전적으로 시각적 인공물입니다.<code>중</code>독립적입니다<code>에이</code>그리고 상단 패널에서 본 명백한 추세는 더 작은 지점 밀도로 인해 발생했습니다.<code>에이</code>.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a>GG<span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">a =</span>바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)[,<span class="dv">1</span>],,<span class="at">m =</span> <span class="fu">rnorm</span>(<span class="fu">길이</span>(에이))),</span>
<span id="cb74-2"><a aria-hidden="true" href="#cb74-2" tabindex="-1"></a>            <span class="fu">AES</span>(<span class="at">y =</span>중))</span>
<span id="cb74-3"><a aria-hidden="true" href="#cb74-3" tabindex="-1"></a>GG<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">x =</span>에이),<span class="at">크기 =</span> <span class="fl">0.2</span>))</span>
<span id="cb74-4"><a aria-hidden="true" href="#cb74-4" tabindex="-1"></a>GG<span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">x =</span> <span class="fu">계급</span>(에이)),<span class="at">크기 =</span> <span class="fl">0.2</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphics-MA">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphics-MA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-MA" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-MA-1" width="240">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-MA-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-MA" href="03-chap_files/figure-html/fig-graphics-MA-1.png" title="Figure 3.43 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-MA" id="fig-graphics-MA-1" src="03-chap_files/figure-html/fig-graphics-MA-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-MA-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphics-MA" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-MA-2" width="240">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphics-MA-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphics-MA" href="03-chap_files/figure-html/fig-graphics-MA-2.png" title="Figure 3.43 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphics-MA" id="fig-graphics-MA-2" src="03-chap_files/figure-html/fig-graphics-MA-2.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphics-MA-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-graphics-MA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.43 : 의존성에 대한 시각적 인식에 대한 순위 변환의 영향.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-datatrsf">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.9</div>
</div>
<div class="callout-body-container callout-body">
<p>밀도 또는 비닝 기반 플로팅 방법을 사용하여 시각적 인공물을 피할 수 있습니까?<a class="quarto-xref" href="#fig-graphics-twodsp6">수치<span>3.31</span></a>?</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-histequ">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.10</div>
</div>
<div class="callout-body-container callout-body">
<p>색상 스케일을 선택할 때도 순위 변환을 적용 할 수 있습니다. 히트 맵을 위해? 무엇을 하는가<em>히스토그램 평등</em>이미지 처리에서?</p>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="3.12" id="mathematical-symbols-and-other-fonts">
<h2 class="anchored" data-anchor-id="mathematical-symbols-and-other-fonts" data-number="3.12"><span class="header-section-number">3.12</span>수학적 기호 및 기타 글꼴</h2>
<p>R 구문과 라텍스와 같은 표기법이 혼합 된 표기법을 사용하여 플롯 레이블에서 수학적 표기법을 사용할 수 있습니다.<code>도움말 ( "Plotmath")</code>자세한 내용은) :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-otherfont">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-otherfont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-57" href="imgs/chap3-ecdfs-bauhaus93font.png" title="Figure 3.44: As Figure fig-graphics-onedecdf, with font “Bauhaus 93”."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/chap3-ecdfs-bauhaus93font.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-otherfont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.44 : AS<a class="quarto-xref" href="#fig-graphics-onedecdf">수치<span>3.24</span></a>글꼴 "Bauhaus 93".</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a aria-hidden="true" href="#cb75-1" tabindex="-1"></a>용량<span class="ot">=</span> <span class="cf">기능</span>(Rho, no)</span>
<span id="cb75-2"><a aria-hidden="true" href="#cb75-2" tabindex="-1"></a>pi<span class="sc">^</span>(아니다<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>Rho<span class="sc">^</span>~ 아니다<span class="sc">/</span> <span class="fu">감마</span>(아니다<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb75-3"><a aria-hidden="true" href="#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a aria-hidden="true" href="#cb75-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">티블</span>(<span class="at">아니오 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,,,</span>
<span id="cb75-5"><a aria-hidden="true" href="#cb75-5" tabindex="-1"></a>  <span class="at">오메가 =</span> <span class="fu">용량</span>(<span class="dv">1</span>, 아니요)),<span class="fu">AES</span>(<span class="at">x =</span>아니다,<span class="at">y =</span>오메가))<span class="sc">+</span></span>
<span id="cb75-6"><a aria-hidden="true" href="#cb75-6" tabindex="-1"></a><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb75-7"><a aria-hidden="true" href="#cb75-7" tabindex="-1"></a><span class="fu">xlab</span>(<span class="fu">표현</span>(아니다))<span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">표현</span>(오메가))<span class="sc">+</span></span>
<span id="cb75-8"><a aria-hidden="true" href="#cb75-8" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">레이블 =</span></span>
<span id="cb75-9"><a aria-hidden="true" href="#cb75-9" tabindex="-1"></a><span class="st">"오메가 (Rho, no) == frac (pi^frac (no, 2) ~ rho^no, gamma (frac (no, 2))") ""</span>,,,</span>
<span id="cb75-10"><a aria-hidden="true" href="#cb75-10" tabindex="-1"></a>  <span class="at">구문 분석 =</span> <span class="cn">진실</span>,,,<span class="at">x =</span> <span class="dv">6</span>,,,<span class="at">y =</span> <span class="fl">1.5</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-mathnot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-mathnot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-58" href="03-chap_files/figure-html/fig-graphics-mathnot-1.png" title="Figure 3.45: Volume \Omega of the \nu-dimensional sphere with radius \rho=1, for \nu=1,...,15."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-mathnot-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-mathnot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.45 : 볼륨<span class="math inline">\(\오메가\)</span>의<span class="math inline">\(\아니다\)</span>-반경을 가진 차원 구체<span class="math inline">\ (\ rho = 1 \)</span>, 을 위한<span class="math inline">\ (\ no = 1, ..., 15 \)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-graphics-mathnot">수치<span>3.45</span></a>. 예를 들어 세리프 글꼴 시간과 같은 다른 글꼴로 전환하는 것도 쉽습니다 (<a class="quarto-xref" href="#fig-graphics-timesfont">수치<span>3.46</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a><span class="fu">ggplot</span>(유전자,<span class="fu">AES</span>( <span class="at">x =</span>값,<span class="at">색상 =</span>유전자))<span class="sc">+</span> <span class="fu">STAT_ECDF</span>() <span class="sc">+</span></span>
<span id="cb76-2"><a aria-hidden="true" href="#cb76-2" tabindex="-1"></a>  <span class="fu">주제</span>(<span class="at">텍스트 =</span> <span class="fu">요소 _text</span>(<span class="at">가족 =</span> <span class="st">"타임스"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-timesfont">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-timesfont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-59" href="03-chap_files/figure-html/fig-graphics-timesfont-1.png" title="Figure 3.46: As Figure fig-graphics-onedecdf, with a different font."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-timesfont-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-timesfont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.46 : AS<a class="quarto-xref" href="#fig-graphics-onedecdf">수치<span>3.24</span></a>다른 글꼴로.</figcaption>
</figure>
</div>
</div></div></div>
<p>실제로 표준 R 설치와 함께 사용할 수있는 글꼴 세트는 제한되어 있지만 운 좋게도 패키지가 있습니다.<strong><a href="https://cran.r-project.org/web/packages/extrafont/">엑스트라 폰트</a></strong>R의 표준 포스트 스크립트 글꼴 세트 이외의 글꼴을 사용하여 사용합니다. R 외부의 글꼴을 먼저 알고 있어야하므로 사용하기 전에 추가 작업이 필요합니다. 그들은 워드 프로세서 또는 다른 그래픽 응용 프로그램과 함께 운영 체제와 함께 배송 할 수 있습니다. 따라서 사용 가능한 글꼴 세트와 물리적 위치는 표준화되지 않았지만 운영 체제 및 추가 구성에 따라 다릅니다. 첨부 후 첫 세션에서<strong><a href="https://cran.r-project.org/web/packages/extrafont/">엑스트라 폰트</a></strong>패키지, 기능을 실행해야합니다<code>font_import</code>글꼴을 가져 와서 패키지에 알려줍니다. 그런 다음 사용하려는 각 세션에서<code>로드 폰트</code>기능을 하나 이상의 R의 그래픽 장치에 등록하도록합니다. 마지막으로 사용할 수 있습니다<code>글꼴</code>사용 가능한 글꼴을 나열하는 기능. 문서를 참조해야합니다.<strong><a href="https://cran.r-project.org/web/packages/extrafonts/">엑스트라 폰트</a></strong>이 작업을 컴퓨터에서 만드는 방법을 확인하는 패키지.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>패키지를 사용하십시오<strong><a href="https://cran.r-project.org/web/packages/extrafont/">엑스트라 폰트</a></strong>버전을 생성합니다<a class="quarto-xref" href="#fig-graphics-timesfont">수치<span>3.46</span></a>글꼴 "Bauhaus 93"(또는 시스템에서 사용 가능한 다른 하나).</p>
</div>
</div>
</section>
<section class="level2 page-columns page-full" data-number="3.13" id="genomic-data">
<h2 class="anchored" data-anchor-id="genomic-data" data-number="3.13"><span class="header-section-number">3.13</span>게놈 데이터</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-EBI-genomebrowser-rnaseq">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-EBI-genomebrowser-rnaseq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-60" href="imgs/EBI-genomebrowser-rnaseq.png" title="Figure 3.47: Screenshot from Ensembl genome browser, showing gene annotation of a genomic region as well as a read pile-up visualization of an RNA-Seq experiment."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/EBI-genomebrowser-rnaseq.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-EBI-genomebrowser-rnaseq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.47 : ensembl 게놈 브라우저의 스크린 샷, 게놈 영역의 유전자 주석과 RNA-Seq 실험의 판독 름업 시각화를 보여주는 스크린 샷.</figcaption>
</figure>
</div>
</div></div></div>
<p>게놈 데이터를 시각화하기 위해이 장에서 논의한 일반적인 원칙 외에도 몇 가지 구체적인 고려 사항이 있습니다. 데이터는 일반적으로 게놈 좌표와 관련이 있습니다. 실제로 게놈 좌표는 게놈 데이터의 통합을위한 훌륭한 조직 원리를 제공합니다. 아마도<a class="quarto-xref" href="#fig-graphics-EBI-genomebrowser-rnaseq">수치<span>3.47</span></a>. 여기서는 데이터와 공개 주석을 사용하여 프로그래밍 방식으로 그러한 플롯을 생성하는 방법을 간략하게 보여줄 것입니다. 그것은 짧은 엿볼 것이며, 우리는 다음과 같은 자원을 언급합니다.<a href="https://www.bioconductor.org">생체 전도체</a>더 많은 사진을 위해.</p>
<p>게놈 데이터 시각화의 주요 과제는 게놈의 크기입니다. 전체 게놈에서 뉴클레오티드 수준까지 여러 척도에서 시각화가 필요합니다. 확대 및 축소하기 쉬워야하며 다양한 크기 척도에 대해 다른 시각화 전략이 필요할 수 있습니다. 3D 물리적 세계에 포함 된 것은 중요 할 수 있지만 생물학적 분자 (게놈, 유전자, 전 사체, 단백질)를 선형적인 방식으로 시각화하는 것이 편리 할 수 ​​있습니다.</p>
<p>인간 염색체 1의 이데 그램 음모 인 몇 가지 재미있는 예에서 시작합시다.<a class="quarto-xref" href="#fig-graphics-ideogram-1">수치<span>3.48</span></a>) 및 RNA 편집 사이트의 게놈 전체 분포의 플롯 (<a class="quarto-xref" href="#fig-graphics-darned1">수치<span>3.49</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggbio"</span>))</span>
<span id="cb77-2"><a aria-hidden="true" href="#cb77-2" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"hg19ideogramcyto"</span>,,,<span class="at">패키지 =</span> <span class="st">"Biovizbase"</span>))</span>
<span id="cb77-3"><a aria-hidden="true" href="#cb77-3" tabindex="-1"></a><span class="fu">Plotideogram</span>(hg19ideogramcyto,<span class="at">subchr =</span> <span class="st">"chr1"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-ideogram-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-ideogram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-61" href="03-chap_files/figure-html/fig-graphics-ideogram-1-1.png" title="Figure 3.48: Chromosome 1 of the human genome: ideogram plot."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-ideogram-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-ideogram-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.48 : 인간 게놈의 염색체 1 : 이데 그램 플롯.</figcaption>
</figure>
</div>
</div></div></div>
<p>그만큼<code>darned_hg19_subset500</code>인간 게놈에 500 개의 RNA 편집 사이트가 선택됩니다. 그것은에서 얻었다<em>파리, 생쥐 및 인간의 RNA 편집 데이터베이스</em>(대담한,<a class="uri" href="https://darned.ucc.ie/">https://darned.ucc.ie/</a>). 결과가 표시됩니다<a class="quarto-xref" href="#fig-graphics-darned1">수치<span>3.49</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="need valid seqlengths information for accurate mapping">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"게놈 광장"</span>))</span>
<span id="cb78-2"><a aria-hidden="true" href="#cb78-2" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"darned_hg19_subset500"</span>,,,<span class="at">패키지 =</span> <span class="st">"Biovizbase"</span>))</span>
<span id="cb78-3"><a aria-hidden="true" href="#cb78-3" tabindex="-1"></a><span class="fu">오토 플롯</span>(darned_hg19_subset500,<span class="at">레이아웃 =</span> <span class="st">"캔자 흐름"</span>,,,</span>
<span id="cb78-4"><a aria-hidden="true" href="#cb78-4" tabindex="-1"></a>         <span class="fu">AES</span>(<span class="at">색상 =</span>exreg,<span class="at">fill =</span>exreg))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-darned1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-darned1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-62" href="03-chap_files/figure-html/fig-graphics-darned1-1.png" title="Figure 3.49: Karyogram with RNA editing sites. exReg indicates whether a site is in the coding region (C), 3’- or 5’-UTR."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-darned1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-darned1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.49 : RNA 편집 사이트가 포함 된 핵유리.<code>exreg</code>사이트가 코딩 영역 (C), 3'- 또는 5'-UTR에 있는지 여부를 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-chroder">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.11</div>
</div>
<div class="callout-body-container callout-body">
<p>염색체의 순서를 어떻게 고정합니까?<a class="quarto-xref" href="#fig-graphics-darned1">수치<span>3.49</span></a>염색체 길이에 대한 경고를 제거합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-19-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-19-contents callout-collapse collapse" id="callout-19">
<div class="callout-body-container callout-body">
<p>인간 게놈의 HG19 어셈블리에서 염색체 길이에 대한 정보는 (예를 들어)에 저장됩니다.<code>이데오 시토</code>데이터 세트. 우리는 기능을 사용합니다<code>KeepSeqLevels</code>염색체를 재정렬하기 위해. 보다<a class="quarto-xref" href="#fig-graphics-darned2">수치<span>3.50</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"ideocyto"</span>,,,<span class="at">패키지 =</span> <span class="st">"Biovizbase"</span>))</span>
<span id="cb79-2"><a aria-hidden="true" href="#cb79-2" tabindex="-1"></a>DN<span class="ot">=</span>darned_hg19_subset500</span>
<span id="cb79-3"><a aria-hidden="true" href="#cb79-3" tabindex="-1"></a><span class="fu">seqlengths</span>(DN)<span class="ot">=</span> <span class="fu">seqlengths</span>(이데오 시토<span class="sc">$</span>HG19) [<span class="fu">이름</span>(<span class="fu">seqlengths</span>(dn))]</span>
<span id="cb79-4"><a aria-hidden="true" href="#cb79-4" tabindex="-1"></a>DN<span class="ot">=</span> <span class="fu">KeepSeqLevels</span>(dn,<span class="fu">페이스트0</span>(<span class="st">"chr"</span>,,,<span class="fu">기음</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>,,,<span class="st">"엑스"</span>))))</span>
<span id="cb79-5"><a aria-hidden="true" href="#cb79-5" tabindex="-1"></a><span class="fu">오토 플롯</span>(dn,<span class="at">레이아웃 =</span> <span class="st">"캔자 흐름"</span>,,,<span class="fu">AES</span>(<span class="at">색상 =</span>exreg,<span class="at">fill =</span>exreg))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphics-darned2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphics-darned2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-63" href="03-chap_files/figure-html/fig-graphics-darned2-1.png" title="Figure 3.50: Improved version of Figure fig-graphics-darned1."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="03-chap_files/figure-html/fig-graphics-darned2-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphics-darned2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 3.50 : 개선 된 버전<a class="quarto-xref" href="#fig-graphics-darned1">수치<span>3.49</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphics-darned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 3.12</div>
</div>
<div class="callout-body-container callout-body">
<p>어떤 유형의 물체가<code>darned_hg19_subset500</code>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-21-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-21-contents callout-collapse collapse" id="callout-21">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a>darned_hg19_subset500 [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 개의 범위와 10 개의 메타 데이터 열이있는 그랑스 물체 :
      Seqnames 범위 스트랜드 |       인치 inrna snp
         &lt;rle&gt; &lt;iranges&gt; &lt;rle&gt; | &lt;캐릭터&gt; &lt;문자&gt; &lt;문자&gt;
  [1] Chr5 86618225- |           a i &lt;na&gt;
  [2] Chr7 99792382- |           a i &lt;na&gt;
             Gene Seqreg exreg 소스 Ests Esta
      &lt;ataince&gt; &lt;atire&gt; &lt;ataince&gt; &lt;문자&gt; &lt;integer&gt; &lt;integer&gt;
  [1] &lt;na&gt; o &lt;na&gt; Amygdala 0 0
  [2] &lt;na&gt; o &lt;na&gt; &lt;na&gt; 0 0
           작가
      &lt;문자&gt;
  [1] 15342557
  [2] 15342557
  -------
  Seqinfo : 지정되지 않은 게놈으로부터 23 서열; seqlength가 없습니다</code></pre>
</div>
</div>
<p>그것은입니다<em>전원</em>대상, 즉 게놈 좌표와 관련된 데이터를 저장하기위한 바이오 컨덕터 프로젝트의 특수 클래스. 처음 세 열은 의무적입니다.<code>seqnames</code>, 함유 바이오 폴리머의 이름 (우리의 경우 인간 염색체의 이름),<code>범위</code>, 간격의 게놈 좌표 (이 경우, 간격은 각각 단일 뉴클레오티드를 참조 할 때 길이 1을 갖는다) 및 DNA<code>바닷가</code>RNA가 전사됩니다. 이 클래스 사용 방법과 문서에서 관련 인프라 (예 : 비네팅)에 대한 자세한 내용은<strong><a href="https://bioconductor.org/packages/GenomicRanges/">게놈 생성</a></strong>패키지. 배우는 것은 게놈 관련 데이터 세트로 작업하려면 노력할 가치가 있습니다.이 데이터를 편리하고 효율적이며 안전하게 조작하고 많은 강력한 유틸리티를 제공합니다.</p>
</div>
</div>
</div>
</section>
<section class="level2" data-number="3.14" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="3.14"><span class="header-section-number">3.14</span>이 장의 요약</h2>
<p>"원시"또는 다양한 처리 단계, 요약 및 추론에 따라 데이터를 시각화하는 것은 응용 통계 및 과학에서 가장 중요한 활동 중 하나입니다. 연역적 이론이 많지 않기 때문에 교과서에서 때때로 짧은 슈 리프트가 발생합니다. 그러나 많은 수의 좋은 (그리고 나쁜) 관행이 있으며, 일단주의를 기울인 후에는 특정 그래픽이 메시지를 전달하는 데 효과적인지 또는 강력하고 미적으로 유의미한 데이터 시각화를 만들 수 있는지 신속하게 알 수 있습니다. 중요한 옵션 중에는 플롯 유형 (<code>geom</code>~에<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>), 비율 (종횡비) 및 색상. 그만큼<em>그래픽의 문법</em>그래픽에 대해 추론하고 데이터 시각화에 대한 우리의 의도를 컴퓨터에 전달하는 강력한 개념 세트입니다.</p>
<p>피하다<em>게으름</em>- 옵션에 대해 생각하지 않고 소프트웨어의 기본값을 사용하여<em>도망가는 것</em>- 줄거리를 막지 만 실제 메시지가없는 시각적 사탕을 많이 묘사합니다. 자신만의 시각화를 만드는 것은 여러 가지면에서 좋은 글쓰기와 같은 것입니다. 메시지를 전달하는 것이 매우 중요하지만 (논문에서, 논문으로) 간단한 레시피는 없습니다. 다른 사람들이 만든 많은 시각화를주의 깊게 살펴보고 자신의 시각화를 실험하여 로프를 배우고 스타일이 무엇인지 결정하십시오.</p>
</section>
<section class="level2" data-number="3.15" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="3.15"><span class="header-section-number">3.15</span>추가 독서</h2>
<p>가장 유용한 리소스<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>두 번째 판입니다<span class="citation" data-cites="ggplot2">위엄 (Wickham)<a href="16-chap.html#ref-ggplot2" role="doc-biblioref">2016</a>))</span>그리고<a href="https://ggplot2.tidyverse.org">ggplot2</a>웹 사이트. 많은 것이 있습니다<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>연습 후 검색 엔진을 통해 찾을 수있는 온라인 코드 스 니펫. 그러나 비판적이고 소스를 확인하십시오. 때로는 온라인에서 찾을 수있는 코드 예제는 패키지의 구식 버전을 참조하고 때로는 품질이 좋지 않습니다.</p>
<p>시스템의 기초는 기반입니다<span class="citation" data-cites="GrofGrbook">윌킨슨 (Wilkinson) (<a href="16-chap.html#ref-GrofGrbook" role="doc-biblioref">2005</a>))</span>그리고 아이디어<span class="citation" data-cites="Tukey77 Tukey:1988">튜키 (<a href="16-chap.html#ref-Tukey77" role="doc-biblioref">1977</a>; <a href="16-chap.html#ref-Tukey:1988" role="doc-biblioref">윌리엄 S. 클리블랜드 1988</a>))</span>.</p>
</section>
<section class="level2 page-columns page-full" data-number="3.16" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="3.16"><span class="header-section-number">3.16</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphics-themes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 3.1</div>
</div>
<div class="callout-body-container callout-body">
<p>사용<em>테마</em>음모의 시각적 모양을 바꾸려면. 다음 예를 실행하여 시작하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a>GGCARS<span class="ot">=</span> <span class="fu">ggplot</span>(mtcars,<span class="fu">AES</span>(<span class="at">x =</span>HP,<span class="at">y =</span>MPG))<span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb82-2"><a aria-hidden="true" href="#cb82-2" tabindex="-1"></a>GGCARS</span>
<span id="cb82-3"><a aria-hidden="true" href="#cb82-3" tabindex="-1"></a>GGCARS<span class="sc">+</span> <span class="fu">테마_BW</span>()</span>
<span id="cb82-4"><a aria-hidden="true" href="#cb82-4" tabindex="-1"></a>GGCARS<span class="sc">+</span> <span class="fu">테마_minimal</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>다른 테마는 무엇입니까? (힌트 :<a href="https://ggplot2.tidyverse.org/reference">GGPLOT2의 온라인 문서</a>.)이 모든 테마입니까? (힌트 :<strong><a href="https://cran.r-project.org/web/packages/ggthemes/">ggthemes</a></strong>패키지.) 위의 플롯의 버전을<em>경제학자</em>잡지. 스무딩 라인을 추가하십시오</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphics-colornames">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 3.2</div>
</div>
<div class="callout-body-container callout-body">
<p>허용 할 수있는 것<em>색상 이름</em>기본 R에서? 수동 페이지를 살펴보십시오<code>그림 물감</code>기능. Ryun 예제와 데모.</p>
<p>인터넷 검색 엔진을 사용하여 "r 색상 이름"을 검색하고 등장한 리소스 (예 : 모든 색상이 포함 된 치트 시트)를 탐색하십시오.</p>
<p>히트 맵의 버전을 생성합니다<a class="quarto-xref" href="#fig-graphics-heatmap">수치<span>3.41</span></a>그것은 컬러 팔레트를 사용합니다<a href="https://github.com/dill/beyonce">R 패키지<strong>비욘세</strong></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphics-xkcd">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 3.3</div>
</div>
<div class="callout-body-container callout-body">
<p>스타일로 플롯을 만듭니다<a href="https://xkcd.com">XKCD</a>웹 코믹. 살펴보십시오</p>
<div class="cell" data-layout-align="center">
</div>
<ul>
<li><p>StackoverFlow의 스레드<a href="https://stackoverflow.com/questions/12675147/how-can-we-make-xkcd-style-graphs">XKCD 스타일 그래프를 어떻게 만들 수 있습니까?</a></p></li>
<li><p>이 책의 R 소스 코드는 장의 오프닝 그림을 제작하는 코드에 대한 소스 코드입니다.</p></li>
<li><p>의 비 ignette<strong><a href="https://cran.r-project.org/web/packages/xkcd/">XKCD</a></strong>패키지.</p></li>
</ul>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display callout-margin-content">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-64" href="imgs/xkcdgraph.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/xkcdgraph.png"/></a></p>
</figure>
</div>
</div></div><div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphics-shiny">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 3.4</div>
</div>
<div class="callout-body-container callout-body">
<p>확인하십시오<strong><a href="https://cran.r-project.org/web/packages/shiny/">빛나는</a></strong>Rstudio 웹 사이트의 튜토리얼. a<em>반짝이는 앱</em>이 장의 음모 중 하나를 표시하지만, 상호 작용 요소가 제어 할 유전자가 표시되는 유전자 (그림)<a class="quarto-xref" href="#fig-graphics-facet1"><span>3.33</span></a>-<a class="quarto-xref" href="#fig-graphics-facet3"><span>3.35</span></a>).</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphics-serialization">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 3.5</div>
</div>
<div class="callout-body-container callout-body">
<p>어떤 옵션이 있습니다<em>직렬화</em>나중에 사용하기 위해 저장하거나 다른 소프트웨어에로드 할 수있는 파일에 그래픽을 저장하기위한 그래픽? 대화식 그래픽을 어떻게 직렬화 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphics-comirnaty">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">연습 3.6</div>
</div>
<div class="callout-body-container callout-body">
<p>중요하고 잘 수행 된 그래픽은 복잡 할 필요가 없습니다. 예를 들어,<a href="extras/comirnaty-epar-public-assessment-report_en.pdf">Comirnaty에 대한 유럽 의약 기관의 공개 평가 보고서</a><a class="footnote-ref" href="#fn21" id="fnref21" role="doc-noteref"><sup>21</sup></a>그리고<a href="https://xkcd.com/2400/">XKCD 2400</a>.</p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn21"><p><sup>21</sup>당신은 또한 이것을 얻을 수 있습니다<a class="uri" href="https://www.ema.europa.eu/en/medicines/human/EPAR/comirnaty">https://www.ema.europa.eu/en/medicines/human/epar/comirnaty</a>.</p></div></div><div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Carr1987hexbin" role="listitem">Carr, Daniel B, Richard J Littlefield, WL Nicholson 및 JS Littlefield. 1987.<span>“크기를위한 ScatterPlot 매트릭스 기술<span>N</span>.”</span> <em>미국 통계 협회 저널</em>82 (398) : 424–36.</div>
<div class="csl-entry" id="ref-Tukey:1988" role="listitem">클리블랜드, 윌리엄 S. 1988.<em>John w.의 수집 된 작품. Tukey : 그래픽 1965-1985</em>. vol. 5. CRC 프레스.</div>
<div class="csl-entry" id="ref-Cleveland:1988:Banking" role="listitem">클리블랜드, William S., Marylyn E. McGill 및 Robert McGill. 1988.<span>"두 가지 변수 그래프의 모양 매개 변수."</span> <em>미국 통계 협회 저널</em>83 : 289–300.</div>
<div class="csl-entry" id="ref-Helmholtz:1867" role="listitem">Helmholtz, H. von. 1867.<em>생리적 외관의 핸드북</em>. 라이프 치히 : 레오폴드 보스.</div>
<div class="csl-entry" id="ref-IhakaColorPres" role="listitem">이삭, 로스. 2003.<span>"프리젠 테이션 그래픽을위한 색상."</span>~ 안에<em>분산 통계 컴퓨팅에 관한 제 3 차 국제 워크숍의 절차</em>, Kurt Hornik과 Friedrich Leisch가 편집했습니다. 오스트리아 비엔나 : http://www.r-project.org/conferences/dsc-2003/proceedings/; ISSN 1609-395X.</div>
<div class="csl-entry" id="ref-Irizarry:Biostat:2003" role="listitem">Irizarry, R. A., B. Hobbs, F. Collin, Y. D. Beazer-Barclay, K. J. Antonellis, U. Scherf 및 T.P. Speed. 2003.<span>"고밀도 올리고 뉴클레오티드 어레이 수준 데이터의 탐사, 정규화 및 요약."</span> <em>생물 통계학</em>4 (2) : 249–64.</div>
<div class="csl-entry" id="ref-Lawrence:Nature:2013" role="listitem">Lawrence, Michael S., Petar Stoolov, Paz Polak, Gregory V. Kryukov, Kristian Cibulskis, Andrey Sivachenko, Scott L. Carter 등. 2013.<span>"암의 돌연변이 이질성과 새로운 암 관련 유전자에 대한 검색."</span> <em>자연</em>499 (7457) : 214–18.<a href="https://doi.org/10.1038/nature12213">https://doi.org/10.1038/nature12213</a>.
</div>
<div class="csl-entry" id="ref-McCormick:1972:MatrixClustering" role="listitem">McCormick Jr, William T, Paul J Schweitzer 및 Thomas W White. 1972.<span>"클러스터링 기술에 의한 문제 분해 및 데이터 재구성."</span> <em>운영 연구</em>20 (5) : 993–1009.</div>
<div class="csl-entry" id="ref-Mollon:1995" role="listitem">Mollon, John. 1995.<span>"색을 보는 것."</span>~ 안에<em>색상 : 예술과 과학</em>, T. Lamb 및 J. Bourriat에 의해 편집 됨. 케임브리지 불공정 언론.</div>
<div class="csl-entry" id="ref-Ohnishi2014" role="listitem">Ohnishhi, Y., W. Huber, A. Tour, M. Kang, P. Xenopolos, K. Curioto, A. K. Oles 등. 2014.<span>"셀-세포 발현 변동성에 이어 신호 강화가 점차 초기 마우스 계보를 분리합니다."</span> <em>자연 세포 생물학</em>16 (1) : 27–37.</div>
<div class="csl-entry" id="ref-Tukey77" role="listitem">Tukey, John W. 1977.<span>"탐색 적 데이터 분석."</span> <em>매사추세츠 : 애디슨 웨슬리</em>.
</div>
<div class="csl-entry" id="ref-Wickham:LayeredGrammar" role="listitem">위엄, 해들리. 2010 년.<span>"그래픽의 계층 문법."</span> <em>계산 및 그래픽 통계 저널</em>19 (1) : 3–28.</div>
<div class="csl-entry" id="ref-ggplot2" role="listitem">———. 2016.<em>GGPLOT2 : 데이터 분석을위한 우아한 그래픽</em>. 스프링거 뉴욕.<a href="http://had.co.nz/ggplot2/book">http://had.co.nz/ggplot2/book</a>.
</div>
<div class="csl-entry" id="ref-Wilkinson:DotPlots:1999" role="listitem">Wilkinson, Leland. 1999.<span>"도트 플롯."</span> <em>미국 통계 학자</em>53 (3) : 276.</div>
<div class="csl-entry" id="ref-GrofGrbook" role="listitem">———. 2005.<em>그래픽의 문법</em>. 뛰는 것.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
