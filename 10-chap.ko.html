<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>10  Networks and Trees – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="10  Networks and Trees – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="10  Networks and Trees – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">10.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#graphs" href="#graphs" id="toc-graphs"><span class="header-section-number">10.2</span>그래프</a></li>
<li><a class="nav-link" data-scroll-target="#from-gene-set-enrichment-to-networks" href="#from-gene-set-enrichment-to-networks" id="toc-from-gene-set-enrichment-to-networks"><span class="header-section-number">10.3</span>유전자 설정에서 네트워크까지</a></li>
<li><a class="nav-link" data-scroll-target="#phylogenetic-trees" href="#phylogenetic-trees" id="toc-phylogenetic-trees"><span class="header-section-number">10.4</span>계통 발생 나무</a></li>
<li><a class="nav-link" data-scroll-target="#combining-phylogenetic-trees-into-a-data-analysis" href="#combining-phylogenetic-trees-into-a-data-analysis" id="toc-combining-phylogenetic-trees-into-a-data-analysis"><span class="header-section-number">10.5</span>계통 발생 트리를 데이터 분석에 결합합니다</a></li>
<li><a class="nav-link" data-scroll-target="#minimum-spanning-trees" href="#minimum-spanning-trees" id="toc-minimum-spanning-trees"><span class="header-section-number">10.6</span>최소 스패닝 나무</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">10.7</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">10.8</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">10.9</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-graphs"><span class="chapter-number">10</span>  <span class="chapter-title">네트워크와 나무</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/Darwin_Tree_1837_web.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Darwin_Tree_1837_web.png"/></a></p>
</figure>
</div>
</div></div></div>
<p>네트워크와 나무는 종종 생물학적 시스템에 대한 지식을 나타내는 데 사용됩니다. 또한 실험이나 연구에서 관찰을 직접 인코딩하는 데 사용될 수 있습니다. 계통 발생적 나무는 종들 사이의 가족과 유사성 관계를 나타내며 다윈의 유명한 노트 스케치 전에도이 나무들에게 기계적이고 인과 적 해석을 주었습니다. 네트워크의 노드와 가장자리의 의미는 다를 수 있으며 지정해야합니다. 예를 들어, 네트워크는<a class="quarto-xref" href="#fig-chemo">수치<span>10.1</span></a>, 노드가 유전자 또는 그들의 암호화 된 단백질을 의미 할 수 있고, 가장자리는 직접적인 물리적 상호 작용 또는보다 추상적 인 "기능적"또는 실험 결과를 나타내는 "유전 적"상호 작용 일 수있다. 이 책에서 우리는 용어를 사용합니다<em>그래프</em>그리고<em>회로망</em>크게 교환 적으로. 전자 용어는 수학적 구조를 조금 더 연상시킨다. 후자는 생물학적 해석의 후자이다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-chemo">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chemo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="10-chap_files/figure-html/fig-chemo-1.png" title="Figure 10.1: A small protein-protein network that represents pairwise relationships between proteins."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-chemo-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chemo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.1 : 단백질 간의 쌍별 관계를 나타내는 작은 단백질-단백질 네트워크.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는 봤습니다<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>우리는 Markov 체인으로서의 상태 전이 시퀀스를 모델링 할 수 있으며, 이는 가장자리에 가중치가있는 지시 된 그래프로 표현 될 수 있습니다. 노드가 화학적 대사 산물이고 가장자리는 화학 반응을 나타내는 대사 경로. 돌연변이 이력 나무는 암 유전체학에 사용되어 돌연변이의 계통을 나타냅니다.</p>
<p>전염병 네트워크는 전염병의 역학을 연구하는 데 중요합니다. 실제 네트워크는 매우 클 수 있으므로이를 대표하고 시각화하기위한 특별한 방법이 필요합니다. 이 장은 그래프를 데이터 분석 워크 플로에 통합하는 방법에 중점을 둘 것입니다.</p>
<section class="level2" data-number="10.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="10.1"><span class="header-section-number">10.1</span>이 장의 목표</h2>
<p>이 장에서는 우리가 할 것입니다</p>
<ul>
<li><p>그래프의 구성 요소 (가장자리, 정점, 레이아웃)의 공식 정의를 사용하여 인접 행렬과 가장자리 목록을 사용하여 R에서 조작하는 방법을 확인하십시오.</p></li>
<li><p>그래프 객체를 변환 할 것입니다<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>레이어 접근에 따라 시각화 할 수있는 물체로<strong><a href="https://bioconductor.org/packages/ggplot2/">ggplot2</a></strong>사용<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>. 우리는 그래프 가장자리와 노드에 부착하는 공변량을 실험 할 것입니다.</p></li>
<li><p>그래프는 시스템에 대한 사전 지식을 인코딩하는 유용한 방법이며, 간단한 유전자 세트 분석에서 네트워크에 유의점을 매핑하여 섭동을 감지하여 의미있는 생물학적 권장 사항으로 어떻게 갈 수 있는지 볼 수 있습니다.<em>핫스팟</em>.</p></li>
<li><p>우리는 DNA 서열에서 시작하여 계통 발생적 나무를 만들고 특별히 설계된 R 패키지 로이 나무를 시각화합니다.<strong><a href="https://cran.r-project.org/web/packages/ape/">원숭이</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/ggtree/">Ggtree</a></strong>.</p></li>
<li><p>우리는 Microbiome 16S rRNA 데이터로 구축 된 계통 발생 트리를 공변량과 결합하여 Taxa 사이의 계층 적 관계가 여러 가설 테스트에서 전력을 증가시킬 수있는 방법을 보여줍니다.</p></li>
<li><p>최소 스패닝 트리 (MST)라는 특수 트리는 그래프와 다른 공변량 간의 관계를 테스트하는 데 매우 유용합니다. Friedman-Rafsky 테스트라고 알려진 다른 버전을 구현하는 방법을 살펴 보겠습니다. 우리는 마우스 쓰레기에서 박테리아의 동시 발생과 HIV 전염병 네트워크에서 유사성을 연구 할 것입니다.</p></li>
</ul>
</section>
<section class="level2 page-columns page-full" data-number="10.2" id="graphs">
<h2 class="anchored" data-anchor-id="graphs" data-number="10.2"><span class="header-section-number">10.2</span>그래프</h2>
<section class="level3 page-columns page-full" data-number="10.2.1" id="what-is-a-graph-and-how-can-it-be-encoded">
<h3 class="anchored" data-anchor-id="what-is-a-graph-and-how-can-it-be-encoded" data-number="10.2.1"><span class="header-section-number">10.2.1</span>그래프 란 무엇이며 어떻게 인코딩 할 수 있습니까?</h3>
<p>에이<strong>그래프</strong>종종 두 세트의 조합으로 정의되며, 종종<span class="math inline">\ ((V, E) \)</span>. 여기,<span class="math inline">\(다섯\)</span>세트입니다<strong>노드</strong>또는<strong>정점</strong>,,,<span class="math inline">\(이자형\)</span>세트입니다<strong>가장자리</strong>정점 사이. 각 요소<span class="math inline">\(이자형\)</span>한 쌍의 노드입니다. 즉, 두 가지 요소로 구성됩니다.<span class="math inline">\(다섯\)</span>. 그래프를 나타내는 직관적 인 방법은<strong>-부터</strong>대표. 우리가 정점 세트를 다음과 같이 표시한다면<span class="math inline">\ (v = (\ text {a},
\ text {b}, \ text {c}, \ ldots) \)</span>, 그런 다음 (또는<strong>에지 목록</strong>) 표현은 다음 형식의 표입니다.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>부터
1 A b
2 b c
3 A e
4 c d
5 e f</code></pre>
</div>
</div>
<p>To To To To To To The The Hack의 순서는 역할을하지 않습니다. a<strong>지시</strong>또는<strong>지향 그래프</strong>, 가장자리는 순서 쌍, 즉 위 표의 첫 번째 줄은 A에서 B까지의 모서리가 있지만 B에서 A까지 가장자리가 있는지 여부는 말하지 않습니다. 이는 별도의 테이블 행에 표시되어야합니다.</p>
<p>에서<strong>방향이없는 그래프</strong>, 가장자리는 지정되지 않은 쌍입니다. 즉, A에서 B까지의 모서리는 B에서 A 로의 에지와 구별되지 않습니다. 지시되지 않은 그래프는 비대칭 관계를 나타냅니다.</p>
<p>그래프를 시각화와 혼동하지 않는 것이 중요합니다. IN과 같은 2 차원 영역에 그래프를 그릴 수 있습니다.<a class="quarto-xref" href="#fig-chemo">수치<span>10.1</span></a>그러나 이것은 선택 사항이며 고유 한 것이 아닙니다. 항상 동일한 그래프를 그릴 수있는 다양한 방법이 있습니다. 그러한 시각화에서 가장자리가 겹치지 않는다는 보장은 없습니다. 그래프에 따라 이런 일이 발생할 수 있습니다. 그래프는 물리적 공간 (2D 나 3D)에 살지 않지만 말 그대로 노드와 가장자리 세트 일뿐입니다.</p>
<p>To-to 테이블에 해당하는 대체 표현은 다음과 같습니다.<strong>인접 매트릭스</strong>, 그래프의 노드만큼 행 (및 열)이 많은 2 차 행렬. 매트릭스에는 0이 아닌 항목이 포함되어 있습니다<span class="math inline">\(나\)</span>ROW와<span class="math inline">\ (J \)</span>Th 열 사이에 가장자리가 있음을 인코딩하는 열<span class="math inline">\(나\)</span>th and<span class="math inline">\ (J \)</span>정점.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-undirectedmatrix">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.1</div>
</div>
<div class="callout-body-container callout-body">
<p>방향이없는 그래프의 경우 인접 매트릭스의 특별한 점<span class="math inline">\(에이\)</span>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-2-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-2-contents callout-collapse collapse" id="callout-2">
<div class="callout-body-container callout-body">
<p>인접 매트릭스는 대칭입니다.<span class="math inline">\ (m = m^t \)</span>. 예는 그림에 나와 있습니다<a class="quarto-xref" href="#fig-igraphplot"><span>10.2</span></a>그리고<a class="quarto-xref" href="#fig-adjmatrix"><span>10.3</span></a>. <code>G1</code>3 열 매트릭스에서 인코딩 된 To-to Table에서 생성됩니다.<code>가장자리</code>) 아래 코드에 의해.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"IGRAP"</span>))</span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a>가장자리<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">2</span>,,,<span class="dv">3</span>,,,<span class="dv">3</span>,,,<span class="dv">4</span>,,,<span class="dv">4</span>,,,<span class="dv">5</span>,,,<span class="dv">4</span>,,,<span class="dv">6</span>),)<span class="at">Byrow =</span> <span class="cn">진실</span>,,,<span class="at">NCOL =</span> <span class="dv">2</span>))</span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a>G1<span class="ot">=</span> <span class="fu">그래프 _from_edgelist</span>(가장자리,<span class="at">지시 =</span> <span class="cn">거짓</span>))</span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a><span class="fu">vertex_attr</span>(G1,<span class="at">이름 =</span> <span class="st">"이름"</span>))<span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a><span class="fu">구성</span>(G1,<span class="at">vertex.size =</span> <span class="dv">25</span>,,,<span class="at">edge.width =</span> <span class="dv">5</span>,,,<span class="at">vertex.color =</span> <span class="st">"산호"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-igraphplot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-igraphplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="10-chap_files/figure-html/fig-igraphplot-1.png" title="Figure 10.2: A small undirected graph with numbered nodes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-igraphplot-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-igraphplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.2 : 번호가 번호가 매겨진 작은 방향 그래프.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-adjmatrix">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-adjmatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="10-chap_files/figure-html/fig-adjmatrix-1.png" title="Figure 10.3: The adjacency matrix of the graph shown in Figure fig-igraphplot is is a symmetric n \times n matrix of 0s and 1s, where is n is the number of nodes."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-adjmatrix-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-adjmatrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.3 : 표시된 그래프의 인접 매트릭스<a class="quarto-xref" href="#fig-igraphplot">수치<span>10.2</span></a>대칭입니다<span class="math inline">\ (n \ times n \)</span>매트릭스<span class="math inline">\ (0 \)</span>S와<span class="math inline">\ (1 \)</span>s, 어디에<span class="math inline">\(N\)</span>노드 수입니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-alternative">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.2</div>
</div>
<div class="callout-body-container callout-body">
<p>답에 표시된 대안에 대한 대안적인 방법을 줄 수 있습니까?<a class="quarto-xref" href="#wrn-graphs-undirectedmatrix">질문<span>10.1</span></a>위의 가장자리 데이터 프레임 목록에서 그래프를 만들기 위해?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-4-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-4-contents callout-collapse collapse" id="callout-4">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a>가장자리<span class="ot">=</span> <span class="st">"1,3</span><span class="sc">\N</span><span class="st">2,3</span><span class="sc">\N</span><span class="st">3,4</span><span class="sc">\N</span><span class="st">4,6</span><span class="sc">\N</span><span class="st">4,5 "</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a>DF<span class="ot">=</span> <span class="fu">read.csv</span>(<span class="fu">텍스트 연결</span>(가장자리),<span class="at">헤더 =</span> <span class="cn">거짓</span>))</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a>sg<span class="ot">=</span> <span class="fu">그래프 _from_data_frame</span>(df,<span class="at">지시 =</span> <span class="cn">거짓</span>))</span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a>sg</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>이그랩 1467322 UN- 6 5- 
+ attr : 이름 (V/C)
+ 1467322의 가장자리 (정점 이름) :
[1] 1-3 2-3 3-4 4-6 4-5</code></pre>
</div>
</div>
<p>일반적으로 사용합니다<code>read.csv</code>기능 별도 파일에서 From-to Table을 읽을 수 있습니다. 여기서 책의 저자는 문자열을 만들기로 결정했습니다.<code>가장자리</code>즉, 함수를 사용하여 파일과 동등한 것으로 바뀌려면<code>텍스트 연결</code>, 예제를보다 컴팩트하게 유지하려면. 표기법<code>"\N"</code>라인 브레이크를 나타냅니다.</p>
</div>
</div>
</div>
<section class="level4 unnumbered" id="elements-of-a-simple-graph">
<h4 class="unnumbered anchored" data-anchor-id="elements-of-a-simple-graph">간단한 그래프의 요소</h4>
<ul>
<li><p>노드 또는 정점. 이들은 숫자가있는 색깔의 원입니다.<a class="quarto-xref" href="#fig-igraphplot">수치<span>10.2</span></a>.</p></li>
<li><p>가장자리 또는 연결, 노드를 연결하고 지시 될 수있는 세그먼트.</p></li>
<li><p>가장자리 속성, 그러한 가장자리 길이. 지정되지 않은 경우 가장자리 길이가 모두 동일하다고 가정합니다. 예를 들어, 그래프에서 두 노드 사이의 거리를 계산하기 위해 가장 짧은 경로를 따라 가장자리의 길이를 요약합니다.</p></li>
<li><p>모서리 및 노드 속성 : 선택적으로, 각 모서리 또는 각 노드는 유형, 색상, 무게, 모서리 너비, 노드 크기와 같은 추가 연속 또는 범주 형 변수에 매핑 될 수 있습니다.<span class="math inline">\ (... \)</span>응용 프로그램과 의도 된 계산에 따라 여기에서 거의 모든 것이 가능합니다.</p></li>
</ul>
<p>우리는 또한 가장자리 길이의 지시 된 그래프를 호출합니다.<strong>회로망</strong>. 네트워크의 인접 행렬은 an입니다<span class="math inline">\ (n \ times n \)</span>모서리 길이에 해당하는 양수의 매트릭스.</p>
</section>
<section class="level4 unnumbered page-columns page-full" id="basic-concepts">
<h4 class="unnumbered anchored" data-anchor-id="basic-concepts">기본 개념</h4>
<p>그만큼<em>도</em>노드는 연결된 가장자리 수입니다. 지시 된 그래프에서 우리는 차별화됩니다<em>도전</em>그리고<em>외부</em>들어오고 나가는 가장자리를 위해. 사이클이 포함 된 지시 된 그래프와 (순환 및 acyclic 그래프라고 함) 지시 된 그래프를 더욱 구별 할 수 있습니다.</p>
<p>큰 그래프의 경우, on은 정점 도의 분포를 살펴보면 전체 그래프 구조를 요약 할 수 있으며, 특히 흥미로운 영역이나 특정 노드와 중심성 및 사이의 측정 값으로 그래프에서 가장자리를 식별 할 수 있습니다. 이러한 조치는 다양한 패키지로 제공됩니다 (<strong><a href="https://cran.r-project.org/web/packages/network/">회로망</a></strong>,,,<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>).</p>
<p>가장자리 수가 노드 수와 동일한 순서 인 경우<span class="math inline">\ (\#and \ 예 o (\ #v) \)</span>), 우리는 그래프가 있다고 말합니다<strong>부족한</strong>. 일부 그래프에는 패키지에 많은 노드가 있습니다<strong><a href="https://bioconductor.org/packages/ppiData/">ppidata</a></strong>예측 된 단백질 상호 작용을 함유합니다.<code>ppipred</code>) 약 200000 모서리를 가진 약 2500 개의 단백질의 그래프<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>. 이러한 그래프에 대한 완전한 인접 매트릭스에는 6 백만 개 이상의 메모리 단위가 필요하며 그 중 대부분에는 0이 포함되어 있습니다. 이것은 불필요하게 낭비됩니다. 동일한 그래프의 가장자리 목록 표현은 더 작습니다. 가장자리가있는 곳에서만 스토리지 만 사용합니다.이 예에서는 200000 메모리 단위에 해당합니다. 가장자리 목록 표현의 특별한 선택 중 하나는 패키지에서 구현 된 스파스 매트릭스 인코딩입니다.<strong><a href="https://cran.r-project.org/web/packages/Matrix/">행렬</a></strong>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>유전자 및 종 계통 발생은 훨씬 더 클 수 있습니다.</p></div></div><p>반면에, a<strong>밀집한</strong>그래프, 가장자리의 수는 잠재적 인 가장자리의 수, 즉 노드 수의 제곱과 동일한 순서입니다.<span class="math inline">\ (\ #e \ 예 o (\#v^2) \)</span>. 메모리 공간은 큰 밀도가 큰 그래프를 저장하는 데 문제가 될 수 있습니다.</p>
</section>
<section class="level4 unnumbered" id="graph-layout">
<h4 class="unnumbered anchored" data-anchor-id="graph-layout">그래프 레이아웃</h4>
<p>우리는 미적 또는 실제적인 이유로 동일한 그래프가 다른 방식으로 표시되는 몇 가지 예를 보게 될 것입니다. 이것은 선택을 통해 이루어집니다<strong>그래프 레이아웃</strong>.</p>
<p>가장자리가 거리를 나타내는 길이가있는 경우 그래프의 2D 표현 문제는 우리가 본 다차원 스케일링과 동일합니다.<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>그것은 종종 정점 포인트를 가능한 한 많이 확산시켜 비슷한 방식으로 해결됩니다. 길이가없는 간단한 가장자리의 경우 알고리즘은 다른 기준을 선택할 수 있습니다. Fruchterman과 Reingold의 방법은 기본적인 선택입니다. 그것은 (Newtonian) 물리적 힘의 영향을받는 것처럼 비슷한 점이 서로를 끌어 들이고 격퇴하는 물리에서 영감을 얻은 모델을 기반으로합니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>사용하십시오<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>다음을 수행 할 패키지</p>
<ul>
<li><p>12 개의 노드와 50 개 이상의 모서리가있는 밀도가 높은 랜덤 그래프를 만듭니다.</p></li>
<li><p>다른 레이아웃으로 그래프를 플로팅하는 실험 : 노드를 원에 놓거나 가능한 한 대칭 적으로 그래프를 표시하고 겹치는 노드 나 모서리를 피하십시오.</p></li>
</ul>
</div>
</div>
</section>
<section class="level4 unnumbered page-columns page-full" id="graphs-from-data">
<h4 class="unnumbered anchored" data-anchor-id="graphs-from-data">데이터의 그래프</h4>
<p>일반적으로 데이터는 그래프 형태로 도착하지 않습니다. 그래픽 또는 네트워크 표현은 종종 다른 데이터 유형에서 변환 한 결과입니다.</p>
<p><strong>거리 또는 유사점에서 :</strong>그래프는 객체를 이항하여 거리 또는 유사성 관계를 단순화 할 수 있습니다. 노드는 비슷하거나 가까운 경우 연결되어 있으며 그렇지 않은 경우 연결되지 않습니다. 따라서 입력은 관심있는 물체의 모든 쌍 (유전자, 단백질, 종, 표현형, 유사성 또는 거리 측정입니다.<span class="math inline">\ (... \)</span>), 임계 값이 적용됩니다. 조치 세트는 조밀 한 매트릭스로 실현되거나 즉시 계산 될 수 있습니다.</p>
<p><strong>이중 파파트 그래프 :</strong>일부 데이터는 두 가지 유형의 물체, 예를 들어 갈라파고스 군도의 핀치 종과 섬 사이의 결석 또는 존재 관계로 자연스럽게 도착합니다 (<a class="quarto-xref" href="#fig-bipartite">수치<span>10.4</span></a>) 또는 전사 인자 및 유전자 조절 영역이 결합하는 것으로 간주됩니다. 이러한 관계는 직사각형 매트릭스에서 0/1 값으로 인코딩 될 수 있으며, 여기서 행은 한 객체 유형을 나타내고 다른 열은 열을 나타냅니다. 결과 그래프에는 두 가지 유형의 노드 (예 : Finch-Node와 Island-Node)가 있으며, 예를 들어 분류와 섬 사이의 다른 유형의 노드 사이에만 가장자리가 존재할 수 있지만 분류군이나 섬 사이에는 존재할 수 있습니다. 가장자리<a class="quarto-xref" href="#fig-bipartite">수치<span>10.4</span></a>대표하다<em>계속 살고 있습니다</em>관계.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-bipartite">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bipartite-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="imgs/BipartiteTaxa.png" title="Figure 10.4: This bipartite graph connects each taxon to the sites where it was observed."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BipartiteTaxa.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bipartite-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.4 : 이것<strong>양파</strong>그래프는 각 분류를 관찰 된 사이트에 연결합니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-finches">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.3</div>
</div>
<div class="callout-body-container callout-body">
<p>로드<code>Finch.CSV</code>데이터와 실험은 이들이 이중 파파트 네트워크를 나타내는 것을 강조하기 위해 그것들을 플로팅합니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-7-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-7-contents callout-collapse collapse" id="callout-7">
<div class="callout-body-container callout-body">
<p>다음 코드의 출력이 표시됩니다<a class="quarto-xref" href="#fig-finches-1">수치<span>10.5</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a>핀치<span class="ot">=</span>readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"../data/finch.csv"</span>,,,<span class="at">주석 =</span> <span class="st">"#"</span>,,,<span class="at">col_types =</span> <span class="st">"CC"</span>))</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a>핀치</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 122 × 2
   . 테일. 헤드             
   &lt;CHR&gt; &lt;CHR&gt;             
 1 C 큰 지상 핀치
 2 D 대형 지상 핀치
 3 e 큰 지상 핀치
 4 f 큰 그라운드 핀치
 5 g 큰 지상 핀치
 6 H 큰 지상 핀치
 7 나는 큰 그라운드 핀치
 8 J 대형 지상 핀치
 9 l 큰 지상 핀치
10 m 대형 지상 핀치
# 112 줄이 더 있습니다</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"회로망"</span>))</span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a>핀치 .nw<span class="ot">=</span> <span class="fu">as.network</span>(핀치,<span class="at">이분자 =</span> <span class="cn">진실</span>,,,<span class="at">지시 =</span> <span class="cn">거짓</span>))</span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3" tabindex="-1"></a>IS.ISLAND<span class="ot">=</span> <span class="fu">NCHAAR</span>(<span class="fu">Network.vertex.names</span>(Finch.nw)))<span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4" tabindex="-1"></a><span class="fu">구성</span>(Finch.nw,<span class="at">vertex.cex =</span> <span class="fl">2.5</span>,,,<span class="at">displayLabels =</span> <span class="cn">진실</span>,,,</span>
<span id="cb7-5"><a aria-hidden="true" href="#cb7-5" tabindex="-1"></a>     <span class="at">vertex.col =</span> <span class="fu">ifelse</span>(IS.ISLAND,<span class="st">"포레스트 그린"</span>,,,<span class="st">"3"</span>),)</span>
<span id="cb7-6"><a aria-hidden="true" href="#cb7-6" tabindex="-1"></a>     <span class="at">레이블 =</span> <span class="fu">보결</span>(<span class="st">"핀치"</span>,,,<span class="st">"" "</span>,,,<span class="fu">Network.vertex.names</span>(Finch.nw))))</span>
<span id="cb7-7"><a aria-hidden="true" href="#cb7-7" tabindex="-1"></a>핀치 .nw<span class="sc">|&gt;</span> <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">티</span>() <span class="sc">|&gt;</span>(\ (x) x [,<span class="fu">주문하다</span>(<span class="fu">colnames</span>(엑스))])()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A B C D E F G H I J K L M N O P Q
큰 그라운드 핀치 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
중간 그라운드 핀치 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0
작은 지상 핀치 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
날카로운 고리 지상 핀치 0 1 1 1 0 1 0 1 0 1 1 1 1 1
Cactus Ground Finch 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0
큰 선인장 지상 핀치 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0
큰 나무 핀치 0 0 1 1 1 1 1 1 1 0 1 0 1 1 0 0
중간 트리 핀치 0 0 0 0 0 0 0 0 0 0 0 0 0 0
작은 나무 핀치 0 0 1 1 1 1 1 1 1 1 1 0 1 0 1 0 0
채식 핀치 0 0 1 1 1 1 1 1 1 1 0 1 1 1 0 0
딱따구리 핀치 0 0 1 1 1 0 1 0 1 0 0 0 0 0 0
맹그로브 핀치 0 0 1 0 0 0 0 0 0 0 0 0 0 0
워 블러 핀치 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-finches-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-finches-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="10-chap_files/figure-html/fig-finches-1-1.png" title="Figure 10.5: The finches graph. There are many ways to improve the layout, including better taking into account the bipartite nature of the graph."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-finches-1-1.png" style="width:85.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-finches-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.5 :<code>핀치</code>그래프. 그래프의 이중 특성을 더 잘 고려하는 것을 포함하여 레이아웃을 개선하는 방법에는 여러 가지가 있습니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-ggnetworkong1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.4</div>
</div>
<div class="callout-body-container callout-body">
<p>그래프의 플롯을 만드십시오<code>G1</code>사용<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>레이아웃을 선택하고 다음과 같이 제공 한 Geoms가있는 패키지<code>geom_edge_link</code>,,,<code>geom_node_point</code>그리고<code>geom_node_text</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-9-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-9-contents callout-collapse collapse" id="callout-9">
<div class="callout-body-container callout-body">
<p>다음 코드의 출력이 표시됩니다<a class="quarto-xref" href="#fig-ggnetworkong1-1">수치<span>10.6</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggraph"</span>))</span>
<span id="cb9-2"><a aria-hidden="true" href="#cb9-2" tabindex="-1"></a><span class="fu">ggraph</span>(G1,<span class="at">레이아웃 =</span> <span class="st">"훌륭하게"</span>))<span class="sc">+</span> </span>
<span id="cb9-3"><a aria-hidden="true" href="#cb9-3" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span> </span>
<span id="cb9-4"><a aria-hidden="true" href="#cb9-4" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">크기 =</span><span class="dv">6</span>,,,<span class="at">색상 =</span><span class="st">"#8856A7"</span>))<span class="sc">+</span> </span>
<span id="cb9-5"><a aria-hidden="true" href="#cb9-5" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="at">레이블 =</span><span class="fu">vertex_attr</span>(G1)<span class="sc">$</span>이름,<span class="at">색상 =</span><span class="st">"하얀색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ggnetworkong1-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggnetworkong1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="10-chap_files/figure-html/fig-ggnetworkong1-1-1.png" title="Figure 10.6: A ggraph example."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-ggnetworkong1-1-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggnetworkong1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.6 : a<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>예.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="level4 unnumbered page-columns page-full" id="an-example-a-four-state-markov-chain">
<h4 class="unnumbered anchored" data-anchor-id="an-example-a-four-state-markov-chain">예 : 4 개의 주 마르코프 체인</h4>
<p>~ 안에<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>, 우리는 Markov 체인이 뉴클레오티드 (시스템 상태로 간주) 사이의 전이를 요약 할 수있는 방법을 보았다. 이것은 종종 그래프로 구성됩니다. 그만큼<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>패키지는 그래프 "장식"에 대한 많은 선택을 제공합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Markovchain"</span>))</span>
<span id="cb10-2"><a aria-hidden="true" href="#cb10-2" tabindex="-1"></a>주 이름<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"에이"</span>,,,<span class="st">"기음"</span>,,,<span class="st">"G"</span>,,,<span class="st">"티"</span>))</span>
<span id="cb10-3"><a aria-hidden="true" href="#cb10-3" tabindex="-1"></a>T1MC<span class="ot">=</span> <span class="fu">새로운</span>(<span class="st">"Markovchain"</span>,,,<span class="at">상태 =</span>주 이름,<span class="at">TransitionMatrix =</span></span>
<span id="cb10-4"><a aria-hidden="true" href="#cb10-4" tabindex="-1"></a>  <span class="fu">행렬</span>(<span class="fu">기음</span>(<span class="fl">0.2</span>,,,<span class="fl">0.1</span>,,,<span class="fl">0.4</span>,,,<span class="fl">0.3</span>,,,<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="fl">0.1</span>,,,<span class="fl">0.2</span>,,,<span class="fl">0.2</span>,,,<span class="fl">0.5</span>,,,<span class="fl">0.1</span>,,,<span class="fl">0.1</span>,,,<span class="fl">0.8</span>,,,<span class="fl">0.0</span>),)</span>
<span id="cb10-5"><a aria-hidden="true" href="#cb10-5" tabindex="-1"></a>         <span class="at">nrow =</span> <span class="dv">4</span>,,,<span class="at">Byrow =</span> <span class="cn">진실</span>,,,<span class="at">dimnames =</span> <span class="fu">목록</span>(StatesNames, StatesNames))))</span>
<span id="cb10-6"><a aria-hidden="true" href="#cb10-6" tabindex="-1"></a><span class="fu">구성</span>(T1MC,<span class="at">Edge.arrow.size =</span> <span class="fl">0.4</span>,,,<span class="at">vertex.color =</span> <span class="st">"보라"</span>,,,</span>
<span id="cb10-7"><a aria-hidden="true" href="#cb10-7" tabindex="-1"></a>     <span class="at">edge.arrow.width =</span> <span class="fl">2.2</span>,,,<span class="at">edge.width =</span> <span class="dv">5</span>,,,<span class="at">edge.color =</span> <span class="st">"파란색"</span>,,,</span>
<span id="cb10-8"><a aria-hidden="true" href="#cb10-8" tabindex="-1"></a>     <span class="at">Edge.curved =</span> <span class="cn">진실</span>,,,<span class="at">edge.label.cex =</span> <span class="fl">2.5</span>,,,<span class="at">vertex.size =</span> <span class="dv">32</span>,,,</span>
<span id="cb10-9"><a aria-hidden="true" href="#cb10-9" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> <span class="fl">3.5</span>,,,<span class="at">edge.loop.angle =</span> <span class="dv">3</span>,,,</span>
<span id="cb10-10"><a aria-hidden="true" href="#cb10-10" tabindex="-1"></a>     <span class="at">vertex.label.family =</span> <span class="st">"산"</span>,,,<span class="at">vertex.label.color =</span> <span class="st">"하얀색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-fourstateMC">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fourstateMC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-8" href="imgs/MarkovACGT.png" title="Figure 10.7: A four state Markov chain with arrows representing possible transitions between states."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/MarkovACGT.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourstateMC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.7 : 상태간에 가능한 전이를 나타내는 화살표가있는 4 개의 상태 Markov 체인.</figcaption>
</figure>
</div>
</div></div></div>
<p>Markov 체인은 동적 시스템의 간단한 모델이며, 상태는 그래프의 노드로 표시됩니다. 전이 행렬은 우리에게 무게를 제공합니다<strong>지시</strong>상태 사이의 가장자리 (화살표).</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-MCgraph">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.5</div>
</div>
<div class="callout-body-container callout-body">
<p>이 Markov 체인이 끝날 것이라고 생각하십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-11-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-11-contents callout-collapse collapse" id="callout-11">
<div class="callout-body-container callout-body">
<p>C를 제외한 모든 노드에는 나가는 가장자리가 있으며, C는 단지 인상된 가장자리와 자체 에지 만 가지고 있습니다. 따라서 C는 흡수 상태입니다. 조만간이 체인의 모든 프로세스가 끝나고 C에 유지됩니다.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>당신의 변화를 시도하십시오<code>set.seed</code>함수 입력 및 플롯이 변경되는지 확인하십시오.</p></li>
<li><p>이 특정의 도움에 액세스하십시오<code>구성</code>기능.</p></li>
<li><p>그래프를 다시 실행하고 브라운의 녹색 및 정점에서 전이 확률로 가장자리에 라벨을 붙입니다.</p></li>
</ol>
</div>
</div>
<p>우리는 주석이 달린 상태 공간 마르코프 체인 그래프의 완전한 예를 구축하는 방법을 볼 것입니다.<a class="quarto-xref" href="#imp-graphs-PNASMarkov">운동<span>10.3</span></a>.</p>
</section>
</section>
<section class="level3" data-number="10.2.2" id="sec-graphs-layers">
<h3 class="anchored" data-anchor-id="sec-graphs-layers" data-number="10.2.2"><span class="header-section-number">10.2.2</span>많은 레이어가있는 그래프 : 가장자리와 노드의 레이블</h3>
<p>다음은<a href="https://string-db.org">끈</a>정점에 주석이있는 데이터베이스.</p>
<div class="cell" data-layout-align="center" data-warning.known="unlabeled data points">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a>datf<span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"../data/string_graph.txt"</span>,,,<span class="at">헤더 =</span> <span class="cn">진실</span>))</span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>Grs<span class="ot">=</span> <span class="fu">그래프 _from_data_frame</span>(datf [,<span class="fu">기음</span>(<span class="st">"node1"</span>,,,<span class="st">"node2"</span>)], <span class="at">지시 =</span> <span class="cn">거짓</span>))</span>
<span id="cb11-3"><a aria-hidden="true" href="#cb11-3" tabindex="-1"></a><span class="fu">이자형</span>(GRS)<span class="sc">$</span>무게<span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb11-4"><a aria-hidden="true" href="#cb11-4" tabindex="-1"></a><span class="fu">다섯</span>(GRS)<span class="sc">$</span>크기<span class="ot">=</span> <span class="fu">centr_degree</span>(GRS)<span class="sc">$</span>해안</span>
<span id="cb11-5"><a aria-hidden="true" href="#cb11-5" tabindex="-1"></a><span class="fu">ggraph</span>(GRS)<span class="sc">+</span></span>
<span id="cb11-6"><a aria-hidden="true" href="#cb11-6" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>,,,<span class="at">강도 =</span> <span class="fl">0.05</span>,,,<span class="at">알파 =</span> <span class="fl">0.8</span>))<span class="sc">+</span></span>
<span id="cb11-7"><a aria-hidden="true" href="#cb11-7" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">크기 =</span> <span class="fl">2.5</span>,,,<span class="at">알파 =</span> <span class="fl">0.5</span>,,,<span class="at">색상 =</span> <span class="st">"주황색"</span>))<span class="sc">+</span></span>
<span id="cb11-8"><a aria-hidden="true" href="#cb11-8" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span><span class="fu">vertex_attr</span>(GRS)<span class="sc">$</span>이름),<span class="at">크기 =</span> <span class="dv">3</span>,,,<span class="at">알파 =</span> <span class="fl">0.9</span>,,,<span class="at">색상 =</span> <span class="st">"#8856A7"</span>,,,<span class="at">repel =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-completechemokine">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-completechemokine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-9" href="10-chap_files/figure-html/fig-completechemokine-1.png" title="Figure 10.8: Perturbed chemokine subnetwork uncovered in @YuGXNA using differential gene expression patterns in sorted T-cells. Notice the clique-like structure of the genes CXCR3, CXCL13, CCL19, CSCR5 and CCR7 in the right hand corner."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-completechemokine-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-completechemokine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.8 : 교란 된 케모카인 서브 네트워크가 발견되지 않았습니다<span class="citation" data-cites="YuGXNA">Yu et al. (<a href="16-chap.html#ref-YuGXNA" role="doc-biblioref">2012</a>))</span>분류 된 T- 세포에서 차등 유전자 발현 패턴을 사용한다. 오른쪽 모서리에서 유전자 CXCR3, CXCL13, CCL19, CSCR5 및 CCR7의 파악 유사 구조에 주목하십시오.</figcaption>
</figure>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-completechemokine">수치<span>10.8</span></a>GXNA를 사용한 유방암 전이 연구에서 발견 된 혼란 스러워진 케모카인 서브 네트워크를 보여줍니다.<span class="citation" data-cites="GXNA">(<a href="16-chap.html#ref-GXNA" role="doc-biblioref">Nacu et al. 2007</a>))</span>그리고 보고서<span class="citation" data-cites="YuGXNA">Yu et al. (<a href="16-chap.html#ref-YuGXNA" role="doc-biblioref">2012</a>))</span>.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="10.3" id="from-gene-set-enrichment-to-networks">
<h2 class="anchored" data-anchor-id="from-gene-set-enrichment-to-networks" data-number="10.3"><span class="header-section-number">10.3</span>유전자 설정에서 네트워크까지</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-10" href="imgs/devil.png" title="A long unstructured laundry list of possibly differentially expressed genes can be daunting."><img alt="A long unstructured laundry list of possibly differentially expressed genes can be daunting." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>구조적으로 발현 된 유전자의 긴 구조화되지 않은 세탁 목록은 어려울 수 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>~ 안에<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>, 우리는 차별적으로 발현 된 유전자 목록을 찾는 방법을 연구했습니다. 낮은 FDR을 유지하려는 노력과 함께 작은 샘플 크기는 종종 차등 발현을 감지하기위한 저전력을 초래합니다. 따라서, 차별적으로 발현 된대로 자신있게 선포 될 수있는 긴 유전자 목록을 얻는 것은 초기에 승리이다. 그러나 기본 생물학을 이해하려면 생물학적 시스템에서 중요한 플레이어의 세탁 목록 이상이 필요합니다.</p>
<section class="level3" data-number="10.3.1" id="methods-using-pre-defined-gene-sets-gsea">
<h3 class="anchored" data-anchor-id="methods-using-pre-defined-gene-sets-gsea" data-number="10.3.1"><span class="header-section-number">10.3.1</span>사전 정의 된 유전자 세트 (GSEA)를 사용하는 방법</h3>
<p>가장 빠른 접근법 중 하나는 유전자 속성을 찾는 것이 었습니다.<strong>과도하게 표현되었습니다</strong>또는<strong>풍부한</strong>중요한 유전자의 세탁 목록에서. 이들 유전자 클래스는 종종 유전자 온톨로지 (GO) 범주 (예 : 기관 성장에 관여하는 유전자 또는 공급 행동에 관여하는 유전자)를 기반으로한다. 유전자 온톨로지 (GO)는 유전자 및 유전자 생성물을 설명하는 세 가지 온톨로지의 모음입니다. 이 온톨로지는 지시 된 acyclic 그래프 (DAG)의 구조를 가진 제한된 어휘입니다. 가장 구체적인 용어는 그래프의 잎입니다. GO 그래프는 노드 (여기서는 유전자 온톨로지 용어)와보다 구체적인 용어 (어린이)에서 덜 구체적인 (부모)까지 가장자리로 구성되며, 종종 이러한 가장자리가 지시됩니다. 노드와 모서리에는 시각화 할 수있는 여러 속성이있을 수 있습니다. 실험에서 중요한 것으로 지정된 특정 유전자 세트에 대해 GO 주석을 사용하는 주요 목적은<strong>강화</strong>이 목록에서 GO 기간 동안, 우리는이 용어에 아래의 통계적 의미를 줄 것입니다. 중요한 유전자 세트의 다른 많은 유용한 목록이 존재합니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>유전자 세트의 유용한 데이터베이스를 찾으십시오.</p>
</div>
</div>
<p>예를 들어,<code>MIGDB</code>분자 시그니처 데이터베이스<span class="citation" data-cites="MSigDB">(<a href="16-chap.html#ref-MSigDB" role="doc-biblioref">Liberzon et al. 2011</a>))</span>기능을 사용하여 R 내에서 액세스 할 수있는 많은 유전자 세트가 포함되어 있습니다.<code>GetBroadsets</code>바이오 컨덕터 패키지에서<strong><a href="https://bioconductor.org/packages/GSEABase/">GSEABASE</a></strong>대략 다음과 같이 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"gseabase"</span>))</span>
<span id="cb12-2"><a aria-hidden="true" href="#cb12-2" tabindex="-1"></a><span class="do">## 웹 사이트에 로그인해야합니다.</span></span>
<span id="cb12-3"><a aria-hidden="true" href="#cb12-3" tabindex="-1"></a>FL<span class="ot">=</span>  <span class="st">"/path/to/msigdb_v5.1.xml"</span></span>
<span id="cb12-4"><a aria-hidden="true" href="#cb12-4" tabindex="-1"></a>GSS<span class="ot">=</span>  <span class="fu">GetBroadsets</span>(FL)</span>
<span id="cb12-5"><a aria-hidden="true" href="#cb12-5" tabindex="-1"></a><span class="fu">유기체</span>(GSS [[<span class="dv">1</span>]]))</span>
<span id="cb12-6"><a aria-hidden="true" href="#cb12-6" tabindex="-1"></a><span class="fu">테이블</span>(<span class="fu">Sapply</span>(GSS, 유기체)))))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="10.3.2" id="sec-graphs-GSEA">
<h3 class="anchored" data-anchor-id="sec-graphs-GSEA" data-number="10.3.2"><span class="header-section-number">10.3.2</span>양방향 테이블 테스트를 통한 유전자 세트 분석</h3>
<div class="cell page-columns page-full" data-layout-align="center" data-tbl-cap-location="top">
<div class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center" data-tbl-cap-location="top" id="tbl-hypergeom">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hypergeom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">표 10.1 : 각 범주의 유전자가 같은 수의 유전자가 있습니다.<em>중요한</em>세트, 아래 시뮬레이션과 양방향 테이블의 테스트 이론은 파란색 범주가 풍부하다는 것을 보여줍니다.</figcaption>
<div aria-describedby="tbl-hypergeom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">노란색</th>
<th style="text-align: right;">파란색</th>
<th style="text-align: right;">빨간색</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">중요한</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">우주</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">400</td>
</tr>
</tbody>
</table>
</div></div></div>
</figure>
</div>
</div>
<p>여기서 우리는 자주 불리는 기본 접근법을 설명하는 것으로 시작합니다.<strong>Fisher의 "정확한"테스트</strong>또는<strong>초 지오메트리 테스트</strong>잉.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-11" href="imgs/devil.png" title="So-called ‘exact’ tests because they are nonparametric and based on exhaustive enumerations: not because we are sure of the answer – this is statistics after all."><img alt="So-called ‘exact’ tests because they are nonparametric and based on exhaustive enumerations: not because we are sure of the answer – this is statistics after all." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>소위 '정확한'테스트는 비모수 적이며 철저한 열거를 기반으로하기 때문에 :<strong>~ 아니다</strong>우리는 답을 확신하기 때문에 - 이것은 결국 통계입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>잠재적으로 중요 할 수있는 후보 유전자의 우주를 정의하고; 이 우주는 크기라고 말합니다<span class="math inline">\(N\)</span>. 우리는 또한 실제로 유전자에 대한 기록이 있습니다.<strong>했다</strong>우리가 그곳에 있다고 생각하는 중요한 것입니다<span class="math inline">\(중\)</span>.</p>
<p>우리는 상자에 공을 포함하는 장난감 모델을 만듭니다.<span class="math inline">\(N\)</span>유전자 우주에서 확인 된 유전자에 해당하는 공. 이 유전자는 다른 기능 범주로 나뉘어져 있습니다.<span class="math inline">\ (n = 1,000 \)</span>500은 노란색이고 100은 파란색이고 400은 빨간색입니다. 그런 다음 하위 집합<span class="math inline">\ (M = 75 \)</span>유전자는 다음과 같이 표시됩니다<strong>중요한</strong>,이 상당히 흥미로운 유전자들 중에서 25 노란색, 25 개의 빨간색 및 25 파란색이 있다고 가정합니다. 파란색 카테고리가 풍부하거나 과도하게 표현됩니까?</p>
<p>우리는이 하이퍼 게오 메트릭 양방향 테이블 테스트를 사용하여 일부 범주는 매우 많고 다른 범주는 드물다는 사실을 설명합니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-simulationFishertest">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.6</div>
</div>
<div class="callout-body-container callout-body">
<p>20,000 개의 시뮬레이션으로 Monte Carlo 실험을 실행하고 중요한 세트에서 범주가 과도하게 표현되지 않는다는 귀무 가설에서 25 개의 블루를 갖는 P- 값을 계산하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-15-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-15-contents callout-collapse collapse" id="callout-15">
<div class="callout-body-container callout-body">
<p>널 아래에서 75는 다음과 같이 우리의 불평등 한 상자에서 무작위로 샘플링됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a>우주<span class="ot">=</span> <span class="fu">기음</span>(<span class="fu">대표</span>(<span class="st">"노란색"</span>,,,<span class="dv">500</span>),)<span class="fu">대표</span>(<span class="st">"파란색"</span>,,,<span class="dv">100</span>),)<span class="fu">대표</span>(<span class="st">"빨간색"</span>,,,<span class="dv">400</span>)))</span>
<span id="cb13-2"><a aria-hidden="true" href="#cb13-2" tabindex="-1"></a>Countblue<span class="ot">=</span> <span class="fu">뒤로 젖히다</span>(<span class="dv">20000</span>, {</span>
<span id="cb13-3"><a aria-hidden="true" href="#cb13-3" tabindex="-1"></a>pick75<span class="ot">=</span> <span class="fu">견본</span>(우주,<span class="dv">75</span>,,,<span class="at">교체 =</span> <span class="cn">거짓</span>))</span>
<span id="cb13-4"><a aria-hidden="true" href="#cb13-4" tabindex="-1"></a>  <span class="fu">합집합</span>(pick75<span class="sc">==</span> <span class="st">"파란색"</span>))</span>
<span id="cb13-5"><a aria-hidden="true" href="#cb13-5" tabindex="-1"></a>})</span>
<span id="cb13-6"><a aria-hidden="true" href="#cb13-6" tabindex="-1"></a><span class="fu">요약</span>(Countblue)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>최소 1st qu.  중앙값 평균 3 번째 qu.    맥스. 
  0.000 6,000 7,000 7,496 9,000 20,000</code></pre>
</div>
</div>
<p>히스토그램<a class="quarto-xref" href="#fig-histblue">수치<span>10.9</span></a>NULL 모델에서 25의 값을 갖는 것은 극히 드 rare니다.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-histblue">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histblue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="10-chap_files/figure-html/fig-histblue-1.png" title="Figure 10.9: We can see that even in 20000 simulations, no blue count comes close to being 25. We can reject such an event as having happened by chance and conclude that the blue are enriched."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-histblue-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histblue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.9 : 200000 시뮬레이션에서도 파란색 수가 25 일에 가까워지는 것을 알 수 있습니다. 우연히 발생한 이벤트를 거부하고 파란색이<strong>풍부한</strong>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>일반적으로 유전자 우주는<span class="math inline">\(N\)</span>우리가 선택하면 공<span class="math inline">\(중\)</span>무작위로 볼은 비율이 있습니다<span class="math inline">\ (k/n \)</span>파란 공, 우리는 볼 것으로 예상합니다<span class="math inline">\ (km/n \)</span>크기의 파란색 공<span class="math inline">\(케이\)</span>.</p>
<section class="level4 unnumbered page-columns page-full" id="plotting-gene-enrichment-networks-with-goplot">
<h4 class="unnumbered anchored" data-anchor-id="plotting-gene-enrichment-networks-with-goplot">유전자 농축 네트워크를 플로팅합니다<strong><a href="https://cran.r-project.org/web/packages/GOplot/">Goplot</a></strong></h4>
<p>여기 우리는 유전자 기능 범주와 중요한 유전자 세트 사이의 연결을 요약하는 매력적인 방법을 보여줍니다.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known='["for a discrete variable is not advised","rows containing missing values"]'>
<div class="sourceCode cell-code" data-cap-location="margin" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Goplot"</span>))</span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"EC"</span>))</span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a>회로<span class="ot">=</span>  <span class="fu">Circle_dat</span>(EC<span class="sc">$</span>David, EC<span class="sc">$</span>일반 주의자)</span>
<span id="cb15-4"><a aria-hidden="true" href="#cb15-4" tabindex="-1"></a>현<span class="ot">=</span>  <span class="fu">chord_dat</span>(Circ, Ec<span class="sc">$</span>유전자, EC<span class="sc">$</span>프로세스)</span>
<span id="cb15-5"><a aria-hidden="true" href="#cb15-5" tabindex="-1"></a><span class="fu">경비원</span>(현,<span class="at">한계 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">5</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-GOplotEC">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-GOplotEC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="10-chap_files/figure-html/fig-GOplotEC-1.jpeg" title="Figure 10.10: This graph shows the correspondence between GO terms and significantly changed genes in a study on differential expression in endothelial cells from two steady state tissues (brain and heart, see @Nolan:2013). After normalization a differential expression analysis was performed giving a list of genes. A gene-annotation enrichment analysis of the set of differentially expressed genes (adjusted p-value &lt; 0.05) was then performed with the GOplot package."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-GOplotEC-1.jpeg" width="880"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-GOplotEC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.10 :이 그래프는 두 개의 정상 상태 조직 (뇌와 심장, 참조)의 내피 세포에서의 차등 발현에 대한 연구에서 GO 용어와 유의하게 변화된 유전자 사이의 대응을 보여줍니다.<span class="citation" data-cites="Nolan:2013">Nolan et al. (<a href="16-chap.html#ref-Nolan:2013" role="doc-biblioref">2013</a>))</span>). 정규화 후 유전자 목록을 제공하는 차등 발현 분석이 수행되었다. 이어서, 차등 적으로 발현 된 유전자 세트 (조정 된 p- 값 &lt;0.05)의 유전자-공유 농축 분석을<strong><a href="https://cran.r-project.org/web/packages/GOplot/">Goplot</a></strong>패키지.</figcaption>
</figure>
</div>
</div>
</div>
<p>사실, 유전자 온톨로지 그래프가 반드시 의미있는 것을 포착 할 필요는 없습니다.<em>유전자 상호 작용</em>다른 과정의 유전자는 종종 생산적으로 상호 작용합니다. 예를 들어, 많은 양의 정보는 사용되지 않은 상태로 남아 있습니다. 예를 들어, 모든 중요한 유전자는 p- 값의 잠재적으로 큰 변화에도 불구하고 일반적으로 동일한 중량이 주어집니다.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="10.3.3" id="significant-subgraphs-and-high-scoring-modules">
<h3 class="anchored" data-anchor-id="significant-subgraphs-and-high-scoring-modules" data-number="10.3.3"><span class="header-section-number">10.3.3</span>중요한 하위 그래프 및 높은 점수 모듈</h3>
<p>우리는 단순한 유전자 온톨로지 이상의 처분을 가지고 있습니다. 우리가 선택할 수있는 여러 가지 유전자 네트워크 데이터베이스가 있습니다.<strong>알려진 골격</strong>우리는 차등 발현 실험의 p- 값과 같은 유의점 점수를 투영하는 그래프. 우리는 처음 제안한 아이디어를 따를 것입니다<span class="citation" data-cites="Ideker:2002">Ideker et al. (<a href="16-chap.html#ref-Ideker:2002" role="doc-biblioref">2002</a>))</span>. 이것은 더욱 발전되었습니다<span class="citation" data-cites="GXNA">Nacu et al. (<a href="16-chap.html#ref-GXNA" role="doc-biblioref">2007</a>))</span>. 생체 전도기 패키지로 많은 개선 사항이있는 신중한 구현이 가능합니다.<strong><a href="https://bioconductor.org/packages/BioNet/">비오넷</a></strong> <span class="citation" data-cites="BioNet">(<a href="16-chap.html#ref-BioNet" role="doc-biblioref">Beisser et al. 2010 년</a>))</span>. 이러한 방법은 모두 특히 보이는 스코어 스켈레톤 네트워크의 하위 그래프 또는 모듈을 검색합니다.<strong>교란</strong>.</p>
<p>네트워크의 각 유전자-노드에는 T-Statistic 또는 P- 값에서 계산할 수있는 점수가 할당됩니다. 종종 경로는 상향 조절 된 유전자 및 하향 조절 된 유전자를 모두 함유하고; 지적한대로<span class="citation" data-cites="Ideker:2002">Ideker et al. (<a href="16-chap.html#ref-Ideker:2002" role="doc-biblioref">2002</a>))</span>, 이것은 테스트 통계의 절대 값을 취하거나 p- 값에서 계산 된 점수를 통합하여 캡처 할 수 있습니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>. <span class="citation" data-cites="BioNet">Beisser et al. (<a href="16-chap.html#ref-BioNet" role="doc-biblioref">2010 년</a>))</span>우리가했던 것처럼 유전자의 p- 값을 모델링하십시오.<a class="quarto-xref" href="06-chap.html"><span>6 장</span></a>: p- 값이 균일하게 분포 될 수있는 비 교란 유전자의 혼합물 및 교란 된 유전자로부터 균일하게 분포 된 p- 값. 다음 p- 값에 대한 베타 분포를 사용하여 데이터의 신호를 모델링합니다.<span class="citation" data-cites="Pounds2003">파운드와 모리스 (<a href="16-chap.html#ref-Pounds2003" role="doc-biblioref">2003</a>))</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>우리는 같은 것을 원할 것입니다<span class="math inline">\ (-\ log p \)</span>작은 p- 값이 큰 점수를줍니다.</p></div></div><p>노드 스코어링 기능을 감안할 때, 우리는 그래프에서 연결된 핫스팟, 즉 높은 결합 점수를 가진 유전자의 하위 그래프를 검색합니다.</p>
<section class="level4 unnumbered" id="using-a-subgraph-search-algorithm">
<h4 class="unnumbered anchored" data-anchor-id="using-a-subgraph-search-algorithm">서브 그래프 검색 알고리즘 사용</h4>
<p>일반 그래프의 최대 점수 서브 그래프를 찾는 것은 일반적으로 다루기 어려운 것으로 알려져 있습니다 (우리는 그것이 NP- 하드 문제라고합니다). 따라서 다양한 대략적인 알고리즘이 제안되었습니다.<span class="citation" data-cites="Ideker:2002">Ideker et al. (<a href="16-chap.html#ref-Ideker:2002" role="doc-biblioref">2002</a>))</span>시뮬레이션 된 어닐링을 사용하는 것을 제안하지만, 이것은 느리고 해석하기 어려운 큰 서브 그래프를 생성하는 경향이 있습니다.<span class="citation" data-cites="GXNA">Nacu et al. (<a href="16-chap.html#ref-GXNA" role="doc-biblioref">2007</a>))</span>종자 정점으로 시작하여 점차적으로 주변을 확장합니다.<span class="citation" data-cites="BioNet">Beisser et al. (<a href="16-chap.html#ref-BioNet" role="doc-biblioref">2010 년</a>))</span>소위 최소 스패닝 트리 (MST)로 검색을 시작했습니다.이 장의 뒷부분에서 공부할 그래프입니다.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="10.3.4" id="an-example-with-the-bionet-implementation">
<h3 class="anchored" data-anchor-id="an-example-with-the-bionet-implementation" data-number="10.3.4"><span class="header-section-number">10.3.4</span>Bionet 구현의 예</h3>
<div class="page-columns page-full"><p>이 방법을 설명하기 위해 데이터에서 데이터를 표시합니다<strong><a href="https://bioconductor.org/packages/BioNet/">비오넷</a></strong>패키지.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">그만큼<code>상호 작용</code>데이터는 2034 개의 다른 유전자 생성물과 8399 상호 작용을 포함하는 네트워크의 연결된 구성 요소를 포함합니다. 이것은 우리가 작동 할 골격 그래프를 구성합니다.<span class="citation" data-cites="BioNet">Beisser et al. (<a href="16-chap.html#ref-BioNet" role="doc-biblioref">2010 년</a>))</span>.</span></div></div>
<p>그만큼<code>Datalym</code>관련 PVALUES를 포함합니다<span class="math inline">\(티\)</span>3,583 개의 유전자에 대한 통계에 대한 통계에 액세스하고 다음과 같이 분석을 수행 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Bionet"</span>))</span>
<span id="cb16-2"><a aria-hidden="true" href="#cb16-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"DLBCL"</span>))</span>
<span id="cb16-3"><a aria-hidden="true" href="#cb16-3" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"Datalym"</span>))</span>
<span id="cb16-4"><a aria-hidden="true" href="#cb16-4" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"상호 작용"</span>))</span>
<span id="cb16-5"><a aria-hidden="true" href="#cb16-5" tabindex="-1"></a>상호 작용</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>방향이없는 가장자리가있는 그래 넬 그래프
노드 수 = 9386 
가장자리 수 = 36504</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a>PVAL<span class="ot">=</span>Datalym<span class="sc">$</span>T.pval</span>
<span id="cb18-2"><a aria-hidden="true" href="#cb18-2" tabindex="-1"></a><span class="fu">이름</span>(PVAL)<span class="ot">=</span>Datalym<span class="sc">$</span>상표</span>
<span id="cb18-3"><a aria-hidden="true" href="#cb18-3" tabindex="-1"></a>서브넷<span class="ot">=</span> <span class="fu">서브 네트워크</span>(Datalym<span class="sc">$</span>레이블, interactome)</span>
<span id="cb18-4"><a aria-hidden="true" href="#cb18-4" tabindex="-1"></a>서브넷<span class="ot">=</span> <span class="fu">rmselfloops</span>(서브넷)</span>
<span id="cb18-5"><a aria-hidden="true" href="#cb18-5" tabindex="-1"></a>서브넷</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>방향이없는 가장자리가있는 그래 넬 그래프
노드 수 = 2559 
가장자리 수 = 7788</code></pre>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="fit-a-beta-uniform-model">
<h4 class="unnumbered anchored" data-anchor-id="fit-a-beta-uniform-model">베타 불균형 모델에 맞습니다</h4>
<div class="page-columns page-full"><p>p- 값은 우리가 연구 한 혼합물 유형에 적합합니다.<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>, 확률이있는 널의 균일 성분으로<span class="math inline">\ (\ pi_0 \)</span>및 베타 분포 (비례에 비례합니다<span class="math inline">\ (a x^{a -1} \)</span>) 대안에 해당하는 p- 값의 경우<span class="citation" data-cites="Pounds2003">(<a href="16-chap.html#ref-Pounds2003" role="doc-biblioref">파운드와 모리스 2003</a>))</span>. <span class="math display">\ [f (x | a, \ pi_0) = \ pi_0 + (1- \ pi_0) a x^{a -1} \ qquad \ mbox {for} 0 &lt;x \ leq 1; \; 0 &lt;a &lt;1 \]</span>모델로 모델을 실행합니다<span class="math display">\ [fdr \]</span>0.001 :</p><div class="no-row-height column-margin column-container"><span class="margin-aside">패키지는 실제로 다른 이름을 제공합니다<span class="math inline">\ (\\ pi_0 \)</span>: 사용합니다<span class="math inline">\ (\\ lambda \)</span>그리고 그것을 믹싱 매개 변수라고합니다.</span></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a>FB<span class="ot">=</span> <span class="fu">fitbummodel</span>(PVAL,<span class="at">플롯 =</span> <span class="cn">거짓</span>))</span>
<span id="cb20-2"><a aria-hidden="true" href="#cb20-2" tabindex="-1"></a>FB</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>베타-불균형 혼합 (BUM) 모델

3583 PVALUES가 장착되었습니다

혼합 매개 변수 (Lambda) : 0.482
모양 매개 변수 (a) : 0.180
log-likelihood : 4471.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" href="#cb22-1" tabindex="-1"></a>점수<span class="ot">=</span><span class="fu">스코로 드</span>(서브넷, FB,<span class="at">fdr =</span> <span class="fl">0.001</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="All aesthetics have length...">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotFITBum">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotFITBum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="10-chap_files/figure-html/fig-plotFITBum-1.png" title="Figure 10.11: The qqplot shows the quality of the fit of beta-uniform mixture model to the data. The red points have the theoretical quantiles from the beta distribution as the x coordinates the observed quantiles and the y coordinates. The blue line shows that this model fits nicely."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-plotFITBum-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotFITBum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.11 : QQPlot은 데이터에 대한 베타 불균형 혼합 모델의 적합의 품질을 보여줍니다. X는 관찰 된 Quantile 및 Y 좌표를 조정하므로 적색 점은 베타 분포에서 이론적 Quantile을 갖습니다. 블루 라인은이 모델이 잘 어울린다는 것을 보여줍니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-histFITBum">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histFITBum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="10-chap_files/figure-html/fig-histFITBum-1.png" title="Figure 10.12: A histogram of the mixture components for the p-values, the beta in red and the uniform in blue, \pi_0 is the mixing proportion assigned to the null component whose distribution should be uniform."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-histFITBum-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histFITBum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.12 : p- 값에 대한 혼합 성분의 히스토그램, 빨간색의 베타, 균일 한 파란색,<span class="math inline">\ (\ pi_0 \)</span>분포가 균일 해야하는 널 구성 요소에 할당 된 혼합 비율입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>그런 다음 우리는 다음을 사용하여 높은 점수의 스코어링 서브 그래프를 검색합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a>hotsu<span class="ot">=</span>  <span class="fu">Runfastheinz</span>(서브넷, 점수)</span>
<span id="cb23-2"><a aria-hidden="true" href="#cb23-2" tabindex="-1"></a>hotsu</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>방향이없는 가장자리가있는 그래 넬 그래프
노드 수 = 144 
가장자리 수 = 221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a>logfc<span class="ot">=</span>Datalym<span class="sc">$</span>차이</span>
<span id="cb25-2"><a aria-hidden="true" href="#cb25-2" tabindex="-1"></a><span class="fu">이름</span>(logfc)<span class="ot">=</span>Datalym<span class="sc">$</span>상표</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-igraph">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.7</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 만들었습니다<a class="quarto-xref" href="#fig-plotBioNet">수치<span>10.13</span></a>다음 코드 사용 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a><span class="fu">PlotModule</span>(hotsuub,<span class="at">레이아웃 =</span>layout.davidson.harel,<span class="at">점수 =</span>점수,</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a>                  <span class="at">diff.expr =</span>logfc)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotBioNet">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plotBioNet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-16" href="10-chap_files/figure-html/fig-plotBioNet-1.png" title="Figure 10.13: The subgraph found as maximally enriched for differential expression between ABC and GCB B-cell lymphoma. The nodes are colored in red and green: green shows an upregulation in ACB and red an upregulation in GBC. The shape of the nodes depicts the score: rectangles indicate a negative score, circles a positive score."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-plotBioNet-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotBioNet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.13 : 서브 그래프는 ABC와 GCB B- 세포 림프종 사이의 차등 발현을 위해 최대로 농축 된 것으로 밝혀졌습니다. 노드는 빨간색과 녹색으로 채색되어 있습니다. 녹색은 ACB의 상향 조절을 보여주고 GBC의 상향 조절이 적색을 나타냅니다. 노드의 모양은 점수를 나타냅니다. 직사각형은 음수 점수를 나타내고, 원은 양의 점수를 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>기능 사용<code>IGraph.from.graphnel</code>, 모듈 객체를 변환하고<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>표시된 방법<a class="quarto-xref" href="#sec-graphs-layers"><span>섹션 10.2.2</span></a>.</p>
</div>
</div>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="10.4" id="phylogenetic-trees">
<h2 class="anchored" data-anchor-id="phylogenetic-trees" data-number="10.4"><span class="header-section-number">10.4</span>계통 발생 나무</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-IntroTree">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-IntroTree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-17" href="imgs/SameTreePhyl.png" title="Figure 10.14: As mathematical objects, the hierarchical clustering trees (studied in sec-clustering) are the same as phylogenetic trees. They are rooted binary trees with labels at the tips."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SameTreePhyl.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-IntroTree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.14 : 수학적 물체로서 계층 적 클러스터링 트리 (연구<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>)는 계통 발생 나무와 동일합니다. 그들은입니다<strong>뿌리 이진</strong>팁에 레이블이있는 나무.</figcaption>
</figure>
</div>
</div></div></div>
<p>생물학에서 그래프를 정말로 중요한 사용은 계통 발생 나무의 구성입니다. 나무는 아니오가있는 그래프입니다<strong>사이클</strong>(자가 루프 또는 여러 정점을 통과하는 루프의 공식 단어). 계통 발생 나무는 보통 현대에 해당하는 잎에 레이블 만있는 뿌리 이진 나무입니다.<a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>팁에 분류군. 내부 노드는 다음과 같습니다<strong>조상</strong>에서 추론 해야하는 서열<strong>동시</strong>팁에 대한 데이터. 많은 방법은 다른 종 또는 집단의 정렬 된 DNA 서열을 사용하여 나무를 추론하거나 추정합니다. 나무 끝이 일반적으로 호출됩니다<strong>하나</strong>S (운영 분류학 단위). 통계<strong>매개 변수</strong>이 분석에 관심이있는 것은 잎에 OTU 라벨이있는 뿌리 바이너리 트리입니다 (<span class="citation" data-cites="holmesima holmes2003b">홈즈 (Holmes) (<a href="16-chap.html#ref-holmesima" role="doc-biblioref">1999</a>,,,<a href="16-chap.html#ref-holmes2003b" role="doc-biblioref">2003b</a>))</span>자세한 내용은).</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>그것들은 현대적이기 때문에 나무는 종종 뿌리와 같은 거리에있는 잎이 ll이되도록 종종 표현됩니다.</p></div></div><section class="level4 unnumbered page-columns page-full" id="the-example-of-hiv">
<h4 class="unnumbered anchored" data-anchor-id="the-example-of-hiv">HIV의 예</h4>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HIVtree">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HIVtree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-18" href="imgs/hivtreeplos.png" title="Figure 10.15: This phylogenetic tree describes the history of different HIV/SIV strains in Africa [@Wertheim:2009], [Figure from]."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/hivtreeplos.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HIVtree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.15 :이 계통 발생 트리는 아프리카의 다른 HIV/SIV 균주의 역사를 설명합니다.<span class="citation" data-cites="Wertheim:2009">(<a href="16-chap.html#ref-Wertheim:2009" role="doc-biblioref">Wertheim and Worobey 2009</a>))</span>, [From].</figcaption>
</figure>
</div>
</div></div></div>
<p>HIV는 매우 빠르게 진화함으로써 스스로를 보호하는 바이러스입니다 (몇 달 안에 몇 가지 돌연변이가 나타날 수 있음). 따라서 그것의 진화는 실시간으로 따라갈 수있다. 반면에 수백만 년에 걸쳐 일어난 큰 유기체의 진화. HIV 트리는 약물 내성에 대한 탐지 및 이해와 같은 의료 목적으로 제작되었습니다. 그들은 개별 유전자에 대해 추정됩니다. 다른 유전자는 진화 역사의 차이를 보여줄 수 있으며, 따라서 다른 생성<strong>유전자 나무</strong>. 계통 발생 나무<a class="quarto-xref" href="#fig-HIVtree">수치<span>10.15</span></a>바이러스가 원숭이에서 인간으로 전환 된 시간을 보여줍니다.<span class="citation" data-cites="Wertheim:2009">(<a href="16-chap.html#ref-Wertheim:2009" role="doc-biblioref">Wertheim and Worobey 2009</a>))</span>.</p>
</section>
<section class="level4 unnumbered" id="special-elements-in-phylogenies">
<h4 class="unnumbered anchored" data-anchor-id="special-elements-in-phylogenies">계통 발생의 특수 요소</h4>
<ul>
<li><p>대부분의 계통 발생 나무는 뿌리로 표시되며, '뿌리'는 일반적으로 나중에 볼 수 있듯이 트리 팁에 그룹을 포함하여 발견됩니다.</p></li>
<li><p>이 공통 조상에서 파생 된 인물은 상 동성이라고 불립니다 (인구 연구를 수행하는 유전자 학자 연구는 상향식이라는 용어를 하강 (IBD)으로 대체합니다).</p></li>
<li><p>공통 조상에 의해 정의 된 나무의 자매는 Clades 또는 Monophyletic Group이라고 불리며<em>유사성</em>공통적으로.</p></li>
</ul>
</section>
<section class="level3 page-columns page-full" data-number="10.4.1" id="markovian-models-for-evolution.">
<h3 class="anchored" data-anchor-id="markovian-models-for-evolution." data-number="10.4.1"><span class="header-section-number">10.4.1</span>진화를위한 마르코프 모델.</h3>
<p>나무 끝에 수집 된 현대 데이터에서 조상 종에서 일어난 일을 추론하려면 시간이 지남에 따라 대체와 삭제가 어떻게 발생하는지에 대한 가정을해야합니다. 우리가 사용하는 모델은 모두 Markovian이며 시간 균질하다고 말합니다. 돌연변이 속도는 역사에서 일정합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="imgs/devil.png" title="This is called the molecular clock hypothesis, if we do not make this assumption we run into what is known as non-identifiability (ie we can’t tell the difference between the many possible mutational histories given the observed data)."><img alt="This is called the molecular clock hypothesis, if we do not make this assumption we run into what is known as non-identifiability (ie we can’t tell the difference between the many possible mutational histories given the observed data)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>이것을<strong>분자 시계</strong>가설에서, 우리 가이 가정을하지 않으면 우리는 비 식별 불가이라고 알려진 것을 얻지 못합니다 (즉, 관찰 된 데이터를 고려할 때 가능한 많은 돌연변이 역사의 차이를 알 수 없습니다).</figcaption>
</figure>
</div>
</div></div></div>
<section class="level4 unnumbered page-columns page-full" id="continuous-markov-chain-and-generator-matrix">
<h4 class="unnumbered anchored" data-anchor-id="continuous-markov-chain-and-generator-matrix">연속 Markov 체인 및 발전기 매트릭스</h4>
<p>우리는 우리가 본 Markov 체인을 사용할 것입니다.<a class="quarto-xref" href="#fig-fourstateMC">수치<span>10.7</span></a>상태에서 [A, C, G, T]; 그러나 이제 우리는 상태의 변화, 즉 돌연변이가 무작위로 발생한다고 생각합니다. 이러한 돌연변이 사건 사이의 격차는 지수 분포를 따릅니다. 이 연속 시간 마르코프 체인은 다음과 같은 특성을 가지고 있습니다.</p>
<ul>
<li><p><strong>기억이 없습니다</strong>. <span class="math inline">\ (p (y (y (u+t) = j \; | \; y (t) = i) \)</span>이전 시간에 의존하지 않습니다<span class="math inline">\(티\)</span>.</p></li>
<li><p><strong>시간 균질성</strong>. 확률<span class="math inline">\ (p (y (h+t) = j \, | \, y (t) = i) \)</span>의존하지 않습니다<span class="math inline">\(티\)</span>그러나하지만<span class="math inline">\(시간\)</span>, 이벤트 사이의 시간과<span class="math inline">\(나\)</span>그리고<span class="math inline">\ (J \)</span>.</p></li>
<li><p><strong>선형성</strong>. 순간 전이율은 대략 선형 형태입니다.</p></li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="imgs/devil.png" title="We use an error term written here as o(h), we read this little o of h, which just means that this error terms grows much slower (i.e., sublinear) than h."><img alt="We use an error term written here as o(h), we read this little o of h, which just means that this error terms grows much slower (i.e., sublinear) than h." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>우리는 여기에 기록 된 오류 용어를 사용합니다<span class="math inline">\(오)\)</span>, 우리는이 작은 것을 읽습니다<span class="math inline">\(영형\)</span>~의<span class="math inline">\(시간\)</span>이 오류 용어는<span class="math inline">\(시간\)</span>.</figcaption>
</figure>
</div>
</div></div></div>
<p><span class="anchored-eq" data-anchor-id="eq-ebntiwmhzopu" id="eq-ebntiwmhzopu"><span class="math display">\ [
\ 시작 {align}
p_ {ij} (h) &amp; = q_ {ij} h+o (h), \ quad \ text {for} j \ neq i \\
p_ {ii} (h) &amp; = 1-q_i (h)+ o (h), \ qquad \ text {where} q_i = \ sum_ {j \ neq i} q_ {ij}.
\ end {align}
\ tag {10.1} \]</span></span></p>
<p><span class="math inline">\ (e_ {ij} \)</span>순간 전이율로 알려져 있습니다. 이 속도는 매트릭스를 In과 같이 정의합니다<a class="quarto-xref" href="#tbl-JCKimura">테이블<span>10.2</span></a>.</p>
<ul>
<li><strong>지수 분포</strong>. 변화 사이의 시간은 기하 급수적으로 분포되어야합니다.</li>
</ul>
<!-- -->
<div class="cell page-columns page-full" data-layout-align="center" data-tbl-cap-location="margin">
<div class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center" data-tbl-cap-location="margin" id="tbl-JCKimura">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-JCKimura-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 48%"/>
<col style="width: 51%"/>
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\ (q = \ begin {array} {lcccc} &amp; a &amp; t &amp; c &amp; g \\
  A &amp; -3 \ alpha &amp; \ alpha &amp; \ alpha &amp; \ alpha \\
  t &amp; \ alpha &amp; -3 \ alpha &amp; \ alpha &amp; \ alpha \\
  c &amp; \ alpha &amp; \ alpha &amp; -3 \ alpha &amp; \ alpha \\
  g &amp; \ alpha &amp; \ alpha &amp; \ alpha &amp; -3 \ alpha \\ \ end {array} \)</span></td>
<td style="text-align: right;"><span class="math inline">\ (q = \ begin {array} {lcccc} &amp; a &amp; t &amp; c &amp; g \\
  a &amp; -\ alpha -2 \ beta &amp; \ beta &amp; \ beta &amp; \ alpha \\
  t &amp; \ beta &amp; -\ alpha -2 \ beta &amp; \ alpha &amp; \ beta \\
  c &amp; \ beta &amp; \ alpha &amp; -\ alpha -2 \ beta &amp; \ beta \\
  g &amp; \ alpha &amp; \ beta &amp; \ beta &amp; -\ alpha -2 \ beta \\ \ end {array} \)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-JCKimura-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">표 10.2 : 왼쪽의 속도 행렬의 두 가지 예 : Jukes-Cantor (<code>JC69</code>) 모델, 오른쪽에 Kimura가 표시됩니다 (<code>K80</code>) 두 개의 매개 변수 모델.</figcaption>
</figure>
</div>
</div>
<p>순간 변경 확률 매트릭스가 호출됩니다<strong>생성기</strong>. Jukes-Cantor 모델이라고하는 가장 간단한 가능한 모델에서; 모든 돌연변이도 마찬가지로 가능성이 높습니다 (왼쪽 참조<a class="quarto-xref" href="#tbl-JCKimura">테이블<span>10.2</span></a>). Kimura 모델이라는 약간 더 유연한 모델이 오른쪽에 표시됩니다.<a class="quarto-xref" href="#tbl-JCKimura">테이블<span>10.2</span></a>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-KimuraJC">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.8</div>
</div>
<div class="callout-body-container callout-body">
<p>Kimura 모델이 더 유연하다고 말하는 이유는 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-18-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-18-contents callout-collapse collapse" id="callout-18">
<div class="callout-body-container callout-body">
<p>Jukes-Cantor는 하나의 매개 변수 만 가지고 있으며,이 모델은 모든 전환을 가정하고 전환이 똑같이 가능성이 있다고 가정합니다. 기무라에는 전이에 대한 하나의 매개 변수가 있고 다른 하나는 전이에 대한 매개 변수가있다 (퓨린에서 피리 미딘으로 발생하는 돌연변이 또는 그 반대도 마찬가지).</p>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<p>! [어휘 과부하! : 이러한 맥락에서의 전이는 퓨린 내 (a &lt;-&gt; g]) 또는 피리 미딘 (c &lt;-&gt; t) 내에서 돌연변이 변화를 의미한다; 반면에 우리는 마르코프 체인에 대해 이전에 이야기했을 때<strong>이행</strong>매트릭스는 상태 변경의 모든 확률이 포함되어 있습니다.] (IMGS/DEVIL.PNG) {fig-align =‘중심’너비 = 123}</p>
</div></div></div>
<p>가장 유연한 모델을 일반화 된 시간 가역 (GTR) 모델이라고합니다. 6 개의 무료 매개 변수가 있습니다. 알려진 트리의 이러한 생성 모델에 따라 시뮬레이션 된 데이터의 예를 보여 드리겠습니다.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="10.4.2" id="simulating-data-and-plotting-a-tree">
<h3 class="anchored" data-anchor-id="simulating-data-and-plotting-a-tree" data-number="10.4.2"><span class="header-section-number">10.4.2</span>데이터 시뮬레이션 및 트리 플로팅</h3>
<p>우리가 이미 우리의 계통 발생 나무를 알고 있으며이 트리 아래에 뉴클레오티드의 진화를 시뮬레이션하고 싶다고 가정 해 봅시다. 먼저 우리는 나무를 시각화합니다<code>트리 1</code>사용<code>Ggtree</code>; 트리와 관련 패키지로드 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Phangorn"</span>))</span>
<span id="cb27-2"><a aria-hidden="true" href="#cb27-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Ggtree"</span>))</span>
<span id="cb27-3"><a aria-hidden="true" href="#cb27-3" tabindex="-1"></a><span class="fu">짐</span>(<span class="fu">file.path</span>(데이터,<span class="st">"트리 1.rdata"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>사용하십시오<code>Ggtree</code>플롯 할 기능<code>트리 1</code>; 나무 녹색 삼각형, 조상 노드, 빨간색 서클의 끝을 만드십시오.</p>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a><span class="fu">Ggtree</span>(tree1,<span class="at">lwd =</span> <span class="dv">2</span>,,,<span class="at">색상 =</span> <span class="st">"Darkgreen"</span>,,,<span class="at">알파 =</span> <span class="fl">0.8</span>,,,<span class="at">오른쪽 =</span> <span class="cn">진실</span>))<span class="sc">+</span></span>
<span id="cb28-2"><a aria-hidden="true" href="#cb28-2" tabindex="-1"></a>  <span class="fu">geom_tiplab</span>(<span class="at">크기 =</span> <span class="dv">7</span>,,,<span class="at">각도 =</span> <span class="dv">90</span>,,,<span class="at">오프셋 =</span> <span class="fl">0.05</span>))<span class="sc">+</span></span>
<span id="cb28-3"><a aria-hidden="true" href="#cb28-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">모양 =</span>istip,<span class="at">색상 =</span>istip),<span class="at">크기 =</span> <span class="dv">5</span>,,,<span class="at">알파 =</span> <span class="fl">0.6</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Atree1b">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Atree1b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-21" href="10-chap_files/figure-html/fig-Atree1b-1.png" title="Figure 10.16: This is the tree we use as our true parameter. We generate nucleotides one at a time from the root and `dropping’ them down the tree. With some probability proportional to the edge lengths, mutations occur down the branches."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-Atree1b-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Atree1b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.16 : 이것은 우리가 우리로 사용하는 나무입니다<em>진실</em>매개 변수. 우리는 뿌리에서 한 번에 하나씩 뉴클레오티드를 생성하고 나무 아래로 떨어 뜨립니다. 가장자리 길이에 비례하는 확률로, 돌연변이는 가지 아래에 발생합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이제 우리는 나무에서 시퀀스를 생성합니다. 각 서열은 뿌리에서 무작위로 생성 된 새로운 뉴클레오티드 문자로 시작합니다. 우리가 나무를 내려 가면 돌연변이가 발생할 수 있습니다. 당신은 볼 수 있습니다<a class="quarto-xref" href="#fig-ggtreeAlignment">수치<span>10.17</span></a>루트의 주파수가 균일 한 것과 다르기로 선택 되었기 때문에 색상이 똑같이 표현되지 않습니다. 다음 코드를 참조하십시오.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a>seqs6<span class="ot">=</span> <span class="fu">Simseq</span>(tree1,<span class="at">l =</span> <span class="dv">60</span>,,,<span class="at">유형 =</span> <span class="st">"DNA"</span>,,,<span class="at">bf =</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">3</span>,,,<span class="dv">3</span>))<span class="sc">/</span><span class="dv">8</span>,,,<span class="at">속도 =</span> <span class="fl">0.1</span>))</span>
<span id="cb29-2"><a aria-hidden="true" href="#cb29-2" tabindex="-1"></a>seqs6</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>60 자 및 30 개의 다른 사이트 패턴을 갖는 6 개의 시퀀스.
상태는 C G T입니다</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a>MAT6DF<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="fu">AS.CHARACTER</span>(seqs6))</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a>피<span class="ot">=</span> <span class="fu">Ggtree</span>(tree1,<span class="at">lwd =</span> <span class="fl">1.2</span>))<span class="sc">+</span> <span class="fu">geom_tiplab</span>(<span class="fu">AES</span>(<span class="at">x =</span>나뭇가지),<span class="at">크기 =</span> <span class="dv">5</span>,,,<span class="at">vjust =</span> <span class="dv">2</span>))</span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a><span class="fu">GHEATMAP</span>(P, MAT6DF [,<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>],,<span class="at">오프셋 =</span> <span class="fl">0.01</span>,,,<span class="at">colnames =</span> <span class="cn">거짓</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ggtreeAlignment">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggtreeAlignment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-22" href="10-chap_files/figure-html/fig-ggtreeAlignment-1.png" title="Figure 10.17: The tree on the left was used to generate the sequences on the right according to a Jukes Cantor model. The nucleotide frequencies generated at the root were quite unequal, with A and C being generated more rarely. As the sequences percolate down the tree, mutations occur, they are more likely to occur on the longer branches."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-ggtreeAlignment-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggtreeAlignment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.17 : 왼쪽의 트리는 Jukes Cantor 모델에 따라 오른쪽의 시퀀스를 생성하는 데 사용되었습니다. 뿌리에서 생성 된 뉴클레오티드 주파수는 매우 불평등했으며<code>에이</code>그리고<code>기음</code>더 드물게 생성됩니다. 서열이 나무 아래로 침투함에 따라 돌연변이가 발생하면 더 긴 가지에서 발생할 가능성이 더 높습니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-simulateseqs">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.9</div>
</div>
<div class="callout-body-container callout-body">
<p>위의 코드를 실험하십시오. 변경<code>BF</code>그리고<code>비율</code>인수<code>Simseq</code>돌연변이를 더 많이 만들 수있는 기능. 매우 높은 돌연변이 속도로 생성 된 서열이 나무를 생성 한 나무를 더 쉽게 추론 할 수 있다고 생각하십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-21-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-21-contents callout-collapse collapse" id="callout-21">
<div class="callout-body-container callout-body">
<p>돌연변이 속도가 매우 높으면 돌연변이가 스스로 쓰여지고 추론이 더 어려워집니다. 물론, 우리가 나무 가지를 해결하기 위해서는 일부 돌연변이가 발생하기 때문에 달콤한 지점이 있습니다. 특정 시간과 특정 수의 돌연변이 후에는 뿌리에서 무슨 일이 일어나고 있는지 알기가 매우 어려울 수 있습니다. 보다<span class="citation" data-cites="Mossel:2003">홍합 (홍합<a href="16-chap.html#ref-Mossel:2003" role="doc-biblioref">2003</a>))</span>자세한 내용.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-distancebias">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.10</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>추정 바이어스 : 거리 과소 평가.</strong><br/>1) 간단한 해밍 거리를 사용하여 두 시퀀스 사이의 변화 수만 계산하지만 둘 사이에 많은 진화 적 변화가 있었는데 왜 서열 사이의 거리를 과소 평가합니까?<br/>2) 작은 진화 거리의 경우 편견이 더 클 것인가?</p>
</div>
</div>
<p>우리가 위에서 본 표준 마르코프의 진화 모델을 통해 이러한 추정치를 개선 할 수 있습니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="10.4.3" id="estimating-a-phylogenetic-tree">
<h3 class="anchored" data-anchor-id="estimating-a-phylogenetic-tree" data-number="10.4.3"><span class="header-section-number">10.4.3</span>계통 발생 나무 추정</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-23" href="imgs/Magnify.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/Magnify.png"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">“이런 종류의 문제를 해결할 때, 웅장한 것은 뒤로 추론 할 수있는 것입니다. 그것은 매우 유용한 업적이며 매우 쉬운 일이지만 사람들은 그것을 많이 연습하지 않습니다. 일상 생활에서는 추론하는 것이 더 유용하므로 다른 사람은 소홀히 할 수 있습니다.<strong>셜록 홈즈</strong></span></div></div>
<p>진정한 트리 파라미터가 알려져있을 때, 위에서 언급 한 확률 적 발전 모델은 시퀀스에서 어떤 패턴을 기대 해야하는지 알려줍니다. 이전 장에서 볼 수 있듯이 통계는 데이터에서 매개 변수의 합리적인 추정으로 되돌아가는 것을 의미합니다. 여기서 나무 자체와 분기 길이, 심지어 진화 속도조차도 매개 변수로 간주 될 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-igraphsteiner">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-igraphsteiner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-24" href="10-chap_files/figure-html/fig-igraphsteiner-1.png" title="Figure 10.18: A Steiner tree, the inner points are represented as squares. The method for creating the shortest tree that passes through all outer 1,2,5,6 is to create two inside (“ancester”) points 3 and 4."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-igraphsteiner-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-igraphsteiner-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.18 : 스타너 트리, 내부 점은 사각형으로 표시됩니다. 모든 외부 1,2,5,6을 통과하는 가장 짧은 트리를 만드는 방법은 내부 (“Genester”) 포인트 3과 4를 만드는 것입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>추정에는 몇 가지 접근 방식이 있습니다. 트리`건물 '은 예외가 아닙니다. 여기에 주요 것들이 있습니다.</p>
<p><strong>비모수 적 추정치 : 파르 시몬 트리</strong>Parsimony는 데이터를 설명하는 데 필요한 변경의 수를 최소화하는 비모수 적 방법입니다. 솔루션은 Steiner 트리 문제와 동일합니다 (참조).<a class="quarto-xref" href="#fig-igraphsteiner">수치<span>10.18</span></a>).</p>
<p><strong>파라 메트릭 추정치 : 최대 우도 트리</strong>최대 가능성 또는 베이지안 접근법을 사용하여 트리를 추정하기 위해서는 돌연변이 속도와 분기 가장자리 길이를 통합하는 분자 진화 모델이 필요합니다. ML 추정 (예 :<code>벌레</code>,,,<code>FASTML</code>,,,<code>RAXML</code>) 효율적인 최적화 알고리즘을 사용하여 모델 가정 하에서 트리의 가능성을 극대화하십시오.</p>
<p><strong>나무의 베이지안 사후 분포</strong>베이지안 추정, Mrbayes<span class="citation" data-cites="mrbayes3">(<a href="16-chap.html#ref-mrbayes3" role="doc-biblioref">Ronquist et al. 2012</a>))</span>또는 짐승<span class="citation" data-cites="beast">(<a href="16-chap.html#ref-beast" role="doc-biblioref">Bouckkaert et al. 2014</a>))</span>둘 다 MCMC를 사용하여 계통 발생의 후방 분포를 찾습니다. 베이지안 방법은 R에 직접 통합되지 않으며 사용자가 Monte Carlo Methods에서 생성 한 나무 컬렉션을 요약하고 신뢰 진술을하기 위해 나무 컬렉션을 가져와야합니다.<span class="citation" data-cites="distory-paper">Chakerian과 Holmes (<a href="16-chap.html#ref-distory-paper" role="doc-biblioref">2012</a>))</span>간단한 예제.</p>
<p><strong>반모용 접근법 : 거리 기반 방법</strong>이웃 결합 및 UPGMA라고 불리는 이러한 방법은 우리가 이미 겪고있는 급수학 클러싱 알고리즘과 매우 유사합니다.<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>. 그러나 거리 추정 단계는<a class="quarto-xref" href="#tbl-JCKimura">테이블<span>10.2</span></a>; '파라 메트릭'이 우리가 반부 모세 트릭 메소드를 부르는 이유의 '파라 메트릭'부분.</p>
<p>이웃 결합 알고리즘 자체는 Steiner 포인트를 두 개의 결합 된 지점의 요약으로 사용하고 계층 적 클러스터링에서와 같이 반복적으로 진행됩니다. 그것은 매우 빠를 수 있으며 종종 시간이 많이 소요되는 방법을위한 좋은 출발점으로 사용됩니다.</p>
<p>데이터에서 트리를 추정하여 시작하겠습니다<code>seqs6</code>사용<code>뉴저지</code>(이웃 결합) 1 파라미터 Jukes-Cantor 모델을 기반으로 DNA 거리에서<a class="quarto-xref" href="#fig-njtree1">수치<span>10.19</span></a>사용<code>Ggtree</code>기능:</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="tree contained negative edge length">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a>Tree.nj<span class="ot">=</span> <span class="fu">뉴저지</span>(<span class="fu">dist.ml</span>(seqs6,<span class="st">"JC69"</span>)))</span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a><span class="fu">Ggtree</span>(tree.nj)<span class="sc">+</span> <span class="fu">geom_tiplab</span>(<span class="at">크기 =</span> <span class="dv">7</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-njtree1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-njtree1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-25" href="10-chap_files/figure-html/fig-njtree1-1.png" title="Figure 10.19: Trees built with a neighbor joining algorithm are very fast to compute and are often used as initial values for more expensive estimation procedures such as the maximum likelihood or parsimony."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-njtree1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-njtree1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.19 : 이웃 결합 알고리즘으로 제작 된 트리는 계산하기에 매우 빠르며 최대 가능성 또는 파시 모니와 같은 더 비싼 추정 절차의 초기 값으로 종종 사용됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-mlscores">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.11</div>
</div>
<div class="callout-body-container callout-body">
<p>주어진 트리 1의 최대 가능성 점수를 생성하십시오.<code>seqs6</code>데이터를 데이터와 비교하여 이웃 결합 트리와 비교하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-24-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-24-contents callout-collapse collapse" id="callout-24">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a>맞다<span class="ot">=</span> <span class="fu">PML</span>(tree1, seqs6,<span class="at">k =</span> <span class="dv">4</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-AAtree">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.12</div>
</div>
<div class="callout-body-container callout-body">
<p>우리가 나무를 추론하려는 아미노산을 정렬 할 때 우리는 사용합니다.<span class="math inline">\ (20 \ Times 20 \)</span>) 전이 행렬. 계통 발생학을 추정하는 방법은 매우 유사합니다. HIV 아미노산 서열이 다운로드 된 Phangorn에서 이것을 시도하십시오.<a class="uri" href="https://www.hiv.lanl.gov/content/sequence/NEWALIGN/align.html">https://www.hiv.lanl.gov/content/sequence/newalign/align.html</a>.</p>
</div>
</div>
<p>트리 추정의 품질은 분류 당 서열의 수와 루트까지의 거리에 따라 다릅니다. 파라 메트릭 및 비모수 적 부트 스트랩을 사용하거나 MCMC를 사용하여 베이지안 트리 추정을 수행하여 추정 품질을 평가할 수 있습니다. 나무의 샘플링 분포를 시각화하고 비교하는 방법의 예는<span class="citation" data-cites="distory-paper">Chakerian과 Holmes (<a href="16-chap.html#ref-distory-paper" role="doc-biblioref">2012</a>))</span>.</p>
</section>
<section class="level3 page-columns page-full" data-number="10.4.4" id="application-to-16s-rrna-data">
<h3 class="anchored" data-anchor-id="application-to-16s-rrna-data" data-number="10.4.4"><span class="header-section-number">10.4.4</span>16S rRNA 데이터에 적용</h3>
<p>~ 안에<a class="quarto-xref" href="05-chap.html"><span>5 장</span></a>우리는 16S rRNA 서열을 거부하기 위해 확률 적 클러스터링 방법을 사용하는 방법을 보았다. 우리는 이제이 거부 된 시퀀스를 다시로드하고 계통 발생을 구축하기 전에 전처리 할 수 ​​있습니다.<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>모든 정보를 유지하고 다른 실험에서 시퀀스를 비교할 수 있도록 시퀀스 자체를 라벨로 사용합니다.<span class="citation" data-cites="Callahan:2017">(<a href="16-chap.html#ref-Callahan:2017" role="doc-biblioref">Callahan, McMurdie 및 Holmes 2017</a>))</span>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dada2"</span>))</span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a>빨려<span class="ot">=</span> <span class="fu">readrds</span>(<span class="fu">file.path</span>(데이터,<span class="st">"seqtab.rds"</span>)))</span>
<span id="cb34-3"><a aria-hidden="true" href="#cb34-3" tabindex="-1"></a>seqs<span class="ot">=</span> <span class="fu">get sequences</span>(꿰매다)</span>
<span id="cb34-4"><a aria-hidden="true" href="#cb34-4" tabindex="-1"></a><span class="fu">이름</span>(seqs)<span class="ot">=</span>seqs</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>16S rRNA 유전자와 같은 잘 연구 된 마커 유전자좌를 사용하는 것 중 하나는 서열화 된 변이체를 분류 학적으로 분류하는 능력입니다.<strong><a href="https://bioconductor.org/packages/dada2/">dada2</a></strong>이 목적을위한 순진한 베이지안 분류 방법을 포함합니다<span class="citation" data-cites="wang2007naive">(<a href="16-chap.html#ref-wang2007naive" role="doc-biblioref">Wang et al. 2007</a>))</span>. 이 분류기는 시퀀스 변형을 분류 된 시퀀스의 훈련 세트와 비교합니다. 여기서는 RDP V16 교육 세트를 사용합니다<span class="citation" data-cites="cole2009rdp">(<a href="16-chap.html#ref-cole2009rdp" role="doc-biblioref">Cole et al. 2009 년</a>))</span><a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>. 예를 들어, 이러한 분류에 대한 코드는 다음과 같습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>DADA2 웹 사이트의 다운로드 링크를 참조하십시오.<a class="uri" href="https://benjjneb.github.io/dada2/training.html">https://benjjneb.github.io/dada2/training.html</a></p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>금식<span class="ot">=</span> <span class="st">"../tmp/rdp_train_set_16.fa.gz"</span></span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a>Taxtab<span class="ot">=</span> <span class="fu">할당 택시 닉</span>(Saab,<span class="at">refraid =</span>금식)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이후<code>할당 택시 닉</code>함수는 잠시 동안 실행되며 위의 코드는 실시되지 않으며 여기에 이전에 계산 된 결과, 분류 정보 표를로드합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a>Taxtab<span class="ot">=</span> <span class="fu">readrds</span>(<span class="fu">file.path</span>(데이터,<span class="st">"taxtab16.rds"</span>)))</span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a><span class="fu">어둑한</span>(taxtab)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 268 6</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-taxtabhead">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.13</div>
</div>
<div class="callout-body-container callout-body">
<p>R의 파이프 연산자를 사용하여 한 줄의 코드를 작성하십시오<code>|&gt;</code>그것은 행 이름이없는 분류 정보의 처음 6 줄을 보여줍니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-27-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-27-contents callout-collapse collapse" id="callout-27">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="fu">머리</span>(taxtab)<span class="sc">|&gt;</span> <span class="st">`</span><span class="at">rownames &lt;-</span><span class="st">`</span>(<span class="cn">널</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>왕국 계급 순서          
[1,] "Bacteria" "Bacteroidetes" "Bacteroidia" "Bacteroidales"
[2,] "Bacteria" "Bacteroidetes" "Bacteroidia" "Bacteroidales"
[3,] "Bacteria" "Bacteroidetes" "Bacteroidia" "Bacteroidales"
[4,] "Bacteria" "Bacteroidetes" "Bacteroidia" "Bacteroidales"
[5,] "Bacteria" "Bacteroidetes" "Bacteroidia" "Bacteroidales"
[6,] "Bacteria" "Bacteroidetes" "Bacteroidia" "Bacteroidales"
     가족 속        
[1,] "porphyromonadaceae"na           
[2,] "porphyromonadaceae"na           
[3,] "porphyromonadaceae"na           
[4,] "Porphyromonadaceae" "Barnesiella"
[5,] "Bacteroidaceae" "Bacteroides"
[6,] "porphyromonadaceae"na</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-treeandtax">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.14</div>
</div>
<div class="callout-body-container callout-body">
<p>분류 학적 정보와 계통 발생 학적 정보의 차이점은 무엇입니까?</p>
</div>
</div>
<p>그 점에 유의하십시오<code>seqs</code>데이터는 무작위로 생성되며, 우리가 처리해야 할 실제 데이터보다 "깨끗합니다".</p>
<p>특히 자연적으로 발생하는 원시 시퀀스는 있어야합니다<strong>정렬</strong>. 일부 서열에는 종종 여분의 뉴클레오티드가 있기 때문에 필요합니다.<em>인델</em>이벤트<a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a>. 또한 돌연변이가 발생하여 하나의 뉴클레오티드를 다른 뉴클레오티드의 치환으로 보인다.</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>뉴클레오티드가 삭제되거나 삽입되며 발생하는 일이 종종 구별하기가 어렵습니다.</p></div></div><p>다음은 처음 몇 인물이<strong>정렬</strong>시퀀스는 다음과 같습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a aria-hidden="true" href="#cb40-1" tabindex="-1"></a><span class="fu">레드 라인</span>(<span class="fu">file.path</span>(데이터,<span class="st">"mal2.dna.txt"</span>)))<span class="sc">|&gt;</span> <span class="fu">머리</span>(<span class="dv">12</span>))<span class="sc">|&gt;</span> <span class="fu">고양이</span>(<span class="at">sep =</span><span class="st">"</span><span class="sc">\N</span><span class="st">"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>11 162
pre1 gtactttgttta ggccttataa gaaagt- tattattta 공격
PME2 GTATCTGTTTTTTTTTTTTTTTTAA AAAGATAGT- TAATTAA 공격
PMA3 GTTTTGTTA AGCCTTATAA GAGAAAGTA TATTTAACTTA AGGA-TTAT
pfa4 gttttgttta ggccttatta guaagt- tatttattgtttttttttt
pbe5 gtatttgttta agccttataa gaaaaa-ttttaa 공격
plo6 gtatttgttta agccttataa gaaagt- tactaactaa 공격
pfr7 gtacttgttta agccttataa gaagaagt- tattoottta 공격
pkn8 gtactttgttta agccttataa gaaagagt- tattootta
pcy9 gtactcgtta agcttta gaaagt- tattoottta 공격
PVI10 GTACTTTGTTTA AGCTTTA GAAAGT- TATTTATTTA 공격
PGA11 GTTTTTTGTTA AGCCTTATAA GAAAGT- TATTATTTA 공격</code></pre>
</div>
</div>
<p>우리는이 다중 정렬을 수행 할 것입니다<code>seqs</code>The 데이터를 사용한 데이터<strong><a href="https://bioconductor.org/packages/DECIPHER/">풀다</a></strong>패키지<span class="citation" data-cites="wright2015decipher">(<a href="16-chap.html#ref-wright2015decipher" role="doc-biblioref">Wright 2015</a>))</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"풀다"</span>))</span>
<span id="cb42-2"><a aria-hidden="true" href="#cb42-2" tabindex="-1"></a>조정<span class="ot">=</span> <span class="fu">AlignSeq</span>(<span class="fu">dnastrings</span>(seqs),<span class="at">앵커 =</span> <span class="cn">NA</span>,,,<span class="at">verbose =</span> <span class="cn">거짓</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 사용합니다<strong><a href="https://cran.r-project.org/web/packages/phangorn/">Phangorn</a></strong>MLE 트리를 만들기위한 패키지 (GTR 모델 아래) 그러나 이웃 결합 트리를 시작점으로 사용합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a>Phangalign<span class="ot">=</span>Phangorn<span class="sc">::</span><span class="fu">Phydat</span>(<span class="fu">~처럼</span>(조정,<span class="st">"행렬"</span>),)<span class="at">유형 =</span> <span class="st">"DNA"</span>))</span>
<span id="cb43-2"><a aria-hidden="true" href="#cb43-2" tabindex="-1"></a>DM<span class="ot">=</span>Phangorn<span class="sc">::</span><span class="fu">dist.ml</span>(Phangalign)</span>
<span id="cb43-3"><a aria-hidden="true" href="#cb43-3" tabindex="-1"></a>트린<span class="ot">=</span>Phangorn<span class="sc">::</span><span class="fu">뉴저지</span>(DM)<span class="co"># 참고 : 팁 순서! = 시퀀스 순서</span></span>
<span id="cb43-4"><a aria-hidden="true" href="#cb43-4" tabindex="-1"></a>맞다<span class="ot">=</span>Phangorn<span class="sc">::</span><span class="fu">PML</span>(Treenj,<span class="at">데이터 =</span>Phangalign)</span>
<span id="cb43-5"><a aria-hidden="true" href="#cb43-5" tabindex="-1"></a>fitgtr<span class="ot">=</span> <span class="fu">업데이트</span>(맞다,<span class="at">k =</span> <span class="dv">4</span>,,,<span class="at">inv =</span> <span class="fl">0.2</span>))</span>
<span id="cb43-6"><a aria-hidden="true" href="#cb43-6" tabindex="-1"></a>fitgtr<span class="ot">=</span>Phangorn<span class="sc">::</span><span class="fu">Optim.pml</span>(fitgtr,<span class="at">모델 =</span> <span class="st">"GTR"</span>,,,<span class="at">optinv =</span> <span class="cn">진실</span>,,,</span>
<span id="cb43-7"><a aria-hidden="true" href="#cb43-7" tabindex="-1"></a>         <span class="at">optgamma =</span> <span class="cn">진실</span>,,,<span class="at">재 배열 =</span> <span class="st">"확률 론"</span>,,,</span>
<span id="cb43-8"><a aria-hidden="true" href="#cb43-8" tabindex="-1"></a>         <span class="at">제어 =</span>Phangorn<span class="sc">::</span><span class="fu">pml.control</span>(<span class="at">추적 =</span> <span class="dv">0</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="10.5" id="combining-phylogenetic-trees-into-a-data-analysis">
<h2 class="anchored" data-anchor-id="combining-phylogenetic-trees-into-a-data-analysis" data-number="10.5"><span class="header-section-number">10.5</span>계통 발생 트리를 데이터 분석에 결합합니다</h2>
<p>우리는 이제 계통 발생 나무와 거부 된 판독 풍부도를 읽은 샘플에 대한 보완 정보와 결합해야합니다. 샘플에 대한이 정보는 종종 spreadhseet (또는<code>.CSV</code>), 때로는<em>메타</em>-데이터<a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>. 이 데이터 조합 단계는 특수 컨테이너와 액세서에 의해 촉진됩니다.<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong>제공.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>우리는 접두사를 고려합니다<em>메타</em>도움이되지 않고 잠재적으로 혼란스러워 : 샘플에 대한 데이터는 바로 다음과 같습니다.</p></div></div><p>다음 단계 세트에는 객체 생성에서 끝나는 몇 가지 데이터 정리 및 재구성 작업 (둔하지만 필요한 적용 통계의 부분)이 포함됩니다.<code>PS1</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a>샘플<span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../data/mimarks_data_combined.csv"</span>,,,<span class="at">헤더 =</span> <span class="cn">진실</span>))</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a>샘플<span class="sc">$</span>견본<span class="ot">=</span> <span class="fu">페이스트0</span>(<span class="fu">GSUB</span>(<span class="st">"00"</span>,,,<span class="st">"" "</span>, 샘플<span class="sc">$</span>host_subject_id),</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a>                          <span class="st">"디"</span>, 샘플<span class="sc">$</span>나이<span class="dv">-21</span>))</span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a>샘플<span class="ot">=</span>샘플 [<span class="sc">!</span><span class="fu">복제</span>(샘플<span class="sc">$</span>sampleid),]</span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a><span class="fu">Stopifnot</span>(<span class="fu">모두</span>(<span class="fu">Rownames</span>(꿰매다)<span class="sc">%안에%</span>샘플<span class="sc">$</span>견본))</span>
<span id="cb44-6"><a aria-hidden="true" href="#cb44-6" tabindex="-1"></a><span class="fu">Rownames</span>(샘플)<span class="ot">=</span>샘플<span class="sc">$</span>견본</span>
<span id="cb44-7"><a aria-hidden="true" href="#cb44-7" tabindex="-1"></a>Keepcols<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"collection_date"</span>,,,<span class="st">"Biome"</span>,,,<span class="st">"대상 _gene"</span>,,,<span class="st">"대상 _subfragment"</span>,,,</span>
<span id="cb44-8"><a aria-hidden="true" href="#cb44-8" tabindex="-1"></a>  <span class="st">"host_common_name"</span>,,,<span class="st">"host_subject_id"</span>,,,<span class="st">"나이"</span>,,,<span class="st">"섹스"</span>,,,<span class="st">"body_product"</span>,,,<span class="st">"TOT_MASS"</span>,,,</span>
<span id="cb44-9"><a aria-hidden="true" href="#cb44-9" tabindex="-1"></a>  <span class="st">"다이어트"</span>,,,<span class="st">"family_relationship"</span>,,,<span class="st">"유전자형"</span>,,,<span class="st">"샘플 리드"</span>))</span>
<span id="cb44-10"><a aria-hidden="true" href="#cb44-10" tabindex="-1"></a>샘플<span class="ot">=</span>샘플 [<span class="fu">Rownames</span>(seqtab), keepcols]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>샘플 별 시퀀스 피처 테이블, 샘플 (메타) 데이터, 서열 분류 및 계통 발생 트리는 다음과 같이 단일 객체로 결합됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Phyloseq"</span>))</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a>PSO<span class="ot">=</span> <span class="fu">Phyloseq</span>(<span class="fu">tax_table</span>(taxtab),</span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a>               <span class="fu">Sample_Data</span>(샘플),</span>
<span id="cb45-4"><a aria-hidden="true" href="#cb45-4" tabindex="-1"></a>               <span class="fu">One_table</span>(Saab,<span class="at">taxa_are_rows =</span> <span class="cn">거짓</span>),)</span>
<span id="cb45-5"><a aria-hidden="true" href="#cb45-5" tabindex="-1"></a>               <span class="fu">phy_tree</span>(fitgtr<span class="sc">$</span>나무))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 이미 이종 데이터 세트를 링크를 자동화하고 데이터 세트의 다른 부분을 일관성있게 유지하는 특수 데이터 클래스로 결합하는 몇 가지 사례를 이미 발견했습니다 (예 :<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>, 우리가 공부할 때<code>패자</code>데이터).</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>자세한 내용을보십시오<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong> <a href="https://joey711.github.io/phyloseq/tutorials-index.html">여기 문서</a>. 몇 가지 필터링 작업을 시도하십시오. 예를 들어, 트리, 분류 풍부 테이블, 샘플 및 샘플 및 분류 정보가 5000 개 이상인 샘플 만 포함하는 데이터의 하위 집합을 만듭니다.</p>
</div>
</div>
<p>이것은 한 줄로 수행 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="fu">prune_samples</span>(<span class="fu">로우 섬</span>(<span class="fu">One_table</span>(PSO))<span class="sc">&gt;</span> <span class="dv">5000</span>, pso)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Phyloseq 클래스 실험 수준 객체
OTU_Table () OTU 테이블 : [268 분류 및 10 개의 샘플]
Sample_Data () 샘플 데이터 : [14 개의 샘플 변수에 의한 10 개의 샘플]
tax_table () 분류 표 : [268 분류 계급에 의한 268 분류]
phy_tree () 계통 발생 트리 : [268 팁 및 266 개의 내부 노드]</code></pre>
</div>
</div>
<p>또한 모든 데이터 구성 요소 간의 링크의 무결성을 유지하면서 다른 데이터 변환을 할 수도 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-phyloseqsubset">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.15</div>
</div>
<div class="callout-body-container callout-body">
<p>다음 줄의 코드는 무엇을합니까?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>널리 퍼짐<span class="ot">=</span> <span class="fu">적용하다</span>(<span class="at">x =</span> <span class="fu">One_table</span>(PSO),</span>
<span id="cb48-2"><a aria-hidden="true" href="#cb48-2" tabindex="-1"></a>                   <span class="at">여백 =</span> <span class="fu">ifelse</span>(<span class="fu">TABA_ARE_ROWS</span>(PSO),<span class="at">예 =</span> <span class="dv">1</span>,,,<span class="at">아니오 =</span> <span class="dv">2</span>),)</span>
<span id="cb48-3"><a aria-hidden="true" href="#cb48-3" tabindex="-1"></a>                   <span class="at">재미 =</span> <span class="cf">기능</span>(x) {<span class="fu">합집합</span>(엑스<span class="sc">&gt;</span> <span class="dv">0</span>)})</span>
<span id="cb48-4"><a aria-hidden="true" href="#cb48-4" tabindex="-1"></a>prevdf<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="at">유병률 =</span>널리 퍼짐,</span>
<span id="cb48-5"><a aria-hidden="true" href="#cb48-5" tabindex="-1"></a>                    <span class="at">TotalBundance =</span> <span class="fu">taxa_sums</span>(PSO),</span>
<span id="cb48-6"><a aria-hidden="true" href="#cb48-6" tabindex="-1"></a>                    <span class="fu">tax_table</span>(PSO))</span>
<span id="cb48-7"><a aria-hidden="true" href="#cb48-7" tabindex="-1"></a>꼬리표<span class="ot">=</span> <span class="fu">테이블</span>(prevdf<span class="sc">$</span>문)</span>
<span id="cb48-8"><a aria-hidden="true" href="#cb48-8" tabindex="-1"></a>Keepphyla<span class="ot">=</span> <span class="fu">이름</span>(탭) [탭<span class="sc">&gt;</span><span class="dv">5</span>]]</span>
<span id="cb48-9"><a aria-hidden="true" href="#cb48-9" tabindex="-1"></a>prevdf1<span class="ot">=</span> <span class="fu">서브 세트</span>(Prevdf, Phylum<span class="sc">%안에%</span>Keepphyla)</span>
<span id="cb48-10"><a aria-hidden="true" href="#cb48-10" tabindex="-1"></a>PS2V<span class="ot">=</span> <span class="fu">subset_taxa</span>(PSO, Phylum<span class="sc">%안에%</span>Keepphyla)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>특정 박테리아에 대한 풍요를 플로팅하는 것은 Barcharts를 사용하여 수행 할 수 있습니다.<strong><a href="https://cran.r-project.org/web/packages/ggplot2/">ggplot2</a></strong>표현은<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong>패키지. 대화식도 있습니다<a href="http://joey711.github.io/shiny-phyloseq/">반신-필로스 Q</a>브라우저 기반 도구<span class="citation" data-cites="mcmurdie2015">(<a href="16-chap.html#ref-mcmurdie2015" role="doc-biblioref">McMurdie와 Holmes 2015</a>))</span>. 자세한 내용은 온라인 비네팅을 참조하십시오.</p>
<section class="level3 page-columns page-full" data-number="10.5.1" id="hierarchical-multiple-testing">
<h3 class="anchored" data-anchor-id="hierarchical-multiple-testing" data-number="10.5.1"><span class="header-section-number">10.5.1</span>계층 적 다중 테스트</h3>
<p>가설 검사는 관심의 샘플 변수와 관련된 개별 박테리아를 식별 할 수 있습니다. 표준 접근법은 우리가 이미 방문한 접근 방식과 매우 유사합니다.<a class="quarto-xref" href="06-chap.html"><span>6 장</span></a>. 각 분류군에 대한 테스트 통계를 개별적으로 계산합니다. 그런 다음 공동으로 p- 값을 조정하여 잘못된 발견 속도 상한을 보장합니다. 그러나이 절차는 테스트 된 가설 중 구조를 악용하지 않습니다. 예를 들어, 우리가 한 루미노 코커스 종이 나이와 밀접한 관련이 있음을 관찰한다면, 이것에 대한 생물학적 이유는 속 수준에 있습니다. 그러면 다른 종들도 그러한 연관성을 가질 것으로 예상 할 것입니다. 그러한 정보를 통합하려면<span class="citation" data-cites="benjamini2003hierarchical">Beanjaminial 및 Yetic (<a href="16-chap.html#ref-benjamini2003hierarchical" role="doc-biblioref">2003</a>))</span>그리고<span class="citation" data-cites="benjamini2014selective">벤자 미니와 보모 몰로프 (Bogomolov) (<a href="16-chap.html#ref-benjamini2014selective" role="doc-biblioref">2014</a>))</span>하위 수준의 분류 그룹이 더 높은 수준이 관련된 경우에만 테스트되는 계층 적 테스트 절차를 제안했습니다. 많은 관련 종에 약간의 신호가있는 경우,이 정보 풀링은 전력을 증가시킬 수 있습니다.</p>
<p>우리는이 방법을 적용하여 미생물 풍부도와 연령 사이의 연관성을 테스트합니다. 우리는 데이터 객체를 사용합니다<code>PS1</code>, 그것은 비슷합니다<code>PSO</code>위에서부터 몇 가지 추가 변환 및 필터링 단계가 있습니다. 또한 이용 가능한 정규화 프로토콜을 적용해야합니다.<strong><a href="https://bioconductor.org/packages/DESeq2/">deseq2</a></strong>우리가 논의한 패키지<a class="quarto-xref" href="08-chap.html"><span>8 장</span></a>, 다음<span class="citation" data-cites="LoveDESeq2">사랑, 허버, 앤더스 (<a href="16-chap.html#ref-LoveDESeq2" role="doc-biblioref">2014</a>))</span>RNA-Seq 데이터의 경우<span class="citation" data-cites="mcmurdie2014">McMurdie와 Holmes (<a href="16-chap.html#ref-mcmurdie2014" role="doc-biblioref">2014</a>))</span>16S의 경우 rRNA 생성 카운트 데이터.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a><span class="co"># 경고 :! expr C ( "deseqdataset.se, design = design, righorerank. : 디자인 공식의 일부 변수는 문자이며 요인으로 변환")</span></span>
<span id="cb49-2"><a aria-hidden="true" href="#cb49-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"deseq2"</span>))</span>
<span id="cb49-3"><a aria-hidden="true" href="#cb49-3" tabindex="-1"></a>PS1<span class="ot">=</span> <span class="fu">readrds</span>(<span class="fu">file.path</span>(데이터,<span class="st">"ps1.rds"</span>)))</span>
<span id="cb49-4"><a aria-hidden="true" href="#cb49-4" tabindex="-1"></a>ps_dds<span class="ot">=</span> <span class="fu">Phyloseq_to_deseq2</span>(PS1,<span class="at">디자인 =</span> <span class="sc">~</span>Agebin<span class="sc">+</span>family_relationship)</span>
<span id="cb49-5"><a aria-hidden="true" href="#cb49-5" tabindex="-1"></a>지오메트리 메신저<span class="ot">=</span> <span class="cf">기능</span>(엑스)</span>
<span id="cb49-6"><a aria-hidden="true" href="#cb49-6" tabindex="-1"></a>   <span class="cf">만약에</span> (<span class="fu">모두</span>(엑스<span class="sc">==</span> <span class="dv">0</span>)) { <span class="dv">0</span> } <span class="cf">또 다른</span> { <span class="fu">exp</span>(<span class="fu">평균</span>(<span class="fu">통나무</span>(더블 엑스<span class="sc">! =</span> <span class="dv">0</span>]))}</span>
<span id="cb49-7"><a aria-hidden="true" href="#cb49-7" tabindex="-1"></a>Geomeans<span class="ot">=</span> <span class="fu">적용하다</span>(<span class="fu">계산</span>(PS_DDS),<span class="dv">1</span>, geometricmean)</span>
<span id="cb49-8"><a aria-hidden="true" href="#cb49-8" tabindex="-1"></a>ps_dds<span class="ot">=</span> <span class="fu">추정 변호사</span>(ps_dds,<span class="at">geomeans =</span>Geomeans)</span>
<span id="cb49-9"><a aria-hidden="true" href="#cb49-9" tabindex="-1"></a>ps_dds<span class="ot">=</span> <span class="fu">추정 대상</span>(PS_DDS)</span>
<span id="cb49-10"><a aria-hidden="true" href="#cb49-10" tabindex="-1"></a>풍요 로움<span class="ot">=</span> <span class="fu">getVariancestabilizedData</span>(PS_DDS)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 사용합니다<strong><a href="https://cran.r-project.org/web/packages/structSSI/">structssi</a></strong>계층 적 테스트를 수행하는 패키지<span class="citation" data-cites="sankaran2014structssi">(<a href="16-chap.html#ref-sankaran2014structssi" role="doc-biblioref">산 카란과 홈즈 2014</a>))</span>. 보다 편리한 인쇄를 위해 먼저 분류의 이름을 단축시킵니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a><span class="fu">Rownames</span>(풍부)<span class="ot">=</span> <span class="fu">기판</span>(<span class="fu">Rownames</span>(풍부),<span class="dv">1</span>,,,<span class="dv">5</span>))<span class="sc">|&gt;</span> <span class="fu">MAKE.NAMES</span>(<span class="at">고유 =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리가 할 계층 적 테스트 절차는 이제 일 변량 테스트가 모든 분류뿐만 아니라 각 상위 수준의 분류 학적 그룹에 대해 수행된다는 점에서 표준 다중 가설 테스트와 다릅니다. 도우미 기능,<code>treepvalues</code>,이를 위해 사용할 수 있습니다. 첫 번째 행은 루트 노드를 지정하는 모서리 목록을 인코딩합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"structssi"</span>))</span>
<span id="cb51-2"><a aria-hidden="true" href="#cb51-2" tabindex="-1"></a>그<span class="ot">=</span> <span class="fu">phy_tree</span>(PS1)<span class="sc">$</span>가장자리</span>
<span id="cb51-3"><a aria-hidden="true" href="#cb51-3" tabindex="-1"></a>EL0<span class="ot">=</span>그</span>
<span id="cb51-4"><a aria-hidden="true" href="#cb51-4" tabindex="-1"></a>EL0<span class="ot">=</span>EL0 [<span class="fu">회전</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(그))), ]</span>
<span id="cb51-5"><a aria-hidden="true" href="#cb51-5" tabindex="-1"></a>el_names<span class="ot">=</span> <span class="fu">기음</span>(<span class="fu">Rownames</span>(풍부),<span class="fu">seq_len</span>(<span class="fu">phy_tree</span>(PS1)<span class="sc">$</span>현재))</span>
<span id="cb51-6"><a aria-hidden="true" href="#cb51-6" tabindex="-1"></a>그[,<span class="dv">1</span>]]<span class="ot">=</span>el_names [el0 [,<span class="dv">1</span>]]]]</span>
<span id="cb51-7"><a aria-hidden="true" href="#cb51-7" tabindex="-1"></a>그[,<span class="dv">2</span>]]<span class="ot">=</span>el_names [el0 [,<span class="dv">2</span>]]]]</span>
<span id="cb51-8"><a aria-hidden="true" href="#cb51-8" tabindex="-1"></a>UNADJ_P<span class="ot">=</span> <span class="fu">treepvalues</span>(풍부하고,<span class="fu">Sample_Data</span>(PS1)<span class="sc">$</span>Agebin)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 계층 적 테스트 절차를 사용하여 FDR 계산을 수행 할 수 있습니다. 테스트 결과는 FDR의 여러 변형을 제어하지만 다른 수준에서 보장됩니다. 우리는 세부 사항을 연기합니다<span class="citation" data-cites="benjamini2003hierarchical benjamini2014selective sankaran2014structssi">(<a href="16-chap.html#ref-benjamini2003hierarchical" role="doc-biblioref">나는했다</a>; <a href="16-chap.html#ref-benjamini2014selective" role="doc-biblioref">Benjamini 및 Bogomolov 2014</a>; <a href="16-chap.html#ref-sankaran2014structssi" role="doc-biblioref">산 카란과 홈즈 2014</a>))</span>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>브라우저 창이 열리는 대화식 플로팅 명령을 포함하여 다음 코드를 시도하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a>hfdr_res<span class="ot">=</span> <span class="fu">hfdr.adjust</span>(unadj_p, the,<span class="fl">0.75</span>))</span>
<span id="cb52-2"><a aria-hidden="true" href="#cb52-2" tabindex="-1"></a><span class="fu">요약</span>(HFDR_RES)</span>
<span id="cb52-3"><a aria-hidden="true" href="#cb52-3" tabindex="-1"></a><span class="co">#plot (hfdr_res, height = 5000) # 실행되지 않음 : 브라우저에서 열립니다.</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-structssi-hfdr">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-structssi-hfdr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-26" href="imgs/structssi-screenshot.png" title="Figure 10.20: A screenshot of a subtree with many differentially abundant microbes, as determined by the hierarchical testing procedure. Currently the user is hovering over the node associated with microbe GCGAG.33; this causes the adjusted p-value (0.029) to appear."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/structssi-screenshot.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-structssi-hfdr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.20 : 계층 적 테스트 절차에 의해 결정된 바와 같이 다르게 풍부한 미생물을 가진 하위 트리의 스크린 샷. 현재 사용자는 미생물 GCGAG와 관련된 노드 위로 떠오르고 있습니다 .33; 이로 인해 조정 된 p- 값 (0.029)이 나타납니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>플롯은 새 브라우저에서 열립니다 - 하위 트리의 정적 스크린 샷이 표시됩니다.<a class="quarto-xref" href="#fig-structssi-hfdr">수치<span>10.20</span></a>. 노드는 파란색에서 주황색으로 P- 값에 따라 음영 처리되며 가장 약한 연관성을 나타냅니다. 회색 노드는 결코 테스트되지 않았으며보다 유망한 하위 트리에 힘을 집중 시켰습니다. 전체 트리를 스캔; 연령 그룹과 분류 학적 풍부 사이의 연관성은 몇몇 고립 된 분류 학적 그룹에만 존재한다는 것이 분명해집니다. 그 그룹에서는 매우 강합니다. 이러한 결과에 대한 맥락을 제공하기 위해, 우리는 거부 된 가설의 분류 학적 정체성을 검색 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" href="#cb53-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb53-2"><a aria-hidden="true" href="#cb53-2" tabindex="-1"></a><span class="fu">옵션</span>(<span class="at">숫자 =</span> <span class="dv">3</span>))</span>
<span id="cb53-3"><a aria-hidden="true" href="#cb53-3" tabindex="-1"></a>세<span class="ot">=</span> <span class="fu">tax_table</span>(ps1) [,<span class="fu">기음</span>(<span class="st">"가족"</span>,,,<span class="st">"속"</span>))]]<span class="sc">|&gt;</span> <span class="fu">데이터. 프레임</span>()</span>
<span id="cb53-4"><a aria-hidden="true" href="#cb53-4" tabindex="-1"></a>세<span class="sc">$</span>서열<span class="ot">=</span> <span class="fu">Rownames</span>(풍부)</span>
<span id="cb53-5"><a aria-hidden="true" href="#cb53-5" tabindex="-1"></a>hfdr_res<span class="sc">@</span>P.Vals<span class="sc">$</span>서열<span class="ot">=</span> <span class="fu">Rownames</span>(hfdr_res<span class="sc">@</span>p.vals)</span>
<span id="cb53-6"><a aria-hidden="true" href="#cb53-6" tabindex="-1"></a><span class="fu">왼쪽_Join</span>(세금, hfdr_res<span class="sc">@</span>p.vals [,<span class="sc">-</span><span class="dv">3</span>])))<span class="sc">|&gt;</span></span>
<span id="cb53-7"><a aria-hidden="true" href="#cb53-7" tabindex="-1"></a>  <span class="fu">마련하다</span>(Adjp)<span class="sc">|&gt;</span> <span class="fu">머리</span>(<span class="dv">9</span>))<span class="sc">|&gt;</span>dplyr<span class="sc">::</span><span class="fu">선택하다</span>(<span class="dv">1</span>,,,<span class="dv">2</span>,,,<span class="dv">4</span>,,,<span class="dv">5</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가족 속의 가설 이름 가설 이시시스 지인 덱스
1 porphyromonaceae &lt;i&gt; &lt;i&gt;
2 porphyromonaceae &lt;i&gt; &lt;i&gt;
3 porphyromonaceae &lt;i&gt; &lt;i&gt;
4 Porphyromonaraceae Barnesiella &lt;na&gt;
5 Bacterroidaceae Bacteroids &lt;i&gt;
6 porphyromonaraceae barnesiella &lt;na&gt;
7 Rikenellaceae alistipes &lt;na&gt;
8 porphyromonaceae &lt;i&gt; &lt;i&gt;
9 porphyromonaceae &lt;i&gt; &lt;i&gt;</code></pre>
</div>
</div>
<p>가장 강하게 관련된 박테리아는 모두 가족에 속한 것 같습니다.<em>Lachnospiraceae</em>.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="10.6" id="minimum-spanning-trees">
<h2 class="anchored" data-anchor-id="minimum-spanning-trees" data-number="10.6"><span class="header-section-number">10.6</span>최소 스패닝 나무</h2>
<p>매우 간단하고 유용한 그래프는 소위 그래프입니다<strong>최소 스패닝 트리</strong> (<strong>MST</strong>). 정점 세트가 주어지면 a<strong>스패닝 트리</strong>적어도 한 번은 모든 지점을 통과하는 나무입니다. 예제가 표시됩니다<a class="quarto-xref" href="#fig-graphs-MST">수치<span>10.21</span></a>. 정점 사이의 거리가 주어진 MST는 총 길이의 최소 스패닝 트리입니다 (<a class="quarto-xref" href="#fig-graphs-MST">수치<span>10.21</span></a>).</p>
<p>욕심 많은 알고리즘은 MST를 계산하는 데 적합하며 R에는 많은 구현이 있습니다.<code>MSTREE</code>~에<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>,,,<code>MST</code>~에<strong><a href="https://cran.r-project.org/web/packages/ape/">원숭이</a></strong>,,,<code>스팬 트리</code>~에<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>,,,<code>MST</code>~에<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>.</p>
<div class="quarto-layout-panel page-columns page-full" id="fig-graphs-MST">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-graphs-MST-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphs-MST" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphs-MST-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphs-MST-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphs-MST" href="10-chap_files/figure-html/fig-graphs-MST-1.png" title="Figure 10.21 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphs-MST" id="fig-graphs-MST-1" src="10-chap_files/figure-html/fig-graphs-MST-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphs-MST-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div></div></div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphs-MST" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphs-MST-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-graphs-MST-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-graphs-MST" href="10-chap_files/figure-html/fig-graphs-MST-2.png" title="Figure 10.21 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-graphs-MST" id="fig-graphs-MST-2" src="10-chap_files/figure-html/fig-graphs-MST-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphs-MST-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphs-MST-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.21 : 동일한 6 개의 정점 세트에 대한 두 개의 스패닝 트리. 2D 평면의 지점 사이의 유클리드 거리가 사용되는 경우 파란색 그래프는 최소 스패닝 트리입니다.</figcaption>
</figure>
</div>
<p>여기서 우리는 전 세계 환자의 HIV 균주 사이에서 DNA 서열 거리를 취하고 최소 스패닝 트리를 구성 할 것입니다. 결과가 표시됩니다<a class="quarto-xref" href="#fig-HIVMSTi">수치<span>10.22</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a><span class="fu">짐</span>(<span class="fu">file.path</span>(데이터,<span class="st">"dist2009c.rdata"</span>)))</span>
<span id="cb55-2"><a aria-hidden="true" href="#cb55-2" tabindex="-1"></a>Country09<span class="ot">=</span> <span class="fu">att</span>(Dist2009C,<span class="st">"상표"</span>))</span>
<span id="cb55-3"><a aria-hidden="true" href="#cb55-3" tabindex="-1"></a>MSTREE2009<span class="ot">=</span>원숭이<span class="sc">::</span><span class="fu">MST</span>(Dist2009c)</span>
<span id="cb55-4"><a aria-hidden="true" href="#cb55-4" tabindex="-1"></a>GR09<span class="ot">=</span> <span class="fu">Graph_from_adjacency_matrix</span>(MSTREE2009,<span class="at">모드 =</span> <span class="st">"변환되지 않은"</span>))</span>
<span id="cb55-5"><a aria-hidden="true" href="#cb55-5" tabindex="-1"></a><span class="fu">ggraph</span>(GR09,<span class="at">레이아웃 =</span><span class="st">"정말로"</span>))<span class="sc">+</span></span>
<span id="cb55-6"><a aria-hidden="true" href="#cb55-6" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>,,,<span class="at">알파 =</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb55-7"><a aria-hidden="true" href="#cb55-7" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span> <span class="fu">vertex_attr</span>(GR09)<span class="sc">$</span>이름),<span class="at">크기 =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb55-8"><a aria-hidden="true" href="#cb55-8" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span> <span class="fu">vertex_attr</span>(GR09)<span class="sc">$</span>이름),<span class="at">색상 =</span><span class="st">"검은색"</span>,,,<span class="at">크기 =</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb55-9"><a aria-hidden="true" href="#cb55-9" tabindex="-1"></a>  <span class="fu">테마_void</span>() <span class="sc">+</span></span>
<span id="cb55-10"><a aria-hidden="true" href="#cb55-10" tabindex="-1"></a>  <span class="fu">가이드</span>(<span class="at">색상 =</span><span class="fu">가이드 _legend</span>(<span class="at">keyheight =</span><span class="fl">0.1</span>,,,<span class="at">keywidth =</span><span class="fl">0.1</span>,,,</span>
<span id="cb55-11"><a aria-hidden="true" href="#cb55-11" tabindex="-1"></a>      <span class="at">제목 =</span><span class="st">"국가"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-HIVMSTi">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-HIVMSTi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="10-chap_files/figure-html/fig-HIVMSTi-1.png" title="Figure 10.22: The minimum spanning tree computed from DNA distances between HIV sequences from samples taken in 2009 and whose country of origin was known, data as published in the HIVdb database [@HIVdb]."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-HIVMSTi-1.png" width="600"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HIVMSTi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.22 : 2009 년에 취한 샘플과 원산지 국가가 알려진 HIV 시퀀스 사이의 DNA 거리에서 계산 된 최소 스패닝 트리.<code>HIVDB</code>데이터 베이스<span class="citation" data-cites="HIVdb">(<a href="16-chap.html#ref-HIVdb" role="doc-biblioref">Rhee et al. 2003</a>))</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-networklabelrepel">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.16</div>
</div>
<div class="callout-body-container callout-body">
<p>네트워크 플롯을 다시 만들지 만 교체하십시오<code>geom_node_text</code>겹치는 노드 레이블을 최소화하기 위해 서로를 격퇴하는 레이블을 사용합니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-33-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-33-contents callout-collapse collapse" id="callout-33">
<div class="callout-body-container callout-body">
<p>보다<a class="quarto-xref" href="#fig-graphs-networklabelrepel">수치<span>10.23</span></a>. 어쩌면 더 나은 접근법이나 추가 접근 방식은 처음에는 같은 나라에서 매우 가까운 정점을 클러스터링하는 것입니다.</p>
<div class="cell" data-layout-align="center" data-warning.known="too many overlaps">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggraph"</span>))</span>
<span id="cb56-2"><a aria-hidden="true" href="#cb56-2" tabindex="-1"></a><span class="fu">ggraph</span>(GR09,<span class="at">레이아웃 =</span><span class="st">"정말로"</span>))<span class="sc">+</span></span>
<span id="cb56-3"><a aria-hidden="true" href="#cb56-3" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>,,,<span class="at">알파 =</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb56-4"><a aria-hidden="true" href="#cb56-4" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span> <span class="fu">vertex_attr</span>(GR09)<span class="sc">$</span>이름),<span class="at">크기 =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb56-5"><a aria-hidden="true" href="#cb56-5" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">AES</span>(<span class="at">레이블 =</span> <span class="fu">vertex_attr</span>(GR09)<span class="sc">$</span>이름),<span class="at">색상 =</span><span class="st">"검은색"</span>,,,<span class="at">크기 =</span><span class="dv">2</span>,,,<span class="at">repel =</span><span class="cn">진실</span>))<span class="sc">+</span></span>
<span id="cb56-6"><a aria-hidden="true" href="#cb56-6" tabindex="-1"></a>  <span class="fu">테마_void</span>() <span class="sc">+</span></span>
<span id="cb56-7"><a aria-hidden="true" href="#cb56-7" tabindex="-1"></a>  <span class="fu">가이드</span>(<span class="at">색상 =</span><span class="fu">가이드 _legend</span>(<span class="at">keyheight =</span><span class="fl">0.1</span>,,,<span class="at">keywidth =</span><span class="fl">0.1</span>,,,</span>
<span id="cb56-8"><a aria-hidden="true" href="#cb56-8" tabindex="-1"></a>      <span class="at">제목 =</span><span class="st">"국가"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-graphs-networklabelrepel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphs-networklabelrepel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="10-chap_files/figure-html/fig-graphs-networklabelrepel-1.png" title="Figure 10.23: Solution to Question wrn-graphs-networklabelrepel."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-graphs-networklabelrepel-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphs-networklabelrepel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.23 : 해결책<a class="quarto-xref" href="#wrn-graphs-networklabelrepel">질문<span>10.16</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>사용하는 것이 바람직 할 수 있습니다<strong>그래프 레이아웃</strong>알려진 지리적 좌표를 통합합니다. 따라서, 우리는 여행자 이동성을 통해 바이러스가 전 세계에서 어떻게 먼 거리를 뛰어 넘었는지 볼 수 있습니다. 우리는 대략적인 국가 좌표를 소개합니다<strong>지터</strong>중첩을 줄이기 위해 약간.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"rworldmap"</span>))</span>
<span id="cb57-2"><a aria-hidden="true" href="#cb57-2" tabindex="-1"></a>매트<span class="ot">=</span> <span class="fu">성냥</span>(Country09, CountryLow<span class="sc">$</span>이름)</span>
<span id="cb57-3"><a aria-hidden="true" href="#cb57-3" tabindex="-1"></a>COORDS2009<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(</span>
<span id="cb57-4"><a aria-hidden="true" href="#cb57-4" tabindex="-1"></a>  <span class="at">lat =</span>CountryLow<span class="sc">$</span>년 [mat],</span>
<span id="cb57-5"><a aria-hidden="true" href="#cb57-5" tabindex="-1"></a>  <span class="at">lon =</span>CountryLow<span class="sc">$</span>론 [mat],</span>
<span id="cb57-6"><a aria-hidden="true" href="#cb57-6" tabindex="-1"></a>  <span class="at">국가 =</span>Country09)</span>
<span id="cb57-7"><a aria-hidden="true" href="#cb57-7" tabindex="-1"></a>LayoutCoordinates<span class="ot">=</span> <span class="fu">cbind</span>(</span>
<span id="cb57-8"><a aria-hidden="true" href="#cb57-8" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">지터</span>(coords2009<span class="sc">$</span>론,<span class="at">금액 =</span> <span class="dv">15</span>),)</span>
<span id="cb57-9"><a aria-hidden="true" href="#cb57-9" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">지터</span>(coords2009<span class="sc">$</span>LAT,<span class="at">금액 =</span> <span class="dv">8</span>)))</span>
<span id="cb57-10"><a aria-hidden="true" href="#cb57-10" tabindex="-1"></a>랩<span class="ot">=</span> <span class="fu">이름</span>(<span class="fu">테이블</span>(Country09) [<span class="fu">어느</span>(<span class="fu">테이블</span>(Country09)<span class="sc">&gt;</span> <span class="dv">1</span>))))</span>
<span id="cb57-11"><a aria-hidden="true" href="#cb57-11" tabindex="-1"></a>MATC<span class="ot">=</span> <span class="fu">성냥</span>(Labc, Countreslow<span class="sc">$</span>이름)</span>
<span id="cb57-12"><a aria-hidden="true" href="#cb57-12" tabindex="-1"></a>DFC<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(</span>
<span id="cb57-13"><a aria-hidden="true" href="#cb57-13" tabindex="-1"></a>  <span class="at">latc =</span>CountryLow<span class="sc">$</span>년 [MATC],</span>
<span id="cb57-14"><a aria-hidden="true" href="#cb57-14" tabindex="-1"></a>  <span class="at">lonc =</span>CountryLow<span class="sc">$</span>lon [matc],</span>
<span id="cb57-15"><a aria-hidden="true" href="#cb57-15" tabindex="-1"></a>labc)</span>
<span id="cb57-16"><a aria-hidden="true" href="#cb57-16" tabindex="-1"></a>dfctrans<span class="ot">=</span>DFC</span>
<span id="cb57-17"><a aria-hidden="true" href="#cb57-17" tabindex="-1"></a>dfctrans [,<span class="dv">1</span>]]<span class="ot">=</span>(DFC [,<span class="dv">1</span>]]<span class="sc">+</span> <span class="dv">31</span>))<span class="sc">/</span> <span class="dv">93</span></span>
<span id="cb57-18"><a aria-hidden="true" href="#cb57-18" tabindex="-1"></a>dfctrans [,<span class="dv">2</span>]]<span class="ot">=</span>(DFC [,<span class="dv">2</span>]]<span class="sc">+</span> <span class="dv">105</span>))<span class="sc">/</span> <span class="dv">238</span></span>
<span id="cb57-19"><a aria-hidden="true" href="#cb57-19" tabindex="-1"></a>국가<span class="ot">=</span> <span class="fu">vertex_attr</span>(GR09)<span class="sc">$</span>이름</span>
<span id="cb57-20"><a aria-hidden="true" href="#cb57-20" tabindex="-1"></a></span>
<span id="cb57-21"><a aria-hidden="true" href="#cb57-21" tabindex="-1"></a><span class="fu">ggraph</span>(GR09,<span class="at">레이아웃 =</span>LayoutCoordinates)<span class="sc">+</span></span>
<span id="cb57-22"><a aria-hidden="true" href="#cb57-22" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>국가),<span class="at">크기 =</span> <span class="dv">3</span>,,,<span class="at">알파 =</span><span class="fl">0.75</span>))<span class="sc">+</span></span>
<span id="cb57-23"><a aria-hidden="true" href="#cb57-23" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>,,,<span class="at">알파 =</span> <span class="fl">0.5</span>,,,<span class="at">강도 =</span><span class="fl">0.15</span>))<span class="sc">+</span></span>
<span id="cb57-24"><a aria-hidden="true" href="#cb57-24" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">데이터 =</span>DFC,<span class="fu">AES</span>(<span class="at">x =</span>론,<span class="at">y =</span>LATC<span class="at">레이블 =</span>실험실,<span class="at">fill =</span>labc),<span class="at">색상 =</span><span class="st">"하얀색"</span>,,,<span class="at">알파 =</span><span class="fl">0.8</span>,,,<span class="at">크기 =</span><span class="dv">3</span>,,,<span class="at">show.legend =</span>에프)<span class="sc">+</span></span>
<span id="cb57-25"><a aria-hidden="true" href="#cb57-25" tabindex="-1"></a>  <span class="fu">테마_void</span>()  </span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-HIVmap">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-HIVmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="10-chap_files/figure-html/fig-HIVmap-1.png" title="Figure 10.24: A minimum spanning tree between HIV cases. The geographic locations of the cases were jittered to reduce overlapping. The DNA sequence distances between the HIV strains were used as input to an undirected minimum spanning tree algorithm."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-HIVmap-1.png" width="640"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-HIVmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.24 : HIV 사례 사이의 최소 스패닝 트리. 겹치는 것을 줄이기 위해 사례의 지리적 위치가 지터링되었습니다. HIV 균주들 사이의 DNA 서열 거리는 방향 변환 된 최소 스패닝 트리 알고리즘에 대한 입력으로 사용되었다.</figcaption>
</figure>
</div>
</div>
</div>
<p>최소 스패닝 트리 알고리즘에 대한 입력은 거리 매트릭스 또는 길이 가장자리 속성이있는 그래프입니다.<a class="quarto-xref" href="#fig-HIVmap">수치<span>10.24</span></a>HIV 사례 사이의 최소 스패닝 트리는 HIVDB 데이터베이스@HIVDB를 통해 스트레인 정보를 사용할 수있게되었습니다. Jukes-Cantor 돌연변이 모델을 사용하여 DNA 거리를 계산 하였다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-MSTworlddirected">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.17</div>
</div>
<div class="callout-body-container callout-body">
<p>위의 분석이 제공되었습니다<strong>변호사</strong>연결 네트워크, 실제로 최소 스패닝 트리의 여러 구현 (예 :<code>MSTREE</code>~에<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>)는 지점을 통해 지시 된 경로를 제공하며, 이는 (명백한) disases의 확산에 대한 의미있는 정보를 제공 할 수 있습니다. 위의지도의 지시 된 네트워크 버전을 만드십시오.</p>
</div>
</div>
<p>MST는 정점에 매핑되는 요인 간의 차이를 감지하기 위해 간단한 비모수 적 테스트의 매우 유용한 구성 요소입니다.</p>
<section class="level3 page-columns page-full" data-number="10.6.1" id="mst-based-testing-the-friedmanrafsky-test">
<h3 class="anchored" data-anchor-id="mst-based-testing-the-friedmanrafsky-test" data-number="10.6.1"><span class="header-section-number">10.6.1</span>MST 기반 테스트 : Friedman – Rafsky 테스트</h3>
<p>그래프 기반 2- 표본 테스트<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>Friedman과 Rafsky가 소개했습니다<span class="citation" data-cites="friedman1979multivariate">(<a href="16-chap.html#ref-friedman1979multivariate" role="doc-biblioref">Friedman and Rafsky 1979</a>))</span>Wald-Wolfowitz의 일반화로서 테스트를 실행합니다 (참조<a class="quarto-xref" href="#fig-WWtest">수치<span>10.25</span></a>). 우리의 이전 예제는 원산지와 같은 공변량과 관련된 그래프 정점을 보여줍니다. 여기서 우리는 공변량이 크게 있는지 테스트합니다<strong>관련된</strong>그래프 구조로.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>두 샘플이 동일한 분포에서 도출되었는지 여부를 탐색하는 테스트.</p></div></div><p>그만큼<strong>프리드먼-라프 스키</strong>최소 스패닝 트리에서 2/다중 샘플 분리를 테스트합니다. 그것은 일 변량 Wald-Wolfowitz Runs 테스트의 일반화로 생각되었습니다. 우리가 두 샘플을 비교하는 경우, 좌표가 관심 측정을 나타내는 남성과 여성은 말합니다. 우리는 두 그룹을 파란색과 빨간색으로 색칠합니다.<a class="quarto-xref" href="#fig-WWtest">수치<span>10.25</span></a>Wald-Wolfowitz 테스트는 두 그룹이 다른 수단을 가지고 있음을 나타냅니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-WWtest">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-WWtest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-32" href="10-chap_files/figure-html/fig-WWtest-1.png" title="Figure 10.25: Seeing the number of runs in a one-dimensional, two-sample, nonparametric Wald-Wolfowitz test can indicate whether the two groups have the same distributions."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-WWtest-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-WWtest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.25 : 1 차원, 2- 샘플, 비모수 적 Wald-Wolfowitz 테스트에서 실행 횟수를 보면 두 그룹이 동일한 분포를 가지고 있는지 여부를 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>한 유형 ( '실행')의 연속 값을 찾는 대신 동일한 유형의 연결된 노드 수를 계산합니다.</p>
<p>최소 스패닝 트리가 구성되면, 범주 형 변수의 다른 수준에 따라 정점에 '색상'이 할당됩니다. 우리는 전화합니다<strong>순수한</strong>두 노드가 동일한 수준의 요인 변수를 가진 가장자리. 우리는 사용합니다<span class="math inline">\(그래서\)</span>, 수<strong>순수한</strong>테스트 통계로서 가장자리. 그룹이 동일한 분포를 가질 때 우연히 관찰 된 값이 발생할 수 있는지 여부를 평가하기 위해 Vertix 레이블 (색)을 무작위로 분출시키고 얼마나 많은 순수한 가장자리가 있는지 다시 이야기합니다. 이 레이블 교환이 여러 번 반복되어 NULL 분포를 만듭니다.<span class="math inline">\(에스\)</span>.</p>
</section>
<section class="level3 page-columns page-full" data-number="10.6.2" id="example-bacteria-sharing-between-mice">
<h3 class="anchored" data-anchor-id="example-bacteria-sharing-between-mice" data-number="10.6.2"><span class="header-section-number">10.6.2</span>예 : 생쥐 사이의 박테리아 공유</h3>
<p>여기 우리는 의자가 미생물 함량에 대해 분석 된 마우스의 샘플 모음에 대한 아이디어를 설명합니다. 우리는 많은 마우스와 많은 분류군이있는 데이터 세트를 읽고 자카르 거리를 계산 한 다음 사용합니다.<code>MST</code>기능<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>패키지. 아래 코드에 표시된대로 관련 공변량으로 그래프에 그래프에 주석을 달 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a>PS1<span class="ot">=</span> <span class="fu">readrds</span>(<span class="fu">file.path</span>(데이터,<span class="st">"ps1.rds"</span>)))</span>
<span id="cb58-2"><a aria-hidden="true" href="#cb58-2" tabindex="-1"></a>샘플드타<span class="ot">=</span> <span class="fu">데이터. 프레임</span>( <span class="fu">Sample_Data</span>(PS1))</span>
<span id="cb58-3"><a aria-hidden="true" href="#cb58-3" tabindex="-1"></a>D1<span class="ot">=</span> <span class="fu">as.matrix</span>(Phyloseq<span class="sc">::</span><span class="fu">거리</span>(PS1,<span class="at">방법 =</span><span class="st">"자카르"</span>)))</span>
<span id="cb58-4"><a aria-hidden="true" href="#cb58-4" tabindex="-1"></a>gr<span class="ot">=</span> <span class="fu">Graph_from_adjacency_matrix</span>(D1,<span class="at">모드 =</span> <span class="st">"변환되지 않은"</span>,,,<span class="at">가중 =</span> <span class="cn">진실</span>))</span>
<span id="cb58-5"><a aria-hidden="true" href="#cb58-5" tabindex="-1"></a>그물<span class="ot">=</span>이그라프<span class="sc">::</span><span class="fu">MST</span>(Gr)</span>
<span id="cb58-6"><a aria-hidden="true" href="#cb58-6" tabindex="-1"></a><span class="fu">다섯</span>(그물)<span class="sc">$</span>ID<span class="ot">=</span>샘플러다타 [<span class="fu">이름</span>(<span class="fu">다섯</span>(그물)),<span class="st">"host_subject_id"</span>]]</span>
<span id="cb58-7"><a aria-hidden="true" href="#cb58-7" tabindex="-1"></a><span class="fu">다섯</span>(그물)<span class="sc">$</span>깃<span class="ot">=</span>샘플러다타 [<span class="fu">이름</span>(<span class="fu">다섯</span>(그물)),<span class="st">"family_relationship"</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 a<code>ggraph</code>결과적으로 생성 된 최소 스패닝 트리의 객체<a class="quarto-xref" href="#fig-mstplot">수치<span>10.26</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a><span class="fu">ggraph</span>(그물,<span class="at">레이아웃 =</span><span class="st">"정말로"</span>))<span class="sc">+</span></span>
<span id="cb59-2"><a aria-hidden="true" href="#cb59-2" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">색상 =</span> <span class="st">"Darkgray"</span>))<span class="sc">+</span></span>
<span id="cb59-3"><a aria-hidden="true" href="#cb59-3" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>ID,<span class="at">모양 =</span>깃))<span class="sc">+</span> </span>
<span id="cb59-4"><a aria-hidden="true" href="#cb59-4" tabindex="-1"></a>  <span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span><span class="st">"맨 아래"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mstplot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mstplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-33" href="10-chap_files/figure-html/fig-mstplot-1.png" title="Figure 10.26: The minimum spanning tree based on Jaccard dissimilarity and annotated with the mice ID and litter factors"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-mstplot-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mstplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.26 : 자크 카드 비 유사성을 기반으로 한 최소 스패닝 트리 및 마우스 ID 및 쓰레기 요인으로 주석이 달린 트리</figcaption>
</figure>
</div>
</div></div></div>
<p>이제 우리는 테스트를 위해 널 분포와 p- 값을 계산합니다.<strong>Phyloseqgraphtest</strong>패키지:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" href="#cb60-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Phyloseqgraphtest"</span>))</span>
<span id="cb60-2"><a aria-hidden="true" href="#cb60-2" tabindex="-1"></a>GT<span class="ot">=</span> <span class="fu">Graph_Perm_test</span>(PS1,<span class="st">"host_subject_id"</span>,,,<span class="at">거리 =</span><span class="st">"자카르"</span>,,,</span>
<span id="cb60-3"><a aria-hidden="true" href="#cb60-3" tabindex="-1"></a>                     <span class="at">유형 =</span><span class="st">"MST"</span>,,,<span class="at">nperm =</span><span class="dv">1000</span>))</span>
<span id="cb60-4"><a aria-hidden="true" href="#cb60-4" tabindex="-1"></a>GT<span class="sc">$</span>PVAL</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000999</code></pre>
</div>
</div>
<p>우리는 순열을 사용하여 생성 된 null 분포의 전체 히스토그램을 볼 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a><span class="fu">plot_permutations</span>(GT)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mstJaccard">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mstJaccard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-34" href="10-chap_files/figure-html/fig-mstJaccard-1.png" title="Figure 10.27: The permutation histogram of the number of pure edges in the network obtained from the minimal spanning tree with Jaccard similarity."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-mstJaccard-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mstJaccard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.27 : Jaccard 유사성을 가진 최소 스패닝 트리에서 얻은 네트워크의 순수한 가장자리 수의 순열 히스토그램.</figcaption>
</figure>
</div>
</div></div></div>
<section class="level4 unnumbered page-columns page-full" id="different-choices-for-the-skeleton-graph">
<h4 class="unnumbered anchored" data-anchor-id="different-choices-for-the-skeleton-graph">골격 그래프에 대한 다른 선택</h4>
<p>가장자리를 정의하는 골격 그래프에 MST를 사용할 필요는 없습니다. 가장 가까운 이웃을 연결하여 만든 그래프<span class="citation" data-cites="schilling1986multivariate">(<a href="16-chap.html#ref-schilling1986multivariate" role="doc-biblioref">Schilling 1986</a>))</span>또는 거리 임계 값 작업도 마찬가지입니다.</p>
<p>바이오 컨덕터 패키지<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong>함수를 통해 거리 매트릭스 임계 값을 기반으로 그래프를 작성하는 기능이 있습니다.<code>make_network</code>. Jaccard 비 유사성이 임계 값보다 작는 샘플간에 에지를 생성하여 네트워크를 만듭니다.<code>맥스 디스트</code>. 우리는 또한 사용할 수 있습니다<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>샘플이 어떤 마우스에서 왔는지, 마우스에 어떤 쓰레기를 뿌린지를 나타내는 정점에 속성을 추가하는 패키지.<a class="quarto-xref" href="#fig-ggnetworkplotJ">수치<span>10.28</span></a>, 마우스와 쓰레기 모두에 의한 샘플 그룹이있다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a aria-hidden="true" href="#cb63-1" tabindex="-1"></a>그물<span class="ot">=</span> <span class="fu">make_network</span>(PS1,<span class="at">max.dist =</span> <span class="fl">0.35</span>))</span>
<span id="cb63-2"><a aria-hidden="true" href="#cb63-2" tabindex="-1"></a>샘플드타<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="fu">Sample_Data</span>(PS1))</span>
<span id="cb63-3"><a aria-hidden="true" href="#cb63-3" tabindex="-1"></a><span class="fu">다섯</span>(그물)<span class="sc">$</span>ID<span class="ot">=</span>샘플러다타 [<span class="fu">이름</span>(<span class="fu">다섯</span>(그물)),<span class="st">"host_subject_id"</span>]]</span>
<span id="cb63-4"><a aria-hidden="true" href="#cb63-4" tabindex="-1"></a><span class="fu">다섯</span>(그물)<span class="sc">$</span>깃<span class="ot">=</span>샘플러다타 [<span class="fu">이름</span>(<span class="fu">다섯</span>(그물)),<span class="st">"family_relationship"</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a><span class="fu">ggraph</span>(그물,<span class="at">레이아웃 =</span><span class="st">"정말로"</span>))<span class="sc">+</span></span>
<span id="cb64-2"><a aria-hidden="true" href="#cb64-2" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">색상 =</span> <span class="st">"Darkgray"</span>))<span class="sc">+</span></span>
<span id="cb64-3"><a aria-hidden="true" href="#cb64-3" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">AES</span>(<span class="at">색상 =</span>ID,<span class="at">모양 =</span>깃))<span class="sc">+</span> </span>
<span id="cb64-4"><a aria-hidden="true" href="#cb64-4" tabindex="-1"></a>    <span class="fu">주제</span>(<span class="at">plot.margin =</span> <span class="fu">단위</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">5</span>,,,<span class="dv">2</span>,,,<span class="dv">0</span>),)<span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb64-5"><a aria-hidden="true" href="#cb64-5" tabindex="-1"></a>    <span class="fu">주제</span>(<span class="at">LEGEND.POSITION =</span> <span class="fu">기음</span>(<span class="fl">1.4</span>,,,<span class="fl">0.3</span>),)<span class="at">전설. 백 그라운드 =</span> <span class="fu">요소 _blank</span>(),</span>
<span id="cb64-6"><a aria-hidden="true" href="#cb64-6" tabindex="-1"></a>          <span class="at">전설 .margin =</span><span class="fu">여유</span>(<span class="dv">0</span>,,,<span class="dv">3</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb64-7"><a aria-hidden="true" href="#cb64-7" tabindex="-1"></a>         <span class="fu">가이드</span>(<span class="at">색상 =</span><span class="fu">가이드 _legend</span>(<span class="at">NCOL =</span><span class="dv">2</span>)))<span class="sc">+</span></span>
<span id="cb64-8"><a aria-hidden="true" href="#cb64-8" tabindex="-1"></a>  <span class="fu">테마_graph</span>(<span class="at">배경 =</span> <span class="st">"하얀색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-ggnetworkplotJ">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-ggnetworkplotJ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-35" href="10-chap_files/figure-html/fig-ggnetworkplotJ-1.png" title="Figure 10.28: A co-occurrence network created by using a threshold on the Jaccard dissimilarity matrix. The colors represent which mouse the sample came from; the shape represents which litter the mouse was in."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-ggnetworkplotJ-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ggnetworkplotJ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.28 : Jaccard Distimilarity Matrix의 임계 값을 사용하여 생성 된 동시 발생 네트워크. 색상은 샘플에서 나온 마우스를 나타냅니다. 모양은 마우스가 흩어 졌는지를 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>샘플 사이에 어떤 그래프를 작성하든 그래프 노드의 레이블을 순간으로하여 널 분포를 근사화 할 수 있습니다. 그러나 때로는 공변량 사이의 알려진 구조를 설명하기 위해 순열 분포를 조정하는 것이 바람직합니다.</p>
</section>
</section>
<section class="level3 page-columns page-full" data-number="10.6.3" id="friedmanrafsky-test-with-nested-covariates">
<h3 class="anchored" data-anchor-id="friedmanrafsky-test-with-nested-covariates" data-number="10.6.3"><span class="header-section-number">10.6.3</span>중첩 된 공변량을 사용한 Friedman – Rafsky 테스트</h3>
<p>위의 시험에서, 우리는 다소 순진한 접근법을 취했고 개별 마우스 사이에 유의 한 차이가 있음을 보여 주었다.<code>host_subject_id</code>변하기 쉬운). 여기서 우리는 약간 다른 순열 테스트를 수행하여 마우스의 차이를 제어하는지 알아냅니다. 쓰레기가 있습니까 (the<code>family_relationship</code>변수) 효과? 테스트의 설정은 비슷합니다. 단순히 순열이 생성되는 방식입니다. 우리는<code>그룹화</code>논쟁. 우리는<code>family_relationship</code>라벨이지만 보관하십시오<code>host_subject_id</code>구조 손상되지 않습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a>GT<span class="ot">=</span> <span class="fu">Graph_Perm_test</span>(PS1,<span class="st">"family_relationship"</span>,,,</span>
<span id="cb65-2"><a aria-hidden="true" href="#cb65-2" tabindex="-1"></a>        <span class="at">그룹화 =</span> <span class="st">"host_subject_id"</span>,,,</span>
<span id="cb65-3"><a aria-hidden="true" href="#cb65-3" tabindex="-1"></a>        <span class="at">거리 =</span> <span class="st">"자카르"</span>,,,<span class="at">유형 =</span> <span class="st">"MST"</span>,,,<span class="at">nperm =</span> <span class="dv">1000</span>))</span>
<span id="cb65-4"><a aria-hidden="true" href="#cb65-4" tabindex="-1"></a>GT<span class="sc">$</span>PVAL</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002</code></pre>
</div>
</div>
<p>이 테스트에는 작은 p- 값이 있으며, 두 샘플이 동일한 분포에서 나온다는 귀무 가설을 거부합니다. 최소 스패닝 트리의 플롯에서<a class="quarto-xref" href="#fig-mstJaccard">수치<span>10.27</span></a>, 우리는 눈에 의해 샘플 그룹이 우연히 기대하는 것보다 더 많이 그룹화된다는 것을 알 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a aria-hidden="true" href="#cb67-1" tabindex="-1"></a><span class="fu">plot_permutations</span>(GT)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mstpermplotNest">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mstpermplotNest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-36" href="10-chap_files/figure-html/fig-mstpermplotNest-1.png" title="Figure 10.29: The permutation histogram obtained from the minimal spanning tree with Jaccard similarity."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-mstpermplotNest-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mstpermplotNest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.29 : Jaccard 유사성을 가진 최소 스패닝 트리에서 얻은 순열 히스토그램.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-graphs-nn-graph">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 10.18</div>
</div>
<div class="callout-body-container callout-body">
<p>그만큼<span class="math inline">\(케이\)</span>-가장 큰 이웃 그래프는 두 샘플 중 하나가<span class="math inline">\(케이\)</span>-다른 이웃의 이웃. Jaccard 거리로 정의 된 가장 가까운 이웃을 사용하여 그래프를 정의하여 테스트를 다시 실행하십시오. 당신은 무엇을 결론 내리겠습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-36-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-36-contents callout-collapse collapse" id="callout-36">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a aria-hidden="true" href="#cb68-1" tabindex="-1"></a>gtnn1<span class="ot">=</span> <span class="fu">Graph_Perm_test</span>(PS1,<span class="st">"family_relationship"</span>,,,</span>
<span id="cb68-2"><a aria-hidden="true" href="#cb68-2" tabindex="-1"></a>                      <span class="at">그룹화 =</span> <span class="st">"host_subject_id"</span>,,,</span>
<span id="cb68-3"><a aria-hidden="true" href="#cb68-3" tabindex="-1"></a>                      <span class="at">거리 =</span> <span class="st">"자카르"</span>,,,<span class="at">유형 =</span> <span class="st">"Knn"</span>,,,<span class="at">Knn =</span> <span class="dv">1</span>))</span>
<span id="cb68-4"><a aria-hidden="true" href="#cb68-4" tabindex="-1"></a>gtnn1<span class="sc">$</span>PVAL</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004</code></pre>
</div>
</div>
<p><a class="quarto-xref" href="#fig-knn-1-plot">수치<span>10.30</span></a>이 가장 가까운 이웃 그래프에서 가장자리 사이에 가장자리가있는 샘플 쌍은 같은 쓰레기에서 나온 것 같습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a aria-hidden="true" href="#cb70-1" tabindex="-1"></a><span class="fu">plot_test_network</span>(GTNN1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-knn-1-plot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-knn-1-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-37" href="10-chap_files/figure-html/fig-knn-1-plot-1.png" title="Figure 10.30: The graph obtained from a nearest-neighbor graph with Jaccard similarity."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-knn-1-plot-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-knn-1-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.30 : Jaccard 유사성을 가진 가장 가까운 이웃 그래프에서 얻은 그래프.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>참고 : 듀얼 그래프</strong><br/>위의 예에서 우리는 공유 분류군을 통해 샘플 간의 관계를 보여 주려고 노력했습니다. 또한 분류군에 대한 질문을하는 것도 흥미로울 수 있습니다. 분류군 중 일부는 예상보다 더 자주 발생합니까? 이 접근법은 미생물이 미생물 군집으로 조립할 때 미생물 '커뮤니티'를 연구하는 데 도움이 될 수 있습니다. 우리가 무엇보다도 개발 한 방법은이 사용 사례에 적용되며 실제로 모든 것이 데이터를 전환하는 것입니다. Jaccard를 사용하는 미생물 군집과 같은 희소 데이터는 항상 바람직합니다. 다른 설정에서는 적절할 수있는 상관 관계 네트워크를 구축하지 않습니다.</p>
</section>
</section>
<section class="level2" data-number="10.7" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="10.7"><span class="header-section-number">10.7</span>이 장의 요약</h2>
<section class="level4 unnumbered" id="annotated-graphs">
<h4 class="unnumbered anchored" data-anchor-id="annotated-graphs">주석이 달린 그래프</h4>
<p>이 장에서는 간단한 배열보다 구조가 더 많은 데이터를 저장하고 플로팅하는 방법을 배웠습니다. 그래프에는 가장자리와 노드가있어 유용하게 표시 될 수있는 추가 주석과 관련 될 수 있습니다.</p>
</section>
<section class="level4 unnumbered" id="important-examples-of-graphs-and-useful-r-packages">
<h4 class="unnumbered anchored" data-anchor-id="important-examples-of-graphs-and-useful-r-packages">그래프 및 유용한 R 패키지의 중요한 예</h4>
<p>우리는 Markov 체인 그래프, 계통 발생 나무 및 최소 스패닝 나무와 같은 특정 예에서 시작했습니다. 우리는 사용 방법을 보았다<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>특정 그래프 레이아웃 알고리즘을 사용하여 그래프를 시각화하고 가능한 많은 정보를 표시하는 패키지.</p>
</section>
<section class="level4 unnumbered" id="combining-graphs-with-statistical-data">
<h4 class="unnumbered anchored" data-anchor-id="combining-graphs-with-statistical-data">그래프를 통계 데이터와 결합합니다</h4>
<p>그런 다음 알려진 '스켈레톤'그래프를 미분 표현 분석에 통합하는 문제에 접근했습니다. 이를 통해 네트워크에서 섭동 핫스팟을 정확히 찾아 낼 수 있습니다. 우리는 뿌리 이진 나무를 따라 정의 된 진화 모델이 계통 발생 트리 추정의 기초 역할을했으며 R 패키지를 사용하여 차등 풍부 분석에서 이러한 나무를 보충 정보로 통합 할 수있는 방법을 보았습니다.<strong><a href="https://cran.r-project.org/web/packages/structSSI/">structssi</a></strong>그리고<strong><a href="https://bioconductor.org/packages/phyloseq/">Phyloseq</a></strong>.</p>
</section>
<section class="level4 unnumbered" id="linking-co-occurrence-to-other-variables">
<h4 class="unnumbered anchored" data-anchor-id="linking-co-occurrence-to-other-variables">동시 발생을 다른 변수와 연결합니다</h4>
<p>그래프 및 네트워크 도구를 사용하면 동시 발생 데이터에서 네트워크를 생성 할 수 있으며 요인 공변량의 효과를 시각화하고 테스트하는 데 사용될 수 있습니다. 우리는 Friedman-Rafsky 테스트를 보았는데, 이는 골격 그래프의 가장자리 구조로 변수의 종속성을 쉽게 테스트하는 방법을 제공했습니다.</p>
</section>
<section class="level4 unnumbered" id="context-and-intepretation-aids">
<h4 class="unnumbered anchored" data-anchor-id="context-and-intepretation-aids">맥락과 정수 보조제</h4>
<p>이 장에서는 네트워크에 플레이어의 상호 작용을 통합하는 방법을 보여 주었으며이를 통계적 점수와 결합하는 것이 얼마나 유용한 지 보았습니다. 이것은 종종 복잡한 생물학적 시스템의 분석에 대한 생물학적 통찰력을 제공합니다.</p>
</section>
<section class="level4 unnumbered" id="previous-knowledge-or-outcome">
<h4 class="unnumbered anchored" data-anchor-id="previous-knowledge-or-outcome">사전 지식 또는 결과</h4>
<p>우리는 그래프가 우리의 사전 지식을 인코딩하는 데 유용 할 수 있음을 알았으며, 알려진 박테리아의 유전자 온톨로지 및 계통 발생 트리는 모두 표준 데이터베이스에서 사용할 수 있음을 알았습니다. 연구에서 모든 알려진 정보를 잘못 표현하고 이러한 골격 네트워크를 관찰 된 데이터와 결합하여 이미 알려진 것의 맥락에서 실험 결과에 대한 이해를 향상시키는 것이 유익합니다.</p>
<p>반면, 그래프는 우리가 예측하려는 결과 일 수 있으며 데이터 (계통 발생 트리, 동시 발생 네트워크 및 최소 스패닝 트리)에서 그래프를 작성하는 방법을 보았습니다.</p>
</section>
</section>
<section class="level2" data-number="10.8" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="10.8"><span class="header-section-number">10.8</span>추가 독서</h2>
<p>계통 발생 나무에 사용되는 진화 모델의 완전한 발전과 중요한 결과는 다음과 같은 책을 참조하십시오.<span class="citation" data-cites="WHLi LiandGraur">리 (Li)<a href="16-chap.html#ref-WHLi" role="doc-biblioref">1997</a>; <a href="16-chap.html#ref-LiandGraur" role="doc-biblioref">Li and Graur 1991</a>))</span>. 책<span class="citation" data-cites="fels:book">펠슨 슈타인 (Felsenstein) (Felsenstein)<a href="16-chap.html#ref-fels:book" role="doc-biblioref">2004</a>))</span>계통 발생 나무 추정에 대한 고전적인 텍스트입니다.</p>
<p>저자가 쓴 책<strong><a href="https://cran.r-project.org/web/packages/ape/">원숭이</a></strong>패키지,<span class="citation" data-cites="paradis:2011">파라디스 (Paradis)<a href="16-chap.html#ref-paradis:2011" role="doc-biblioref">2011</a>))</span>R에서 나무 조작에 대한 많은 유스 케이스와 세부 사항이 포함되어 있습니다. 계통 발생적 나무에 대한 부트 스트랩의 검토는<span class="citation" data-cites="Holmes-2003">홈즈 (Holmes) (<a href="16-chap.html#ref-Holmes-2003" role="doc-biblioref">2003a</a>))</span>.</p>
<p>우리는 DPCOA (Double Principal Coordinate Analysis)라는 PCOA-MDS의 확장을 통해 비상 테이블 데이터의 풍부와 풍부도를 사용할 수 있습니다. 미생물 데이터의 경우, 계통 발생 트리는 분류군 사이의 거리를 제공합니다. 이 거리는 첫 번째 PCOA의 기초가됩니다. 두 번째 PCOA는 가중 샘플 포인트를 투사 할 수 있습니다. 이것은 미생물 생태 응용 분야에서 매우 효과적인 것으로 판명되었습니다.<span class="citation" data-cites="Purdom2010">퓨도 (<a href="16-chap.html#ref-Purdom2010" role="doc-biblioref">2010 년</a>))</span>또는<span class="citation" data-cites="Fukuyama:2012">후쿠야마 et al. (<a href="16-chap.html#ref-Fukuyama:2012" role="doc-biblioref">2012</a>))</span>자세한 내용.</p>
<p>그래프는 정점 공변량을 예측하는 데 사용될 수 있습니다. 그래프의 가장자리를 그래프의 공변량 또는 부분적 지식을 기반으로 예측을 할 수있는 응답 변수로 간주하는 큰 적용 통계 및 기계 학습 필드가 있습니다. 여기에는 포함됩니다<strong>ERGM</strong>(지수 랜덤 그래프 모델,<span class="citation" data-cites="robins:2007">Robins et al. (<a href="16-chap.html#ref-robins:2007" role="doc-biblioref">2007</a>))</span>) 및 그래프 용 커널 방법<span class="citation" data-cites="VertKernel">(<a href="16-chap.html#ref-VertKernel" role="doc-biblioref">Schölkopf, Tsuda 및 Vert 2004</a>))</span>.</p>
<p>Friedman-Rafsky 테스트의 이론적 특성 및 더 많은 예는 다음과 같습니다.<span class="citation" data-cites="Bhattacharya:2015">Bhattacharya (<a href="16-chap.html#ref-Bhattacharya:2015" role="doc-biblioref">2015</a>))</span>.</p>
<p>그래프 및 네트워크를 다루는 전체 목록 패키지는 다음과 같습니다.<a class="uri" href="http://www.bioconductor.org/packages/release/BiocViews.html#___GraphAndNetwork">http://www.bioconductor.org/packages/release/biocviews.html#___graphandnetwork</a>.</p>
</section>
<section class="level2" data-number="10.9" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="10.9"><span class="header-section-number">10.9</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-creategraphs">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.1</div>
</div>
<div class="callout-body-container callout-body">
<p>인접 행렬에서 시작하여 그래프를 표시하는 함수를 만듭니다. 예제에서 어떻게 작동하는지 보여줍니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-38-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-38-contents callout-collapse collapse" id="callout-38">
<div class="callout-body-container callout-body">
<!-- TODO: missing solutions here -->
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a aria-hidden="true" href="#cb71-1" tabindex="-1"></a>ggplotadjacency<span class="ot">=</span> <span class="cf">기능</span>(a) {</span>
<span id="cb71-2"><a aria-hidden="true" href="#cb71-2" tabindex="-1"></a>N<span class="ot">=</span> <span class="fu">nrow</span>(에이)</span>
<span id="cb71-3"><a aria-hidden="true" href="#cb71-3" tabindex="-1"></a>피<span class="ot">=</span> <span class="fu">NCOL</span>(에이)</span>
<span id="cb71-4"><a aria-hidden="true" href="#cb71-4" tabindex="-1"></a>에서<span class="ot">=</span>reshape2<span class="sc">::</span><span class="fu">녹다</span>(에이)</span>
<span id="cb71-5"><a aria-hidden="true" href="#cb71-5" tabindex="-1"></a>  <span class="fu">Stopifnot</span>(<span class="fu">동일한</span>(<span class="fu">nrow</span>(Fromto), n<span class="sc">*</span>피))</span>
<span id="cb71-6"><a aria-hidden="true" href="#cb71-6" tabindex="-1"></a>에서<span class="sc">$</span>값<span class="ot">=</span> <span class="fu">AS.Factor</span>(에서<span class="sc">$</span>값)</span>
<span id="cb71-7"><a aria-hidden="true" href="#cb71-7" tabindex="-1"></a>콜스<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"하얀색"</span>,,,<span class="st">"다크 블루"</span>))</span>
<span id="cb71-8"><a aria-hidden="true" href="#cb71-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">데이터 =</span>에서,,<span class="fu">AES</span>(<span class="at">x =</span>var1,<span class="at">y =</span>var2,<span class="at">fill =</span>값))<span class="sc">+</span></span>
<span id="cb71-9"><a aria-hidden="true" href="#cb71-9" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>))<span class="sc">+</span></span>
<span id="cb71-10"><a aria-hidden="true" href="#cb71-10" tabindex="-1"></a>    <span class="fu">coord_fixed</span>(<span class="at">비율 =</span> <span class="dv">1</span>,,,<span class="at">어퍼 =</span> <span class="fu">기음</span>(<span class="fl">0.5</span>, N<span class="sc">+</span> <span class="fl">0.5</span>),)<span class="at">xlim =</span> <span class="fu">기음</span>(<span class="fl">0.5</span>, p<span class="sc">+</span> <span class="fl">0.5</span>)))<span class="sc">+</span></span>
<span id="cb71-11"><a aria-hidden="true" href="#cb71-11" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">값 =</span>cols)<span class="sc">+</span></span>
<span id="cb71-12"><a aria-hidden="true" href="#cb71-12" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">이름 =</span> <span class="st">"" "</span>,,,<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span>피,<span class="at">라벨 =</span> <span class="fu">반죽</span>(<span class="dv">1</span><span class="sc">:</span>피))<span class="sc">+</span></span>
<span id="cb71-13"><a aria-hidden="true" href="#cb71-13" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(  <span class="at">이름 =</span> <span class="st">"" "</span>,,,<span class="at">breaks =</span>N<span class="sc">:</span><span class="dv">1</span>,,,<span class="at">라벨 =</span> <span class="fu">반죽</span>(N<span class="sc">:</span><span class="dv">1</span>)))<span class="sc">+</span> </span>
<span id="cb71-14"><a aria-hidden="true" href="#cb71-14" tabindex="-1"></a>    <span class="fu">테마_BW</span>() <span class="sc">+</span></span>
<span id="cb71-15"><a aria-hidden="true" href="#cb71-15" tabindex="-1"></a>    <span class="fu">주제</span>(<span class="at">axis.text =</span> <span class="fu">요소 _text</span>(<span class="at">크기 =</span> <span class="dv">14</span>),)</span>
<span id="cb71-16"><a aria-hidden="true" href="#cb71-16" tabindex="-1"></a>      <span class="at">LEGEND.KEY =</span> <span class="fu">요소 _Rect</span>(<span class="at">fill =</span> <span class="st">"하얀색"</span>),)</span>
<span id="cb71-17"><a aria-hidden="true" href="#cb71-17" tabindex="-1"></a>      <span class="at">전설. 백 그라운드 =</span> <span class="fu">요소 _Rect</span>(<span class="at">fill =</span> <span class="st">"하얀색"</span>),)</span>
<span id="cb71-18"><a aria-hidden="true" href="#cb71-18" tabindex="-1"></a>      <span class="at">PALEN.BORDER =</span> <span class="fu">요소 _blank</span>(),</span>
<span id="cb71-19"><a aria-hidden="true" href="#cb71-19" tabindex="-1"></a>      <span class="at">PALEN.GRID.MAJOR =</span> <span class="fu">요소 _blank</span>(),</span>
<span id="cb71-20"><a aria-hidden="true" href="#cb71-20" tabindex="-1"></a>      <span class="at">PALEN.GRID.MINOR =</span> <span class="fu">요소 _blank</span>(),</span>
<span id="cb71-21"><a aria-hidden="true" href="#cb71-21" tabindex="-1"></a>      <span class="at">axis.line =</span> <span class="fu">요소 _line</span>(<span class="at">색상 =</span> <span class="st">"하얀색"</span>),)</span>
<span id="cb71-22"><a aria-hidden="true" href="#cb71-22" tabindex="-1"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">요소 _blank</span>(),</span>
<span id="cb71-23"><a aria-hidden="true" href="#cb71-23" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">요소 _blank</span>() </span>
<span id="cb71-24"><a aria-hidden="true" href="#cb71-24" tabindex="-1"></a>))</span>
<span id="cb71-25"><a aria-hidden="true" href="#cb71-25" tabindex="-1"></a>}</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-GOgraph">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.2</div>
</div>
<div class="callout-body-container callout-body">
<p>유전자 기능 사이의 관계는 Gene Ontology (GO) 그래프라는 그래프로 계층 적으로 구성됩니다. 생물학적 과정은 더 미세하고 미세한 규모로 구성됩니다. 관심있는 유기체에 대한 GO 정보를 제공하는 데이터베이스 중 하나를 가져 가십시오. 유전자 목록을 선택하고 해당 목록의 GO 그래프를 작성하십시오.<br/>힌트 : 몇 가지 예제는 패키지에서 찾을 수 있습니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-PNASMarkov">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.3</div>
</div>
<div class="callout-body-container callout-body">
<p><em>질 미생물 상태의 상태 간의 전이 그래프 마르코프 체인</em>: 안에<span class="citation" data-cites="DigiulioCallahan:2015">Digiulio et al. (<a href="16-chap.html#ref-DigiulioCallahan:2015" role="doc-biblioref">2015</a>))</span>저자는 an을 사용합니다<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>사용을 사용하는 커뮤니티 상태 유형 CST 간의 전환 속도를 나타내는 플롯<strong><a href="https://cran.r-project.org/web/packages/markovchain/">Markovchain</a></strong>패키지. 데이터 및 전환율 및 상태 이름을 특별 클래스의 객체로로드하십시오.<code>Markovchain</code>그리고 정점에 대한 공변량으로 조산의 백분율을 포함하도록 레이아웃을 신중하게 조정하십시오 (이 변수에 정점 크기를 비례하게 만드십시오). 화살표의 너비로 상태 간의 전이 크기를 포함하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-41-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-41-contents callout-collapse collapse" id="callout-41">
<div class="callout-body-container callout-body">
<p>참고 : 아래 코드는 라이브가 아니며, 한 지점에서 저자를 위해 사용되는 버전은 독자가 마무리 할 수있는 출발점으로 제공되며 현대화 및 개선 기회가 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-PSB-MC-s">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PSB-MC-s-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-38" href="imgs/PSB_MC_s.png" title="Figure 10.31: This figure was originally created for the study done in @DigiulioCallahan:2015, where the nodes designate states of the vaginal microbiome and arrows represent transitions between states with different probabilities."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/PSB_MC_s.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PSB-MC-s-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.31 :이 수치는 원래 연구를 위해 만들어졌습니다.<span class="citation" data-cites="DigiulioCallahan:2015">Digiulio et al. (<a href="16-chap.html#ref-DigiulioCallahan:2015" role="doc-biblioref">2015</a>))</span>, 노드가 질 미생물 군과 화살표의 상태를 지정하는 경우, 다른 확률을 가진 상태 사이의 전이를 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Markovchain"</span>))</span>
<span id="cb72-2"><a aria-hidden="true" href="#cb72-2" tabindex="-1"></a><span class="co"># Markov 체인 객체를 만드십시오</span></span>
<span id="cb72-3"><a aria-hidden="true" href="#cb72-3" tabindex="-1"></a>MCPREG<span class="ot">=</span>  <span class="fu">새로운</span>(<span class="st">"Markovchain"</span>,,,<span class="at">상태 =</span>CSTS,</span>
<span id="cb72-4"><a aria-hidden="true" href="#cb72-4" tabindex="-1"></a>              <span class="at">TransitionMatrix =</span>트랜스,<span class="at">이름 =</span><span class="st">"pregcst"</span>))</span>
<span id="cb72-5"><a aria-hidden="true" href="#cb72-5" tabindex="-1"></a>MCPREG</span>
<span id="cb72-6"><a aria-hidden="true" href="#cb72-6" tabindex="-1"></a><span class="co"># Markov 체인의 IGraph를 설정합니다</span></span>
<span id="cb72-7"><a aria-hidden="true" href="#cb72-7" tabindex="-1"></a>netmc<span class="ot">=</span>Markovchain<span class="sc">:::</span><span class="fu">.getnet</span>(McPreg,<span class="at">라운드 =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 여러 플롯 매개 변수를 정의하고 해당 CST 및 조산 결과의 연관성을 기반으로 노드 색상을 할당하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a aria-hidden="true" href="#cb73-1" tabindex="-1"></a>wts<span class="ot">=</span>  <span class="fu">이자형</span>(NetMC)<span class="sc">$</span>무게<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb73-2"><a aria-hidden="true" href="#cb73-2" tabindex="-1"></a>에겔<span class="ot">=</span>  <span class="fu">Error 500 (Server Error)!!1500.That’s an error.There was an error. Please try again later.That’s all we know.</span>(NetMC)</span>
<span id="cb73-3"><a aria-hidden="true" href="#cb73-3" tabindex="-1"></a>Elcat<span class="ot">=</span>  <span class="fu">반죽</span>(Edgel [,<span class="dv">1</span>], Edgel [,<span class="dv">2</span>])))</span>
<span id="cb73-4"><a aria-hidden="true" href="#cb73-4" tabindex="-1"></a>엘리프<span class="ot">=</span>  <span class="fu">반죽</span>(Edgel [,<span class="dv">2</span>], Edgel [,<span class="dv">1</span>])))</span>
<span id="cb73-5"><a aria-hidden="true" href="#cb73-5" tabindex="-1"></a>Edge.curved<span class="ot">=</span>  <span class="fu">Sapply</span>(Elcat,<span class="cf">기능</span>(x) x<span class="sc">%안에%</span>Elrev)</span>
<span id="cb73-6"><a aria-hidden="true" href="#cb73-6" tabindex="-1"></a>샘플 _def<span class="ot">=</span>  <span class="fu">데이터. 프레임</span>(<span class="fu">Sample_Data</span>(추신))</span>
<span id="cb73-7"><a aria-hidden="true" href="#cb73-7" tabindex="-1"></a>샘플 _def<span class="ot">=</span>샘플 _def [샘플<span class="sc">$</span>조산아<span class="sc">|</span>샘플<span class="sc">$</span>용어,]<span class="co"># 분명히 할당 된 것, 즉 한계가 아닙니다</span></span>
<span id="cb73-8"><a aria-hidden="true" href="#cb73-8" tabindex="-1"></a>누르다<span class="ot">=</span>  <span class="fu">테이블</span>(샘플 _def<span class="sc">$</span>CST, 샘플 _def<span class="sc">$</span>조기)</span>
<span id="cb73-9"><a aria-hidden="true" href="#cb73-9" tabindex="-1"></a><span class="fu">Rownames</span>(누르다)<span class="ot">=</span>Markovchain<span class="sc">::</span><span class="fu">주</span>(MCPREG)</span>
<span id="cb73-10"><a aria-hidden="true" href="#cb73-10" tabindex="-1"></a><span class="fu">colnames</span>(누르다)<span class="ot">=</span>  <span class="fu">기음</span>(<span class="st">"용어"</span>,,,<span class="st">"조산"</span>))</span>
<span id="cb73-11"><a aria-hidden="true" href="#cb73-11" tabindex="-1"></a>누르다</span>
<span id="cb73-12"><a aria-hidden="true" href="#cb73-12" tabindex="-1"></a>누르다<span class="ot">=</span>누르다<span class="sc">/</span><span class="fu">로우 섬</span>(누르다)</span>
<span id="cb73-13"><a aria-hidden="true" href="#cb73-13" tabindex="-1"></a>vert.cstclrs<span class="ot">=</span>cstcolors</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a>default.par<span class="ot">=</span>  <span class="fu">평가</span>(<span class="at">아니요. READONLY =</span> <span class="cn">진실</span>))</span>
<span id="cb74-2"><a aria-hidden="true" href="#cb74-2" tabindex="-1"></a><span class="co"># 정의 컬러 스케일</span></span>
<span id="cb74-3"><a aria-hidden="true" href="#cb74-3" tabindex="-1"></a><span class="co"># Markov 체인의 플로팅 기능</span></span>
<span id="cb74-4"><a aria-hidden="true" href="#cb74-4" tabindex="-1"></a>PlotMC<span class="ot">=</span>  <span class="cf">기능</span>(물체, ...) {</span>
<span id="cb74-5"><a aria-hidden="true" href="#cb74-5" tabindex="-1"></a>netmc<span class="ot">=</span>Markovchain<span class="sc">:::</span><span class="fu">.getnet</span>(물체,<span class="at">라운드 =</span> <span class="cn">진실</span>))</span>
<span id="cb74-6"><a aria-hidden="true" href="#cb74-6" tabindex="-1"></a>    <span class="fu">plot.igraph</span>(<span class="at">x =</span>netmc, ...)</span>
<span id="cb74-7"><a aria-hidden="true" href="#cb74-7" tabindex="-1"></a>}</span>
<span id="cb74-8"><a aria-hidden="true" href="#cb74-8" tabindex="-1"></a><span class="co"># Markov 체인 시각화, 조산 강도의 기울기를위한 컬러 바</span></span>
<span id="cb74-9"><a aria-hidden="true" href="#cb74-9" tabindex="-1"></a>color.bar<span class="ot">=</span>  <span class="cf">기능</span>(lut, min,<span class="at">최대 =</span><span class="sc">-</span>최소<span class="at">nticks =</span><span class="dv">11</span>,,,<span class="at">진드기 =</span><span class="fu">서열</span>(Min, Max,<span class="at">len =</span>nticks),<span class="at">제목 =</span><span class="cn">널</span>) {</span>
<span id="cb74-10"><a aria-hidden="true" href="#cb74-10" tabindex="-1"></a>규모<span class="ot">=</span> (<span class="fu">길이</span>(lut)<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(최대<span class="sc">-</span>민)</span>
<span id="cb74-11"><a aria-hidden="true" href="#cb74-11" tabindex="-1"></a>cur.par<span class="ot">=</span> <span class="fu">평가</span>(<span class="at">아니요. READONLY =</span> <span class="cn">진실</span>))</span>
<span id="cb74-12"><a aria-hidden="true" href="#cb74-12" tabindex="-1"></a>    <span class="fu">평가</span>(<span class="at">mar =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">4</span>,,,<span class="dv">1</span>,,,<span class="dv">4</span>))<span class="sc">+</span> <span class="fl">0.1</span>,,,<span class="at">그 자체의 =</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>))<span class="sc">+</span> <span class="fl">0.1</span>))</span>
<span id="cb74-13"><a aria-hidden="true" href="#cb74-13" tabindex="-1"></a>    <span class="fu">평가</span>(<span class="at">ps =</span> <span class="dv">10</span>,,,<span class="at">cex =</span> <span class="fl">0.8</span>))</span>
<span id="cb74-14"><a aria-hidden="true" href="#cb74-14" tabindex="-1"></a>    <span class="fu">평가</span>(<span class="at">tcl =</span><span class="sc">-</span><span class="fl">0.2</span>,,,<span class="at">cex.axis =</span><span class="fl">0.8</span>,,,<span class="at">cex.lab =</span> <span class="fl">0.8</span>))</span>
<span id="cb74-15"><a aria-hidden="true" href="#cb74-15" tabindex="-1"></a>    <span class="fu">구성</span>(<span class="fu">기음</span>(Min, Max),<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">10</span>),)<span class="at">유형 =</span><span class="st">'N'</span>,,,<span class="at">bty =</span><span class="st">'N'</span>,,,<span class="at">xaxt =</span><span class="st">'N'</span>,,,<span class="at">xlab =</span><span class="st">"yaht = 'n', wabper ="</span>,,,<span class="at">메인 =</span>제목)</span>
<span id="cb74-16"><a aria-hidden="true" href="#cb74-16" tabindex="-1"></a>    <span class="fu">중심선</span>(<span class="dv">1</span>,,,<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="fl">0.5</span>,,,<span class="dv">1</span>)))</span>
<span id="cb74-17"><a aria-hidden="true" href="#cb74-17" tabindex="-1"></a>    <span class="cf">~을 위한</span>(나<span class="cf">~에</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">길이</span>(lut)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb74-18"><a aria-hidden="true" href="#cb74-18" tabindex="-1"></a>엑스<span class="ot">=</span>(나<span class="dv">-1</span>))<span class="sc">/</span>규모<span class="sc">+</span>최소</span>
<span id="cb74-19"><a aria-hidden="true" href="#cb74-19" tabindex="-1"></a>      <span class="fu">rect</span>(엑스,<span class="dv">0</span>,엑스<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>규모,<span class="dv">10</span>,,,<span class="at">col =</span>lut [i],<span class="at">국경 =</span><span class="cn">NA</span>))</span>
<span id="cb74-20"><a aria-hidden="true" href="#cb74-20" tabindex="-1"></a>    }</span>
<span id="cb74-21"><a aria-hidden="true" href="#cb74-21" tabindex="-1"></a>}</span>
<span id="cb74-22"><a aria-hidden="true" href="#cb74-22" tabindex="-1"></a></span>
<span id="cb74-23"><a aria-hidden="true" href="#cb74-23" tabindex="-1"></a>단짝<span class="ot">=</span>  <span class="fu">colormppalette</span>(<span class="fu">기음</span>(<span class="st">"grey50"</span>,,,<span class="st">"적갈색"</span>,,,<span class="st">"Magenta2"</span>)) (<span class="dv">101</span>))</span>
<span id="cb74-24"><a aria-hidden="true" href="#cb74-24" tabindex="-1"></a>vert.clrs<span class="ot">=</span>  <span class="fu">Sapply</span>(<span class="fu">주</span>(MCPREG),<span class="cf">기능</span>(x) pal [<span class="dv">1</span><span class="sc">+</span><span class="fu">둥근</span>(<span class="dv">100</span><span class="sc">*</span>premat [x,<span class="st">"조산"</span>])])</span>
<span id="cb74-25"><a aria-hidden="true" href="#cb74-25" tabindex="-1"></a>VERT.SZ<span class="ot">=</span>  <span class="dv">4</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">Sapply</span>(<span class="fu">주</span>(MCPREG),</span>
<span id="cb74-26"><a aria-hidden="true" href="#cb74-26" tabindex="-1"></a>              <span class="cf">기능</span>(엑스)<span class="fu">nrow</span>(<span class="fu">고유한</span>(<span class="fu">Sample_Data</span>(추신)[<span class="fu">Sample_Data</span>(추신)<span class="sc">$</span>CST<span class="sc">==</span>엑스,<span class="st">"주제"</span>])))</span>
<span id="cb74-27"><a aria-hidden="true" href="#cb74-27" tabindex="-1"></a>VERT.SZ<span class="ot">=</span>VERT.SZ<span class="sc">*</span> <span class="fl">0.85</span></span>
<span id="cb74-28"><a aria-hidden="true" href="#cb74-28" tabindex="-1"></a>vert.font.clrs<span class="ot">=</span>  <span class="fu">기음</span>(<span class="st">"하얀색"</span>,,,<span class="st">"하얀색"</span>,,,<span class="st">"하얀색"</span>,,,<span class="st">"하얀색"</span>,,,<span class="st">"하얀색"</span>))</span>
<span id="cb74-29"><a aria-hidden="true" href="#cb74-29" tabindex="-1"></a></span>
<span id="cb74-30"><a aria-hidden="true" href="#cb74-30" tabindex="-1"></a><span class="co"># e (netmc) Edge 목록을 보려면 vertex가 아닌 # in edge 목록에 의해 개별적으로 루프 각도를 정의해야합니다.</span></span>
<span id="cb74-31"><a aria-hidden="true" href="#cb74-31" tabindex="-1"></a>Edge.loop.angle<span class="ot">=</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="fl">3.14</span>,,,<span class="fl">3.14</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="fl">3.14</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>))<span class="sc">-</span><span class="fl">0.45</span></span>
<span id="cb74-32"><a aria-hidden="true" href="#cb74-32" tabindex="-1"></a>공들여 나열한 것<span class="ot">=</span>  <span class="fu">행렬</span>(<span class="fu">기음</span>(<span class="fl">0.6</span>,,,<span class="fl">0.95</span>,,,<span class="fl">0.43</span>,,,<span class="dv">1</span>,,,<span class="fl">0.3</span>,,,<span class="fl">0.66</span>,,,<span class="fl">0.55</span>,,,<span class="fl">0.3</span>,,,<span class="fl">0.75</span>,,,<span class="fl">0.65</span>),)<span class="at">nrow =</span> <span class="dv">5</span>,,,<span class="at">NCOL =</span> <span class="dv">2</span>,,,<span class="at">Byrow =</span> <span class="cn">진실</span>))</span>
<span id="cb74-33"><a aria-hidden="true" href="#cb74-33" tabindex="-1"></a></span>
<span id="cb74-34"><a aria-hidden="true" href="#cb74-34" tabindex="-1"></a><span class="co"># 조산과 관련하여 색상</span></span>
<span id="cb74-35"><a aria-hidden="true" href="#cb74-35" tabindex="-1"></a><span class="fu">공들여 나열한 것</span>(<span class="fu">행렬</span>(<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">2</span>,,,<span class="dv">2</span>),)<span class="dv">2</span>,,,<span class="dv">2</span>,,,<span class="at">Byrow =</span> <span class="cn">진실</span>),)<span class="at">높이 =</span><span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">10</span>)))</span>
<span id="cb74-36"><a aria-hidden="true" href="#cb74-36" tabindex="-1"></a><span class="fu">color.bar</span>(단짝,<span class="at">최소 =</span><span class="dv">0</span>,,,<span class="at">최대 =</span><span class="dv">1</span>,,,<span class="at">nticks =</span><span class="dv">6</span>,,,<span class="at">제목 =</span><span class="st">"분수 조산"</span>))</span>
<span id="cb74-37"><a aria-hidden="true" href="#cb74-37" tabindex="-1"></a><span class="fu">평가</span>(<span class="at">mar =</span><span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>))<span class="sc">+</span><span class="fl">0.1</span>))</span>
<span id="cb74-38"><a aria-hidden="true" href="#cb74-38" tabindex="-1"></a>Edge.arrow.size<span class="ot">=</span><span class="fl">0.8</span></span>
<span id="cb74-39"><a aria-hidden="true" href="#cb74-39" tabindex="-1"></a>Edge.arrow.width<span class="ot">=</span><span class="fl">1.4</span></span>
<span id="cb74-40"><a aria-hidden="true" href="#cb74-40" tabindex="-1"></a>Edge.width<span class="ot">=</span> (<span class="dv">15</span><span class="sc">*</span>wts<span class="sc">+</span> <span class="fl">0.1</span>))<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb74-41"><a aria-hidden="true" href="#cb74-41" tabindex="-1"></a>Edge.labels<span class="ot">=</span>  <span class="fu">AS.CHARACTER</span>(<span class="fu">이자형</span>(NetMC)<span class="sc">$</span>무게<span class="sc">/</span><span class="dv">100</span>))</span>
<span id="cb74-42"><a aria-hidden="true" href="#cb74-42" tabindex="-1"></a>Edge.labels [Edge.labels<span class="sc">&lt;</span><span class="fl">0.4</span>]]<span class="ot">=</span>  <span class="cn">NA</span>  <span class="co"># 셀프 루프용 라벨</span></span>
<span id="cb74-43"><a aria-hidden="true" href="#cb74-43" tabindex="-1"></a><span class="fu">PlotMC</span>(McPreg,<span class="at">Edge.arrow.size =</span>Edge.arrow.size,<span class="at">edge.arrow.width =</span>Edge.arrow.width,</span>
<span id="cb74-44"><a aria-hidden="true" href="#cb74-44" tabindex="-1"></a>       <span class="at">edge.width =</span>Edge.width,<span class="at">Edge.curved =</span>Edge.curved,</span>
<span id="cb74-45"><a aria-hidden="true" href="#cb74-45" tabindex="-1"></a>       <span class="at">vertex.color =</span>vert.clrs,<span class="at">vertex.size =</span>(VERT.SZ),</span>
<span id="cb74-46"><a aria-hidden="true" href="#cb74-46" tabindex="-1"></a>       <span class="at">vertex.label.font =</span> <span class="dv">2</span>,,,<span class="at">vertex.label.cex =</span> <span class="dv">1</span>,,,</span>
<span id="cb74-47"><a aria-hidden="true" href="#cb74-47" tabindex="-1"></a>       <span class="at">vertex.label.color =</span>vert.font.clrs,<span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,,,</span>
<span id="cb74-48"><a aria-hidden="true" href="#cb74-48" tabindex="-1"></a>       <span class="at">레이아웃 =</span>공들여 나열한 것,<span class="at">edge.loop.angle =</span>Edge.loop.angle)</span>
<span id="cb74-49"><a aria-hidden="true" href="#cb74-49" tabindex="-1"></a><span class="fu">평가</span>(default.par)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-ppinteraction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.4</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>단백질 상호 작용 네트워크</strong>: Wikipedia 기사를 읽으십시오<a href="https://en.wikipedia.org/wiki/STRING">끈</a>데이터베이스 (http://www.string-db.org).<br/>단백질 사이클린 B1은 CCNB1 유전자에 의해 암호화된다. Wikipedia에서 여기에서 읽을 수 있습니다.<a class="uri" href="https://en.wikipedia.org/wiki/Cyclin_B1">https://en.wikipedia.org/wiki/cyclin_b1</a>.<br/>문자열을 사용하여 텍스트 파일을 생성하십시오 (호출하십시오<em>ccnb1datsmall.txt</em>CCNB1 유전자 주위의 가장자리의). Co-Expression의 증거로 연결된 노드를 0.9보다 높은 신뢰로 선택합니다. 그래프에서 CCNB1에서 2 단계 떨어진 50 개 이하의 상호 작용 및 추가 노드를 수집하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-43-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-43-contents callout-collapse collapse" id="callout-43">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>가십시오<a href="http://www.string-db.org">http://www.string-db.org</a>.</p></li>
<li><p>CCNB1을 단백질 이름으로 입력하고 유기체로 호모 사피엔스를 입력하십시오. “계속!”을 클릭하십시오.</p></li>
<li><p>단백질 CCNB1 (상단)으로 옵션을 선택하십시오.</p></li>
<li><p>"정보 및 매개 변수…"4a로 아래로 스크롤하십시오. 활성 예측 방법의 경우-"공동 표현"을 제외한 모든 것을 선택하지 않습니다. 필수 신뢰 -“최고 신뢰도 (0.900) 4c. 표시된 상호 작용자의 경우 -“50 개 이하의 인터랙터”4D를 선택하십시오.</p></li>
<li><p>그림 아래에서 "저장"을 클릭하십시오 (디스켓 표시). 새 창이 열리면 데이터를 저장할 형식을 선택할 수 있습니다.</p></li>
<li><p>"TEXT- Summer (TXT- Simple Tab Delimited Flatfile)"로 스크롤하여 해당 문서를 다음과 같이 저장하십시오.<em>ccnb1datsmall.txt</em>.</p></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-graphinput">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.5</div>
</div>
<div class="callout-body-container callout-body">
<p>txt 파일을 읽으십시오<em>ccnb1datsmall.txt</em>이 장에서 다루는 그래프 시각화 방법 중 하나를 사용하여 r로, 그래프 플롯을 작성하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-45-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-45-contents callout-collapse collapse" id="callout-45">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ccnb1img">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccnb1img-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-39" href="imgs/ccnb1img.png" title="Figure 10.32: This network was created with the STRING website by setting a 2 step neighborhood around the CCNB1 gene for co-expression levels \geq 0.900."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/ccnb1img.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccnb1img-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.32 :이 네트워크는 CCNB1 유전자 주위에 공동 표현 수준에 대해 2 단계 이웃을 설정하여 문자열 웹 사이트로 만들어졌습니다.<span class="math inline">\ (\ geq \)</span>0.900.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a aria-hidden="true" href="#cb75-1" tabindex="-1"></a>저것<span class="ot">=</span> <span class="fu">read.table</span>(<span class="fu">file.path</span>(데이터,<span class="st">"ccnb1datsmall.txt"</span>),)<span class="at">헤더 =</span> <span class="cn">진실</span>,,,<span class="at">comment.char =</span> <span class="st">"" "</span>,,,<span class="at">stringsasfactors =</span> <span class="cn">진실</span>))</span>
<span id="cb75-2"><a aria-hidden="true" href="#cb75-2" tabindex="-1"></a>다섯<span class="ot">=</span> <span class="fu">레벨</span>(<span class="fu">무제한</span>(저것[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="co"># 정점 이름</span></span>
<span id="cb75-3"><a aria-hidden="true" href="#cb75-3" tabindex="-1"></a>N<span class="ot">=</span> <span class="fu">길이</span>(다섯)<span class="co"># 정점 수</span></span>
<span id="cb75-4"><a aria-hidden="true" href="#cb75-4" tabindex="-1"></a>이자형<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">성냥</span>(<span class="fu">AS.CHARACTER</span>(<span class="fu">무제한</span>(저것[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])), v),<span class="at">NCOL =</span><span class="dv">2</span>))<span class="co"># 에지 목록</span></span>
<span id="cb75-5"><a aria-hidden="true" href="#cb75-5" tabindex="-1"></a>w<span class="ot">=</span>저것<span class="sc">$</span>공동 발현<span class="co"># 가장자리 가중치</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>M은 우리의 공동 발현 네트워크 인접 매트릭스입니다. 문자열 데이터는 단백질 i와 j가 공동 발현되어 (i, j)와 (j, i)를 구별하지 않는 경우에만 나타나기 때문에 (i, j)는 (j, i)의 중량을 고려하여 M 대칭 (무시되지 않은)을 만들려고합니다. a는 우리의 공동 발현 그래프 인접 매트릭스이며 우리는<span class="math inline">\ (a_ {ij} = 1 \)</span>그들이 공동 발현된다면.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a>중<span class="ot">=</span> <span class="fu">행렬</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb76-2"><a aria-hidden="true" href="#cb76-2" tabindex="-1"></a>나]<span class="ot">=</span>w</span>
<span id="cb76-3"><a aria-hidden="true" href="#cb76-3" tabindex="-1"></a>중<span class="ot">=</span>중<span class="sc">+</span> <span class="fu">티</span>(중)</span>
<span id="cb76-4"><a aria-hidden="true" href="#cb76-4" tabindex="-1"></a><span class="fu">Dimnames</span>(중)<span class="ot">=</span> <span class="fu">목록</span>(V, V)</span>
<span id="cb76-5"><a aria-hidden="true" href="#cb76-5" tabindex="-1"></a>에이<span class="ot">=</span> <span class="dv">1</span><span class="sc">*</span>(중<span class="sc">&gt;</span> <span class="dv">0</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>기본 플로팅 매개 변수를 사용하고 패키지를 사용하여 그래프를 생성합니다.<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>시작<code>이자형</code>, 가장자리의 벡터 (대안은 인접성 행렬 A를 사용하는 것입니다).</p>
<!-- TODO: there's actually no set.seed() here? -->
<p><em>메모:</em>우리는 씨앗을 사용하여 그래프를 항상 동일하게 보이게합니다. 그래프 레이아웃에는 종종 그래프 자체가 동일하지만 그림을 다르게 보이게하는 임의의 구성 요소의 최적화가 포함됩니다.</p>
<!--```{r}
#| child: devil.qmd
#| fig-cap: "We use a seed to make the graph always look the same. Graph layout often contains an optimization with a random component that makes the picture look different, although the graph itself is the same."
```-->
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a><span class="fu">도서관</span>(IGraph)</span>
<span id="cb77-2"><a aria-hidden="true" href="#cb77-2" tabindex="-1"></a>그물<span class="ot">=</span> <span class="fu">회로망</span>(이자형,<span class="at">지시 =</span><span class="cn">거짓</span>))</span>
<span id="cb77-3"><a aria-hidden="true" href="#cb77-3" tabindex="-1"></a><span class="fu">평가</span>(<span class="at">mar =</span><span class="fu">대표</span>(<span class="dv">0</span>,,,<span class="dv">4</span>)))</span>
<span id="cb77-4"><a aria-hidden="true" href="#cb77-4" tabindex="-1"></a><span class="fu">구성</span>(그물,<span class="at">레이블 =</span>다섯)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>당신은 그래프를 만들 수 있습니다<strong><a href="https://cran.r-project.org/web/packages/ggraph/">ggraph</a></strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-heatmap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.6</div>
</div>
<div class="callout-body-container callout-body">
<p>생성 된 그래프의 인접 행렬을 보여주는 히트 맵을 만듭니다.<a class="quarto-xref" href="#imp-graphs-graphinput">운동<span>10.5</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-47-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-47-contents callout-collapse collapse" id="callout-47">
<div class="callout-body-container callout-body">
<p>색상 변경을 제외하고 히트 맵을 만드는 데 기본값을 사용하면 추가 매개 변수를 실험하고 추가 할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a>깨진<span class="ot">=</span>  <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="fu">서열</span>(<span class="fl">0.9</span>,,,<span class="dv">1</span>,,,<span class="at">길이 =</span><span class="dv">11</span>)))</span>
<span id="cb78-2"><a aria-hidden="true" href="#cb78-2" tabindex="-1"></a>콜스<span class="ot">=</span>  <span class="fu">회색</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="fu">서열</span>(<span class="fl">0.5</span>,,,<span class="dv">1</span>,,,<span class="at">길이 =</span><span class="dv">10</span>))))</span>
<span id="cb78-3"><a aria-hidden="true" href="#cb78-3" tabindex="-1"></a>ccnb1ind<span class="ot">=</span>  <span class="fu">어느</span>(다섯<span class="sc">==</span> <span class="st">"CCNB1"</span>))</span>
<span id="cb78-4"><a aria-hidden="true" href="#cb78-4" tabindex="-1"></a>vcole<span class="ot">=</span>  <span class="fu">대표</span>(<span class="st">"하얀색"</span>,N)</span>
<span id="cb78-5"><a aria-hidden="true" href="#cb78-5" tabindex="-1"></a>VCOL [CCNB1IND]<span class="ot">=</span>  <span class="st">"파란색"</span></span>
<span id="cb78-6"><a aria-hidden="true" href="#cb78-6" tabindex="-1"></a>vcol [<span class="fu">어느</span>(m [, ccnb1ind]<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">|</span>m [ccnb1ind,])]]<span class="ot">=</span>  <span class="st">"빨간색"</span></span>
<span id="cb78-7"><a aria-hidden="true" href="#cb78-7" tabindex="-1"></a><span class="fu">평가</span>(<span class="at">mar =</span> <span class="fu">대표</span>(<span class="dv">0</span>,,,<span class="dv">4</span>)))</span>
<span id="cb78-8"><a aria-hidden="true" href="#cb78-8" tabindex="-1"></a><span class="fu">히트 맵</span>(중,<span class="at">symm =</span> <span class="cn">진실</span>,,,<span class="at">colsidecolors =</span>vcol,<span class="at">rowsidecolors =</span>vcol,</span>
<span id="cb78-9"><a aria-hidden="true" href="#cb78-9" tabindex="-1"></a>        <span class="at">col =</span>콜스,<span class="at">breaks =</span>휴식,<span class="at">프레임 =</span> <span class="cn">진실</span>))</span>
<span id="cb78-10"><a aria-hidden="true" href="#cb78-10" tabindex="-1"></a><span class="fu">전설</span>(<span class="st">"부호도"</span>,,,<span class="fu">기음</span>(<span class="st">"이웃 (CCNB1)"</span>,,,<span class="st">"CCNB1"</span>),)</span>
<span id="cb78-11"><a aria-hidden="true" href="#cb78-11" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">기음</span>(<span class="st">"빨간색"</span>,,,<span class="st">"파란색"</span>),)</span>
<span id="cb78-12"><a aria-hidden="true" href="#cb78-12" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"N"</span>,,,<span class="at">inset =</span> <span class="dv">0</span>,,,<span class="at">xpd =</span> <span class="cn">진실</span>,,,<span class="at">국경 =</span> <span class="cn">거짓</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-heatmapCCNB1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heatmapCCNB1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-40" href="10-chap_files/figure-html/fig-heatmapCCNB1-1.png" title="Figure 10.33: This represents the adjacency of the CCNB1 network – 2 step neighborhood with co-expression levels \geq 0.900, generated from R (darker is closer to 1, we ignore values &lt; 0.9)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="10-chap_files/figure-html/fig-heatmapCCNB1-1.png" width="480"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heatmapCCNB1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.33 : 이것은 CCNB1 네트워크의 인접성을 나타냅니다-공동 발현 수준을 가진 2 단계 이웃<span class="math inline">\ (\ geq \)</span>r에서 생성 된 0.900 (어두운 것은 1에 가깝고 값 &lt;0.9)을 무시합니다).</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-visualizeinteractions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.7</div>
</div>
<div class="callout-body-container callout-body">
<p>시각화는 CCNB1의 2 단계 이웃에서 가장 강력한 상호 작용을 보여줍니다. 플롯 된 그래프와 히트 맵 이미지는 동일한 데이터를 보여줍니다. CCNB1과 모두 유사한 단백질 클러스터가있는 것 같습니다. 다른 단백질에는 다른 클러스터도 있습니다. CCNB1 클러스터의 많은 단백질은 서로 동시에 공동 발현됩니다.<br/>왜 이것이 사실일까요?<br/>반대로, CCNB1 (2 걸음 떨어진)과 공동 발현되는 단백질과 공동 발현되는 단백질은 서로 공동 발현되는 경향이 없습니다.<br/>그림 중 하나 (플롯 또는 히트 맵)에서 이것을 다른 것보다 더 쉽게 볼 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-comparephylogeny">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.8</div>
</div>
<div class="callout-body-container callout-body">
<p>사용을 비교하십시오<strong><a href="https://cran.r-project.org/web/packages/ape/">원숭이</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/phangorn/">Phangorn</a></strong>HIV 개그 데이터 분석에서. 두 패키지를 사용하여 서열 사이의 Jukes Cantor 거리를 계산하고 해밍 거리와 비교하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"원숭이"</span>))</span>
<span id="cb79-2"><a aria-hidden="true" href="#cb79-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Phangorn"</span>))</span>
<span id="cb79-3"><a aria-hidden="true" href="#cb79-3" tabindex="-1"></a>개그<span class="ot">=</span> <span class="fu">read.dna</span>(<span class="fu">file.path</span>(데이터,<span class="st">"DNA_GAG_20.TXT"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-graphs-CurtisThreshold">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 10.9</div>
</div>
<div class="callout-body-container callout-body">
<p>Bray-Curtis 비 유사성을 사용하여 "2 번의"이웃 그래프로 Friedman – Rafksy 유형 테스트를 수행하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-51-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-51-contents callout-collapse collapse" id="callout-51">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a>GT<span class="ot">=</span> <span class="fu">Graph_Perm_test</span>(PS1,<span class="st">"family_relationship"</span>,,,<span class="at">거리 =</span> <span class="st">"갈아 바수다"</span>,,,</span>
<span id="cb80-2"><a aria-hidden="true" href="#cb80-2" tabindex="-1"></a>                     <span class="at">그룹화 =</span> <span class="st">"host_subject_id"</span>,,,<span class="at">유형 =</span> <span class="st">"Knn"</span>,,,<span class="at">Knn =</span> <span class="dv">2</span>))</span>
<span id="cb80-3"><a aria-hidden="true" href="#cb80-3" tabindex="-1"></a>GT<span class="sc">$</span>PVAL</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-layout-nrow="1" data-warning.known="All aesthetics have length">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a><span class="fu">plot_test_network</span>(GT)</span>
<span id="cb82-2"><a aria-hidden="true" href="#cb82-2" tabindex="-1"></a>permdf<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(<span class="at">파마 =</span>GT<span class="sc">$</span>파마)</span>
<span id="cb82-3"><a aria-hidden="true" href="#cb82-3" tabindex="-1"></a>OBS<span class="ot">=</span>GT<span class="sc">$</span>관찰되었습니다</span>
<span id="cb82-4"><a aria-hidden="true" href="#cb82-4" tabindex="-1"></a>ymax<span class="ot">=</span> <span class="fu">맥스</span>(Gt<span class="sc">$</span>파마)</span>
<span id="cb82-5"><a aria-hidden="true" href="#cb82-5" tabindex="-1"></a><span class="fu">ggplot</span>(permdf,<span class="fu">AES</span>(<span class="at">x =</span>파마))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb82-6"><a aria-hidden="true" href="#cb82-6" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">AES</span>(<span class="at">x =</span>OBS,<span class="at">y =</span> <span class="dv">0</span>,,,<span class="at">xend =</span>OBS,<span class="at">yend =</span>ymax<span class="sc">/</span><span class="dv">10</span>),)<span class="at">색상 =</span> <span class="st">"빨간색"</span>))<span class="sc">+</span></span>
<span id="cb82-7"><a aria-hidden="true" href="#cb82-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">AES</span>(<span class="at">x =</span>OBS,<span class="at">y =</span>ymax<span class="sc">/</span><span class="dv">10</span>),)<span class="at">색상 =</span> <span class="st">"빨간색"</span>))<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"순수한 가장자리의 수"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel" id="fig-knn-2-plot">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-knn-2-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-knn-2-plot" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-knn-2-plot-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-knn-2-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-knn-2-plot" href="10-chap_files/figure-html/fig-knn-2-plot-1.png" title="Figure 10.34 (a): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-knn-2-plot" src="10-chap_files/figure-html/fig-knn-2-plot-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-knn-2-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-knn-2-plot" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-knn-2-plot-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-knn-2-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-knn-2-plot" href="10-chap_files/figure-html/fig-knn-2-plot-2.png" title="Figure 10.34 (b): \text{}"><img class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-knn-2-plot" src="10-chap_files/figure-html/fig-knn-2-plot-2.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-knn-2-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)<span class="math inline">\(\텍스트{}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-knn-2-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 10.34 : Jaccard 유사성이있는 가장 가까운 두 개의 이웃 그래프에서 얻은 그래프 (a) 및 순열 히스토그램 (b).</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-BioNet" role="listitem">Beisser, Daniela, Gunnar W Klau, Thomas Dandekar, Tobias Müller 및 Marcus T Dittrich. 2010 년.<span>"<span>비오넷</span>: an<span>아르 자형</span>-생물학적 네트워크의 기능 분석을위한 포장.”</span> <em>생물 정보학</em>26 (8) : 1129–30.</div>
<div class="csl-entry" id="ref-benjamini2014selective" role="listitem">Benjamini, Yoav 및 Marina Bogomolov. 2014.<span>"가설의 여러 가족에 대한 선택적 추론."</span> <em>왕실 통계 학회지 : 시리즈 b</em>76 (1) : 297–318.</div>
<div class="csl-entry" id="ref-benjamini2003hierarchical" role="listitem">Benjamin, Yovaav 및 Daniel Teli. 2003.<span>“계층 적<span>FDR</span>가설의 나무 테스트.”</span>통계학과 기술 보고서; 텔 아비브 대학교 운영 연구.</div>
<div class="csl-entry" id="ref-Bhattacharya:2015" role="listitem">Bhattacharya, Bhaswar B. 2015.<span>"그래프 기반 2- 표본 테스트의 힘."</span> <em>ARXIV PREPRINT ARXIV : 1508.07530</em>.
</div>
<div class="csl-entry" id="ref-beast" role="listitem">Bouckaert, Remco, Joseph Heled, Denise Kühnert, Tim Vaughan, Chieh-Hsi Wu, Dong Xie, Marc A Suchard, Andrew Rambaut 및 Alexei J Drummond. 2014.<span>"<span>짐승 2</span>: 베이지안 진화 분석을위한 소프트웨어 플랫폼.”</span> <em>PLOS 계산 생물학</em>10 (4) : E1003537.</div>
<div class="csl-entry" id="ref-Callahan:2017" role="listitem">Callahan, Benjamin J, Paul J McMurdie 및 Susan P Holmes. 2017.<span>"정확한 서열 변형은 마커 유전자 데이터 분석에서 작동 분류 학적 단위를 대체해야합니다."</span> <em>ISM 저널</em>, 1–5.</div>
<div class="csl-entry" id="ref-distory-paper" role="listitem">Chakerian, John 및 Susan Holmes. 2012.<span>"계통 발생 학적 및 계층 적 클러스터링 트리를 평가하기위한 계산 도구."</span> <em>계산 및 그래픽 통계 저널</em>21 (3) : 581–99.</div>
<div class="csl-entry" id="ref-cole2009rdp" role="listitem">Cole, J. R., Q. Wang, E. Cardenas, J. Fish, B. Chai, R. J. Farris, A. S. Kulam-Syed-Mohideen 등. 2009 년.<span>"리보솜 데이터베이스 프로젝트 : RRNA 분석을위한 정렬 및 새로운 도구 개선."</span> <em>핵산 연구</em>37 (보충 1) : D141–45.</div>
<div class="csl-entry" id="ref-DigiulioCallahan:2015" role="listitem">Digiulio, Daniel B., Benjamin J. Callahan, Paul J. McMurdie, Elizabeth K. Costello, Deirdre J. Lyelle, Anna Robaczewska, Christine L. Sun 등 2015.<span>"임신 중에 인간 미생물 총의 시간적 및 공간적 변화."</span> <em>PNA</em>.
</div>
<div class="csl-entry" id="ref-fels:book" role="listitem">펠슨 슈타인, 조셉 2004.<em>계통 발생을 유추합니다</em>. 보스턴 : Sinauer.</div>
<div class="csl-entry" id="ref-friedman1979multivariate" role="listitem">Friedman, Jerome H 및 Lawrence C Rafsky. 1979.<span>"Wald-Wolfowitz 및 Smirnov 2- 표본 테스트의 다변량 일반화."</span> <em>통계의 연대기</em>, 697–717.</div>
<div class="csl-entry" id="ref-Fukuyama:2012" role="listitem">후쿠야마, 줄리아, 폴 J McMurdie, Les Dethlefsen, David a Relman 및 Susan Holmes. 2012.<span>"미생물 연구에서 공변량과 풍부함을 결합하기위한 거리 방법의 비교."</span>~ 안에<em>Pac Symp Biocomput</em>. 세계 과학.</div>
<div class="csl-entry" id="ref-holmesima" role="listitem">홈즈, 수잔 1999.<span>"계통 발생 나무 : 개요."</span>~ 안에<em>통계 및 유전학</em>, 81–118. 112. New York : Springer가 있습니다.</div>
<div class="csl-entry" id="ref-Holmes-2003" role="listitem">———. 2003a.<span>"부트 스트래핑 계통 발생 나무 : 이론과 방법."</span> <em>통계 과학</em>18 (2) : 241–55.</div>
<div class="csl-entry" id="ref-holmes2003b" role="listitem">———. 2003b.<span>"<span class="nocase">계통 발생 나무에 대한 통계</span>.”</span> <em>이론적 인구 생물학</em>63 (1) : 17–32.</div>
<div class="csl-entry" id="ref-Ideker:2002" role="listitem">Ideaker, Trey, Owen Ozier, Benno Schwikowski 및 Andrew F Siegel. 2002.<span>"분자 상호 작용 네트워크에서 규제 및 신호 회로 발견."</span> <em>생물 정보학</em>18 Suppl 1 (1 월) : S233–40.<a href="http://bioinformatics.oxfordjournals.org/cgi/reprint/18/suppl\_1/S233">http://bioinformatics.oxfordjournals.org/cgi/reprint/18/suppl\_1/s233</a>.
</div>
<div class="csl-entry" id="ref-WHLi" role="listitem">Li, Wen-Hsiung. 1997.<em>분자 진화.</em>Sinauer Associates Incorporated.</div>
<div class="csl-entry" id="ref-LiandGraur" role="listitem">Li, Wen-Hsiung 및 Dan Graur. 1991.<em>분자 진화의 기초</em>. vol. 48. Sinauer Associates Sunderland, MA.</div>
<div class="csl-entry" id="ref-MSigDB" role="listitem">Liberzon, Arthur, Aravind Subramanian, Reid Pinchback, Helga Thorvaldsdóttir, Pablo Tamayo 및 Jill P Mesirov. 2011.<span>“분자 서명 데이터베이스 (<span>MIGDB</span>) 3.0.”</span> <em>생물 정보학</em>27 (12) : 1739–40.</div>
<div class="csl-entry" id="ref-LoveDESeq2" role="listitem">사랑, Michael I, Wolfgang Huber 및 Simon Anders. 2014.<span>“접힘 변화와 분산의 중재 된 추정<span class="nocase">RNA-seq</span>데이터<span>deseq2</span>.”</span> <em>그놈 생물학</em>15 (12) : 1–21.</div>
<div class="csl-entry" id="ref-mcmurdie2014" role="listitem">McMurdie, Paul J 및 Susan Holmes. 2014.<span>"폐기물은 원하지 않습니다.</span> <em>PLOS 계산 생물학</em>10 (4) : E1003531.</div>
<div class="csl-entry" id="ref-mcmurdie2015" role="listitem">———. 2015.<span>"Shiny-PhyloseQ : 출처 추적을 통한 대화식 미생물 분석을위한 웹 응용 프로그램."</span> <em>생물 정보학</em>31 (2) : 282–83.</div>
<div class="csl-entry" id="ref-Mossel:2003" role="listitem">이끼, 엘 차난. 2003.<span>"조상 데이터와 계통 발생을 재구성하는 데 불가능합니다."</span> <em>전산 생물학 저널</em>10 (5) : 669–76.</div>
<div class="csl-entry" id="ref-GXNA" role="listitem">Nacu, Serban, Rebecca Critchley-Thorne, Peter Lee 및 Susan Holmes. 2007.<span>"유전자 발현 네트워크 분석 및 면역학에 대한 응용."</span> <em>생물 정보학</em>23 (7, 7) : 850–58.<a href="https://doi.org/10.1093/bioinformatics/btm019">https://doi.org/10.1093/bioinformatics/btm019</a>.
</div>
<div class="csl-entry" id="ref-Nolan:2013" role="listitem">Nolan, Daniel J, Michael Ginsberg, Ed Israel, Brisa Police, 2013.<span>"장기 유지 및 재생에서 조직-특이 적 미세 혈관 내피 세포 이질성의 분자 시그니처."</span> <em>발달 세포</em>26 (2) : 204–19.</div>
<div class="csl-entry" id="ref-paradis:2011" role="listitem">Paradis, Emmanuel. 2011.<em>r을 사용한 계통 발생학 및 진화의 분석</em>. Springer Science &amp; Business Media.</div>
<div class="csl-entry" id="ref-Pounds2003" role="listitem">파운드, 스탠, 스테판 W 모리스. 2003.<span>"p- 값의 경험적 분포를 근사화하고 분할하여 마이크로 어레이 연구에서 잘못된 양성 및 잘못된 부정의 발생을 추정한다."</span> <em>생물 정보학</em>19 (10) : 1236–42.</div>
<div class="csl-entry" id="ref-Purdom2010" role="listitem">Purdom, 엘리자베스. 2010 년.<span>"데이터 매트릭스 및 그래프 분석 : Metagenomic 데이터 및 계통 발생 트리."</span> <em>응용 통계의 연대기</em>, 7 월.</div>
<div class="csl-entry" id="ref-HIVdb" role="listitem">Rhee, Soo-Yon, Matthew J Gonzales, Rami Kantor, Bradley J Betts, Jaideep Ravela 및 Robert W Shafer. 2003.<span>"인간 면역 결핍 바이러스 역전사 효소 및 프로테아제 서열 데이터베이스."</span> <em>핵산 연구</em>31 (1) : 298–303.</div>
<div class="csl-entry" id="ref-robins:2007" role="listitem">Robins, Garry, Tom Snijders, Peng Wang, Mark Handcock 및 Philippa Pattison. 2007.<span>"소셜 네트워크에 대한 지수 랜덤 그래프 (P*) 모델의 최근 개발."</span> <em>소셜 네트워크</em>29 (2) : 192–215.</div>
<div class="csl-entry" id="ref-mrbayes3" role="listitem">Ronquist, Fredrik, Maxim Teslenko, Paul van der Mark, Daniel L Ayres, Aaron Darling, Sebastian Höhna, Bret Larget, Liang Liu, Marc A Suchard 및 John P Huelsenbeck. 2012.<span>"Mrbayes 3.2 : 대형 모델 공간에서 효율적인 베이지안 계통 발생 학적 추론 및 모델 선택."</span> <em>체계적인 생물학</em>61 (3) : 539–42.</div>
<div class="csl-entry" id="ref-sankaran2014structssi" role="listitem">Sankaran, Kris 및 Susan Holmes. 2014.<span>"<span class="nocase">structssi : 그룹화 또는 계층 적으로 구조화 된 데이터에 대한 동시 및 선택적 추론</span>.”</span> <em>통계 소프트웨어 저널</em>59 (1) : 1–21.</div>
<div class="csl-entry" id="ref-schilling1986multivariate" role="listitem">Schilling, Mark F. 1986.<span>"가장 가까운 이웃을 기반으로 다변량 2- 표본 테스트."</span> <em>미국 통계 협회 저널</em>81 (395) : 799–806.</div>
<div class="csl-entry" id="ref-VertKernel" role="listitem">Schölkopf, Bernhard, Koji Tsuda 및 Jean-Philippe Vert. 2004.<em>계산 생물학의 커널 방법</em>. 프레스와 함께.</div>
<div class="csl-entry" id="ref-wang2007naive" role="listitem">Wang, Q., G. M. Garrity, J. M. Tiedje 및 J. R. Cole. 2007.<span>"새로운 박테리아 분류법에 RRNA 서열을 빠르게 할당하기위한 순진한 베이지안 분류기."</span> <em>적용 및 환경 미생물학</em>73 (16) : 5261.</div>
<div class="csl-entry" id="ref-Wertheim:2009" role="listitem">Wertheim, Joel O 및 Michael Worobey. 2009 년.<span>“나이의 데이트<span>사용</span>발생한 혈통<span>HIV</span>-1 및<span>HIV</span>-2.”</span> <em>PLOS 계산 생물학</em>5 (5) : E1000377.</div>
<div class="csl-entry" id="ref-wright2015decipher" role="listitem">Wright, Erik S. 2015.<span>"<span>풀다</span>: 단백질 다중 서열 정렬을 개선하기 위해 국소 서열 컨텍스트 활용.”</span> <em><span>BMC 생물 정보학</span></em>16 (1) : 1.</div>
<div class="csl-entry" id="ref-YuGXNA" role="listitem">Yu, Hongxiang, Diana L Simons, Ilana Segall, Valeria Carcamo-Cavazos, Erich J Schwartz, Ning Yan, Neta S Zuckerman 등. 2012.<span>"<span>PRC2</span>/<span>EED-EZH2</span>복합체는 1 차 종양과 비교하여 유방암 림프절 전이에서 상향 조절되며 현장에서 종양 증식과 상관 관계가있다.”</span> <em>plos one</em>7 (12) : E51239.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
