<!DOCTYPE html>

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.31" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>5  Clustering – Modern Statistics for Modern Biology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta content="./" name="quarto:offset"/>
<link href="./imgs/msmb-favicon.png" rel="icon" type="image/png"/>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="site_libs/quarto-html/quarto-syntax-highlighting-af5ec82acda093b5ee751184164e9432.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="site_libs/bootstrap/bootstrap-d63985d606c7f07261ad561a6cfde940.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet"/>
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<link href="msmb.css" rel="stylesheet"/>
<meta content="5  Clustering – Modern Statistics for Modern Biology" property="og:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." property="og:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" property="og:image"/>
<meta content="Modern Statistics for Modern Biology" property="og:site_name"/>
<meta content="5  Clustering – Modern Statistics for Modern Biology" name="twitter:title"/>
<meta content="If you are a biologist and want to get the best out of the powerful methods of modern computational statistics, this is your book." name="twitter:description"/>
<meta content="https://www.huber.embl.de/msmb/imgs/MSFMB-Cover2-cropped.jpg" name="twitter:image"/>
<meta content="summary" name="twitter:card"/>
<script type="text/javascript">
  var _paq = _paq || [];
  
  // Call disableCookies before calling trackPageView 
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='//tr-denbi.embl.de/heimdall/';
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '26']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>
<body class="floating nav-fixed slimcontent quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="./index.html">
<span class="navbar-title">현대 생물학에 대한 현대 통계</span>
</a>
</div>
<div class="" id="quarto-search" title="Search"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown">
<a aria-expanded="false" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" id="nav-menu-chapters" role="link">
<span class="menu-text">챕터</span>
</a>
<ul aria-labelledby="nav-menu-chapters" class="dropdown-menu dropdown-menu-end">
<li>
<a class="dropdown-item" href="./index.html">
<span class="dropdown-text">집</span></a>
</li>
<li>
<a class="dropdown-item" href="./00-chap.html">
<span class="dropdown-text">소개</span></a>
</li>
<li>
<a class="dropdown-item" href="./01-chap.html">
<span class="dropdown-text">개별 데이터에 대한 생성 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./02-chap.html">
<span class="dropdown-text">통계 모델링</span></a>
</li>
<li>
<a class="dropdown-item" href="./03-chap.html">
<span class="dropdown-text">데이터 시각화</span></a>
</li>
<li>
<a class="dropdown-item" href="./04-chap.html">
<span class="dropdown-text">혼합 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./05-chap.html">
<span class="dropdown-text">클러스터링</span></a>
</li>
<li>
<a class="dropdown-item" href="./06-chap.html">
<span class="dropdown-text">테스트</span></a>
</li>
<li>
<a class="dropdown-item" href="./07-chap.html">
<span class="dropdown-text">다변량 분석</span></a>
</li>
<li>
<a class="dropdown-item" href="./08-chap.html">
<span class="dropdown-text">고 처리량 수 데이터 및 일반화 된 선형 모델</span></a>
</li>
<li>
<a class="dropdown-item" href="./09-chap.html">
<span class="dropdown-text">이종 데이터를위한 다변량 방법</span></a>
</li>
<li>
<a class="dropdown-item" href="./10-chap.html">
<span class="dropdown-text">네트워크와 나무</span></a>
</li>
<li>
<a class="dropdown-item" href="./11-chap.html">
<span class="dropdown-text">이미지 데이터</span></a>
</li>
<li>
<a class="dropdown-item" href="./12-chap.html">
<span class="dropdown-text">감독 학습</span></a>
</li>
<li>
<a class="dropdown-item" href="./13-chap.html">
<span class="dropdown-text">높은 처리량 실험 및 분석의 설계</span></a>
</li>
<li>
<a class="dropdown-item" href="./14-chap.html">
<span class="dropdown-text">통계적 일치</span></a>
</li>
<li>
<a class="dropdown-item" href="./15-chap.html">
<span class="dropdown-text">감사의 말</span></a>
</li>
<li>
<a class="dropdown-item" href="./16-chap.html">
<span class="dropdown-text">참조</span></a>
</li>
</ul>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<nav class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto" id="quarto-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">섹션</h2>
<ul class="collapse">
<li><a class="nav-link active" data-scroll-target="#goals-for-this-chapter" href="#goals-for-this-chapter" id="toc-goals-for-this-chapter"><span class="header-section-number">5.1</span>이 장의 목표</a></li>
<li><a class="nav-link" data-scroll-target="#what-are-the-data-and-why-do-we-cluster-them" href="#what-are-the-data-and-why-do-we-cluster-them" id="toc-what-are-the-data-and-why-do-we-cluster-them"><span class="header-section-number">5.2</span>데이터는 무엇이며 왜 우리가 클러스터링합니까?</a></li>
<li><a class="nav-link" data-scroll-target="#how-do-we-measure-similarity" href="#how-do-we-measure-similarity" id="toc-how-do-we-measure-similarity"><span class="header-section-number">5.3</span>유사성을 어떻게 측정합니까?</a></li>
<li><a class="nav-link" data-scroll-target="#nonparametric-mixture-detection" href="#nonparametric-mixture-detection" id="toc-nonparametric-mixture-detection"><span class="header-section-number">5.4</span>비모수 혼합물 검출</a></li>
<li><a class="nav-link" data-scroll-target="#clustering-examples-flow-cytometry-and-mass-cytometry" href="#clustering-examples-flow-cytometry-and-mass-cytometry" id="toc-clustering-examples-flow-cytometry-and-mass-cytometry"><span class="header-section-number">5.5</span>클러스터링 예 : 유세포 분석 및 질량 세포 측정</a></li>
<li><a class="nav-link" data-scroll-target="#hierarchical-clustering" href="#hierarchical-clustering" id="toc-hierarchical-clustering"><span class="header-section-number">5.6</span>계층 적 클러스터링</a></li>
<li><a class="nav-link" data-scroll-target="#sec-clustervalidation" href="#sec-clustervalidation" id="toc-sec-clustervalidation"><span class="header-section-number">5.7</span>클러스터 수 검증 및 선택</a></li>
<li><a class="nav-link" data-scroll-target="#clustering-as-a-means-for-denoising" href="#clustering-as-a-means-for-denoising" id="toc-clustering-as-a-means-for-denoising"><span class="header-section-number">5.8</span>비난을위한 수단으로서의 클러스터링</a></li>
<li><a class="nav-link" data-scroll-target="#summary-of-this-chapter" href="#summary-of-this-chapter" id="toc-summary-of-this-chapter"><span class="header-section-number">5.9</span>이 장의 요약</a></li>
<li><a class="nav-link" data-scroll-target="#further-reading" href="#further-reading" id="toc-further-reading"><span class="header-section-number">5.10</span>추가 독서</a></li>
<li><a class="nav-link" data-scroll-target="#exercises" href="#exercises" id="toc-exercises"><span class="header-section-number">5.11</span>수업 과정</a></li>
</ul>
</nav>
</nav>
<div class="quarto-sidebar-collapse-item" data-bs-target=".quarto-sidebar-collapse-item" data-bs-toggle="collapse" id="quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar zindex-bottom" id="quarto-margin-sidebar">
</div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title"><span class="quarto-section-identifier" id="sec-clustering"><span class="chapter-number">5</span>  <span class="chapter-title">클러스터링</span></span></h1>
</div>
<div class="quarto-title-meta">
</div>
</header>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-1" href="imgs/starlings_copyrightfree.jpg"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/starlings_copyrightfree.jpg"/></a></p>
</figure>
</div>
</div></div></div>
<p>세포, 질병, 유기체의 범주를 찾은 다음 자연 과학의 핵심 활동입니다. ~ 안에<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>우리는 일부 데이터가 명확한 파라 메트릭 생성 모델을 가진 다른 그룹 또는 인구의 혼합물로 모델링 될 수 있음을 알았습니다. 이 예제에서 EM 알고리즘을 사용하여 구성 요소를 풀릴 수있는 방법을 보았습니다. 우리는 다른 그룹을 어떤 경우에 해제한다는 아이디어를 확장 할 것입니다.<strong>클러스터</strong>반드시 멋진 타원을 가지고 있지는 않습니다<a class="footnote-ref" href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a>모양.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>다변량 정규 분포를 가진 혼합 모델링은 타원 클러스터 경계를 의미합니다.</p></div></div><p>클러스터링은 데이터 (연속 또는 준 연속)를 가져 와서 새로운 범주 형을 추가합니다.<em>그룹</em>종종 의사 결정을 단순화 할 수있는 변수; 때때로 무시하는 비용이 발생하더라도<em>중간</em>주. 예를 들어, 간단한 그룹으로 복잡하고 고차원 진단 측정을 대체함으로써 의학적 결정은 단순화됩니다. 간단한 그룹 : 금식 포도당, 당화 된 헤모글로빈 및 혈장 포도당과 관련된 숫자에 대한 전체 보고서는 환자를 당뇨병의 "그룹"에 할당하여 대체합니다.</p>
<p>이 장에서는 저 차원 및 고 차원에서 의미있는 클러스터 또는 그룹을 찾는 방법을 연구합니다.<strong>비모수 적</strong>설정. 그러나 경고가 있습니다. 클러스터링 알고리즘은 클러스터를 찾도록 설계되었으므로 클러스터를 찾을 수 있습니다.<a class="footnote-ref" href="#fn2" id="fnref2" role="doc-noteref"><sup>2</sup></a>. 그래서 클러스터<em>확인</em>특히 클러스터의 존재를 지원하는 사전 도메인 지식이없는 경우 프로세스의 필수 구성 요소입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>이것은 인간을 회상합니다. 우리는 무작위로 패턴을보고 싶어합니다.</p></div></div><section class="level2 page-columns page-full" data-number="5.1" id="goals-for-this-chapter">
<h2 class="anchored" data-anchor-id="goals-for-this-chapter" data-number="5.1"><span class="header-section-number">5.1</span>이 장의 목표</h2>
<p>이 장에서는 우리가 할 것입니다</p>
<ul>
<li><p>유익하게 클러스터링 될 수있는 다양한 유형의 데이터를 연구하십시오.</p></li>
<li><p>(dis) 유사성 측정을 참조하십시오<strong>거리</strong>클러스터를 정의하는 데 도움이됩니다.</p></li>
<li><p>데이터를 분할하여 숨겨진 또는 잠재적 클러스터링을 발견<em>더 단단하다</em>세트.</p></li>
<li><p>수십만 개의 세포 각각에 바이오 마커가 주어지면 클러스터링을 사용하십시오. 예를 들어 면역 세포는 자연적으로 단단한 하위 집단으로 분류 될 수 있음을 알 수 있습니다.</p></li>
<li><p>비모수 적 알고리즘을 실행하십시오<strong><span class="math inline">\(케이\)</span>-수단</strong>,,,<strong><span class="math inline">\(케이\)</span>-미도들</strong>실제 단일 셀 데이터에서.</p></li>
<li><p>관찰과 그룹을 세트의 계층으로 결합하는 클러스터링에 대한 재귀 적 접근법을 실험하고; 이 방법은 다음으로 알려져 있습니다<strong>계층 적 클러스터링</strong>.</p></li>
<li><p>리 샘플링 기반 부트 스트랩 접근 방식을 통해 클러스터를 검증하는 방법을 연구하십시오. 이는 단일 셀 데이터 세트에서 시연 할 것입니다.</p></li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-SnowMapSmallest-web">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SnowMapSmallest-web-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-2" href="imgs/SnowMapSmallest_web.png" title="Figure 5.1: John Snow’s map of cholera cases: small barcharts at each house indicate a clustering of diagnosed cases."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SnowMapSmallest_web.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SnowMapSmallest-web-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.1 : John Snow의 콜레라 사례지도 : 각 집의 작은 바 차트는 진단 된 사례의 군집을 나타냅니다.</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-3" href="imgs/book_icon.png" title="David Freedman has a wonderful detailed account of all the steps that led to this discovery [@freedman1991]."><img alt="David Freedman has a wonderful detailed account of all the steps that led to this discovery (Freedman 1991)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
<figcaption>David Freedman 은이 발견으로 이어진 모든 단계에 대한 훌륭한 자세한 설명을 가지고 있습니다.<span class="citation" data-cites="freedman1991">(<a href="16-chap.html#ref-freedman1991" role="doc-biblioref">Freedman 1991</a>))</span>.</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section class="level2 page-columns page-full" data-number="5.2" id="what-are-the-data-and-why-do-we-cluster-them">
<h2 class="anchored" data-anchor-id="what-are-the-data-and-why-do-we-cluster-them" data-number="5.2"><span class="header-section-number">5.2</span>데이터는 무엇이며 왜 우리가 클러스터링합니까?</h2>
<section class="level3 page-columns page-full" data-number="5.2.1" id="clustering-can-sometimes-lead-to-discoveries.">
<h3 class="anchored" data-anchor-id="clustering-can-sometimes-lead-to-discoveries." data-number="5.2.1"><span class="header-section-number">5.2.1</span>클러스터링은 때때로 발견으로 이어질 수 있습니다.</h3>
<p>John Snow는 콜레라 사례지도를 만들고 식별했습니다.<em>클러스터</em>사례. 그런 다음 펌프의 상황에 대한 추가 정보를 수집했습니다. 브로드 스트리트 펌프에 대한 조밀 한 사례 클러스터의 근접성은 가능한 범인으로 물을 가리 켰습니다. 그는 콜레라 발생의 출처를 유추 할 수있는 별도의 정보 소스를 수집했습니다.</p>
<p>이제 런던의 다른지도를 보자.<a class="quarto-xref" href="#fig-bombings">수치<span>5.2</span></a>. 레드 점은 제 2 차 세계 대전 중에 폭격 된 위치를 지정합니다. 분석 팀에 의해 전쟁 중에 많은 이론이 제시되었습니다. 그들은 폭격 패턴에 대한 합리적인 설명을 찾으려고 시도했다 (유틸리티 플랜트, 무기고,<span class="math inline">\ (... \)</span>). 실제로, 전쟁이 끝난 후에는 폭탄 테러가 특정 목표를 달성하려는 시도없이 무작위로 배포 된 것으로 밝혀졌습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-bombings">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-bombings-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-4" href="imgs/RedBombsLondon_web.png" title="Figure 5.2: Here is a map of the location of the bombs that were dropped on London on September, 7th, 1940 as depicted by the website of the British National Archives http://bombsight.org."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/RedBombsLondon_web.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-bombings-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.2 : 영국 국립 기록 보관소의 웹 사이트에서 묘사 된 1940 년 9 월 7 일 런던에 떨어진 폭탄의 위치에 대한지도가 있습니다.<a href="http://bombsight.org">http://bombsight.org</a>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>클러스터링은 복잡한 다변량 데이터를 이해하는 데 유용한 기술입니다. 그것은<strong>감독되지 않은</strong><a class="footnote-ref" href="#fn3" id="fnref3" role="doc-noteref"><sup>3</sup></a>. 탐색 기술은 데이터 해석에 중요한 그룹을 보여줍니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>따라서 모든 변수는 동일한 상태를 가지기 때문에 설명 변수의 정보를 기반으로 한 변수 (감독 응답)의 값을 예측하거나 배우려고하지 않습니다.</p></div></div><p>예를 들어, 클러스터링을 통해 연구원들은 암 생물학에 대한 이해를 향상시킬 수있었습니다. 해부학 적 위치와 조직 병리학에 기초하여 동일하게 보이는 종양은 유전자 발현 데이터와 같은 분자 시그니처에 기초하여 다수의 클러스터로 떨어졌다.<span class="citation" data-cites="Hallett2012">(<a href="16-chap.html#ref-Hallett2012" role="doc-biblioref">Hallett et al. 2012</a>))</span>. 결국, 이러한 군집은 새롭고 관련성이 높은 질병 유형의 정의로 이어질 수 있습니다. 예를 들어 관련성은 다른 환자 결과와 관련되어 있다는 사실에 의해 입증됩니다. 이 장에서 우리가 목표로하는 것은 사진이 어떻게<a class="quarto-xref" href="#fig-cancerHC">수치<span>5.3</span></a>구성되고 해석하는 방법.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-cancerHC">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-cancerHC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-5" href="imgs/BreastCancerSubType_Biomed.png" title="Figure 5.3: The breast cancer samples (shown from The Cancer Genome Atlas (TCGA) and the Molecular Taxonomy of Breast Cancer International Consortium (METABRIC)) can be split into groups using their miRNA expression [@Aure2017]. The authors show in the lower plots that the survival times in different % groups were different. Thus these clusters were biologically and clinically relevant. The promise of such analyses is that the groups can be used to provide more specific, optimized treatments."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BreastCancerSubType_Biomed.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cancerHC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.3 : 유방암 샘플 (암 게놈 아틀라스 (TCGA) 및 유방암 국제 컨소시엄 (Metabric)의 분자 분류법 (Metabric)의 분자 분류)는 miRNA 발현을 사용하여 그룹으로 분할 될 수 있습니다.<span class="citation" data-cites="Aure2017">(<a href="16-chap.html#ref-Aure2017" role="doc-biblioref">Aure et al. 2017</a>))</span>. 저자는 더 낮은 음모에서 다른 % 그룹의 생존 시간이 다르다는 것을 보여줍니다. 따라서, 이들 클러스터는 생물학적 및 임상 적으로 관련이 있었다. 이러한 분석의 약속은 그룹이보다 구체적이고 최적화 된 치료를 제공하는 데 사용될 수 있다는 것입니다.</figcaption>
</figure>
</div>
</div>
</div>
<p>~ 안에<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>, 우리는 이미 그룹을 발견하기위한 하나의 기술인 EM 알고리즘을 연구했습니다. 이 장에서 우리가 탐색하는 기술은보다 일반적이며보다 복잡한 데이터에 적용될 수 있습니다. 그들 중 다수는 관찰 한 쌍 사이의 거리를 기반으로하며 (이것은 모두 대대적이거나, 때로는 모든대로 일부일 수 있음), 문학 및 과학 소프트웨어 환경에서 클러스터링 알고리즘의 증식이 있습니다. 이것은 협박 할 수 있습니다. 실제로 그것은 데이터 유형의 다양성과 다른 영역에서 추구되는 목표와 연결되어 있습니다.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>찾아라<a href="http://www.bioconductor.org/packages/release/BiocViews.html">Biocviews 클러스터링</a>또는<a href="https://cran.r-project.org/web/views/Cluster.html">크랜에서 클러스터보기</a>클러스터링 도구를 제공하는 패키지 수를 계산하십시오.</p>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-ClusteringA">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-ClusteringA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-6" href="imgs/ClusteringA.png" title="Figure 5.4: We decompose the choices made in a clustering algorithm according to the steps taken: starting from an observations-by-features rectangular table X, we choose an observations-to-observations distance measure and compute the distance matrix, here schematized by the triangle. The distances are used to construct the clusters. On the left, we schematize agglomerative methods, that build a hierarchical clustering tree; on the right, partitioning methods that separate the data into subsets. Both types of methods require a choice to be made: the number k of clusters. For partitionning approaches such as k-means this choice has to be made at the outset; for hierarchical clustering this can be deferred to the end of the analysis."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/ClusteringA.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ClusteringA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.4 : 촬영 한 단계에 따라 클러스터링 알고리즘에서 선택한 선택을 분해합니다.<span class="math inline">\(엑스\)</span>, 우리는 관측 관찰 거리 측정을 선택하고 여기서 삼각형에 의해 개략적 인 거리 매트릭스를 계산합니다. 거리는 클러스터를 구성하는 데 사용됩니다. 왼쪽에서는 계층 적 클러스터링 트리를 구축하는 응집 적 방법을 개조합니다. 오른쪽에서 데이터를 서브 세트로 분리하는 분할 방법. 두 가지 유형의 방법 모두 선택을해야합니다.<span class="math inline">\(케이\)</span>클러스터의. 다음과 같은 분할 접근법의 경우<span class="math inline">\(케이\)</span>-이 선택은 처음에 이루어져야한다. 계층 적 클러스터링의 경우 분석이 끝날 때까지 연기 될 수 있습니다.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="5.3" id="how-do-we-measure-similarity">
<h2 class="anchored" data-anchor-id="how-do-we-measure-similarity" data-number="5.3"><span class="header-section-number">5.3</span>유사성을 어떻게 측정합니까?</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-7" href="imgs/devil.png" title="Of a feather: how the distances are measured and similarities between observations defined has a strong impact on the clustering result."><img alt="Of a feather: how the distances are measured and similarities between observations defined has a strong impact on the clustering result." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption><strong>깃털의</strong>: 거리가 측정되는 방법과 정의 된 관측치 사이의 유사성은 클러스터링 결과에 큰 영향을 미칩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리의 첫 번째 단계는 우리가 의미하는 바를 결정하는 것입니다.<em>비슷한</em>. 조류를 비교하는 여러 가지 방법이 있습니다. 예를 들어, 크기와 체중을 사용하는 거리는식이 요법이나 서식지를 사용하는 것과는 다른 클러스터링을 제공합니다. 관련 기능을 선택하면 여러 기능 간의 차이를 단일 숫자로 결합하는 방법을 결정해야합니다. 다음은 선택의 선택이 있습니다. 그중 일부는 다음과 같습니다.<a class="quarto-xref" href="#fig-fourdistances">수치<span>5.5</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-layout-nrow="2">
<div class="quarto-layout-panel page-columns page-full" id="fig-fourdistances">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-fourdistances-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourdistances" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-fourdistances-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourdistances-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-fourdistances" href="imgs/FourDistances_a.png" title="Figure 5.5 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-fourdistances" id="fig-fourdistances-1" src="imgs/FourDistances_a.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourdistances-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourdistances" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-fourdistances-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourdistances-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-fourdistances" href="imgs/FourDistances_b.png" title="Figure 5.5 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-fourdistances" id="fig-fourdistances-2" src="imgs/FourDistances_b.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourdistances-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div></div>
</div>
<div class="quarto-layout-row page-full">
<div class="no-row-height column-margin column-container"><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourdistances" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-fourdistances-3">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourdistances-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-fourdistances" href="imgs/FourDistances_c.png" title="Figure 5.5 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-fourdistances" id="fig-fourdistances-3" src="imgs/FourDistances_c.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourdistances-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div><div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fourdistances" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-fourdistances-4">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fourdistances-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-fourdistances" href="imgs/FourDistances_d.png" title="Figure 5.5 (d): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-fourdistances" id="fig-fourdistances-4" src="imgs/FourDistances_d.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fourdistances-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(디)</figcaption>
</figure>
</div>
</div></div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fourdistances-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.5 : 4 개의 다른 거리에 따른 동등한 윤곽선 플롯 : 하나의 곡선의 점은 모두 중심 지점과 동일합니다.</figcaption>
</figure>
</div>
</div>
<p><strong>유클리드</strong>두 지점 사이의 유클리드 거리<span class="math inline">\ (a = (a_1, ..., a_p) \)</span>그리고<span class="math inline">\ (b = (b_1, ..., b_p) \)</span>a<span class="math inline">\(피\)</span>-차원 공간 (<span class="math inline">\(피\)</span>특징)은 모두의 차이의 제곱 합의 제곱근입니다.<span class="math inline">\(피\)</span>좌표 방향 :</p>
<p><span class="math display">\ [
d (a, b) = \ sqrt {(a_1-b_1)^2+(a_2-b_2)^2+...+(a_p-b_p)^2}.
\]</span></p>
<p><strong>맨해튼</strong>맨해튼, 도시 블록, 택시 또는<span class="math inline">\ (l_1 \)</span>거리는 모든 좌표에서 절대 차이의 합을 취합니다.</p>
<p><span class="math display">\ [
d (a, b) = | a_1-b_1 |+| a_2-b_2 |+...+| a_p-b_p |.
\]</span></p>
<p><strong>최고</strong>좌표 간의 절대적인 차이의 최대 값은<span class="math inline">\ (l_ \ infty \)</span>거리:</p>
<p><span class="math display">\ [
d_ \ infty (a, b) = \ max_ {i} | a_i-b_i |.
\]</span></p>
<p><strong>가중 유클리드 거리</strong>피처 공간에 다른 방향을 다른 방향으로 제공함으로써 일반 유클리드 거리의 일반화입니다. 우리는 이미 가중 유클리드 거리의 한 예를 만났습니다.<a class="quarto-xref" href="02-chap.html"><span>2 장</span></a>,,<span class="math inline">\ (\ chi^2 \)</span>거리. 우발 테이블의 행을 비교하는 데 사용되며 각 기능의 무게는 예상 값의 역수입니다. 그만큼<em>Mahalanobis</em>거리는 다른 특징이 다이내믹 레인지를 가질 수 있고 일부 기능이 서로 긍정적이거나 부정적인 상관 관계가 있다는 사실을 고려하는 또 다른 가중 유클리드 거리입니다. 이 경우의 가중치는 기능의 공분산 행렬에서 파생됩니다. 참조하십시오<a class="quarto-xref" href="#wrn-clustering-Maha">질문<span>5.1</span></a>.</p>
<p><strong>Minkowski</strong>지수를 허용합니다<span class="math inline">\(중\)</span>대신<span class="math inline">\ (2 \)</span>, 유클리드 거리에서와 같이, Minkowski 거리를 제공합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-cluster" id="eq-cluster-minkowski"><span class="math display">\ [
d (a, b) = \ left ((a_1-b_1)^m+(a_2-b_2)^m+...+(a_p-b_p)^m \ 오른쪽)^\ frac {1} {m}.
\ tag {5.1} \]</span></span></p>
<p><strong>편집, 해밍</strong>이 거리는 문자 시퀀스를 비교하는 가장 간단한 방법입니다. 그것은 단순히 두 문자열의 차이점을 계산합니다. 이것은 뉴클레오티드 또는 아미노산 서열에 적용될 수 있지만,이 경우, 다른 특성 치환은 일반적으로 거리에 대한 다른 기여 (물리적 또는 진화 적 유사성을 설명하기 위해), 결실 및 삽입도 허용 될 수있다.</p>
<p><strong>이진</strong>두 벡터에 이진 비트가 좌표로서 이진 비트를 갖는 경우 0이 아닌 요소를 'ON'으로 생각하고 제로 요소를 'OFF'로 생각할 수 있습니다. 이진 거리는 적어도 하나의 비트가있는 기능 중 하나만 켜진 기능의 비율입니다.</p>
<p><strong>자카 카드 거리</strong>생태 학적 또는 돌연변이 데이터에서 특성 또는 특징의 발생은 존재 및 부재로 번역되어 1과 0으로 인코딩 할 수 있습니다. 그러한 상황에서, 동시 경력은 종종 공동 주수보다 유익합니다. 예를 들어, HIV에서 돌연변이 패턴을 비교할 때, 돌연변이의 두 가지 균주에서의 공존은 그 공동 결성보다 더 중요한 관찰 경향이있다. 이러한 이유로 생물 학자들은 다음을 사용합니다<strong>자카르드 인덱스</strong>. 두 관측 벡터를 부르겠습니다<span class="math inline">\(에스\)</span>그리고<span class="math inline">\(티\)</span>,,,<span class="math inline">\ (f_ {11} \)</span>기능이 동시에 발생합니다<span class="math inline">\(에스\)</span>그리고<span class="math inline">\(티\)</span>,,,<span class="math inline">\ (f_ {10} \)</span>(그리고<span class="math inline">\ (f_ {01} \)</span>) 기능이 발생하는 횟수<span class="math inline">\(에스\)</span>그러나 안에는 안됩니다<span class="math inline">\(티\)</span>(그리고 그 반대도 마찬가지)<span class="math inline">\ (f_ {00} \)</span>기능의 횟수는 공동으로 제공됩니다. Jaccard 지수는입니다</p>
<p><span class="anchored-eq" data-anchor-id="eq-cluster" id="eq-cluster-jaccardindex"><span class="math display">\ [
j (s, t) = \ frac {f_ {11}} {f_ {01}+f_ {10}+f_ {11}},
\ tag {5.2} \]</span></span></p>
<p>(즉, 무시합니다<span class="math inline">\ (f_ {00} \)</span>), 그리고<strong>자카르드 비 유사성</strong>~이다</p>
<p><span class="anchored-eq" data-anchor-id="eq-cluster" id="eq-cluster-jaccarddissimilarity"><span class="math display">\ [
d_j (s, t) = 1-j (s, t) = \ frac {f_ {01}+f_ {10}} {f_ {01}+f_ {10}+f_ {11}}.
\ tag {5.3} \]</span></span></p>
<p><strong>상관 관계 기반 거리</strong></p>
<p><span class="math display">\ [
d (a, b) = \ sqrt {2 (1- \ text {cor} (a, b))}.
\]</span></p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-Mahalanobis">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Mahalanobis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-12" href="05-chap_files/figure-html/fig-Mahalanobis-1.png" title="Figure 5.6: An example for the use of Mahalanobis distances to measure the distance of a new data point (red) from two cluster centers."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-Mahalanobis-1.png" width="376"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Mahalanobis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.6 : 두 클러스터 센터에서 새로운 데이터 포인트 (빨간색)의 거리를 측정하기 위해 Mahalanobis 거리를 사용하기위한 예.</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-Maha">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.1</div>
</div>
<div class="callout-body-container callout-body">
<p>두 클러스터 중심 중 어느 것입니다<a class="quarto-xref" href="#fig-Mahalanobis">수치<span>5.6</span></a>레드 포인트가 가장 가까운가?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-3-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-3-contents callout-collapse collapse" id="callout-3">
<div class="callout-body-container callout-body">
<p>순진한 대답은 유클리드 메트릭을 사용하고 포인트가 왼쪽 클러스터에 더 가깝다고 결정합니다. 그러나 기능의 범위와 상관 관계가 다르고 두 클러스터 간에도 다르다는 것을 알 수 있듯이 클러스터 별 Mahalanobis 거리를 사용하는 것이 합리적입니다. 그림은 두 클러스터의 윤곽선을 보여줍니다. 이들은 밀도 추정에서 얻어졌다; Mahalanobis 거리는 타원으로 이러한 윤곽선과 비슷합니다. 빨간색 점과 각 클러스터 센터 사이의 거리는 교차 된 윤곽선의 수에 해당합니다. 우리는 오른쪽에있는 그룹이 더 확산됨에 따라 빨간색 점은 실제로 그것에 더 가깝다는 것을 알 수 있습니다.</p>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-DistanceTriangle">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-DistanceTriangle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-13" href="imgs/DistanceTriangle.png" title="Figure 5.7: The lower triangle of distances can be computed by any of a hundred different functions in various R packages (vegdist in vegan, daisy in cluster, genetic_distance in gstudio, dist.dna in ape, Dist in amap, distance in ecodist, dist.multiPhylo in distory, shortestPath in gdistance, % dudi.dist and dist.genet in ade4)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/DistanceTriangle.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DistanceTriangle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.7 : 거리의 하부 삼각형은 다양한 R 패키지에서 100 개의 다른 기능으로 계산할 수 있습니다.<code>Vegdist</code>~에<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>,,,<code>데이지</code>~에<strong><a href="https://cran.r-project.org/web/packages/cluster/">무리</a></strong>,,,<code>genetic_distance</code>~에<strong><a href="https://cran.r-project.org/web/packages/gstudio/">Gstudio</a></strong>,,,<code>dist.dna</code>~에<strong><a href="https://cran.r-project.org/web/packages/ape/">원숭이</a></strong>,,,<code>dist</code>~에<strong><a href="https://cran.r-project.org/web/packages/amap/">amap</a></strong>,,,<code>거리</code>~에<strong><a href="https://cran.r-project.org/web/packages/ecodist/">에코 디스트</a></strong>,,,<code>dist.multiphylo</code>~에<strong><a href="https://cran.r-project.org/web/packages/distory/">Distory</a></strong>,,,<code>짧은 경로</code>~에<strong><a href="https://cran.r-project.org/web/packages/gdistance/">gdistance</a></strong>, % <code>dudi.dist</code>그리고<code>dist.genet</code>~에<strong><a href="https://cran.r-project.org/web/packages/ade4/">적절한</a></strong>).
</figcaption>
</figure>
</div>
</div></div></div>
<section class="level3 page-columns page-full" data-number="5.3.1" id="computations-related-to-distances-in-r">
<h3 class="anchored" data-anchor-id="computations-related-to-distances-in-r" data-number="5.3.1"><span class="header-section-number">5.3.1</span>R의 거리와 관련된 계산</h3>
<p>그만큼<code>dist</code>R의 함수는 전체보다 적은 공간을 사용하도록 설계되었습니다.<span class="math inline">\ (n^2 \)</span>완전한 위치<span class="math inline">\ (n \ times n \)</span>사이의 거리 매트릭스<span class="math inline">\(N\)</span>물체가 필요합니다. 이 함수는 6 가지 거리의 선택 중 하나를 계산합니다 (<code>유클리드</code>,,,<code>최고</code>,,,<code>맨해튼</code>,,,<code>캔버라</code>,,,<code>이진</code>,,,<code>Minkowski</code>) 및 전체 거리 행렬을 재구성하기에 충분한 값의 벡터를 출력합니다. 함수는 클래스의 특별한 대상을 반환합니다<code>dist</code>이는 크기의 관련 벡터를 인코딩합니다<span class="math inline">\ (n \ times (n-1)/2 \)</span>. 다음은 다음에 대한 출력입니다<span class="math inline">\ (3 \)</span>~에 의해<span class="math inline">\ (3 \)</span>행렬:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>MX<span class="ot">=</span> <span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>))</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>나의<span class="ot">=</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">0</span>,,,<span class="dv">1</span>))</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>MZ<span class="ot">=</span> <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>,,,<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="dv">1</span>))</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>매트<span class="ot">=</span> <span class="fu">rbind</span>(MX, MY, MZ)</span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a><span class="fu">dist</span>(매트)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mx my
내 1.732051         
MZ 2.000000 1.732051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="fu">dist</span>(매트,<span class="at">방법 =</span> <span class="st">"바이너리"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mx my
내 0.6000000          
MZ 0.6666667 0.5000000</code></pre>
</div>
</div>
<p>특정 거리 (예 : 관측 1과 2 사이의 거리)에 액세스하려면<code>dist</code>클래스 객체를 매트릭스로 다시 넣습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="fu">짐</span>(<span class="st">"../data/morder.rdata"</span>))</span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">합집합</span>((깨물다[<span class="dv">1</span>,]<span class="sc">-</span>깨물다[<span class="dv">2</span>,]))<span class="sc">^</span><span class="dv">2</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.593667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">as.matrix</span>(<span class="fu">dist</span>(깨물다))[<span class="dv">2</span>,,,<span class="dv">1</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.593667</code></pre>
</div>
</div>
<p>HIV 균주 사이에서 위에서 정의한 Jaccard 거리를 계산하는 방법을 살펴 보겠습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a>뮤트<span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../data/hivmutations.csv"</span>))</span>
<span id="cb9-2"><a aria-hidden="true" href="#cb9-2" tabindex="-1"></a>뮤트 [<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,,,<span class="dv">10</span><span class="sc">:</span><span class="dv">16</span>]]</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P32I P33F P34Q P35G P43T P46I P46L
1 0 1 0 0 0 0
2 0 1 0 0 1 0
3 0 1 0 0 0 0</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-comparejaccard">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.2</div>
</div>
<div class="callout-body-container callout-body">
<p>Jaccard 거리를 비교하십시오 (함수로 사용 가능<code>Vegdist</code>R 패키지에서<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>) HIV 데이터의 돌연변이 사이<code>뮤트</code>상관 관계 기반 거리에.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-5-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-5-contents callout-collapse collapse" id="callout-5">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"비건 채식"</span>))</span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a>mutj<span class="ot">=</span> <span class="fu">Vegdist</span>(mut,<span class="st">"자카르"</span>))</span>
<span id="cb11-3"><a aria-hidden="true" href="#cb11-3" tabindex="-1"></a>mutc<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">코</span>(<span class="fu">티</span>(mut))))</span>
<span id="cb11-4"><a aria-hidden="true" href="#cb11-4" tabindex="-1"></a>mutj</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4
2 0.800                  
3 0.750 0.889            
4 0.900 0.778 0.846      
5 1.000 0.800 0.889 0.900</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a><span class="fu">as.dist</span>(mutc)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4
2 1.19               
3 1.10 1.30          
4 1.32 1.13 1.30     
5 1.45 1.19 1.30 1.32</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-xkcd-birds">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-xkcd-birds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-14" href="imgs/birds_and_dinosaurs.png" title="Figure 5.8: An example of computing the cophenetic distance (xkcd)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/birds_and_dinosaurs.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-xkcd-birds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.8 : 코 페 네틱 거리 (XKCD)를 계산하는 예.</figcaption>
</figure>
</div>
</div></div></div>
<p>또한 전통적인 벡터가 아닌 복잡한 물체 나 비 유사성이나 거리를 사용하여 실수를 비교하는 것도 흥미로울 수 있습니다. 혼합 양식 데이터 (범주 형 요인 및 연속 변수 모두)에 대한 Gower의 거리는 다음과 같이 계산할 수 있습니다.<code>데이지</code>기능. 실제로, 지점이 아니라 모든 쌍의 물체 사이에서 거리를 정의 할 수 있습니다.<span class="math inline">\ ({\ mathbb r}^p \)</span>또는 문자 시퀀스. 예를 들어,<code>짧은 가장</code>기능<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>우리가 볼 수있는 패키지<a class="quarto-xref" href="10-chap.html"><span>10 장</span></a>그래프의 정점과 함수 사이의 거리를 계산합니다.<code>코 페르 네틱</code>그림에 표시된 것처럼 나무의 잎 사이의 거리를 계산합니다.<a class="quarto-xref" href="#fig-xkcd-birds">수치<span>5.8</span></a>. 우리는 사용하는 나무 사이의 거리를 계산할 수 있습니다<code>dist.multiphylo</code>에서<strong><a href="https://cran.r-project.org/web/packages/distory/">Distory</a></strong>패키지.</p>
<p>그래프 간의 Jaccard Index는 동일한 노드에 구축 된 두 개의 그래프를보고 공동 발생하는 모서리의 수를 계산하여 계산할 수 있습니다. 이것은 함수에서 구현됩니다<code>유사</code>에서<strong><a href="https://cran.r-project.org/web/packages/igraph/">이그라프</a></strong>패키지. 거리와 비 유사성은 이미지, 사운드,지도 및 문서를 비교하는 데 사용됩니다. 거리는 도메인 지식을 유용하게 포괄 할 수 있으며, 신중하게 선택하면 이종 데이터와 관련된 많은 어려운 문제의 해결책을 초래할 수 있습니다. 스스로에게 무엇이 있는지 묻습니다<em>관련 있는</em>“친밀감”또는 데이터의 유사성 개념은 우리가 탐색 할대로 유용한 방법을 제공 할 수 있습니다.<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>.</p>
</section>
</section>
<section class="level2 page-columns page-full" data-number="5.4" id="nonparametric-mixture-detection">
<h2 class="anchored" data-anchor-id="nonparametric-mixture-detection" data-number="5.4"><span class="header-section-number">5.4</span>비모수 혼합물 검출</h2>
<section class="level3 page-columns page-full" data-number="5.4.1" id="k-methods-k-means-k-medoids-and-pam">
<h3 class="anchored" data-anchor-id="k-methods-k-means-k-medoids-and-pam" data-number="5.4.1"><span class="header-section-number">5.4.1</span> <span class="math inline">\(케이\)</span>-행동 양식:<span class="math inline">\(케이\)</span>-수단,<span class="math inline">\(케이\)</span>-미도들과 팸</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-15" href="imgs/devil.png" title="The centers of the groups are sometimes called medoids, thus the name PAM (partitioning around medoids)."><img alt="The centers of the groups are sometimes called medoids, thus the name PAM (partitioning around medoids)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>그룹의 중심은 때때로 메도이드라고 불리며, 따라서 PAM이라는 이름 (메이드 주변의 파티션)입니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>분할 또는 반복적 재배치 방법은 고차원 환경에서 잘 작동하며<a class="footnote-ref" href="#fn4" id="fnref4" role="doc-noteref"><sup>4</sup></a>확률 밀도, EM 알고리즘 및 파라 메트릭 혼합 모델링을 쉽게 사용할 수 있습니다.<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>. 거리 측정 외에도 주요 선택은 클러스터 수입니다.<span class="math inline">\(케이\)</span>. PAM (메도이드 주변의 파티션,<span class="citation" data-cites="Kaufman2009">Kaufman과 Rousseeuw (<a href="16-chap.html#ref-Kaufman2009" role="doc-biblioref">2009 년</a>))</span>) 메소드는 다음과 같습니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>이것은 소위 차원의 저주 때문입니다. 우리는 이것에 대해 더 자세히 논의 할 것입니다<a class="quarto-xref" href="12-chap.html"><span>12 장</span></a>.</p></div></div><ol type="1">
<li><p>매트릭스에서 시작합니다<span class="math inline">\(피\)</span>세트에서 측정 된 기능<span class="math inline">\(N\)</span>관찰.</p></li>
<li><p>무작위로 선택하십시오<span class="math inline">\(케이\)</span>별개의<em>클러스터 센터</em>밖으로<span class="math inline">\(N\)</span>관찰 ( "씨앗").</p></li>
<li><p>나머지 관찰 각각을 그룹에 가장 가까운 그룹에 할당하십시오.</p></li>
<li><p>각 그룹에 대해 그룹 구성원과 센터까지의 거리의 합이 최소화되도록 그룹의 관측에서 새 센터를 선택하십시오. 이것을<em>메도이드</em>.</p></li>
<li><p>그룹이 안정화 될 때까지 3 단계와 4 단계를 반복하십시오.</p></li>
</ol>
<p>알고리즘이 실행될 때마다 2 단계에서 다른 초기 시드가 선택되며 일반적으로 다른 최종 결과로 이어질 수 있습니다. 인기있는 구현은<code>팸</code>패키지에서 기능<strong><a href="https://cran.r-project.org/web/packages/cluster/">무리</a></strong>.</p>
<p>이 방법의 약간의 변화는 메디노이드를 클러스터의 산술 수단 (중심)으로 대체하며<span class="math inline">\(케이\)</span>-수단. PAM에서는 센터가 관찰되는 동안, 이것은 일반적으로 그렇지 않습니다.<span class="math inline">\(케이\)</span>-수단. 기능<code>kmeans</code>R의 모든 설치와 함께 제공됩니다<strong><a href="https://cran.r-project.org/web/packages/stats/">통계</a></strong>패키지; 예제 실행이 표시됩니다<a class="quarto-xref" href="#fig-clust-kmeansastep1">수치<span>5.9</span></a>.</p>
<div class="cell" data-layout-align="center" data-layout-nrow="1" data-warning.known="did not converge in 1 iteration">
<div class="quarto-layout-panel" id="fig-clust-kmeansastep1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clust-kmeansastep1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-clust-kmeansastep1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-clust-kmeansastep1-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-clust-kmeansastep1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-clust-kmeansastep1" href="05-chap_files/figure-html/fig-clust-kmeansastep1-1.png" title="Figure 5.9 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-clust-kmeansastep1" id="fig-clust-kmeansastep1-1" src="05-chap_files/figure-html/fig-clust-kmeansastep1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-clust-kmeansastep1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-clust-kmeansastep1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-clust-kmeansastep1-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-clust-kmeansastep1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-clust-kmeansastep1" href="05-chap_files/figure-html/fig-clust-kmeansastep1-2.png" title="Figure 5.9 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-clust-kmeansastep1" id="fig-clust-kmeansastep1-2" src="05-chap_files/figure-html/fig-clust-kmeansastep1-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-clust-kmeansastep1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-clust-kmeansastep1" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-clust-kmeansastep1-3" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-clust-kmeansastep1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-clust-kmeansastep1" href="05-chap_files/figure-html/fig-clust-kmeansastep1-3.png" title="Figure 5.9 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-clust-kmeansastep1" id="fig-clust-kmeansastep1-3" src="05-chap_files/figure-html/fig-clust-kmeansastep1-3.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-clust-kmeansastep1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clust-kmeansastep1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.9 : 예제 실행<span class="math inline">\(케이\)</span>-Means 알고리즘. 최초의 무작위로 선택된 센터 (검은 색 원) 및 그룹 (색상)은 (a)에 표시됩니다. 그룹 멤버십은 센터까지의 거리에 따라 할당됩니다. 각각의 반복 (b) 및 (c)에서 그룹 센터가 재정의되고 점은 클러스터 센터에 재 할당됩니다.</figcaption>
</figure>
</div>
</div>
<p>이 소위<span class="math inline">\(케이\)</span>-메조는 클러스터링을위한 가장 일반적인 상용 방법입니다. 클러스터가 크기가 비슷하고 볼록 (블로브 모양) 일 때 특히 잘 작동합니다. 반면에, 진정한 클러스터의 크기가 매우 다르면 더 큰 클러스터는 분해되는 경향이 있습니다. 비 구형 또는 비 타원형 형태로 발음 된 그룹의 경우에도 마찬가지입니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-kmeansem">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.3</div>
</div>
<div class="callout-body-container callout-body">
<p>그만큼<span class="math inline">\(케이\)</span>-평균 지점을 계산하고 포인트를 클러스터에 할당하는 것 사이에 알고리즘이 번갈아 나타납니다. 이 교대 반복적 인 방법은 EM- 전투와 어떻게 다릅니 까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-7-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-7-contents callout-collapse collapse" id="callout-7">
<div class="callout-body-container callout-body">
<p>EM 알고리즘에서 각 점은 할당 된 확률 적 중량을 통해 모든 그룹의 평균 계산에 참여합니다. 에서<span class="math inline">\(케이\)</span>-메소드 메소드는 포인트가 클러스터에 기인 한 것인지 아닌지에 기인하므로 각 포인트는 하나의 클러스터 중심의 계산에만 참여합니다.</p>
</div>
</div>
</div>
</section>
<section class="level3" data-number="5.4.2" id="tight-clusters-with-resampling">
<h3 class="anchored" data-anchor-id="tight-clusters-with-resampling" data-number="5.4.2"><span class="header-section-number">5.4.2</span>리 샘플링이있는 단단한 클러스터</h3>
<p>다른 초기 센터 또는 리 샘플링 된 데이터 세트를 사용하여 프로세스를 여러 번 반복하는 영리한 체계가 있습니다. 동일한 데이터에서 클러스터링 절차를 여러 번 반복하지만 다른 출발점이 생성됩니다.<em>강력한 형태</em>~에 따르면<span class="citation" data-cites="Diday1989">Diday와 Brito (<a href="16-chap.html#ref-Diday1989" role="doc-biblioref">1989</a>))</span>. 데이터 세트의 반복 서브 샘플링 및 클러스터링 방법을 적용하면 "거의 항상"함께 그룹화 된 관찰 그룹이 생성됩니다. 이것들은 호출됩니다<em>단단한 클러스터</em> <span class="citation" data-cites="Tseng:2005">(<a href="16-chap.html#ref-Tseng:2005" role="doc-biblioref">Tseng and Wong 2005</a>))</span>. 강력한 형태 또는 단단한 클러스터에 대한 연구는 클러스터 수의 선택을 용이하게합니다. 많은 다른 클러스터의 출력을 결합하고 비교하기 위해 개발 된 최근 패키지는<strong><a href="https://bioconductor.org/packages/clusterExperiment/">clusterexperiment</a></strong>. 여기서 우리는 그 비네팅에서 예를 제시합니다. 단일 세포 RNA-Seq 실험은 개별 세포로부터 유전자 전 사체를 나타내는 판독 수를 제공한다. 단일 세포 해상도는 과학자들이 무엇보다도 세포 계통 역학을 따를 수있게합니다. 클러스터링은 이러한 데이터를 분석하는 데 매우 유용한 것으로 판명되었습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-clusterExp">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.4</div>
</div>
<div class="callout-body-container callout-body">
<p>패키지의 vignette를 따르십시오<strong><a href="https://bioconductor.org/packages/clusterExperiment/">clusterexperiment</a></strong>. 앙상블 클러스터링 기능을 호출하십시오<code>Clustermany</code>, 사용<code>팸</code>개별 클러스터링 노력. 60, 100 또는 150의 가장 가변 유전자에 포함 할 유전자의 선택을 설정하십시오. 클러스터링 결과를 플로팅하십시오<span class="math inline">\(케이\)</span>4와 9 사이의 다양. 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-9-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-9-contents callout-collapse collapse" id="callout-9">
<div class="callout-body-container callout-body">
<p>다음 코드가 생성됩니다<a class="quarto-xref" href="#fig-quiltclust-1">수치<span>5.10</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ClusterExperiment"</span>))</span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a>fluidigm<span class="ot">=</span>Scrnaseq<span class="sc">::</span><span class="fu">재 처리 플루 디그 박다</span>()</span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a>~와 함께<span class="ot">=</span>fluidigm [, fluidigm<span class="sc">$</span>Coverage_Type<span class="sc">==</span> <span class="st">"높은"</span>]]</span>
<span id="cb15-4"><a aria-hidden="true" href="#cb15-4" tabindex="-1"></a><span class="fu">분석</span>(SE)<span class="ot">=</span> <span class="fu">목록</span>(<span class="at">정규화 _counts =</span> <span class="fu">as.matrix</span>(아교<span class="sc">::</span><span class="fu">정상화 Quantiles</span>(<span class="fu">시험</span>(se))))</span>
<span id="cb15-5"><a aria-hidden="true" href="#cb15-5" tabindex="-1"></a>CE<span class="ot">=</span> <span class="fu">Clustermany</span>(와 함께,<span class="at">clusterfunction =</span> <span class="st">"팸"</span>,,,<span class="at">KS =</span> <span class="fu">기음</span>(<span class="dv">5</span>,,,<span class="dv">7</span>,,,<span class="dv">9</span>),)<span class="at">실행 =</span> <span class="cn">진실</span>,,,</span>
<span id="cb15-6"><a aria-hidden="true" href="#cb15-6" tabindex="-1"></a>                 <span class="at">iscount =</span> <span class="cn">진실</span>,,,<span class="at">ReduceMethod =</span> <span class="st">"우리의"</span>,,,<span class="at">nfilterdims =</span> <span class="fu">기음</span>(<span class="dv">60</span>,,,<span class="dv">100</span>,,,<span class="dv">150</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9 매개 변수 조합, 0 순차적 방법 사용, 0 서브 샘플링 방법 사용
매개 변수 조합에서 클러스터링 실행 ...
완료.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a><span class="fu">ClusterLabels</span>(CE)<span class="ot">=</span> <span class="fu">보결</span>(<span class="st">"FilterDims"</span>,,,<span class="st">"" "</span>,,,<span class="fu">ClusterLabels</span>(CE))</span>
<span id="cb17-2"><a aria-hidden="true" href="#cb17-2" tabindex="-1"></a><span class="fu">플롯 클러스터</span>(CE,<span class="at">whatclusters =</span> <span class="st">"워크 플로"</span>,,,<span class="at">Axisline =</span> <span class="sc">-</span><span class="dv">1</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-quiltclust-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quiltclust-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-19" href="05-chap_files/figure-html/fig-quiltclust-1-1.png" title="Figure 5.10: Comparison of clustering results (rows), for different numbers of included genes and for varying numbers of clusters, k. Each column of the heatmap corresponds to a cell, and the colors represent the cluster assignments."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-quiltclust-1-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quiltclust-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.10 : 클러스터링 결과 (행), 다른 수의 포함 유전자 및 다양한 클러스터의 비교<span class="math inline">\(케이\)</span>. 히트 맵의 각 열은 셀에 해당하고 색상은 클러스터 할당을 나타냅니다.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section class="level2 page-columns page-full" data-number="5.5" id="clustering-examples-flow-cytometry-and-mass-cytometry">
<h2 class="anchored" data-anchor-id="clustering-examples-flow-cytometry-and-mass-cytometry" data-number="5.5"><span class="header-section-number">5.5</span>클러스터링 예 : 유세포 분석 및 질량 세포 측정</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-20" href="imgs/book_icon.png" title="You can find reviews of bioinformatics methods for flow cytometry in [@oneill2013flow] and a well-kept wikipedia article."><img alt="You can find reviews of bioinformatics methods for flow cytometry in (O’Neill et al. 2013) and a well-kept wikipedia article." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
<figcaption>유세포 분석법에 대한 생물 정보학 방법에 대한 리뷰를 찾을 수 있습니다.<span class="citation" data-cites="oneill2013flow">(<a href="16-chap.html#ref-oneill2013flow" role="doc-biblioref">O'Neill et al. 2013</a>))</span>그리고<a href="https://en.wikipedia.org/wiki/Flow_cytometry_bioinformatics">잘 관리 된 Wikipedia 기사</a>.</figcaption>
</figure>
</div>
</div></div></div>
<p>단일 세포에 대한 측정을 연구하면 세포 유형과 역학을 분석 할 수있는 초점과 해상도가 향상됩니다. 유세포 분석은 약 10 개의 상이한 셀 마커의 동시 측정을 가능하게한다. 질량 세포 측정법은 세포 당 80 개의 단백질로 측정 수집을 확장시킵니다. 이 기술의 특히 유망한 적용은 면역 세포 역학에 대한 연구입니다.</p>
<section class="level3" data-number="5.5.1" id="flow-cytometry-and-mass-cytometry">
<h3 class="anchored" data-anchor-id="flow-cytometry-and-mass-cytometry" data-number="5.5.1"><span class="header-section-number">5.5.1</span>유세포 분석 및 질량 세포 측정</h3>
<p>발달의 다른 단계에서 면역 세포는 표면에 단백질의 독특한 조합을 발현합니다. 이 단백질 마커가 호출됩니다<strong>CD</strong>S (<strong>Error 500 (Server Error)!!1500.That’s an error.There was an error. Please try again later.That’s all we know.</strong>) 및 유세포 분석법에 의해 수집됩니다 (형광 사용,<span class="citation" data-cites="flowsort">Houlet et al. (<a href="16-chap.html#ref-flowsort" role="doc-biblioref">1969</a>))</span>) 또는 질량 세포 분석법 (중세 요소 리포터의 단일 세포 원자 질량 분석법 사용,<span class="citation" data-cites="BendallCell">Bendall et al. (<a href="16-chap.html#ref-BendallCell" role="doc-biblioref">2012</a>))</span>). 일반적으로 사용되는 CD의 예는 CD4이며,이 단백질은 "CD4+"라고하는 도우미 T 세포에 의해 발현된다. 그러나 일부 세포는 CD4를 발현하지만 (따라서 CD4+이지만) 실제로 도우미 T 세포는 아니다. 우리는 세포 측정 데이터에 대한 유용한 바이오 컨덕터 패키지를로드하여 시작합니다.<strong><a href="https://bioconductor.org/packages/flowCore/">FlowCore</a></strong>그리고<strong><a href="https://bioconductor.org/packages/flowViz/">flowviz</a></strong>, 예시적인 데이터 객체에서 읽으십시오<code>FCSB</code>다음과 같이 :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"FlowCore"</span>))</span>
<span id="cb18-2"><a aria-hidden="true" href="#cb18-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"flowviz"</span>))</span>
<span id="cb18-3"><a aria-hidden="true" href="#cb18-3" tabindex="-1"></a>FCSB<span class="ot">=</span> <span class="fu">read.fcs</span>(<span class="st">"../data/bendall_2011.fcs"</span>,,,<span class="at">truncate_max_range =</span> <span class="cn">거짓</span>))</span>
<span id="cb18-4"><a aria-hidden="true" href="#cb18-4" tabindex="-1"></a><span class="fu">슬롯 이름</span>(FCSB)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "exprs" "매개 변수" "설명"</code></pre>
</div>
</div>
<p><a class="quarto-xref" href="#fig-ObviousClusters">수치<span>5.11</span></a>이용 가능한 두 변수의 산점도를 보여줍니다.<code>FCSB</code>데이터. (우리는 아래에서 그러한 음모를 만드는 방법을 볼 것입니다.) 우리는이 두 가지 차원에서 명확한 이분성과 클러스터링을 볼 수 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-explorationflow">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.5</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>의 구조를보십시오<code>FCSB</code>개체 (힌트 : the<code>colnames</code>기능). 얼마나 많은 변수를 측정 했습니까?<br/>
</li>
<li>처음 몇 행을 보려면 데이터를 서브 세트하십시오 (힌트 : 사용<code>Biobase :: Exprs (FCSB)</code>). 얼마나 많은 세포가 측정 되었습니까?</li>
</ol>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="5.5.2" id="data-preprocessing">
<h3 class="anchored" data-anchor-id="data-preprocessing" data-number="5.5.2"><span class="header-section-number">5.5.2</span>데이터 전처리</h3>
<p>먼저 동위 원소와 마커 (항체) 사이의 매핑을보고하는 테이블 데이터를로드 한 다음 동위 원소 이름을 열 이름으로 바꿉니다.<code>FCSB</code>마커 이름으로. 이렇게하면 후속 분석 및 플로팅 코드가 더 읽을 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a>마커 브<span class="ot">=</span>readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"../data/bendall_2011_markers.csv"</span>))</span>
<span id="cb20-2"><a aria-hidden="true" href="#cb20-2" tabindex="-1"></a>산<span class="ot">=</span> <span class="fu">성냥</span>(Markersb<span class="sc">$</span>동위 원소,<span class="fu">colnames</span>(FCSB))</span>
<span id="cb20-3"><a aria-hidden="true" href="#cb20-3" tabindex="-1"></a><span class="fu">Stopifnot</span>(<span class="sc">!</span><span class="fu">어느</span>(<span class="fu">is.na</span>(MT)))</span>
<span id="cb20-4"><a aria-hidden="true" href="#cb20-4" tabindex="-1"></a><span class="fu">colnames</span>(FCSB) [MT]<span class="ot">=</span>마커 브<span class="sc">$</span>채점자</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 우리는 생성 할 준비가되었습니다<a class="quarto-xref" href="#fig-ObviousClusters">수치<span>5.11</span></a></p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a><span class="fu">FlowPlot</span>(FCSB,<span class="at">PlotParameters =</span> <span class="fu">colnames</span>(FCSB) [<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],,<span class="at">logy =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-ObviousClusters">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ObviousClusters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-21" href="05-chap_files/figure-html/fig-ObviousClusters-1.png" title="Figure 5.11: Cell measurements that show clear clustering in two dimensions."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-ObviousClusters-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ObviousClusters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.11 : 두 차원에서 명확한 클러스터링을 보여주는 셀 측정.</figcaption>
</figure>
</div>
</div></div></div>
<p>데이터를 2 차원으로 표시합니다<a class="quarto-xref" href="#fig-ObviousClusters">수치<span>5.11</span></a>이미 세포가 소집단으로 그룹화 될 수 있음을 보여줍니다. 때로는 마커 중 하나만 사용하여 인구를 스스로 정의 할 수 있습니다. 이 경우 간단합니다<strong>직사각형 게이팅</strong>인구를 분리하는 데 사용됩니다. 예를 들어, CD4+ 세포는 CD4 마커에 대해 높은 값으로 소집단을 복용함으로써 게이트 될 수있다. 데이터의 변환을 신중하게 선택함으로써 셀 클러스터링을 개선 할 수 있습니다. 왼쪽 부분<a class="quarto-xref" href="#fig-plotTransformations">수치<span>5.12</span></a>변환 전에 간단한 1 차원 히스토그램을 보여줍니다. 오른쪽에<a class="quarto-xref" href="#fig-plotTransformations">수치<span>5.12</span></a>우리는 변환 후 분포를 봅니다. 그것은 이분성과 두 세포 집단의 존재를 보여준다.</p>
<p><strong>데이터 변환 : 쌍곡선 아크 신 (ASINH)</strong>. 몇 가지 특수 함수 중 하나를 사용하여 흐름 및 질량 세포 측정 데이터를 모두 변환하는 것이 표준입니다. 우리는 역 쌍곡선 사인 (ASINH)의 예를 취합니다.</p>
<p><span class="math display">\ [
\ OperatorName {asinh} (x) = \ log {(x + \ sqrt {x^2 + 1})}.
\]</span></p>
<p>이것으로부터 우리는 큰 값을 볼 수 있습니다.<span class="math inline">\(엑스\)</span>,,,<span class="math inline">\ (\ OperatorName {asinh} (x) \)</span>로그처럼 행동하며 실제로 동일합니다<span class="math inline">\ (\ log (x)+\ log (2) \)</span>; 작은 경우<span class="math inline">\(엑스\)</span>함수는 선형 IN에 가깝습니다<span class="math inline">\(엑스\)</span>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>변환의 두 가지 주요 체제를 보려면 다음 코드를 실행해보십시오. 작은 값과 큰 값.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" href="#cb22-1" tabindex="-1"></a>v1<span class="ot">=</span> <span class="fu">서열</span>(<span class="dv">0</span>,,,<span class="dv">1</span>,,,<span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb22-2"><a aria-hidden="true" href="#cb22-2" tabindex="-1"></a><span class="fu">구성</span>(<span class="fu">통나무</span>(v1),<span class="fu">asinh</span>(v1),<span class="at">유형 =</span> <span class="st">'엘'</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="fu">구성</span>(v1,<span class="fu">asinh</span>(v1),<span class="at">유형 =</span> <span class="st">'엘'</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a>v3<span class="ot">=</span> <span class="fu">서열</span>(<span class="dv">30</span>,,,<span class="dv">3000</span>,,,<span class="at">길이 =</span> <span class="dv">100</span>))</span>
<span id="cb24-2"><a aria-hidden="true" href="#cb24-2" tabindex="-1"></a><span class="fu">구성</span>(<span class="fu">통나무</span>(v3),<span class="fu">asinh</span>(v3),<span class="at">유형 =</span> <span class="st">'엘'</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>이것은 챕터에서 언급 된 분산 안정화 변환의 또 다른 예입니다.<a class="quarto-xref" href="04-chap.html"><span>4</span></a>그리고<a class="quarto-xref" href="08-chap.html"><span>8</span></a>. <a class="quarto-xref" href="#fig-plotTransformations">수치<span>5.12</span></a>다음 코드에 의해 생성됩니다<code>ArcSinHtransform</code>기능<strong><a href="https://bioconductor.org/packages/flowCore/">FlowCore</a></strong>패키지.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a>asinhrsf<span class="ot">=</span> <span class="fu">ArcSinHtransform</span>(<span class="at">a =</span> <span class="fl">0.1</span>,,,<span class="at">b =</span> <span class="dv">1</span>))</span>
<span id="cb25-2"><a aria-hidden="true" href="#cb25-2" tabindex="-1"></a>FCSBT<span class="ot">=</span> <span class="fu">변환</span>(FCSB,<span class="fu">변환리스트</span>(<span class="fu">colnames</span>(FCSB) [<span class="sc">-</span><span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>,,,<span class="dv">41</span>), asinhrsf)))</span>
<span id="cb25-3"><a aria-hidden="true" href="#cb25-3" tabindex="-1"></a><span class="fu">밀도 플롯</span>(<span class="sc">~</span><span class="st">`</span><span class="at">CD3ALL</span><span class="st">`</span>, fcsb)</span>
<span id="cb25-4"><a aria-hidden="true" href="#cb25-4" tabindex="-1"></a><span class="fu">밀도 플롯</span>(<span class="sc">~</span><span class="st">`</span><span class="at">CD3ALL</span><span class="st">`</span>, fcsbt)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-plotTransformations">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-plotTransformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-plotTransformations" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotTransformations-1" width="75%">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-plotTransformations-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-plotTransformations" href="05-chap_files/figure-html/fig-plotTransformations-1.png" title="Figure 5.12 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-plotTransformations" id="fig-plotTransformations-1" src="05-chap_files/figure-html/fig-plotTransformations-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-plotTransformations-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-plotTransformations" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-plotTransformations-2" width="75%">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-plotTransformations-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-plotTransformations" href="05-chap_files/figure-html/fig-plotTransformations-2.png" title="Figure 5.12 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-plotTransformations" id="fig-plotTransformations-2" src="05-chap_files/figure-html/fig-plotTransformations-2.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-plotTransformations-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plotTransformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.12 : 패널 (a)는 CD3ALL 변수의 히스토그램을 보여줍니다. 셀은 몇 가지 큰 값으로 약 0 정도 클러스터링됩니다. (b)에서, 우리는 ASINH 변환 후, 세포가 클러스터되어 두 그룹 또는 유형으로 떨어집니다.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-dimkmeans">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.6</div>
</div>
<div class="callout-body-container callout-body">
<p>다음 코드는 데이터를 사용하여 데이터를 2 개의 그룹으로 분할하기 위해 몇 개의 차원을 사용합니까?<span class="math inline">\(케이\)</span>-수단 ?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a>KF<span class="ot">=</span> <span class="fu">Kmeansfilter</span>(<span class="st">"CD3ALL"</span> <span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"POP1"</span>,,,<span class="st">"POP2"</span>),)<span class="at">필터 =</span><span class="st">"소프트 필터"</span>))</span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a>Mustow<span class="ot">=</span>FlowCore<span class="sc">::</span><span class="fu">필터</span>(FCSBT, KF)</span>
<span id="cb26-3"><a aria-hidden="true" href="#cb26-3" tabindex="-1"></a><span class="fu">요약</span>(FRES)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>POP1 : 91392 이벤트 중 33434 (36.58%)
POP2 : 91392 이벤트 중 57958 (63.42%)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a>FCSBT1<span class="ot">=</span>FlowCore<span class="sc">::</span><span class="fu">나뉘다</span>(FCSBT, FRES,<span class="at">인구 =</span> <span class="st">"POP1"</span>))</span>
<span id="cb28-2"><a aria-hidden="true" href="#cb28-2" tabindex="-1"></a>FCSBT2<span class="ot">=</span>FlowCore<span class="sc">::</span><span class="fu">나뉘다</span>(FCSBT, FRES,<span class="at">인구 =</span> <span class="st">"POP2"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-flowCD3CD56-1">수치<span>5.13</span></a>다음 코드에 의해 생성 된 CD3 및 CD56 마커에 의해 저장된 2 차원으로의 순진한 투영을 보여줍니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Flowpeaks"</span>))</span>
<span id="cb29-2"><a aria-hidden="true" href="#cb29-2" tabindex="-1"></a>FP<span class="ot">=</span> <span class="fu">Flowpeaks</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(FCSBT) [,<span class="fu">기음</span>(<span class="st">"CD3ALL"</span>,,,<span class="st">"CD56"</span>))))</span>
<span id="cb29-3"><a aria-hidden="true" href="#cb29-3" tabindex="-1"></a><span class="fu">구성</span>(FP)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-flowCD3CD56-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-flowCD3CD56-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-24" href="05-chap_files/figure-html/fig-flowCD3CD56-1-1.png" title="Figure 5.13: After transformation these cells were clustered using kmeans."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-flowCD3CD56-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-flowCD3CD56-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.13 : 변형 후이 셀은 클러스터링되었습니다<code>kmeans</code>.
</figcaption>
</figure>
</div>
</div></div></div>
<p>영역을 밀도로 채우는 지점을 플로팅 할 때 우리는 오버 플로팅을 피하려고 노력해야합니다. 우리는 선호하는 기술 중 일부를 보았습니다<a class="quarto-xref" href="03-chap.html"><span>3 장</span></a>; 여기서 우리는 윤곽과 음영을 사용합니다. 이것은 다음과 같이 수행됩니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a><span class="fu">FlowPlot</span>(FCSBT,<span class="at">PlotParameters =</span> <span class="fu">기음</span>(<span class="st">"CD3ALL"</span>,,,<span class="st">"CD56"</span>),)<span class="at">logy =</span> <span class="cn">거짓</span>))</span>
<span id="cb30-2"><a aria-hidden="true" href="#cb30-2" tabindex="-1"></a><span class="fu">윤곽</span>(FCSBT [,<span class="fu">기음</span>(<span class="dv">40</span>,,,<span class="dv">19</span>)], <span class="at">추가 =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-groupcontourCD3CD56">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-groupcontourCD3CD56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-25" href="05-chap_files/figure-html/fig-groupcontourCD3CD56-1.png" title="Figure 5.14: Like Figure fig-flowCD3CD56-1, using contours."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-groupcontourCD3CD56-1.png" width="400"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-groupcontourCD3CD56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.14 : 좋아요<a class="quarto-xref" href="#fig-flowCD3CD56-1">수치<span>5.13</span></a>, 윤곽을 사용합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이것은 생성됩니다<a class="quarto-xref" href="#fig-groupcontourCD3CD56">수치<span>5.14</span></a>-보다 유익한 버전<a class="quarto-xref" href="#fig-flowCD3CD56-1">수치<span>5.13</span></a>.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>바이오 컨덕터 패키지<strong><a href="https://bioconductor.org/packages/ggcyto/">ggcyto</a></strong>다른면에서 각 환자의 데이터를 플로팅 할 수 있습니다.<code>ggplot</code>. 이 접근 방식을 사용하여 출력을 다음 줄을 따라 위에서 수행 한 작업과 비교해보십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggcyto"</span>))</span>
<span id="cb31-2"><a aria-hidden="true" href="#cb31-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"라벨링"</span>))</span>
<span id="cb31-3"><a aria-hidden="true" href="#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a aria-hidden="true" href="#cb31-4" tabindex="-1"></a>P1<span class="ot">=</span> <span class="fu">ggcyto</span>(FCSB,<span class="fu">AES</span>(<span class="at">x =</span>CD4))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">60</span>))</span>
<span id="cb31-5"><a aria-hidden="true" href="#cb31-5" tabindex="-1"></a>P2<span class="ot">=</span> <span class="fu">ggcyto</span>(FCSB,<span class="fu">AES</span>(<span class="at">x =</span>CD8))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">60</span>))</span>
<span id="cb31-6"><a aria-hidden="true" href="#cb31-6" tabindex="-1"></a>P3<span class="ot">=</span> <span class="fu">ggcyto</span>(FCSB,<span class="fu">AES</span>(<span class="at">x =</span>CD4,<span class="at">y =</span>CD8))<span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>))</span>
<span id="cb31-7"><a aria-hidden="true" href="#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a aria-hidden="true" href="#cb31-8" tabindex="-1"></a>FCSBT<span class="ot">=</span> <span class="fu">변환</span>(FCSB,<span class="fu">변환리스트</span>(<span class="fu">colnames</span>(FCSB) [<span class="sc">-</span><span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">2</span>,,,<span class="dv">41</span>)], </span>
<span id="cb31-9"><a aria-hidden="true" href="#cb31-9" tabindex="-1"></a>                                      <span class="fu">ArcSinHtransform</span>(<span class="at">a =</span> <span class="dv">0</span>,,,<span class="at">b =</span> <span class="dv">1</span>))))</span>
<span id="cb31-10"><a aria-hidden="true" href="#cb31-10" tabindex="-1"></a>                                      </span>
<span id="cb31-11"><a aria-hidden="true" href="#cb31-11" tabindex="-1"></a>P1T<span class="ot">=</span> <span class="fu">ggcyto</span>(FCSBT,<span class="fu">AES</span>(<span class="at">x =</span>CD4))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">빈 =</span> <span class="dv">90</span>))</span>
<span id="cb31-12"><a aria-hidden="true" href="#cb31-12" tabindex="-1"></a>P2T<span class="ot">=</span> <span class="fu">ggcyto</span>(FCSBT,<span class="fu">AES</span>(<span class="at">x =</span>CD4,<span class="at">y =</span>CD8))<span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>))</span>
<span id="cb31-13"><a aria-hidden="true" href="#cb31-13" tabindex="-1"></a>P3T<span class="ot">=</span> <span class="fu">ggcyto</span>(FCSBT,<span class="fu">AES</span>(<span class="at">x =</span>CD45RA,<span class="at">y =</span>CD20))<span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">색상 =</span> <span class="st">"검은색"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="5.5.3" id="density-based-clustering">
<h3 class="anchored" data-anchor-id="density-based-clustering" data-number="5.5.3"><span class="header-section-number">5.5.3</span>밀도 기반 클러스터링</h3>
<p>마커와 많은 수의 셀을 포함하는 유세포 분석과 같은 데이터 세트는 밀도 기반 클러스터링에 적합합니다. 이 방법은 Sparser 영역으로 분리 된 고밀도 영역을 찾습니다. 반드시 볼록한 클러스터에 대처할 수 있다는 이점이 있습니다. 이러한 방법의 하나의 구현을 DBSCAN이라고합니다. 다음 코드를 실행하여 예제를 살펴 보겠습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"DBSCAN"</span>))</span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a>MC5<span class="ot">=</span>바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(FCSBT) [,<span class="fu">기음</span>(<span class="dv">15</span>,,,<span class="dv">16</span>,,,<span class="dv">19</span>,,,<span class="dv">40</span>,,,<span class="dv">33</span>))]]</span>
<span id="cb32-3"><a aria-hidden="true" href="#cb32-3" tabindex="-1"></a>res5<span class="ot">=</span>DBSCAN<span class="sc">::</span><span class="fu">DBSCAN</span>(MC5,<span class="at">EPS =</span> <span class="fl">0.65</span>,,,<span class="at">minpts =</span> <span class="dv">30</span>))</span>
<span id="cb32-4"><a aria-hidden="true" href="#cb32-4" tabindex="-1"></a>MC5DF<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(MC5,<span class="at">클러스터 =</span> <span class="fu">AS.Factor</span>(RES5<span class="sc">$</span>무리))</span>
<span id="cb32-5"><a aria-hidden="true" href="#cb32-5" tabindex="-1"></a><span class="fu">테이블</span>(MC5DF<span class="sc">$</span>무리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 1 2 3 4 5 6 7 8 
76053 4031 5450 5310 257 160 63 25 43</code></pre>
</div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1" data-warning.known='["zero contours were generated","no non-missing arguments to"]'>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a><span class="fu">ggplot</span>(MC5DF,<span class="fu">AES</span>(<span class="at">x =</span>CD4,<span class="at">y =</span>CD8,<span class="at">col =</span>무리))<span class="sc">+</span><span class="fu">geom_density2d</span>()</span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a><span class="fu">ggplot</span>(MC5DF,<span class="fu">AES</span>(<span class="at">x =</span>CD3ALL,<span class="at">y =</span>CD20,<span class="at">col =</span>무리))<span class="sc">+</span><span class="fu">geom_density2d</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-dbscanfcs5">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dbscanfcs5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-dbscanfcs5" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-dbscanfcs5-1" width="75%">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-dbscanfcs5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-dbscanfcs5" href="05-chap_files/figure-html/fig-dbscanfcs5-1.png" title="Figure 5.15 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-dbscanfcs5" id="fig-dbscanfcs5-1" src="05-chap_files/figure-html/fig-dbscanfcs5-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-dbscanfcs5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-dbscanfcs5" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-dbscanfcs5-2" width="75%">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-dbscanfcs5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-dbscanfcs5" href="05-chap_files/figure-html/fig-dbscanfcs5-2.png" title="Figure 5.15 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-dbscanfcs5" id="fig-dbscanfcs5-2" src="05-chap_files/figure-html/fig-dbscanfcs5-2.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-dbscanfcs5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dbscanfcs5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.15 :이 두 플롯은 클러스터링 결과를 보여줍니다.<code>DBSCAN</code>5 개의 마커 사용. 여기서 우리는 데이터의 예측 만 CD4-CD8 및 C3ALL-CD20 평면으로 보여줍니다.</figcaption>
</figure>
</div>
</div>
<p>출력이 표시됩니다<a class="quarto-xref" href="#fig-dbscanfcs5">수치<span>5.15</span></a>. 2D 투영에서 클러스터의 겹침을 통해 클러스터링의 다차원 적 특성을 이해할 수 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-changedim">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.7</div>
</div>
<div class="callout-body-container callout-body">
<p>입력 데이터에서 CD 마커 변수 하나를 추가하여 차원을 6으로 늘리십시오.<br/>그런 다음 다양합니다<code>EPS</code>그리고 적어도 2 개의 클러스터가 100 점 이상을 가질 수 있도록 4 개의 클러스터를 찾으십시오.<br/>이 7 CD 마커 변수에 대한 반복, 무엇을 알아 차릴 것인가?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-15-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-15-contents callout-collapse collapse" id="callout-15">
<div class="callout-body-container callout-body">
<p>다음 6 개의 마커가있는 예</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" href="#cb35-1" tabindex="-1"></a>MC6<span class="ot">=</span>바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(FCSBT) [,<span class="fu">기음</span>(<span class="dv">15</span>,,,<span class="dv">16</span>,,,<span class="dv">19</span>,,,<span class="dv">33</span>,,,<span class="dv">25</span>,,,<span class="dv">40</span>))]]</span>
<span id="cb35-2"><a aria-hidden="true" href="#cb35-2" tabindex="-1"></a>해안<span class="ot">=</span>DBSCAN<span class="sc">::</span><span class="fu">DBSCAN</span>(MC6,<span class="at">EPS =</span> <span class="fl">0.65</span>,,,<span class="at">minpts =</span> <span class="dv">20</span>))</span>
<span id="cb35-3"><a aria-hidden="true" href="#cb35-3" tabindex="-1"></a>MC6DF<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(MC6,<span class="at">클러스터 =</span> <span class="fu">AS.Factor</span>(res<span class="sc">$</span>무리))</span>
<span id="cb35-4"><a aria-hidden="true" href="#cb35-4" tabindex="-1"></a><span class="fu">테이블</span>(MC6DF<span class="sc">$</span>무리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 1 2 3 4 5 6 
91068 34 61 20 67 121 21</code></pre>
</div>
</div>
<p>EPS = 0.75에서는 EPS = 0.65를 복용하는 것보다 충분히 큰 클러스터를 찾는 것이 더 쉽고 EPS = 0.55가 불가능하다는 것을 알 수 있습니다. 우리는 차원을 7으로 증가 시키면 EPS를 더 크게 만들어야합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a>MC7<span class="ot">=</span>바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(FCSBT) [,<span class="fu">기음</span>(<span class="dv">11</span>,,,<span class="dv">15</span>,,,<span class="dv">16</span>,,,<span class="dv">19</span>,,,<span class="dv">25</span>,,,<span class="dv">33</span>,,,<span class="dv">40</span>))]]</span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a>해안<span class="ot">=</span>DBSCAN<span class="sc">::</span><span class="fu">DBSCAN</span>(MC7,<span class="at">EPS =</span> <span class="fl">0.95</span>,,,<span class="at">minpts =</span> <span class="dv">20</span>))</span>
<span id="cb37-3"><a aria-hidden="true" href="#cb37-3" tabindex="-1"></a>MC7DF<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(MC7,<span class="at">클러스터 =</span> <span class="fu">AS.Factor</span>(res<span class="sc">$</span>무리))</span>
<span id="cb37-4"><a aria-hidden="true" href="#cb37-4" tabindex="-1"></a><span class="fu">테이블</span>(MC7DF<span class="sc">$</span>무리)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 1 2 3 4 5 6 7 8 9 10 
90249 21 102 445 158 119 19 224 17 20 18</code></pre>
</div>
</div>
<p>이것은 우리에게 소위를 보여줍니다<strong>치수의 저주</strong>실제로, 그 중 더<a class="quarto-xref" href="12-chap.html"><span>12 장</span></a>.</p>
</div>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="how-does-density-based-clustering-dbscan-work">
<h4 class="unnumbered anchored" data-anchor-id="how-does-density-based-clustering-dbscan-work">밀도 기반 클러스터링 (DBSCAN)은 어떻게 작동합니까?</h4>
<p>DBSCAN 방법 클러스터는 조밀 한 영역에 따라<em>밀도-연결성</em>표준. 반경의 작은 이웃 구를 살펴 봅니다<span class="math inline">\ (\ epsilon \)</span>포인트가 연결되어 있는지 확인합니다.</p>
<p>DBSCAN의 빌딩 블록은 밀도 수집 성의 개념입니다.<span class="math inline">\(큐\)</span>직접적입니다<strong>밀도가 부과 가능합니다</strong>한 지점에서<span class="math inline">\(피\)</span>주어진 임계 값보다 더 멀지 않은 경우<span class="math inline">\ (\ epsilon \)</span>그리고 if<span class="math inline">\(피\)</span>고려할 수있는 충분한 지점으로 둘러싸여 있습니다.<span class="math inline">\(피\)</span>(그리고<span class="math inline">\(큐\)</span>) 조밀 한 지역의 일부가 되십시오. 우리는 그렇게 말합니다<span class="math inline">\(큐\)</span>~이다<em>밀도가 부과 가능합니다</em>~에서<span class="math inline">\(피\)</span>포인트 시퀀스가있는 경우<span class="math inline">\ (p_1, ..., p_n \)</span>~와 함께<span class="math inline">\ (p_1 = p \)</span>그리고<span class="math inline">\ (p_n = q \)</span>, 각각<span class="math inline">\ (p_ {i + 1} \)</span>직접 밀도가 부과됩니다<span class="math inline">\ (p_i \)</span>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-28" href="imgs/devil.png" title="It is important that the method looks for high density of points in a neighborhood. Other methods exist that try to define clusters by a void, or “missing points” between clusters. But these are vulnerable to the curse of dimensionality; these can create spurious “voids”."><img alt="It is important that the method looks for high density of points in a neighborhood. Other methods exist that try to define clusters by a void, or “missing points” between clusters. But these are vulnerable to the curse of dimensionality; these can create spurious “voids”." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption>이 방법은 이웃에서 높은 밀도의 점을 찾는 것이 중요합니다. 클러스터 사이의 공허 또는 "누락 된 점"으로 클러스터를 정의하려고하는 다른 방법이 존재합니다. 그러나 이것들은 차원의 저주에 취약하다. 이들은 가짜 "voids"를 만들 수 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>에이<em>무리</em>그런 다음 다음 속성을 충족하는 포인트의 하위 집합입니다.</p>
<ol type="1">
<li><p>클러스터 내의 모든 점은 상호 밀도 연결됩니다.</p></li>
<li><p>포인트가 클러스터의 모든 지점에 밀도로 연결되면 클러스터의 일부입니다.</p></li>
<li><p>포인트 그룹은 적어도 있어야합니다<code>Minpts</code>클러스터로 계산할 수 있습니다.</p></li>
</ol>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="5.6" id="hierarchical-clustering">
<h2 class="anchored" data-anchor-id="hierarchical-clustering" data-number="5.6"><span class="header-section-number">5.6</span>계층 적 클러스터링</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-LinnaeusClass">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-LinnaeusClass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-29" href="imgs/LinnaeusClass-01.png" title="Figure 5.16: A snippet of Linnus’ taxonomy that clusters organisms according to feature similarities."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/LinnaeusClass-01.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LinnaeusClass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.16 : 특징 유사성에 따라 유기체를 클러스터하는 Linnus 분류의 스 니펫.</figcaption>
</figure>
</div>
</div></div></div>
<p>계층 적 클러스터링은 상향식 접근법이며, 유사한 관찰 및 서브 클래스가 반복적으로 조립됩니다.<a class="quarto-xref" href="#fig-LinnaeusClass">수치<span>5.16</span></a>Linnæus가 특정 특성에 따라 어떻게 중첩 된 유기체 클러스터를 만든지를 보여줍니다. 이러한 계층 적 조직은 많은 분야에서 유용했으며<em>자연의 사다리</em>.</p>
<p><strong>덴드로 그램 주문</strong>. 예에서 볼 수 있듯이<a class="quarto-xref" href="#fig-Cluster-dendrogramorder">수치<span>5.17</span></a>, 라벨의 순서는 형제 쌍 내에서 중요하지 않습니다. 수평 거리는 일반적으로 의미가 없지만 수직 거리는 일부 정보를 인코딩합니다. 이러한 특성은 단일 물질이 아닌 이웃에 대해 해석 할 때 (즉, 동일한 하위 트리 나 클레이드에 있지는 않지만) 음모에서 이웃으로 나타납니다 (오른쪽 나무의 B와 D는 비 단성적 이웃입니다).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-Cluster-dendrogramorder">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-Cluster-dendrogramorder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-30" href="imgs/SameTree-01.png" title="Figure 5.17: Three representations of the same hierarchical clustering tree."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/SameTree-01.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-Cluster-dendrogramorder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.17 : 세 가지 표현<strong>같은</strong>계층 적 클러스터링 트리.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>하향식 계층</strong>. 대안의 하향식 접근 방식은 모든 객체를 취하고 선택한 기준에 따라 순차적으로 분할됩니다. 그러한 소위<strong>재귀 분할</strong>방법은 종종 의사 결정 트리를 만드는 데 사용됩니다. 그것들은 예측에 유용 할 수 있습니다 (예 : 의학적 진단이 주어지면 생존 시간) : 우리는 이러한 경우 이종 인구를 분할을 통해보다 균질 한 하위 그룹으로 나누기를 바라고 있습니다. 이 장에서는 상향식 접근법에 집중합니다. 감독 학습 및 분류에 대해 이야기 할 때 파티션으로 돌아갑니다.<a class="quarto-xref" href="12-chap.html"><span>12 장</span></a>.</p>
<section class="level3 page-columns page-full" data-number="5.6.1" id="how-to-compute-dissimilarities-between-aggregated-clusters">
<h3 class="anchored" data-anchor-id="how-to-compute-dissimilarities-between-aggregated-clusters" data-number="5.6.1"><span class="header-section-number">5.6.1</span>집계 된 클러스터 간의 유사성을 계산하는 방법?</h3>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-single">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-31" href="imgs/ClusterStepChoiceSingle1b.png" title="Figure 5.18: In the single linkage method, the distance between groups C_1 and C_2 is defined as the distance between the closest two points from the groups."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/ClusterStepChoiceSingle1b.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.18 : 단일 연결 방법에서 그룹 간의 거리<span class="math inline">\ (C_1 \)</span>그리고<span class="math inline">\ (C_2 \)</span>그룹에서 가장 가까운 두 지점 사이의 거리로 정의됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>집계에 의해 작동하는 계층 적 클러스터링 알고리즘은 가장 유사한 관찰을 함께 그룹화하여 시작하기에 쉽습니다. 그러나 우리는 모든 개별 객체 쌍 사이의 거리 이상이 필요합니다. 일단 집계가 이루어지면, 새로 형성된 클러스터와 다른 모든 지점 (또는 기존 클러스터) 사이의 거리가 어떻게 계산되는지 말해야합니다. 객체-객체 거리를 기반으로 한 다른 선택이 있으며 각 선택은 다른 유형의 계층 적 클러스터링을 초래합니다.</p>
<p>그만큼<strong>최소 점프</strong>방법도 호출됩니다<strong>단일 연결</strong>또는 가장 가까운 이웃 방법은 클러스터 사이의 거리를 두 클러스터의 두 지점 사이의 가장 작은 거리 (<a class="quarto-xref" href="#fig-single">수치<span>5.18</span></a>) : :</p>
<p><span class="math display">\ [
d_ {12} = \ min_ {i \ in c_1, j \ in c_2} d_ {ij}.
\]</span></p>
<p>이 방법은 인접한 점 문자열처럼 보이는 클러스터를 생성하는 경향이 있습니다. 클러스터 트리는 종종 빗처럼 보입니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-complete">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-complete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-32" href="imgs/ClusterStepChoiceComplete1b.png" title="Figure 5.19: In the complete linkage method, the distance between groups C_1 and C_2 is defined as the maximum distance between pairs of points from the two groups."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/ClusterStepChoiceComplete1b.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-complete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.19 : 전체 연결 방법에서 그룹 간의 거리<span class="math inline">\ (C_1 \)</span>그리고<span class="math inline">\ (C_2 \)</span>두 그룹의 포인트 쌍 사이의 최대 거리로 정의됩니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>그만큼<strong>최대 점프</strong>(또는<strong>완전한 연결</strong>) 메소드는 클러스터 사이의 거리는<a class="quarto-xref" href="#fig-complete">수치<span>5.19</span></a>:</p>
<p><span class="math display">\ [
d_ {12} = \ max_ {i \ in c_1, j \ in c_2} d_ {ij}.
\]</span></p>
<p>그만큼<strong>평균 연계</strong>방법은 위의 두 가지 사이의 절반입니다 (여기, 여기,<span class="math inline">\ (| C_K | \)</span>클러스터의 요소 수를 나타냅니다<span class="math inline">\(케이\)</span>) : :</p>
<p><span class="math display">\ [
d_ {12} = \ frac {1} {| c_1 | |
\]</span></p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-betweenwithin">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-betweenwithin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-33" href="imgs/BetweenWithinb.png" title="Figure 5.20: The Ward method maximizes the between group sum of squares (red edges), while minimizing the sums of squares within groups (black edges)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/BetweenWithinb.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-betweenwithin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.20 : 와드 방법은 그룹 내에서 사각형 (붉은 모서리) 사이의 그룹 합계를 최대화하면서 그룹 내에서 제곱의 합을 최소화합니다 (검은 모서리).</figcaption>
</figure>
</div>
</div></div></div>
<p><strong>와드의 방법</strong>목표는 클러스터 내 분산을 최소화하는 것이 목표입니다. 이 방법은 매우 효율적이지만 더 작은 크기의 클러스터를 만드는 경향이 있습니다.</p>
<table class="caption-top table">
<caption>집계 사이의 거리를 정의하는 다양한 선택의 장점과 단점<span class="citation" data-cites="distory-paper">(<a href="16-chap.html#ref-distory-paper" role="doc-biblioref">Chakerian과 Holmes 2012</a>))</span>.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">방법</th>
<th style="text-align: left;">프로</th>
<th style="text-align: left;">단점</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">단일 연결</td>
<td style="text-align: left;">클러스터 수</td>
<td style="text-align: left;">Comblike 나무</td>
</tr>
<tr class="even">
<td style="text-align: left;">완전한 연결</td>
<td style="text-align: left;">소형 수업</td>
<td style="text-align: left;">하나의 관찰은 그룹을 바꿀 수 있습니다</td>
</tr>
<tr class="odd">
<td style="text-align: left;">평균 연계</td>
<td style="text-align: left;">비슷한 크기와 분산</td>
<td style="text-align: left;">견고하지 않습니다</td>
</tr>
<tr class="even">
<td style="text-align: left;">중심</td>
<td style="text-align: left;">특이 치에게 강력합니다</td>
<td style="text-align: left;">더 적은 수의 클러스터</td>
</tr>
<tr class="odd">
<td style="text-align: left;">구</td>
<td style="text-align: left;">관성 최소화</td>
<td style="text-align: left;">높은 변동성이면 작은 클래스</td>
</tr>
</tbody>
</table>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-mobile">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mobile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-34" href="imgs/CalderHand.png" title="Figure 5.21: Hierarchical clustering output has similar properties to a mobile: the branches can rotate freely from their suspension points."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/CalderHand.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mobile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.21 : 계층 적 클러스터링 출력은 모바일과 유사한 특성을 가지고 있습니다. 분기는 서스펜션 지점에서 자유롭게 회전 할 수 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>이것이 우리가 계층 적 클러스터링 트리를 만드는 데 필요한 선택입니다. 분할 방법과 비교하여 계층 적 클러스터링의 장점은 그룹의 강도, 트리의 내부 가장자리의 길이에 대한 그래픽 진단을 제공한다는 것입니다.</p>
<p>클러스터가 거의 같은 크기라는 사전 지식이있을 때, 평균 연계 또는 클래스 분산을 최소화하는 Ward의 방법을 사용하는 것이 가장 좋은 전술입니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-hclustcellpop">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.8</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>세포 집단에 대한 계층 적 클러스터링</strong>그만큼<code>깨물다</code>데이터는 10 명의 환자의 3 가지 유형 (순진, 이펙터, 기억)의 T 세포에 대한 156 개의 유전자에 대한 유전자 발현 측정이다.<span class="citation" data-cites="holmes2005memory">(<a href="16-chap.html#ref-holmes2005memory" role="doc-biblioref">Holmes et al. 2005</a>))</span>. 사용<strong><a href="https://cran.r-project.org/web/packages/pheatmap/">pheatmap</a></strong>이 데이터의 유클리드 및 맨해튼 거리에 덴 그램이나 재정렬없이 두 개의 간단한 히트 맵을 만들어냅니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-difftrees">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.9</div>
</div>
<div class="callout-body-container callout-body">
<p>이제이 두 거리가있는 계층 적 군집화 트리의 순서 차이점을 살펴보십시오. 어떤 차이가 눈에 띄나요?</p>
</div>
</div>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-treeshapes">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-treeshapes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-treeshapes" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-treeshapes-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-treeshapes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-treeshapes" href="imgs/single14heatmap.png" title="Figure 5.22 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-treeshapes" id="fig-treeshapes-1" src="imgs/single14heatmap.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-treeshapes-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-treeshapes" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-treeshapes-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-treeshapes-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-treeshapes" href="imgs/average14heatmap.png" title="Figure 5.22 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-treeshapes" id="fig-treeshapes-2" src="imgs/average14heatmap.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-treeshapes-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-treeshapes" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-treeshapes-3">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-treeshapes-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-treeshapes" href="imgs/complete14heatmap.png" title="Figure 5.22 (c): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-treeshapes" id="fig-treeshapes-3" src="imgs/complete14heatmap.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-treeshapes-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(기음)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-treeshapes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.22 : 다른 응집 선택으로 제작 된 3 개의 계층 적 클러스터링 플롯. (a)의 단일 연결에 대한 빗 모양의 구조에 유의하십시오. 평균 (b) 및 완전한 연계 (c) 나무는 내부 가지의 길이 만 다릅니다.</figcaption>
</figure>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-apeclust14">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-apeclust14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-38" href="imgs/apeclust14.png" title="Figure 5.23: This tree can be drawn in many different ways. The ordering of the leaves as it is appears here is (8,11,9,10,7,5,6,1,4,2,3)."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/apeclust14.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-apeclust14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.23 :이 나무는 여러 가지 방법으로 그릴 수 있습니다. 여기에 나타나는 잎의 순서는<span class="math inline">\ ((8,11,9,10,7,5,6,1,4,2,3) \)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-caldermobile">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.10</div>
</div>
<div class="callout-body-container callout-body">
<p>계층 적 클러스터링 트리는 Calder Mobile과 같습니다.<a class="quarto-xref" href="#fig-mobile">수치<span>5.21</span></a>그것은 많은 내부 피벗 포인트를 중심으로 스윙 할 수 있으므로 주어진 나무와 일치하는 많은 팁을 제공 할 수 있습니다. 나무를보세요<a class="quarto-xref" href="#fig-apeclust14">수치<span>5.23</span></a>. 팁 레이블을 주문하고 여전히 그 나무와 일관성을 유지하는 방법은 몇 개입니까?</p>
</div>
</div>
<p>계층 적 클러스터링 트리를 기반으로 행 및/또는 열이 순서를 지정하는 히트 맵을 보는 것이 일반적입니다. 때때로 이것은 일부 클러스터를 매우 강하게 보이게합니다. 나무가 실제로 암시하는 것보다 강합니다. 예를 들어 패키지에 열 맵에서 행과 열을 주문하는 대체 방법이 있습니다.<strong><a href="https://cran.r-project.org/web/packages/NeatMap/">아니다</a></strong>, 그것은 안수 방법을 사용합니다<a class="footnote-ref" href="#fn5" id="fnref5" role="doc-noteref"><sup>5</sup></a>주문을 찾으려면.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>이것들은 설명 될 것입니다<a class="quarto-xref" href="09-chap.html"><span>9 장</span></a>.</p></div></div></section>
</section>
<section class="level2 page-columns page-full" data-number="5.7" id="sec-clustervalidation">
<h2 class="anchored" data-anchor-id="sec-clustervalidation" data-number="5.7"><span class="header-section-number">5.7</span>클러스터 수 검증 및 선택</h2>
<p>우리가 설명한 클러스터링 방법은 다양한 제약 하에서 데이터의 우수한 그룹을 전달하도록 조정됩니다. 그러나 클러스터링 방법은 아무도 없더라도 항상 그룹을 제공 할 것입니다. 실제로 데이터에 실제 클러스터가 없으면 계층 적 클러스터링 트리는 비교적 짧은 내부 분기를 보일 수 있습니다. 그러나 이것을 정량화하는 것은 어렵습니다. 일반적으로 더 객관적인 기준을 가진 클러스터 선택을 검증하는 것이 중요합니다.</p>
<p>클러스터링 결과의 품질을 평가하기위한 한 가지 기준은 그룹 내 거리를 작게 유지하면서 그룹 차이를 극대화하는 정도를 묻는 것입니다 (빨간 선의 길이를 극대화하고 검은 선의 길이를 최소화합니다.<a class="quarto-xref" href="#fig-betweenwithin">수치<span>5.20</span></a>). 우리는 이것을 그룹 내에서 제곱 거리 (WSS)의 합으로 공식화합니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-cluster" id="eq-cluster-WSS1"><span class="math display">\ [
\ text {wss} _k = \ sum _ {\ el = 1}^k \ sum_ {x_i \ in c_ \ el} d^2 (x_i, \ bar {x} _ {\ el})
\ tag {5.4} \]</span></span></p>
<p>여기,<span class="math inline" data-anchor-id="eq-cluster">\(케이\)</span>클러스터 수입니다.<span class="math inline">\(셀\)</span>객체의 세트입니다<span class="math inline">\(\엘\)</span>-TH 클러스터 및<span class="math inline">\ (\ bar {x} _ \ ell \)</span>질량 중심 (평균 점)<span class="math inline">\(\엘\)</span>-TH 클러스터. 우리는 의존성을 진술합니다<span class="math inline">\(케이\)</span>WSS의<a class="quarto-xref" href="#eq-cluster-WSS1">방정식<span>5.4</span></a>우리는이 수량을 다른 값의 비교에 비교하는 데 관심이 있습니다.<span class="math inline">\(케이\)</span>동일한 클러스터 알고리즘의 경우. 그러나 WSS는 충분한 기준이 아닙니다. WSS의 가장 작은 값은 각 지점을 자체 클러스터로 만들어 단순히 얻을 수 있습니다. WSS는 유용한 빌딩 블록이지만이 숫자 만 보는 것보다 더 정교한 아이디어가 필요합니다.</p>
<p>한 가지 아이디어는 보는 것입니다<span class="math inline">\ (\ text {wss} _k \)</span>의 함수로<span class="math inline">\(케이\)</span>. 이것은 항상 감소하는 기능이지만, 급격히 감소한 다음 평평하게하는 뚜렷한 영역이 있다면, 우리는 이것을<em>팔꿈치</em>그리고 이것을 클러스터 수에 대한 잠재적 인 달콤한 지점으로 취할 수 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-WSSclusters">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.11</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>대체 표현<span class="math inline">\ (\ text {wss} _k \)</span></strong>. R을 사용하여 클러스터의 모든 쌍의 지점 사이의 거리를 계산하고이를 비교하십시오.<span class="math inline">\ (\ text {wss} _k \)</span>. 어떻게 볼 수 있습니까?<span class="math inline">\ (\ text {wss} _k \)</span>또한 작성할 수 있습니다.</p>
<p><span class="anchored-eq" data-anchor-id="eq-cluster" id="eq-cluster-WSS2"><span class="math display">\ [
\ text {wss} _k = \ sum _ {\ el = 1}^k \ frac {1} {2 n_ \ el} \ sum_ {x_i \ in c_ \ el} \ sum_ {x_j \ in c_ \ el} d^2 (x_i, x_j),
\ tag {5.5} \]</span></span></p>
<p>어디<span class="math inline">\ (N_ \ ELL \)</span>의 크기입니다<span class="math inline">\(\엘\)</span>-TH 클러스터.</p>
</div>
</div>
<p><a class="quarto-xref" href="#wrn-clustering-WSSclusters">질문<span>5.11</span></a>클러스터 내에서 제곱의 합계를 보여줍니다<span class="math inline">\ (\ text {wss} _k \)</span>클러스터까지의 모든 지점의 거리와 클러스터의 모든 지점 쌍 사이의 평균 거리를 측정합니다.</p>
<p>데이터에 적합한 클러스터 수를 결정하는 데 도움이되는 다양한 지수 및 통계의 동작을 살펴보면 실제로 정답을 아는 경우를 살펴 보는 것이 유용 할 수 있습니다.</p>
<p>우선, 우리는 4 개의 그룹에서 나오는 데이터를 시뮬레이션합니다. 우리는 파이프를 사용합니다 (<code>%&gt;%</code>) 연산자와<code>bind_rows</code>기능<strong><a href="https://cran.r-project.org/web/packages/dplyr/">dplyr</a></strong>네 가지를 연결하기 위해<em>티블</em>s는 각 클러스터에 하나의 큰 것으로 대응합니다<em>티블</em>.<a class="footnote-ref" href="#fn6" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>파이프 연산자는 값을 왼쪽으로 오른쪽으로 전달합니다. 이로 인해 데이터 흐름이 코드에서 쉽게 따라갈 수 있습니다.<code>f (x) %&gt; % g (y)</code>동일합니다<code>g (f (x), y)</code>.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" href="#cb39-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dplyr"</span>))</span>
<span id="cb39-2"><a aria-hidden="true" href="#cb39-2" tabindex="-1"></a>미사<span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">8</span>),)<span class="cf">기능</span>(MX) {</span>
<span id="cb39-3"><a aria-hidden="true" href="#cb39-3" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">기음</span>(<span class="dv">0</span>,,,<span class="dv">8</span>),)<span class="cf">기능</span>(나의) {</span>
<span id="cb39-4"><a aria-hidden="true" href="#cb39-4" tabindex="-1"></a>    <span class="fu">티블</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,,,<span class="at">평균 =</span>MX,<span class="at">SD =</span> <span class="dv">2</span>),)</span>
<span id="cb39-5"><a aria-hidden="true" href="#cb39-5" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,,,<span class="at">평균 =</span>나의,<span class="at">SD =</span> <span class="dv">2</span>),)</span>
<span id="cb39-6"><a aria-hidden="true" href="#cb39-6" tabindex="-1"></a>           <span class="at">클래스 =</span> <span class="fu">반죽</span>(MX, 내,<span class="at">sep =</span> <span class="st">":" "</span>)))</span>
<span id="cb39-7"><a aria-hidden="true" href="#cb39-7" tabindex="-1"></a>   }) <span class="sc">%&gt;%</span>bind_rows</span>
<span id="cb39-8"><a aria-hidden="true" href="#cb39-8" tabindex="-1"></a>}) <span class="sc">%&gt;%</span>bind_rows</span>
<span id="cb39-9"><a aria-hidden="true" href="#cb39-9" tabindex="-1"></a>미사</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># tibble : 400 × 3
        x y 클래스
    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1 -2.42 -4.59 0 : 0  
 2 1.89 -1.56 0 : 0  
 3 0.558 2.17 0 : 0  
 4 2.51 -0.873 0 : 0  
 5 -2.52 -0.766 0 : 0  
 6 3.62 0.953 0 : 0  
 7 0.774 2.43 0 : 0  
 8-1.71 -2.63 0 : 0  
 9 2.01 1.28 0 : 0  
10 2.03 -1.25 0 : 0  
# 390 행</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a>Sydmmic<span class="ot">=</span>심다 :,<span class="fu">기음</span>(<span class="st">"엑스"</span>,,,<span class="st">"와이"</span>))]]<span class="co"># 클래스 레이블없이</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" href="#cb42-1" tabindex="-1"></a><span class="fu">ggplot</span>(Slydate,<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">col =</span>수업))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-2"><a aria-hidden="true" href="#cb42-2" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-simdat-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simdat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-39" href="05-chap_files/figure-html/fig-simdat-1-1.png" title="Figure 5.24: The simdat data colored by the class labels. Here, we know the labels since we generated the data – usually we do not know them."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-simdat-1-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simdat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.24 :<code>미사</code>클래스 레이블에 의해 채색 된 데이터. 여기서 우리는 데이터를 생성 한 이후 레이블을 알고 있습니다. 일반적으로 데이터를 알지 못합니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>우리는에서 얻은 클러스터에 대한 그룹 내 제곱 합을 계산합니다.<span class="math inline">\(케이\)</span>-Means 방법 :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a>WSS<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,,<span class="at">값 =</span> <span class="cn">Na_Real_</span>))</span>
<span id="cb43-2"><a aria-hidden="true" href="#cb43-2" tabindex="-1"></a>WSS<span class="sc">$</span>값[<span class="dv">1</span>]]<span class="ot">=</span> <span class="fu">합집합</span>(<span class="fu">규모</span>(Sydmatxy,<span class="at">스케일 =</span> <span class="cn">거짓</span>))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb43-3"><a aria-hidden="true" href="#cb43-3" tabindex="-1"></a><span class="cf">~을 위한</span>(나<span class="cf">~에</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(wss)) {</span>
<span id="cb43-4"><a aria-hidden="true" href="#cb43-4" tabindex="-1"></a>km<span class="ot">=</span> <span class="fu">kmeans</span>(Sydmatxy,<span class="at">센터 =</span>WSS<span class="sc">$</span>K [I])</span>
<span id="cb43-5"><a aria-hidden="true" href="#cb43-5" tabindex="-1"></a>WSS<span class="sc">$</span>가치 [i]<span class="ot">=</span> <span class="fu">합집합</span>(km<span class="sc">$</span>Withinss)</span>
<span id="cb43-6"><a aria-hidden="true" href="#cb43-6" tabindex="-1"></a>}</span>
<span id="cb43-7"><a aria-hidden="true" href="#cb43-7" tabindex="-1"></a><span class="fu">ggplot</span>(WSS,<span class="fu">AES</span>(<span class="at">x =</span>케이,<span class="at">y =</span>값))<span class="sc">+</span> <span class="fu">geom_col</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-WSS">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-WSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-40" href="05-chap_files/figure-html/fig-WSS-1.png" title="Figure 5.25: The barchart of the WSS statistic as a function of k shows that the last substantial jump is just before k=4. This indicates that the best choice for these data is k=4."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-WSS-1.png" width="240"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-WSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.25 : WSS 통계의 Barchart<span class="math inline">\(케이\)</span>마지막으로 상당한 점프가 바로 직전에 있음을 보여줍니다<span class="math inline">\ (k = 4 \)</span>. 이것은이 데이터의 최선의 선택이<span class="math inline">\ (k = 4 \)</span>.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-WSSresample">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.12</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>코드를 여러 번 실행하고 비교하십시오<code>WSS</code>다른 실행에 대한 값. 왜 다른가요?<br/>
</li>
<li>동일한 범위와 치수를 가진 정규 분포 대신 균일 한 데이터 세트를 만듭니다.<code>미사</code>. THESS 데이터에 대한 WSS 값을 계산하십시오. 당신은 무엇을 결론 내리나요?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-CalinskiHarabaszIndex">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.13</div>
</div>
<div class="callout-body-container callout-body">
<p>소위<strong>Calinski-Harabasz</strong>Index는 WSS 및 BSS (제곱의 그룹 합계 사이)를 사용합니다. 그것은 영감을 받았습니다<span class="math inline">\(에프\)</span>통계 - 분산 분석에 사용되는 평균 사각형의 평균 잔류 합계에 대한 계수로 설명 된 평균 제곱 합의 비율 :</p>
<p><span class="math display">\ [
\ text {ch} (k) = \ frac {\ text {bss} _k} {\ text {wss} _k} \ times \ frac {n-k} {n-1}
\ qquad \ text {where} \ quad \ text {bss} _k = \ sum _ {\ el = 1}^k n_ \ ell (\ bar {x} _ {\ ell}-\ bar {x})^2,
\]</span></p>
<p>어디<span class="math inline">\ (\ bar {x} \)</span>전체 질량 중심 (평균 점)입니다. Calinski-Harabasz 지수를 플롯하십시오<code>미사</code>데이터.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-22-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-22-contents callout-collapse collapse" id="callout-22">
<div class="callout-body-container callout-body">
<p>생성 할 코드는 다음과 같습니다<a class="quarto-xref" href="#fig-CHIndex-1">수치<span>5.26</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"FPC"</span>))</span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"무리"</span>))</span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a>ch<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>,,,</span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a>  <span class="at">값 =</span> <span class="fu">Sapply</span>(케이,<span class="cf">기능</span>(나) {</span>
<span id="cb44-6"><a aria-hidden="true" href="#cb44-6" tabindex="-1"></a>피<span class="ot">=</span> <span class="fu">팸</span>(Simdatxy, i)</span>
<span id="cb44-7"><a aria-hidden="true" href="#cb44-7" tabindex="-1"></a>    <span class="fu">Shredd</span>(증상, p<span class="sc">$</span>무리)</span>
<span id="cb44-8"><a aria-hidden="true" href="#cb44-8" tabindex="-1"></a>  })</span>
<span id="cb44-9"><a aria-hidden="true" href="#cb44-9" tabindex="-1"></a>))</span>
<span id="cb44-10"><a aria-hidden="true" href="#cb44-10" tabindex="-1"></a><span class="fu">ggplot</span>(ch,<span class="fu">AES</span>(<span class="at">x =</span>케이,<span class="at">y =</span>값))<span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-11"><a aria-hidden="true" href="#cb44-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"CH 인덱스"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-CHIndex-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CHIndex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-41" href="05-chap_files/figure-html/fig-CHIndex-1-1.png" title="Figure 5.26: The Calinski-Harabasz index, i.,e., the ratio of the between and within group variances for different choices of k, computed on the simdat data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-CHIndex-1-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CHIndex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.26 : Calinski-Harabasz Index, I., E., 다른 선택에 대한 그룹 분산의 비율<span class="math inline">\(케이\)</span>,<code>미사</code>데이터.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section class="level3 page-columns page-full" data-number="5.7.1" id="using-the-gap-statistic">
<h3 class="anchored" data-anchor-id="using-the-gap-statistic" data-number="5.7.1"><span class="header-section-number">5.7.1</span>갭 통계 사용</h3>
<p>제곱 내에서 로그를 찍는 (<span class="math inline">\ (\ log (\ text {wss} _k) \)</span>) 그리고 구조가 적은 시뮬레이션 된 데이터의 평균과 비교하는 것은 선택하는 좋은 방법이 될 수 있습니다.<span class="math inline">\(케이\)</span>. 이것이 기본 아이디어입니다<strong>갭 통계</strong>소개<span class="citation" data-cites="gap2001">Tibshirani, Walther 및 Hastie (<a href="16-chap.html#ref-gap2001" role="doc-biblioref">2001</a>))</span>. 우리는 계산합니다<span class="math inline">\ (\ log (\ text {wss} _k) \)</span>다양한 값의 경우<span class="math inline">\(케이\)</span>, 클러스터의 수는 다양한 '비 클러스터 된'분포와 유사한 치수의 참조 데이터에서 얻은 것과 비교합니다. 위에서했던 것처럼 균일하게 분산 된 데이터 또는 원래 데이터와 동일한 공분산 구조로 시뮬레이션 된 데이터를 사용할 수 있습니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-42" href="imgs/roulette.png"><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/roulette.png" width="113"/></a></p>
</figure>
</div>
</div></div></div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">이 알고리즘은 관찰 된 데이터의 갭 통계를 유사한 구조를 가진 데이터의 평균 시뮬레이션과 비교하는 Monte Carlo 메소드입니다.</span></div></div>
<p><strong>갭 통계를 계산하기위한 알고리즘<span class="citation" data-cites="gap2001">(<a href="16-chap.html#ref-gap2001" role="doc-biblioref">Tibshirani, Walther 및 Hastie 2001</a>))</span>:</strong></p>
<ol type="1">
<li><p>데이터를 클러스터링하십시오<span class="math inline">\(케이\)</span>클러스터 및 계산<span class="math inline">\ (\ text {wss} _k \)</span>다양한 선택을 위해<span class="math inline">\(케이\)</span>.</p></li>
<li><p>생성하다<span class="math inline">\(비\)</span>균질 한 분포에서 Monte Carlo 샘플링을 사용한 그럴듯한 참조 데이터 세트 및 이러한 새로운 시뮬레이션 데이터에 대해 위의 1 단계를 다시 사용합니다. 결과가 발생합니다<span class="math inline">\(비\)</span>시뮬레이션 된 데이터에 대한 새로운 제곱 내에서<span class="math inline">\ (w_ {kb}^*\)</span>, 을 위한<span class="math inline">\ (b = 1, ..., b \)</span>.</p></li>
<li><p>계산하십시오<span class="math inline">\ (\ text {gap} (k) \)</span>-통계량:</p></li>
</ol>
<p><span class="math display">\ [
\ text {gap} (k) = \ 오버 라인 {l} _k - \ log \ text {wss} _k
\ quad \ text {with} \ quad
\ 오버 라인 {l} _k = \ frac {1} {b} \ sum_ {b = 1}^b \ log w^*_ {kb}
\]</span></p>
<p>클러스터링이 양호하면 첫 번째 용어가 두 번째 용어보다 클 것으로 예상됩니다 (즉, WSS가 더 작습니다). 따라서 갭 통계는 대부분 긍정적이며 우리는 가장 높은 값을 찾고 있습니다.</p>
<ol start="4" type="1">
<li>표준 편차를 사용할 수 있습니다</li>
</ol>
<p><span class="math display">\ [
\ text {sd} _k^2 = \ frac {1} {b-1} \ sum_ {b = 1}^b \ left (\ log (w^*_ {kb})-\ Overline {l}} _k \ right)^2
\]</span></p>
<p>최고를 선택하는 데 도움이됩니다<span class="math inline">\(케이\)</span>. 예를 들어 가장 작은 것을 선택하기 위해 몇 가지 선택을 사용할 수 있습니다.<span class="math inline">\(케이\)</span>그렇게</p>
<p><span class="math display">\ [
\ text {gap} (k) \ geq \ text {gap} (k+1) - s '_ {k+1} \ qquad \ text {where} s'_ {k+1} = \ text {sd} _ {k+1} \ sqrt {1+1/b}.
\]</span></p>
<p>패키지<strong><a href="https://cran.r-project.org/web/packages/cluster/">무리</a></strong>그리고<strong><a href="https://cran.r-project.org/web/packages/clusterCrit/">Clustercrit</a></strong>구현을 제공합니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-gapstat">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.14</div>
</div>
<div class="callout-body-container callout-body">
<p>갭 통계를 표시하는 기능을 만듭니다.<a class="quarto-xref" href="#fig-GapStat-1">수치<span>5.27</span></a>. 출력을 보여줍니다<code>미사</code>예제 데이터 세트와 클러스터링되었습니다<code>팸</code>기능.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-24-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-24-contents callout-collapse collapse" id="callout-24">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" href="#cb45-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"무리"</span>))</span>
<span id="cb45-2"><a aria-hidden="true" href="#cb45-2" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb45-3"><a aria-hidden="true" href="#cb45-3" tabindex="-1"></a>afth<span class="ot">=</span> <span class="cf">기능</span>(X, K)</span>
<span id="cb45-4"><a aria-hidden="true" href="#cb45-4" tabindex="-1"></a>  <span class="fu">목록</span>(<span class="at">클러스터 =</span> <span class="fu">팸</span>(X, K,<span class="at">cluster.only =</span> <span class="cn">진실</span>)))</span>
<span id="cb45-5"><a aria-hidden="true" href="#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a aria-hidden="true" href="#cb45-6" tabindex="-1"></a>GSS<span class="ot">=</span> <span class="fu">clusgap</span>(Sydmatxy,<span class="at">재미 =</span>Pakeman,<span class="at">k.max =</span> <span class="dv">8</span>,,,<span class="at">b =</span> <span class="dv">50</span>,,,</span>
<span id="cb45-7"><a aria-hidden="true" href="#cb45-7" tabindex="-1"></a>              <span class="at">verbose =</span> <span class="cn">거짓</span>))</span>
<span id="cb45-8"><a aria-hidden="true" href="#cb45-8" tabindex="-1"></a>plot_gap<span class="ot">=</span> <span class="cf">기능</span>(x) {</span>
<span id="cb45-9"><a aria-hidden="true" href="#cb45-9" tabindex="-1"></a>gstab<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(엑스<span class="sc">$</span>꼬리표,<span class="at">k =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(엑스<span class="sc">$</span>꼬리표)))</span>
<span id="cb45-10"><a aria-hidden="true" href="#cb45-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(gstab,<span class="fu">AES</span>(K, 갭)))<span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb45-11"><a aria-hidden="true" href="#cb45-11" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">AES</span>(<span class="at">ymax =</span>갭<span class="sc">+</span>그렇다면,</span>
<span id="cb45-12"><a aria-hidden="true" href="#cb45-12" tabindex="-1"></a>                      <span class="at">ymin =</span>갭<span class="sc">-</span>그렇다면),<span class="at">너비 =</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb45-13"><a aria-hidden="true" href="#cb45-13" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">크기 =</span> <span class="dv">3</span>,,,<span class="at">col =</span>  <span class="st">"빨간색"</span>))</span>
<span id="cb45-14"><a aria-hidden="true" href="#cb45-14" tabindex="-1"></a>}</span>
<span id="cb45-15"><a aria-hidden="true" href="#cb45-15" tabindex="-1"></a><span class="fu">plot_gap</span>(GSS)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-GapStat-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-GapStat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-43" href="05-chap_files/figure-html/fig-GapStat-1-1.png" title="Figure 5.27: The gap statistic, see Question wrn-clustering-gapstat."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-GapStat-1-1.png" style="width:33.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-GapStat-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.27 : 갭 통계, 참조<a class="quarto-xref" href="#wrn-clustering-gapstat">질문<span>5.14</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>이제 실제 예에서 메소드를 사용해 봅시다. 우리는<strong><a href="https://bioconductor.org/packages/Hiiragi/">Hiiragi</a></strong>우리가 이미 탐색 한 데이터<a class="quarto-xref" href="03-chap.html"><span>3 장</span></a>그리고 세포가 어떻게 클러스터되는지 볼 것입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"Hiiragi2013"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="warning">
<pre class="knitr r">in inchunk 'hiiragi': 경고 : 이전 가져 오기 'boot :: logit'의 'gtools :: logit'에 의해 'hiiragi2013'을로드 할 때</pre>
</div>
<div class="warning">
<pre class="knitr r">에서 청크 'hiiragi': 경고 : 이전 가져 오기 'boot :: inv.logit'를 'gtools :: inv.logit'` hiiragi2013'을로드 할 때 교체</pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" href="#cb47-1" tabindex="-1"></a><span class="fu">데이터</span>(<span class="st">"엑스"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 50 개의 가장 가변 유전자 (특징)를 선택하는 것으로 시작합니다.<a class="footnote-ref" href="#fn7" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>이 단계의 의도는 기술 (또는 배치) 효과의 영향을 줄이는 것입니다. 개별적으로 작지만 45101의 모든 기능에 걸쳐 축적 될 때<code>엑스</code>,이 특징 선택 단계 없이는 약하거나 표현되지 않은 유전자를 일치시킨다. 이러한 효과는 생물학적 신호를 억제하기 쉽다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a aria-hidden="true" href="#cb48-1" tabindex="-1"></a>자기 배정<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">Rowvars</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]]</span>
<span id="cb48-2"><a aria-hidden="true" href="#cb48-2" tabindex="-1"></a>Embmat<span class="ot">=</span> <span class="fu">티</span>(바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(x) [Selfeats,]))</span>
<span id="cb48-3"><a aria-hidden="true" href="#cb48-3" tabindex="-1"></a>Embgap<span class="ot">=</span> <span class="fu">clusgap</span>(Embmat,<span class="at">재미 =</span>Pakeman,<span class="at">k.max =</span> <span class="dv">24</span>,,,<span class="at">verbose =</span> <span class="cn">거짓</span>))</span>
<span id="cb48-4"><a aria-hidden="true" href="#cb48-4" tabindex="-1"></a>K1<span class="ot">=</span> <span class="fu">맥스</span>(Embgap<span class="sc">$</span>꼬리표[,<span class="st">"갭"</span>], Embgap<span class="sc">$</span>꼬리표[,<span class="st">"그렇다면"</span>])))</span>
<span id="cb48-5"><a aria-hidden="true" href="#cb48-5" tabindex="-1"></a>K2<span class="ot">=</span> <span class="fu">맥스</span>(Embgap<span class="sc">$</span>꼬리표[,<span class="st">"갭"</span>], Embgap<span class="sc">$</span>꼬리표[,<span class="st">"그렇다면"</span>],,</span>
<span id="cb48-6"><a aria-hidden="true" href="#cb48-6" tabindex="-1"></a>           <span class="at">방법 =</span> <span class="st">"TIBS2001SEMAX"</span>))</span>
<span id="cb48-7"><a aria-hidden="true" href="#cb48-7" tabindex="-1"></a><span class="fu">기음</span>(K1, K2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9 7</code></pre>
</div>
</div>
<p>클러스터 수에 대한 기본 선택<code>K1</code>, 첫 번째 값입니다<span class="math inline">\(케이\)</span>차이가 첫 번째 로컬 최대 값에서 표준 오류보다 크지 않은 경우<span class="math inline">\(에스\)</span>(의 수동 페이지를 참조하십시오<code>clusgap</code>기능). 이것은 많은 클러스터를 제공합니다<span class="math inline">\ (k = 9 \)</span>, 선택은 추천합니다<span class="citation" data-cites="gap2001">Tibshirani, Walther 및 Hastie (<a href="16-chap.html#ref-gap2001" role="doc-biblioref">2001</a>))</span>가장 작습니다<span class="math inline">\(케이\)</span>그렇게<span class="math inline">\ (\ text {gap} (k) \ geq \ text {gap} (k+1) -S_ {k+1} '\)</span>, 이것은 제공합니다<span class="math inline">\ (k = 7 \)</span>. 갭 통계를 플로팅합시다 (<a class="quarto-xref" href="#fig-gapHiiragi-1">수치<span>5.28</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a><span class="fu">구성</span>(Embgap,<span class="at">메인 =</span> <span class="st">"" "</span>))</span>
<span id="cb50-2"><a aria-hidden="true" href="#cb50-2" tabindex="-1"></a>cl<span class="ot">=</span> <span class="fu">afth</span>(Embmat,<span class="at">k =</span>K1)<span class="sc">$</span>무리</span>
<span id="cb50-3"><a aria-hidden="true" href="#cb50-3" tabindex="-1"></a><span class="fu">테이블</span>(<span class="fu">PDATA</span>(엑스)[<span class="fu">이름</span>(CL),<span class="st">"샘플 그룹"</span>], cl)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cl
                   1 2 3 4 5 6 7 8 9
  e3.25 23 11 1 1 1 0 0 0 0 0
  E3.25 (FGF4-KO) 0 0 1 16 0 0 0 0 0
  E3.5 (EPI) 2 1 0 0 8 0 0 0
  E3.5 (FGF4-KO) 0 8 0 0 0 0 0 0
  E3.5 (PE) 0 0 0 9 2 0 0 0
  E4.5 (EPI) 0 0 0 0 0 0 4 0
  E4.5 (FGF4-KO) 0 0 0 0 0 0 0 10
  E4.5 (PE) 0 0 0 0 0 4 0 0</code></pre>
</div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-gapHiiragi-1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gapHiiragi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-44" href="05-chap_files/figure-html/fig-gapHiiragi-1-1.png" title="Figure 5.28: The gap statistic for the Hiiragi2013 data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-gapHiiragi-1-1.png" width="360"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gapHiiragi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.28 : 갭 통계<strong><a href="https://bioconductor.org/packages/Hiiragi2013/">Hiiragi2013</a></strong>데이터.</figcaption>
</figure>
</div>
</div></div></div>
<p>위에서 우리는 우리가 얻은 클러스터링 간의 비교를 봅니다.<code>afth</code>데이터 주석에 샘플 레이블이 있습니다.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-noselFeats">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.15</div>
</div>
<div class="callout-body-container callout-body">
<p>모든 기능을 사용하면 결과가 어떻게 변경됩니까?<code>엑스</code>, 상위 50 개가 가장 가변적 인 유전자를 서브셋하는 대신?</p>
</div>
</div>
</section>
<section class="level3 page-columns page-full" data-number="5.7.2" id="cluster-validation-using-the-bootstrap">
<h3 class="anchored" data-anchor-id="cluster-validation-using-the-bootstrap" data-number="5.7.2"><span class="header-section-number">5.7.2</span>부트 스트랩을 사용한 클러스터 유효성 검사</h3>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-BootstrapClusterNew">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-BootstrapClusterNew-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-BootstrapClusterNew" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-BootstrapClusterNew-1">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-BootstrapClusterNew-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-BootstrapClusterNew" href="imgs/BootstrapClusterNew.png" title="Figure 5.29 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-BootstrapClusterNew" id="fig-BootstrapClusterNew-1" src="imgs/BootstrapClusterNew.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-BootstrapClusterNew-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-BootstrapClusterNew" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-BootstrapClusterNew-2">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-BootstrapClusterNew-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-BootstrapClusterNew" href="imgs/BootstrapCluster2New.png" title="Figure 5.29 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-BootstrapClusterNew" id="fig-BootstrapClusterNew-2" src="imgs/BootstrapCluster2New.png"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-BootstrapClusterNew-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-BootstrapClusterNew-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.29 : 동일한 분포의 다른 샘플<span class="math inline">\(에프\)</span>다른 클러스터링으로 이어집니다. (A)에서는 실제 샘플링 변동성이 보입니다. 부트 스트랩은 경험적 분포 함수를 사용하여 서브 샘플을 그려서이 샘플링 변동성을 시뮬레이션합니다.<span class="math inline">\ (\ hat {f} _n \)</span>(b)에 표시된대로.</figcaption>
</figure>
</div>
</div>
<p>우리는 부트 스트랩 원리를 보았습니다<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>: 이상적으로, 우리는 기본 데이터 생성 프로세스에서 많은 새로운 샘플 (데이터 세트)을 사용하고, 각각 클러스터링 방법을 적용한 다음 클러스터링을 비교하는 데 사용한 색인을 사용하여 클러스터링이 얼마나 안정적인지 또는 얼마나 많은 변화가 있는지 확인합니다. 물론 이러한 추가 샘플이 없습니다. 따라서 우리는 실제로 데이터의 다른 임의의 하위 샘플을 가져 와서 매번 얻는 다른 클러스터링을보고 비교하여 단순히 새로운 데이터 세트를 만들려고합니다.<span class="citation" data-cites="gap2001">Tibshirani, Walther 및 Hastie (<a href="16-chap.html#ref-gap2001" role="doc-biblioref">2001</a>))</span>갭 통계를 사용하여 클러스터 수를 유추하기 위해 부트 스트랩 리 샘플링을 사용하는 것이 좋습니다.</p>
<p>우리는 계속 사용할 것입니다<strong><a href="https://bioconductor.org/packages/Hiiragi2013/">Hiiragi2013</a></strong>데이터. 여기서 우리는 Embyronic Day 3.5 (e3.5)의 마우스 배반포의 내부 세포 질량 (ICM)이 다 능성 에피 블라스트 (EPI) 대 기본 endoderm (PE)에 해당하는 두 개의 클러스터로“자연적으로”떨어진다는 가설의 조사를 따랐다.</p>
<p>우리는 클러스터링에서 실제 그룹 레이블을 사용하지 않으며 결과의 최종 해석에서만 사용합니다. 부트 스트랩을 두 개의 다른 데이터 세트 (e3.5)와 (e3.25)에 별도로 적용합니다. 부트 스트랩의 각 단계는 데이터의 임의의 하위 집합의 클러스터링을 생성하며 클러스터 앙상블에 대한 합의를 통해이를 비교해야합니다. 이것에 유용한 프레임 워크가 있습니다<strong><a href="https://cran.r-project.org/web/packages/clue/">단서</a></strong>패키지<span class="citation" data-cites="Hornik2005">(<a href="16-chap.html#ref-Hornik2005" role="doc-biblioref">Hornik 2005</a>))</span>. 기능<code>ClusterResampling</code>, 보충에서 가져 왔습니다<span class="citation" data-cites="Ohnishi2014">Ohnishi et al. (<a href="16-chap.html#ref-Ohnishi2014" role="doc-biblioref">2014</a>))</span>,이 접근법을 구현합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a>ClusterResampling<span class="ot">=</span> <span class="cf">기능</span>(엑스,<span class="at">ngenes =</span> <span class="dv">50</span>,,,<span class="at">k =</span> <span class="dv">2</span>,,,<span class="at">b =</span> <span class="dv">250</span>,,,</span>
<span id="cb52-2"><a aria-hidden="true" href="#cb52-2" tabindex="-1"></a>                             <span class="at">prob =</span> <span class="fl">0.67</span>) {</span>
<span id="cb52-3"><a aria-hidden="true" href="#cb52-3" tabindex="-1"></a>매트<span class="ot">=</span>바이오베이스<span class="sc">::</span><span class="fu">exprs</span>(엑스)</span>
<span id="cb52-4"><a aria-hidden="true" href="#cb52-4" tabindex="-1"></a>CE<span class="ot">=</span> <span class="fu">cl_ensemble</span>(<span class="at">목록 =</span> <span class="fu">lapply</span>(<span class="fu">seq_len</span>(비),<span class="cf">기능</span>(b) {</span>
<span id="cb52-5"><a aria-hidden="true" href="#cb52-5" tabindex="-1"></a>셀릭<span class="ot">=</span> <span class="fu">견본</span>(<span class="fu">NCOL</span>(매트),<span class="at">크기 =</span> <span class="fu">둥근</span>(프로브<span class="sc">*</span> <span class="fu">NCOL</span>(매트)),</span>
<span id="cb52-6"><a aria-hidden="true" href="#cb52-6" tabindex="-1"></a>                      <span class="at">교체 =</span> <span class="cn">거짓</span>))</span>
<span id="cb52-7"><a aria-hidden="true" href="#cb52-7" tabindex="-1"></a>하위 매트<span class="ot">=</span>매트 [, selamps, 드롭<span class="ot">=</span> <span class="cn">거짓</span>]]</span>
<span id="cb52-8"><a aria-hidden="true" href="#cb52-8" tabindex="-1"></a>셀<span class="ot">=</span> <span class="fu">주문하다</span>(<span class="fu">Rowvars</span>(Submat),<span class="at">감소 =</span> <span class="cn">진실</span>) [) [<span class="fu">seq_len</span>(ngenes)]</span>
<span id="cb52-9"><a aria-hidden="true" href="#cb52-9" tabindex="-1"></a>하위 매트<span class="ot">=</span>Submat [셀, 드롭<span class="ot">=</span> <span class="cn">거짓</span>]]</span>
<span id="cb52-10"><a aria-hidden="true" href="#cb52-10" tabindex="-1"></a>Pamres<span class="ot">=</span> <span class="fu">팸</span>(<span class="fu">티</span>(Submat),<span class="at">k =</span>케이)</span>
<span id="cb52-11"><a aria-hidden="true" href="#cb52-11" tabindex="-1"></a>~ 전에<span class="ot">=</span> <span class="fu">cl_predict</span>(Pamres,<span class="fu">티</span>(음식 [sel,]),<span class="st">"멤버십"</span>))</span>
<span id="cb52-12"><a aria-hidden="true" href="#cb52-12" tabindex="-1"></a>    <span class="fu">as.cl_partition</span>(전에)</span>
<span id="cb52-13"><a aria-hidden="true" href="#cb52-13" tabindex="-1"></a>  }))</span>
<span id="cb52-14"><a aria-hidden="true" href="#cb52-14" tabindex="-1"></a>단점<span class="ot">=</span> <span class="fu">cl_consensus</span>(CE)</span>
<span id="cb52-15"><a aria-hidden="true" href="#cb52-15" tabindex="-1"></a>Ag<span class="ot">=</span> <span class="fu">Sapply</span>(CE, CL_AGREEMENT,<span class="at">y =</span>단점)</span>
<span id="cb52-16"><a aria-hidden="true" href="#cb52-16" tabindex="-1"></a>  <span class="fu">목록</span>(<span class="at">계약 =</span>ag,<span class="at">합의 =</span>단점)</span>
<span id="cb52-17"><a aria-hidden="true" href="#cb52-17" tabindex="-1"></a>}</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>기능<code>ClusterResampling</code>다음 단계를 수행합니다.</p>
<ol type="1">
<li><p>교체없이 샘플의 67%를 선택하여 데이터의 임의의 하위 집합 (데이터는 모두 E3.25 또는 모든 E3.5 샘플입니다).</p></li>
<li><p>상단을 선택하십시오<code>ngenes</code>전체 분산에 의한 기능 (서브 세트).</p></li>
<li><p>적용하다<span class="math inline">\(케이\)</span>-클러스터링을 제공하고 샘플의 클러스터 멤버십을<code>cl_predict</code>.의 방법<strong><a href="https://cran.r-project.org/web/packages/clue/">단서</a></strong>클러스터 센터와의 근접성을 통해 패키지.</p></li>
<li><p>1-3 단계를 반복하십시오<code>비</code>타임스.</p></li>
<li><p>컨센서스 클러스터링 적용 (<code>cl_consensus</code>).</p></li>
<li><p>각각에 대해<code>비</code>클러스터링, 함수를 통해 합의와의 계약을 측정합니다.<code>cl_agreement</code>). 여기서 좋은 합의는 1의 값으로 표시되고 더 작은 값으로 동의가 적습니다. 계약이 일반적으로 높으면 클러스터링이<span class="math inline">\(케이\)</span>수업은 안정적이고 재현 가능한 것으로 간주 될 수 있습니다. 반대로, 그것이 낮 으면 샘플의 안정적인 분할이 없습니다.<span class="math inline">\(케이\)</span>클러스터가 분명합니다.</p></li>
</ol>
<p>컨센서스 클러스터링을위한 클러스터 간 거리의 척도로<em>유클리드</em>멤버십의 비 유사성은 사용됩니다. 즉, 제곱 차이의 최소 합의 제곱근<span class="math inline">\ (\ mathbf {u} \)</span>그리고 모든 열 순열<span class="math inline">\ (\ mathbf {v} \)</span>, 어디<span class="math inline">\ (\ mathbf {u} \)</span>그리고<span class="math inline">\ (\ mathbf {v} \)</span>클러스터 멤버십 매트릭스입니다. [clueagree], 수량에 대한 계약 조치로서<span class="math inline">\ (1 -d/m \)</span>사용됩니다<span class="math inline">\(디\)</span>유클리드는 비 유사성입니다<span class="math inline">\(중\)</span>최대 유클리드 비 유사성에 대한 상한입니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a aria-hidden="true" href="#cb53-1" tabindex="-1"></a>ISWT<span class="ot">=</span>(엑스<span class="sc">$</span>유전자형<span class="sc">==</span> <span class="st">"wt"</span>))</span>
<span id="cb53-2"><a aria-hidden="true" href="#cb53-2" tabindex="-1"></a>CR1<span class="ot">=</span> <span class="fu">ClusterResampling</span>(x [, x<span class="sc">$</span>배아<span class="sc">==</span> <span class="st">"e3.25"</span> <span class="sc">&amp;이었다.</span>ISWT])</span>
<span id="cb53-3"><a aria-hidden="true" href="#cb53-3" tabindex="-1"></a>CR2<span class="ot">=</span> <span class="fu">ClusterResampling</span>(x [, x<span class="sc">$</span>배아<span class="sc">==</span> <span class="st">"e3.5"</span>  <span class="sc">&amp;이었다.</span>ISWT])</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>결과가 표시됩니다<a class="quarto-xref" href="#fig-figClue1">수치<span>5.30</span></a>. 그들은 e.35 데이터가 두 클러스터에 속한다는 가설을 확인합니다.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a>Ag1<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">계약 =</span>CR1<span class="sc">$</span>계약,<span class="at">day =</span> <span class="st">"e3.25"</span>))</span>
<span id="cb54-2"><a aria-hidden="true" href="#cb54-2" tabindex="-1"></a>Ag2<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">계약 =</span>CR2<span class="sc">$</span>계약,<span class="at">day =</span> <span class="st">"e3.5"</span>))</span>
<span id="cb54-3"><a aria-hidden="true" href="#cb54-3" tabindex="-1"></a>P1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(AG1, AG2),<span class="fu">AES</span>(<span class="at">x =</span>낮,<span class="at">y =</span>계약)))<span class="sc">+</span></span>
<span id="cb54-4"><a aria-hidden="true" href="#cb54-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb54-5"><a aria-hidden="true" href="#cb54-5" tabindex="-1"></a>Ggbeeswarm<span class="sc">::</span><span class="fu">geom_beeswarm</span>(<span class="at">cex =</span> <span class="fl">1.5</span>,,,<span class="at">col =</span> <span class="st">"#0000ff40"</span>))</span>
<span id="cb54-6"><a aria-hidden="true" href="#cb54-6" tabindex="-1"></a>mem1<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">y =</span> <span class="fu">종류</span>(<span class="fu">Cl_membership</span>(CR1<span class="sc">$</span>의견 일치)[,<span class="dv">1</span>]),</span>
<span id="cb54-7"><a aria-hidden="true" href="#cb54-7" tabindex="-1"></a>              <span class="at">x =</span> <span class="fu">서열</span>(<span class="at">함께 =</span>와이),<span class="at">day =</span> <span class="st">"e3.25"</span>))</span>
<span id="cb54-8"><a aria-hidden="true" href="#cb54-8" tabindex="-1"></a>mem2<span class="ot">=</span> <span class="fu">티블</span>(<span class="at">y =</span> <span class="fu">종류</span>(<span class="fu">Cl_membership</span>(CR2<span class="sc">$</span>의견 일치)[,<span class="dv">1</span>]),</span>
<span id="cb54-9"><a aria-hidden="true" href="#cb54-9" tabindex="-1"></a>              <span class="at">x =</span> <span class="fu">서열</span>(<span class="at">함께 =</span>와이),<span class="at">day =</span> <span class="st">"e3.5"</span>))</span>
<span id="cb54-10"><a aria-hidden="true" href="#cb54-10" tabindex="-1"></a>P2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(mem1, mem2),<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">col =</span>낮))<span class="sc">+</span></span>
<span id="cb54-11"><a aria-hidden="true" href="#cb54-11" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>낮,<span class="at">스케일 =</span> <span class="st">"free_x"</span>))</span>
<span id="cb54-12"><a aria-hidden="true" href="#cb54-12" tabindex="-1"></a>gridextra<span class="sc">::</span><span class="fu">Grid.arrange</span>(P1, P2,<span class="at">너비 =</span> <span class="fu">기음</span>(<span class="fl">2.4</span>,,,<span class="fl">4.0</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-figClue1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-figClue1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-47" href="05-chap_files/figure-html/fig-figClue1-1.png" title="Figure 5.30: Cluster stability analysis with E3.25 and E3.5 samples. Left: beeswarm plots of the cluster agreements with the consensus, for the B clusterings; 1 indicates perfect agreement, lower values indicate lower degrees of agreement. Right: membership probabilities of the consensus clustering. For E3.25, the probabilities are diffuse, indicating that the individual clusterings often disagree, whereas for E3.5, the distribution is bimodal, with only one ambiguous sample."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-figClue1-1.png" width="640"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-figClue1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.30 : E3.25 및 E3.5 샘플을 사용한 클러스터 안정성 분석. 왼쪽 : Consensus와의 클러스터 계약의 꿀벌 따뜻함<code>비</code>클러스터링;<span class="math inline">\ (1 \)</span>완벽한 일치를 나타내고, 낮은 값은 낮은 계약 정도를 나타냅니다. 오른쪽 : 컨센서스 클러스터링의 회원 확률. E3.25의 경우 확률은 확산되어 개별 클러스터링이 종종 동의하지 않음을 나타냅니다. 반면 E3.5의 경우 분포는 모호한 샘플만으로 바이 모달입니다.</figcaption>
</figure>
</div>
</div>
</div>
<section class="level4 unnumbered page-columns page-full" id="computational-and-memory-issues">
<h4 class="unnumbered anchored" data-anchor-id="computational-and-memory-issues">계산 및 메모리 문제</h4>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-48" href="imgs/devil.png" title="Computational complexity. An algorithm is said to be O(n^k), if, as n gets larger, the resource consumption (CPU time or memory) grows proportionally to n^k. There may be other (sometimes considerable) baseline costs, or costs that grow proportionally to lower powers of n, but these always become negligible compared to the leading term as n\to\infty."><img alt="Computational complexity. An algorithm is said to be O(n^k), if, as n gets larger, the resource consumption (CPU time or memory) grows proportionally to n^k. There may be other (sometimes considerable) baseline costs, or costs that grow proportionally to lower powers of n, but these always become negligible compared to the leading term as n\to\infty." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/devil.png" width="123"/></a></p>
</figure>
</div>
<figcaption><strong>계산 복잡성</strong>. 알고리즘이 있다고합니다<span class="math inline">\ (O (n^k) \)</span>, 만약<span class="math inline">\(N\)</span>더 커지면 자원 소비 (CPU 시간 또는 메모리)가 비례 적으로 증가합니다.<span class="math inline">\ (n^k \)</span>. 다른 (때로는 상당한) 기준 비용이있을 수 있습니다.<span class="math inline">\(N\)</span>그러나 이것들은 항상 주요 용어에 비해 무시할 수 있습니다.<span class="math inline">\ (n \ to \ infty \)</span>.</figcaption>
</figure>
</div>
</div></div></div>
<p>모든 거리의 계산은<span class="math inline">\(N\)</span>객체는 an입니다<span class="math inline">\ (O (n^2) \)</span>작동 (시간과 기억). 고전적인 계층 적 클러스터링 접근법 (예 :<code>HCLUST</code>에서<strong><a href="https://cran.r-project.org/web/packages/stats/">통계</a></strong>패키지) 짝수입니다<span class="math inline">\ (O (n^3) \)</span>시간이 지남에 따라. 큰 경우<span class="math inline">\(N\)</span>, 이것은 비현실적 일 수 있습니다<a class="footnote-ref" href="#fn8" id="fnref8" role="doc-noteref"><sup>8</sup></a>. All-VS-All 거리 매트릭스의 완전한 계산을 피할 수 있습니다. 예를 들어,<span class="math inline">\(케이\)</span>-Means는 요구 사항 만 필요합니다<span class="math inline">\ (에) \)</span>계산은 각 객체와 클러스터 센터 사이의 거리를 추적하므로 숫자는 동일하게 유지되므로<span class="math inline">\(N\)</span>증가합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>예를 들어, 8 바이트 플로팅 포인트 숫자로 저장된 백만 개의 물체에 대한 거리 매트릭스는 약 4 테라 바이트 및<code>HCLUST</code>-각각의 반복이 나노초에만 걸린다는 낙관적 인 가정 하에도 30 년 동안 실행됩니다.</p></div></div><p>다음과 같은 빠른 구현<strong><a href="https://cran.r-project.org/web/packages/fastclust/">FastClust</a></strong> <span class="citation" data-cites="Mullner:2013">(<a href="16-chap.html#ref-Mullner:2013" role="doc-biblioref">Müllner 2013</a>))</span>그리고<strong><a href="https://cran.r-project.org/web/packages/dbscan/">DBSCAN</a></strong>많은 관찰을 처리하기 위해 신중하게 최적화되었습니다.</p>
</section>
</section>
</section>
<section class="level2 page-columns page-full" data-number="5.8" id="clustering-as-a-means-for-denoising">
<h2 class="anchored" data-anchor-id="clustering-as-a-means-for-denoising" data-number="5.8"><span class="header-section-number">5.8</span>비난을위한 수단으로서의 클러스터링</h2>
<p>기본적인 실제 값 (예 : 게놈의 DNA 서열로 표시되는 종)을 반영하는 측정 세트를 고려하지만 기술 노이즈에 의해 저하되었습니다. 클러스터링을 사용하여 이러한 노이즈를 제거 할 수 있습니다.</p>
<section class="level3 page-columns page-full" data-number="5.8.1" id="subsection:dada2">
<h3 class="anchored" data-anchor-id="subsection:dada2" data-number="5.8.1"><span class="header-section-number">5.8.1</span>기준 주파수가 다른 시끄러운 관찰</h3>
<p>동일한 오차 분산으로 이루어진 관측치의 이변 량 분포가 있다고 가정합니다. 그러나 샘플링은 기준 주파수가 매우 다른 두 그룹의 것입니다. 또한, 오류가 지속적으로 독립적 인 이변 량이 정상적으로 분포된다고 가정합니다. 우리는 가지고 있습니다<span class="math inline">\ (10^{3} \)</span>~의<code>seq1</code>그리고<span class="math inline">\ (10^{5} \)</span>~의<code>seq2</code>예를 들어 코드에 의해 생성 된대로 :</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"믹스 툴"</span>))</span>
<span id="cb55-2"><a aria-hidden="true" href="#cb55-2" tabindex="-1"></a>seq1<span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="fl">1E3</span>,,,<span class="at">in =</span> <span class="sc">-</span><span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>),)<span class="at">시그마 =</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">일관성</span>(<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>))))</span>
<span id="cb55-3"><a aria-hidden="true" href="#cb55-3" tabindex="-1"></a>seq2<span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="fl">1E5</span>,,,<span class="at">in =</span>  <span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>),)<span class="at">시그마 =</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">일관성</span>(<span class="fu">기음</span>(<span class="dv">1</span>,,,<span class="dv">1</span>))))</span>
<span id="cb55-4"><a aria-hidden="true" href="#cb55-4" tabindex="-1"></a>두그<span class="ot">=</span> <span class="fu">데이터. 프레임</span>(</span>
<span id="cb55-5"><a aria-hidden="true" href="#cb55-5" tabindex="-1"></a>  <span class="fu">rbind</span>(seq1, seq2),</span>
<span id="cb55-6"><a aria-hidden="true" href="#cb55-6" tabindex="-1"></a>  <span class="at">seq =</span> <span class="fu">요인</span>(<span class="fu">기음</span>(<span class="fu">대표</span>(<span class="dv">1</span>,,,<span class="fu">nrow</span>(seq1)),</span>
<span id="cb55-7"><a aria-hidden="true" href="#cb55-7" tabindex="-1"></a>                 <span class="fu">대표</span>(<span class="dv">2</span>,,,<span class="fu">nrow</span>(seq2))))))</span>
<span id="cb55-8"><a aria-hidden="true" href="#cb55-8" tabindex="-1"></a>))</span>
<span id="cb55-9"><a aria-hidden="true" href="#cb55-9" tabindex="-1"></a><span class="fu">colnames</span>(두 그) [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]]<span class="ot">=</span> <span class="fu">기음</span>(<span class="st">"엑스"</span>,,,<span class="st">"와이"</span>))</span>
<span id="cb55-10"><a aria-hidden="true" href="#cb55-10" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"ggplot2"</span>))</span>
<span id="cb55-11"><a aria-hidden="true" href="#cb55-11" tabindex="-1"></a><span class="fu">ggplot</span>(두그,<span class="fu">AES</span>(<span class="at">x =</span>엑스,<span class="at">y =</span>와이,<span class="at">색상 =</span>서열,<span class="at">fill =</span>seq))<span class="sc">+</span></span>
<span id="cb55-12"><a aria-hidden="true" href="#cb55-12" tabindex="-1"></a>  <span class="fu">GEOM_HEX</span>(<span class="at">알파 =</span> <span class="fl">0.5</span>,,,<span class="at">빈 =</span> <span class="dv">50</span>))<span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-seqradius">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seqradius-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-49" href="05-chap_files/figure-html/fig-seqradius-1.png" title="Figure 5.31: Although both groups have noise distributions with the same variances, the apparent radii of the groups are very different. The 10^{5} instances in seq2 have many more opportunities for errors than what we see in seq1, of which there are only 10^{3}. Thus we see that frequencies are important in clustering the data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-seqradius-1.png" width="248"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seqradius-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.31 : 두 그룹 모두 동일한 차이를 갖는 노이즈 분포가 있지만 그룹의 명백한 반경은 매우 다릅니다. 그만큼<span class="math inline">\ (10^{5} \)</span>인스턴스<code>seq2</code>우리가 보는 것보다 오류에 대한 더 많은 기회가 있습니다.<code>seq1</code>, 그중 만 있습니다<span class="math inline">\ (10^{3} \)</span>. 따라서 우리는 데이터를 클러스터링하는 데 주파수가 중요하다는 것을 알 수 있습니다.</figcaption>
</figure>
</div>
</div></div></div>
<p>관찰 된 값은<a class="quarto-xref" href="#fig-seqradius">수치<span>5.31</span></a>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-hardthreshold">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.16</div>
</div>
<div class="callout-body-container callout-body">
<p>데이터를 가져 가십시오<code>seq1</code>그리고<code>seq2</code>그룹 센터와의 거리에 따라 두 그룹으로 클러스터링합니다. 결과가 두 시퀀스 유형 각각의 빈도에 따라야한다고 생각하십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-27-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-27-contents callout-collapse collapse" id="callout-27">
<div class="callout-body-container callout-body">
<p>분류 학적 클러스터링에 자주 사용되는 이러한 접근법, OTU -수술 분류 유닛 클러스터링이라고도합니다.<span class="citation" data-cites="caporaso2010qiime mothur">(<a href="16-chap.html#ref-caporaso2010qiime" role="doc-biblioref">Caporaso et al. 2010 년</a>; <a href="16-chap.html#ref-mothur" role="doc-biblioref">P. D. 늙어 가십시오. 2009 년</a>))</span>) 메소드는 차선책입니다.</p>
<p>유사성에만 근거한 방법은<em>대표성</em>휴리스틱. 인지 심리학의 세계에 대한 간단한 분리를하면서 우리의 자연스러운 성향만이 대표성과 클러스터링 및 분류 학적 할당에서 거리 기반 휴리스틱을 사용하는 것이 편향된 결과로 이어질 수 있는지 설명하는 데 도움이됩니다.</p>
<p>1970 년대에<span class="citation" data-cites="tversky1975judgment">Tversky와 Kahneman (<a href="16-chap.html#ref-tversky1975judgment" role="doc-biblioref">1975</a>))</span>우리는 일반적으로 가장 유사한 것을 보면서 그룹을 할당한다고 지적했습니다.<em>대표</em>. 클러스터링 및 그룹 할당에서는 중앙까지의 거리에 따라 그룹에 새로운 시퀀스를 할당하는 것을 의미합니다. 실제로 이것은 다른 그룹의 유병률 차이에 관계없이 동일한 반경을 가진 공을 복용하는 것과 같습니다. 이 심리적 오류는 다양한 휴리스틱과 편견을 다루는 중요한 과학 논문에서 처음 논의되었습니다.<span class="citation" data-cites="tversky1974heuristics">(<a href="16-chap.html#ref-tversky1974heuristics" role="doc-biblioref">Tversky와 Kahneman 1974</a>))</span>.</p>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a class="lightbox" data-gallery="quarto-lightbox-gallery-50" href="imgs/book_icon.png" title="See @kahneman2011 for a book-length treatment of our natural heuristics and the ways in which they can mislead us when we make probability calculations (we recommend especially Chapters 14 and 15)."><img alt="See Kahneman (2011) for a book-length treatment of our natural heuristics and the ways in which they can mislead us when we make probability calculations (we recommend especially Chapters 14 and 15)." class="img-fluid quarto-figure quarto-figure-center figure-img" src="imgs/book_icon.png" width="126"/></a></p>
</figure>
</div>
<figcaption>보다<span class="citation" data-cites="kahneman2011">카른 만 (Kahneman)<a href="16-chap.html#ref-kahneman2011" role="doc-biblioref">2011</a>))</span>우리의 자연 휴리스틱의 책 길이 치료와 확률 계산을 할 때 그들이 우리를 오도 할 수있는 방법 (특히 14 장과 15 장을 권장합니다).</figcaption>
</figure>
</div>
</div></div></div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">일</div>
</div>
<div class="callout-body-container callout-body">
<p>시뮬레이션<code>n = 2000</code>길이의 이진 변수<code>len = 200</code>그것은 품질을 나타냅니다<code>N</code>길이의 시퀀싱 읽기<code>렌</code>. 단순화하기 위해 시퀀싱 오류가 확률로 독립적이고 균일하게 발생한다고 가정 해 봅시다.<code>perr = 0.001</code>. 즉, 우리는 기지가 올바르게 불려 졌는지 여부 만 돌 봅니다 (<code>진실</code>) 또는 그렇지 않음 (<code>거짓</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a>N<span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb56-2"><a aria-hidden="true" href="#cb56-2" tabindex="-1"></a>렌<span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb56-3"><a aria-hidden="true" href="#cb56-3" tabindex="-1"></a>페르<span class="ot">=</span> <span class="fl">0.001</span></span>
<span id="cb56-4"><a aria-hidden="true" href="#cb56-4" tabindex="-1"></a>seqs<span class="ot">=</span> <span class="fu">행렬</span>(<span class="fu">runif</span>(N<span class="sc">*</span>렌)<span class="sc">&gt; =</span>페르<span class="at">nrow =</span>N,<span class="at">NCOL =</span>렌)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>이제 읽기 사이의 모든 쌍별 거리를 계산하십시오.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a>Dists<span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(seqs,<span class="at">방법 =</span> <span class="st">"맨해튼"</span>)))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>읽기 수의 다양한 값에 대해<code>케이</code>(2에서<code>N</code>),이 읽기 세트 내에서의 최대 거리는 아래 코드로 계산되며<a class="quarto-xref" href="#fig-diameter">수치<span>5.32</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"tibble"</span>))</span>
<span id="cb58-2"><a aria-hidden="true" href="#cb58-2" tabindex="-1"></a>DFSEQ<span class="ot">=</span> <span class="fu">티블</span>(</span>
<span id="cb58-3"><a aria-hidden="true" href="#cb58-3" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">10</span> <span class="sc">^</span> <span class="fu">서열</span>(<span class="fu">log10</span>(<span class="dv">2</span>),)<span class="fu">log10</span>(N),<span class="at">length.out =</span> <span class="dv">20</span>),)</span>
<span id="cb58-4"><a aria-hidden="true" href="#cb58-4" tabindex="-1"></a>  <span class="at">직경 =</span> <span class="fu">vapply</span>(케이,<span class="cf">기능</span>(나) {</span>
<span id="cb58-5"><a aria-hidden="true" href="#cb58-5" tabindex="-1"></a>에스<span class="ot">=</span> <span class="fu">견본</span>(n, i)</span>
<span id="cb58-6"><a aria-hidden="true" href="#cb58-6" tabindex="-1"></a>    <span class="fu">맥스</span>(dists [s, s])</span>
<span id="cb58-7"><a aria-hidden="true" href="#cb58-7" tabindex="-1"></a>    }, <span class="fu">숫자</span>(<span class="dv">1</span>))))</span>
<span id="cb58-8"><a aria-hidden="true" href="#cb58-8" tabindex="-1"></a><span class="fu">ggplot</span>(DFSEQS,<span class="fu">AES</span>(<span class="at">x =</span>케이,<span class="at">y =</span>지름))<span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-diameter">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diameter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-51" href="05-chap_files/figure-html/fig-diameter-1.png" title="Figure 5.32: The diameter of a set of sequences as a function of the number of sequences."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-diameter-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diameter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.32 : 시퀀스 수의 함수로서 서열 세트의 직경.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>이제 오류 확률을 포함하는 데노이징 메커니즘을 사용하여 16SRRNA- 읽기 클러스터링을 향상시킬 것입니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="5.8.2" id="denoising-16s-rrna-sequences">
<h3 class="anchored" data-anchor-id="denoising-16s-rrna-sequences" data-number="5.8.2"><span class="header-section-number">5.8.2</span>16S rRNA 서열을 비난합니다</h3>
<p><strong>데이터는 무엇입니까?</strong>박테리아 16SRRNA 유전자에는 소위가 있습니다<strong>가변 영역</strong>그것은 분류군에 따른 것입니다. 이들은 가능하게하는 지문을 제공합니다<em>분류군</em><a class="footnote-ref" href="#fn9" id="fnref9" role="doc-noteref"><sup>9</sup></a>신분증. 원시 데이터는 PCR- 증폭 된 DNA 영역의 품질 스코어 시퀀스를 가진 FastQ-Files입니다.<a class="footnote-ref" href="#fn10" id="fnref10" role="doc-noteref"><sup>10</sup></a>. 우리는 반복적 인 교대 접근법을 사용합니다<a class="footnote-ref" href="#fn11" id="fnref11" role="doc-noteref"><sup>11</sup></a>데이터에서 확률 론적 노이즈 모델을 구축합니다. 우리는 이것을 a라고 부릅니다<em>다시</em>방법, 클러스터링을 사용하고 클러스터 센터를 거부 시퀀스 변형으로 사용하기 때문에 (Amplicon 서열 변형, ASVS,<span class="citation" data-cites="Callahan:2017">(<a href="16-chap.html#ref-Callahan:2017" role="doc-biblioref">Benjamin J. Callahan, McMurdie 및 Holmes 2017</a>))</span>). 거부 된 모든 변형을 찾은 후, 우리는 다른 샘플에 걸쳐 카운트의 비상 테이블을 만듭니다. 우리는 보여줄 것입니다<a class="quarto-xref" href="10-chap.html"><span>10 장</span></a>이러한 테이블을 사용하여 네트워크 및 그래프를 사용하여 기본 박테리아 커뮤니티의 특성을 유추하는 방법.</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>박테리아의 다른 그룹을 호출합니다<em>분류군</em>보다는<em>종</em>종의 개념이 동물보다 박테리아에서 더 유동적이기 때문에 개념의 대략적인 특성을 강조합니다.</p></div><div id="fn10"><p><sup>10</sup>그만큼<a href="https://en.wikipedia.org/wiki/FASTQ_format">FASTQ 형식은 여기에 설명되어 있습니다</a>.</p></div><div id="fn11"><p><sup>11</sup>우리가 본 EM 알고리즘과 유사합니다<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>.</p></div></div><p>데이터 품질을 향상시키기 위해서는 종종 원시 데이터부터 시작하여 모든 변형 소스를 신중하게 모델링해야합니다. 이것을 예로 생각할 수 있습니다<em>처음부터 요리</em>(끔찍한 세부 사항을 참조하십시오<span class="citation" data-cites="Callahan2016Bioc">Ben J. Callahan et al. (<a href="16-chap.html#ref-Callahan2016Bioc" role="doc-biblioref">2016</a>))</span>그리고<a class="quarto-xref" href="#imp-clustering-dada2">운동<span>5.5</span></a>).</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-seqerror">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.17</div>
</div>
<div class="callout-body-container callout-body">
<p>길이 200의 두 시퀀스가 ​​있다고 가정합니다 (<code>seq1</code>그리고<code>seq2</code>) 우리의 샘플에 매우 다른 풍부로 존재합니다. 우리는 기술 시퀀싱 오류가 각 뉴클레오티드에 대한 독립적 인 Bernoulli (0.0005) 랜덤 사건으로 발생한다고 들었습니다.<br/>시퀀스 당 오차 수의 분포는 무엇입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-30-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-30-contents callout-collapse collapse" id="callout-30">
<div class="callout-body-container callout-body">
<p>확률 이론에 따르면 200 개의 독립적 인 포아송 (0.0005)의 합은 포아송 (0.1)이 될 것입니다.</p>
<p>또한 Monte Carlo Simulation에서이를 확인할 수 있습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a>simseq10k<span class="ot">=</span> <span class="fu">뒤로 젖히다</span>(<span class="fl">1E5</span>,,,<span class="fu">합집합</span>(<span class="fu">RPOIS</span>(<span class="dv">200</span>,,,<span class="fl">0.0005</span>))))</span>
<span id="cb59-2"><a aria-hidden="true" href="#cb59-2" tabindex="-1"></a><span class="fu">평균</span>(simseq10k)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.10143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a aria-hidden="true" href="#cb61-1" tabindex="-1"></a>VCD<span class="sc">::</span><span class="fu">Distplot</span>(simseq10k,<span class="st">"포아송"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-seqradiusex">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seqradiusex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-52" href="05-chap_files/figure-html/fig-seqradiusex-1.png" title="Figure 5.33: distplot for the simseq10K data."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-seqradiusex-1.png" style="width:50.0%"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seqradiusex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.33 :<code>Distplot</code>for the<code>simseq10k</code>데이터.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><a class="quarto-xref" href="#fig-seqradiusex">수치<span>5.33</span></a>Poisson Distribute의 분포가 얼마나 가까운 지 보여줍니다.</p>
</section>
<section class="level3 page-columns page-full" data-number="5.8.3" id="infer-sequence-variants">
<h3 class="anchored" data-anchor-id="infer-sequence-variants" data-number="5.8.3"><span class="header-section-number">5.8.3</span>시퀀스 변형을 추론합니다</h3>
<p>DADA 방법 (Divisive Amplicon Denoising 알고리즘,<span class="citation" data-cites="Rosen:2012">Rosen et al. (<a href="16-chap.html#ref-Rosen:2012" role="doc-biblioref">2012</a>))</span>)는 시퀀싱 오류를 실제 생물학적 변화와 구별하는 대체 오류의 매개 변수 모델을 사용합니다. 이 모델은<span class="math inline">\ ({\ tt a} \)</span>대신 a<span class="math inline">\ ({\ tt c} \)</span>. 이러한 확률은 시퀀스에 따른 위치와 무관하다고 가정합니다. 오류율은 시퀀싱 실행과 PCR 프로토콜마다 크게 다르기 때문에 모델 매개 변수는 EM- 타입 접근법을 사용하여 데이터 자체로부터 추정됩니다. 읽기는 현재 매개 변수를 고려할 때 시끄럽거나 정확한 것으로 분류되며 노이즈 모델 매개 변수는 그에 따라 업데이트됩니다.<a class="footnote-ref" href="#fn12" id="fnref12" role="doc-noteref"><sup>12</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn12"><p><sup>12</sup>큰 데이터 세트의 경우, 완전한 세트에서 노이즈 모델 추정 단계를 수행 할 필요가 없습니다. 보다<a class="uri" href="https://benjjneb.github.io/dada2/bigdata.html">https://benjjneb.github.io/dada2/bigdata.html</a>큰 데이터 세트를 처리 할 때 트릭과 도구.</p></div><div id="fn13"><p><sup>13</sup>F는 전방 가닥과 리버스 스트랜드의 경우 R을 나타냅니다.</p></div></div><p>불쾌한 시퀀스<a class="footnote-ref" href="#fn13" id="fnref13" role="doc-noteref"><sup>13</sup></a>읽고 나서 분열적인 비난을 받고 추정은<code>다다이즘</code>다음 코드에서와 같이 작동합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a>derepfs<span class="ot">=</span> <span class="fu">readrds</span>(<span class="at">파일 =</span><span class="st">"../data/derepfs.rds"</span>))</span>
<span id="cb62-2"><a aria-hidden="true" href="#cb62-2" tabindex="-1"></a>Dereprs<span class="ot">=</span> <span class="fu">readrds</span>(<span class="at">파일 =</span><span class="st">"../data/dereprs.rds"</span>))</span>
<span id="cb62-3"><a aria-hidden="true" href="#cb62-3" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"dada2"</span>))</span>
<span id="cb62-4"><a aria-hidden="true" href="#cb62-4" tabindex="-1"></a>DDF<span class="ot">=</span> <span class="fu">다다이즘</span>(derepfs,<span class="at">err =</span> <span class="cn">널</span>,,,<span class="at">자제주의 =</span> <span class="cn">진실</span>))</span>
<span id="cb62-5"><a aria-hidden="true" href="#cb62-5" tabindex="-1"></a>DDR<span class="ot">=</span> <span class="fu">다다이즘</span>(Dereprs,<span class="at">err =</span> <span class="cn">널</span>,,,<span class="at">자제주의 =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>오류 전환 속도가 합리적으로 잘 추정되었는지 확인하기 위해 관찰 된 오류율 (검은 점)과 장착 오류율 (검은 색 라인) 사이의 적합을 검사합니다 (<a class="quarto-xref" href="#fig-rerrorprofile1">수치<span>5.34</span></a>).</p>
<div class="cell page-columns page-full" data-layout-align="center" data-warning.known="transformation introduced infinite values">
<div class="sourceCode cell-code" data-cap-location="margin" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a aria-hidden="true" href="#cb63-1" tabindex="-1"></a><span class="fu">Plotterrors</span>(DDF)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="warning">
<pre class="knitr r">청크 'Fig-RerrorProfile1': 경고 : 스케일 범위 외부의 결 측값 또는 값이 포함 된 82 행을 제거했습니다 (geom_line ()`).</pre>
</div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center" id="fig-rerrorprofile1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-rerrorprofile1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="quarto-lightbox-gallery-53" href="05-chap_files/figure-html/fig-rerrorprofile1-1.png" title="Figure 5.34: Forward transition error rates as provided by plotErrors(ddF). This shows the frequencies of each type of nucleotide transition as a function of quality."><img class="img-fluid quarto-figure quarto-figure-center figure-img" src="05-chap_files/figure-html/fig-rerrorprofile1-1.png" style="width:75.0%"/></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-rerrorprofile1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.34 : 제공되는 전환 오류율<code>PlotErrors (DDF)</code>. 이것은 품질의 함수로서 각 유형의 뉴클레오티드 전이의 주파수를 보여준다.</figcaption>
</figure>
</div>
</div>
</div>
<p>오류가 추정되면 알고리즘이 데이터에서 재실행되어 시퀀스 변형을 찾습니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a aria-hidden="true" href="#cb64-1" tabindex="-1"></a>Dadafs<span class="ot">=</span> <span class="fu">다다이즘</span>(derepfs,<span class="at">err =</span>DDF [[<span class="dv">1</span>]]]]<span class="sc">$</span>err_out,<span class="at">수영장 =</span> <span class="cn">진실</span>))</span>
<span id="cb64-2"><a aria-hidden="true" href="#cb64-2" tabindex="-1"></a>Dadars<span class="ot">=</span> <span class="fu">다다이즘</span>(Dereprs,<span class="at">err =</span>DDR [[<span class="dv">1</span>]]]]<span class="sc">$</span>err_out,<span class="at">수영장 =</span> <span class="cn">진실</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p><strong>메모:</strong>시퀀스 추론 함수는 두 가지 다른 모드로 실행될 수 있습니다. 샘플에 의한 독립적 인 추론 (<code>수영장 = 거짓</code>), 및 시퀀싱으로부터의 풀링 된 추론은 모든 샘플로부터 결합 된 판독이다. 독립적 인 추론에는 두 가지 장점이 있습니다. 샘플 수의 함수로서 계산 시간은 선형이며 메모리 요구 사항은 일정합니다. 풀링 된 추론은 계산 에세이지만 개별 샘플에서 한 번 또는 두 번만 발생하지만 모든 샘플에서 더 자주 발생하는 드문 변이의 검출을 향상시킬 수 있습니다. 이 데이터 세트는 특히 크지 않기 때문에 풀링 된 추론을 수행했습니다.</p>
<p>시퀀스 추론은 거의 모든 대체를 제거합니다<strong>인델</strong><a class="footnote-ref" href="#fn14" id="fnref14" role="doc-noteref"><sup>14</sup></a>데이터의 오류. 우리는 추론 된 전방 및 역방향 시퀀스를 병합하는 동시에 잔류 오차에 대한 최종 제어로 완벽하게 겹치지 않는 쌍의 서열을 제거합니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn14"><p><sup>14</sup>용어<em>인델</em>삽입 삭제를 의미합니다. 작은 문자에 의해 다른 두 시퀀스를 비교할 때, 이것이 삽입인지 삭제인지, 따라서 이름인지 관점의 문제입니다.</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a>합병<span class="ot">=</span> <span class="fu">병합</span>(Dadafs, derepfs, dadars, dereprs)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>우리는 ASV의 비상 사태 테이블을 생산합니다. 이것은“OTU의 고해상도 아날로그입니다<a class="footnote-ref" href="#fn15" id="fnref15" role="doc-noteref"><sup>15</sup></a>테이블”, 즉, 셀에 의한 샘플은 셀이 각 샘플에서 각 서열 변이체가 관찰 된 횟수를 포함하는 특징 테이블에 의한 것입니다.</p>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup>운영 분류 단위</p></div></div><div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" href="#cb66-1" tabindex="-1"></a>seqtab.all<span class="ot">=</span> <span class="fu">Makesequencetable</span>(합병 [<span class="sc">!</span><span class="fu">포도</span>(<span class="st">"모조품"</span>,,,<span class="fu">이름</span>(합병))]))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-merger">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.18</div>
</div>
<div class="callout-body-container callout-body">
<p>물체의 구성 요소를 탐색하십시오<code>Dadars</code>그리고<code>합병</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-32-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-32-contents callout-collapse collapse" id="callout-32">
<div class="callout-body-container callout-body">
<p><code>Dadars</code>길이 20의 목록입니다. 요소는 객체 클래스입니다.<em>다다이즘</em>거부 된 독서가 포함되어 있습니다. 우리는 볼 것입니다<a class="quarto-xref" href="10-chap.html"><span>10 장</span></a>시퀀스를 정렬하고 분류를 할당 한 후 다운 스트림 분석을위한 샘플 정보와 결합하는 방법.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "목록"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F3D0" "F3D1" "F3D141" "F3D142" "F3D143" "F3D144" "F3D145" "F3D146"
 [9] "F3D147" "F3D148" "F3D149" "F3D150" "F3D2" "F3D3" "F3D5" "F3D6"  
[17] "F3D7" "F3D8" "F3D9" "Mock"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "목록"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>키메라는 원래 서열의 두 가지 (드문 경우, 더 많은 경우)의 용융에 의해 PCR 증폭 동안 인위적으로 생성되는 서열이다. 데노이징 워크 플로를 완료하려면 기능을 호출하여 제거합니다.<code>비비 메라 데노 보를 제거하십시오</code>, 우리는 나중에 사용할 수있는 깨끗한 비상 테이블을 남겨 둡니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a aria-hidden="true" href="#cb73-1" tabindex="-1"></a>빨려<span class="ot">=</span> <span class="fu">비비 메라 데노 보를 제거하십시오</span>(seqtab.all)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled" id="wrn-clustering-chimera">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">질문 5.19</div>
</div>
<div class="callout-body-container callout-body">
<p>키메라가 왜 쉽게 알아볼 수 있다고 생각합니까?<br/>읽기의 몇 가지 비율은 키메라의 키메라였습니다<code>seqtab.all</code>데이터?<br/>고유 한 시퀀스 변이체의 비율은 키메라입니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-34-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-34-contents callout-collapse collapse" id="callout-34">
<div class="callout-body-container callout-body">
<p>여기서 우리는 일부 서열 변이를 키메라로 관찰했지만, 이들은 모든 읽기의 7%만을 나타냅니다.</p>
</div>
</div>
</div>
</section>
</section>
<section class="level2" data-number="5.9" id="summary-of-this-chapter">
<h2 class="anchored" data-anchor-id="summary-of-this-chapter" data-number="5.9"><span class="header-section-number">5.9</span>이 장의 요약</h2>
<p><strong>깃털의 : 관찰을 비교하는 방법</strong>우리는 장의 시작 부분에서<strong>적절한 거리</strong>클러스터링 분석의 필수 첫 단계입니다. 이것은 사례입니다<em>쓰레기, 쓰레기</em>좌우명은 완전히 힘을 가지고 있습니다. 항상 과학적으로 의미가있는 거리를 선택하고 가능한 많은 거리에서 출력을 비교하십시오. 때로는 다른 과학적 목표를 추구 할 때 동일한 데이터가 다른 거리를 요구합니다.</p>
<p><strong>클러스터링의 두 가지 방법</strong>클러스터링에 대한 두 가지 접근법이 있음을 알았습니다.</p>
<ul>
<li><p>반복적 인 파티셔닝 접근법<span class="math inline">\(케이\)</span>-평균 및<span class="math inline">\(케이\)</span>-클러스터 센터를 추정하고 지점을 할당하는 것 사이에서 번갈아 가며 Medoids (PAM);<br/>
</p></li>
<li><p>계층 적 클러스터링은 첫 번째 응집 지점 및 그 이후 성장하는 클러스터를 계층 적 클러스터링으로 표현할 수있는 중첩 된 세트 시퀀스로 접근합니다.<em>나무</em>.</p></li>
</ul>
<p><strong>생물학적 사례</strong>클러스터링은 단일 세포 측정, 특히 면역학 및 단일 세포 데이터 분석에서 잠재 클래스를 찾는 데 중요한 도구입니다. 우리는 밀도 기반 클러스터링이 희소성이 문제가되지 않는 낮은 차원 데이터에 어떻게 유용한 지 보았습니다.</p>
<p><strong>검증</strong>클러스터링 알고리즘<em>언제나</em>클러스터를 제공하므로 품질과 클러스터 수를 신중하게 선택해야합니다. 이러한 검증 단계는 시각화 도구를 사용하여 수행하고 데이터의 많은 리 샘플에서 클러스터링을 반복합니다. WSS/BSS와 같은 통계를 보았습니다<span class="math inline">\ (\ log (\ text {wss}) \)</span>그룹 구조를 이해하고 새로운 데이터의 클러스터 수를 선택하는 데 유용한 벤치 마크를 제공하는 데이터에서 시뮬레이션을 사용하여 교정 할 수 있습니다. 물론, 클러스터의 의미를 알리고 확인하기 위해 생물학적으로 관련된 정보를 사용하는 것이 항상 최상의 검증 접근법입니다.</p>
<p>클러스터링 결과를 일반적으로 비교할 근거 진실은 없을 것입니다. “모든 모델이 잘못되고 일부는 유용합니다”의 오래된 격언도 여기에 적용됩니다. 좋은 클러스터링은 유용한 것으로 판명 된 클러스터링입니다.</p>
<p><strong>거리와 확률</strong>마지막으로 : 거리가 전부가 아닙니다. 클러스터링시 기준 주파수와 국소 밀도를 고려하는 것이 얼마나 중요한지를 보여주었습니다. 이것은 16S rRNA 서열을 거부하는 클러스터링과 같은 경우 실제 클래스 또는 분류군 그룹이 매우 다른 주파수에서 발생하는 곳을 읽는 것과 같은 경우에 필수적입니다.</p>
</section>
<section class="level2" data-number="5.10" id="further-reading">
<h2 class="anchored" data-anchor-id="further-reading" data-number="5.10"><span class="header-section-number">5.10</span>추가 독서</h2>
<p>완전한 책을 위해<em>데이터에서 그룹 찾기</em>, 보다<span class="citation" data-cites="Kaufman2009">Kaufman과 Rousseeuw (<a href="16-chap.html#ref-Kaufman2009" role="doc-biblioref">2009 년</a>))</span>. 의 비 ignette<strong><a href="https://bioconductor.org/packages/clusterExperiment/">clusterexperiment</a></strong>패키지에는 우리가 다룰 예비 차원 감소 (PCA)를 포함하여 다양한 기술을 사용하여 클러스터를 생성하기위한 완전한 워크 플로가 포함되어 있습니다.<a class="quarto-xref" href="07-chap.html"><span>7 장</span></a>. 인접한 생물학적 정보가 없을 때 데이터를 설명하기 위해 얼마나 많은 클러스터가 필요한지 결정하는 방법에 대한 합의는 없습니다. 그러나, 계층 적 클러스터를 만듭니다<em>강력한 형태</em>사용자가 계층 적 트리를 자르기 위해 얼마나 멀리 떨어져 있는지 결정할 수있는 이점이있는 방법입니다. 의 비네팅을 참조하십시오<strong><a href="https://bioconductor.org/packages/clusterExperiment/">clusterexperiment</a></strong>단일 세포 RNA 실험 데이터에 대한 적용.</p>
<p>Hiiragi 데이터 분석에서 이미 언급 된 개념 인 클러스터 확률을 사용했습니다.<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>EM 알고리즘이 예상 값 통계를 계산하기위한 가중치로 사용했습니다. 확률 적 클러스터링의 개념은 베이지안 비모수 혼합 혼합물 프레임 워크에서 잘 발달되어 있으며, 우리가 다루는 혼합 모델을 풍부하게합니다.<a class="quarto-xref" href="04-chap.html"><span>4 장</span></a>보다 일반적인 설정으로. 보다<span class="citation" data-cites="Dundar2014">Dundar et al. ,,,<a href="16-chap.html#ref-Dundar2014" role="doc-biblioref">2014</a>))</span>유세포 분석 에이 프레임 워크를 사용하는 실제 예를 위해. 고 처리량 시퀀싱의 비난 및 할당에서 특정 박테리아 또는 바이러스의 특정 균주에 대한 읽기에서 클러스터링이 필수적입니다. 노이즈가있는 경우, 그룹으로의 클러스터링<em>진실</em>매우 불평등 한 크기의 균주는 어려울 수 있습니다. 데이터를 사용하여 노이즈 모델을 생성하면 동시에 데노이징 및 클러스터 할당이 모두 가능합니다. 이들과 같은 비전 알고리즘<span class="citation" data-cites="Rosen:2012">Rosen et al. (<a href="16-chap.html#ref-Rosen:2012" role="doc-biblioref">2012</a>))</span>또는<span class="citation" data-cites="dada2">Benjamin J. Callahan et al. (<a href="16-chap.html#ref-dada2" role="doc-biblioref">2016</a>))</span>EM 메소드에서 영감을 얻은 반복 워크 플로우를 사용하십시오<span class="citation" data-cites="mclachlan2007algorithm">(<a href="16-chap.html#ref-mclachlan2007algorithm" role="doc-biblioref">McLachlan과 Krishnan 2007</a>))</span>.</p>
</section>
<section class="level2 page-columns page-full" data-number="5.11" id="exercises">
<h2 class="anchored" data-anchor-id="exercises" data-number="5.11"><span class="header-section-number">5.11</span>수업 과정</h2>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-clustering-SilhouetteIndex">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.1</div>
</div>
<div class="callout-body-container callout-body">
<p>우리는 점의 평균 비 유사성을 정의 할 수 있습니다<span class="math inline">\ (x_i \)</span>클러스터에<span class="math inline">\ (C_K \)</span>거리의 평균으로<span class="math inline">\ (x_i \)</span>모든 지점에<span class="math inline">\ (C_K \)</span>. 허락하다<span class="math inline">\(일체 포함)\)</span>클러스터의 모든 지점의 평균 비 유사성이 되십시오.<span class="math inline">\ (x_i \)</span>속한다. 허락하다<span class="math inline">\ (b (i) \)</span>가장 낮은 평균 비 유사성이어야합니다<span class="math inline">\ (x_i \)</span>다른 클러스터에<span class="math inline">\ (x_i \)</span>회원이 아닙니다. 이 평균이 가장 낮은 클러스터는<strong>이웃 클러스터</strong>~의<span class="math inline">\ (x_i \)</span>포인트에 대한 다음으로 가장 잘 맞는 클러스터이기 때문에<span class="math inline">\ (x_i \)</span>. 그만큼<strong>실루엣 인덱스</strong>~이다</p>
<p><span class="math display">\ [
s (i) = \ frac {b (i) -a (i)} {\ max_i (a (i), b (i))}.
\]</span></p>
<p>실루엣 인덱스를 계산하십시오<code>미사</code>우리가 시뮬레이션 한 데이터<a class="quarto-xref" href="#sec-clustervalidation"><span>섹션 5.7</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a><span class="fu">도서관</span>(<span class="st">"무리"</span>))</span>
<span id="cb74-2"><a aria-hidden="true" href="#cb74-2" tabindex="-1"></a>PAM4<span class="ot">=</span> <span class="fu">팸</span>(Sydmatxy,<span class="dv">4</span>))</span>
<span id="cb74-3"><a aria-hidden="true" href="#cb74-3" tabindex="-1"></a>실<span class="ot">=</span> <span class="fu">실루엣</span>(PAM4,<span class="dv">4</span>))</span>
<span id="cb74-4"><a aria-hidden="true" href="#cb74-4" tabindex="-1"></a><span class="fu">구성</span>(사일,<span class="at">col =</span><span class="fu">기음</span>(<span class="st">"빨간색"</span>,,,<span class="st">"녹색"</span>,,,<span class="st">"파란색"</span>,,,<span class="st">"보라"</span>),)<span class="at">메인 =</span><span class="st">"실루엣"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>클러스터 수를 변경하십시오<span class="math inline">\(케이\)</span>그리고 어느 쪽을 평가합니다<span class="math inline">\(케이\)</span>최고의 실루엣 인덱스를 제공합니다.</p>
<p>이제 전체 값에 걸쳐 균일 한 (uppustered) 데이터 배포가있는 그룹에 대해 이것을 반복하십시오.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-clustering-EcoHeatmap">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.2</div>
</div>
<div class="callout-body-container callout-body">
<p>20 개 위치 사이의 거리를 "캐릭터"표현으로 만듭니다.<code>모래 언덕</code>.의 데이터<strong><a href="https://cran.r-project.org/web/packages/vegan/">비건 채식</a></strong>기능을 사용하는 패키지<code>시나</code>.</p>
<p>이 거리의 히트 맵 플롯을 만드십시오.</p>
</div>
</div>
<!-- TODO: solution hidden in the online book? 
::: {.callout-tip collapse="true"}





:::
-->
<div class="callout callout-style-default callout-important no-icon callout-titled page-columns page-full" id="imp-clustering-SpiralClusters">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.3</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<p>로드<code>나선</code>.의 데이터<strong><a href="https://cran.r-project.org/web/packages/kernlab/">kernlab</a></strong>패키지. 사용 결과를 플롯하십시오<span class="math inline">\(케이\)</span>-데이터에 대해서도. 이것은 당신과 비슷한 것을 줄 것입니다<a class="quarto-xref" href="#fig-kmeanspital1">수치<span>5.35</span></a>.</p>
<div class="cell page-columns page-full" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="quarto-layout-panel page-columns page-full" id="fig-kmeanspital1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-kmeanspital1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-kmeanspital1" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-kmeanspital1-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-kmeanspital1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-kmeanspital1" href="05-chap_files/figure-html/fig-kmeanspital1-1.png" title="Figure 5.35 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-kmeanspital1" id="fig-kmeanspital1-1" src="05-chap_files/figure-html/fig-kmeanspital1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-kmeanspital1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-kmeanspital1" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-kmeanspital1-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-kmeanspital1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-kmeanspital1" href="05-chap_files/figure-html/fig-kmeanspital1-2.png" title="Figure 5.35 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-kmeanspital1" id="fig-kmeanspital1-2" src="05-chap_files/figure-html/fig-kmeanspital1-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-kmeanspital1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-kmeanspital1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.35 : 비 정교회 클러스터의 예. (a)에서 우리는 결과를 보여줍니다<span class="math inline">\(케이\)</span>-클러스터링<span class="math inline">\ (k = 2 \)</span>. (b)에서, 우리는 출력이 있습니다<code>DBSCAN</code>. 색상은 설정에 대한 알고리즘에 의해 발견 된 세 ​​개의 클러스터를 나타냅니다.</figcaption>
</figure>
</div>
</div>
<p>클러스터링이 있음을 알 수 있습니다<a class="quarto-xref" href="#fig-kmeanspital1">수치<span>5.35</span></a>불만족스러운 것 같습니다. 다른 방법과 같은 방법을 보여줍니다<code>사양</code>또는<code>DBSCAN</code>, 클러스터 할 수 있습니다<code>나선</code>보다 유용한 방식으로 데이터.</p>
<p>반복하십시오<code>DBSCAN</code>매개 변수가 다른 클러스터링. 그룹 수는 얼마나 강력합니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-clustering-maps">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.4</div>
</div>
<div class="callout-body-container callout-body">
<p>간단한 2 차원 맵에서 그래픽 표현을 보면 종종 중요한 덩어리 패턴이 드러날 수 있습니다. 우리는 Snow가 런던 콜레라 발생의 출처를 발견 할 수있게 해주는지도와 함께 이것에 대한 예를 보았습니다. 이러한 클러스터링은 종종 관찰에 작용하는 숨겨진 변수에 대한 중요한 정보를 나타낼 수 있습니다. 미국의 유방암 발병률을보십시오.<br/>
<a class="uri" href="http://www.huffingtonpost.com/bill-davenhall/post_1663_b_817254.html">http://www.huffingtonpost.com/bill-davenhall/post_1663_b_817254.html</a> <span class="citation" data-cites="mandal2009">(<a href="16-chap.html#ref-mandal2009" role="doc-biblioref">만달 et al. 2009 년</a>))</span>; 발병률이 높은 영역은 공간적으로 클러스터 된 것처럼 보입니다. 서부와 동해안 및 시카고 주변 의이 클러스터링과 높은 발병률의 이유를 추측 할 수 있습니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled page-columns page-full" id="imp-clustering-dada2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.5</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<p><strong>Amplicon Bioinformatics : RAW 읽기에서 복제 된 서열에 이르기까지</strong>. 보충 운동으로서, 우리는 16S rRNA 서열을 비난하기 위해 전체 데이터 전처리 워크 플로에 필요한 중간 단계를 제공합니다. 우리는 디렉토리를 설정하고 다운로드 된 데이터를로드하는 것으로 시작합니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a aria-hidden="true" href="#cb75-1" tabindex="-1"></a>base_dir<span class="ot">=</span> <span class="st">"../데이터"</span></span>
<span id="cb75-2"><a aria-hidden="true" href="#cb75-2" tabindex="-1"></a>miseq_path<span class="ot">=</span> <span class="fu">file.path</span>(base_dir,<span class="st">"miseq_sop"</span>))</span>
<span id="cb75-3"><a aria-hidden="true" href="#cb75-3" tabindex="-1"></a>felt_path<span class="ot">=</span> <span class="fu">file.path</span>(miseq_path,<span class="st">"거르는"</span>))</span>
<span id="cb75-4"><a aria-hidden="true" href="#cb75-4" tabindex="-1"></a>FNFS<span class="ot">=</span> <span class="fu">종류</span>(<span class="fu">list.files</span>(miseq_path,<span class="at">패턴 =</span><span class="st">"_r1_001.fastq"</span>)))</span>
<span id="cb75-5"><a aria-hidden="true" href="#cb75-5" tabindex="-1"></a>fnrs<span class="ot">=</span> <span class="fu">종류</span>(<span class="fu">list.files</span>(miseq_path,<span class="at">패턴 =</span><span class="st">"_r2_001.fastq"</span>)))</span>
<span id="cb75-6"><a aria-hidden="true" href="#cb75-6" tabindex="-1"></a>샘플레이 이름<span class="ot">=</span> <span class="fu">Sapply</span>(<span class="fu">strsplit</span>(FNFS,<span class="st">"_"</span>),)<span class="st">`</span><span class="at">[의 뜻</span><span class="st">`</span>,,,<span class="dv">1</span>))</span>
<span id="cb75-7"><a aria-hidden="true" href="#cb75-7" tabindex="-1"></a><span class="cf">만약에</span> (<span class="sc">!</span><span class="fu">file_test</span>(<span class="st">"-디"</span>, felt_path)))<span class="fu">DIR.REATE를 만듭니다</span>(Felt_path)</span>
<span id="cb75-8"><a aria-hidden="true" href="#cb75-8" tabindex="-1"></a>faltfs<span class="ot">=</span> <span class="fu">file.path</span>(felt_path,<span class="fu">페이스트0</span>(샘플레 이름,<span class="st">"_f_filt.fastq.gz"</span>)))</span>
<span id="cb75-9"><a aria-hidden="true" href="#cb75-9" tabindex="-1"></a>필터<span class="ot">=</span> <span class="fu">file.path</span>(felt_path,<span class="fu">페이스트0</span>(샘플레 이름,<span class="st">_r_filt.fastq.gz</span>)))</span>
<span id="cb75-10"><a aria-hidden="true" href="#cb75-10" tabindex="-1"></a>FNFS<span class="ot">=</span> <span class="fu">file.path</span>(miseq_path, fnfs)</span>
<span id="cb75-11"><a aria-hidden="true" href="#cb75-11" tabindex="-1"></a>fnrs<span class="ot">=</span> <span class="fu">file.path</span>(miseq_path, fnrs)</span>
<span id="cb75-12"><a aria-hidden="true" href="#cb75-12" tabindex="-1"></a><span class="fu">인쇄</span>(<span class="fu">길이</span>(FNFS))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
</div>
<p>데이터는 겹치는 Illumina Miseq입니다<span class="math inline">\ (2 \ Times 250 \)</span>16S rRNA 유전자의 V4 영역으로부터의 앰플 리콘 서열<span class="citation" data-cites="Kozich2013">(<a href="16-chap.html#ref-Kozich2013" role="doc-biblioref">Kozich et al. 2013</a>))</span>. 원래 생후 첫해에 걸쳐 12 마리의 마우스로부터 세로로 수집 된 360 개의 대변 샘플이 원래 있었다. 이것들은 수집되었습니다<span class="citation" data-cites="schloss2012stabilization">P. D. 늙어 가십시오. (<a href="16-chap.html#ref-schloss2012stabilization" role="doc-biblioref">2012</a>))</span>뮤린 미생물 군의 발달 및 안정화를 조사합니다. 데이터를 전처리하는 방법을 설명하기 위해 20 개의 샘플을 선택했습니다.</p>
<p>저품질 읽기를 필터링하고 일관된 길이로 다듬어야합니다. 일반적으로 권장되는 필터링 및 트리밍 매개 변수는 출발점으로 사용되지만 두 개의 데이터 세트가 동일하지 않으므로 진행하기 전에 데이터의 품질을 검사하는 것이 좋습니다. 우리는 두 개의 첫 번째 샘플에 대한 시퀀스 품질 플롯을 보여줍니다.<a class="quarto-xref" href="#fig-profile-1">수치<span>5.36</span></a>. 그들은 다음과 같이 생성됩니다.</p>
<div class="cell page-columns page-full" data-fid-width="4" data-fig-cap-location="margin" data-layout-align="center" data-layout-nrow="1">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a><span class="fu">PlotqualityProfile</span>(fnfs [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"앞으로"</span>))</span>
<span id="cb77-2"><a aria-hidden="true" href="#cb77-2" tabindex="-1"></a><span class="fu">PlotqualityProfile</span>(fnrs [<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"뒤집다"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="quarto-layout-panel page-columns page-full" id="fig-profile-1">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-profile-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-profile-1" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-profile-1-1" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-profile-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-profile-1" href="05-chap_files/figure-html/fig-profile-1-1.png" title="Figure 5.36 (a): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-profile-1" id="fig-profile-1-1" src="05-chap_files/figure-html/fig-profile-1-1.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-profile-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(에이)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-profile-1" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" id="fig-profile-1-2" width="320">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-profile-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a class="lightbox" data-gallery="fig-profile-1" href="05-chap_files/figure-html/fig-profile-1-2.png" title="Figure 5.36 (b): "><img class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-profile-1" id="fig-profile-1-2" src="05-chap_files/figure-html/fig-profile-1-2.png" width="320"/></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-profile-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">(비)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-profile-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">그림 5.36 : 품질 점수. 라인은 위치 요약 통계를 보여줍니다 : 녹색은 평균이고, 주황색은 중앙값이고, 오렌지선은 25 번째와 75 번째 Quantiles입니다.</figcaption>
</figure>
</div>
</div>
<p>또한 각 위치에서 품질 점수의 배경 분포를 볼 수 있습니다.<a class="quarto-xref" href="#fig-profile-1">수치<span>5.36</span></a>회색 규모 열지도로. 어두운 색상은 더 높은 주파수에 해당합니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-clustering-qualityplots">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.6</div>
</div>
<div class="callout-body-container callout-body">
<p>무작위로 선택된 4 개의 전방 및 리버스 리드 세트에 대해 유사한 플롯을 생성합니다. 앞으로 및 리버스 읽기 품질을 비교하십시오. 당신은 무엇을 알아 차십니까?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-41-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-41-contents callout-collapse collapse" id="callout-41">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center" data-warning.known="is deprecated. please use">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a aria-hidden="true" href="#cb78-1" tabindex="-1"></a>II<span class="ot">=</span> <span class="fu">견본</span>(<span class="fu">길이</span>(FNFS),<span class="dv">4</span>))</span>
<span id="cb78-2"><a aria-hidden="true" href="#cb78-2" tabindex="-1"></a><span class="fu">PlotqualityProfile</span>(FNFS [II])<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"앞으로"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a><span class="fu">PlotqualityProfile</span>(FRS [I])<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"뒤집다"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-clustering-dada3">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.7</div>
</div>
<div class="callout-body-container callout-body">
<p>여기서, 전방 판독은 전체적으로 고품질을 유지하는 반면, 역 판독의 품질은 위치 160에서 크게 떨어집니다. 따라서, 우리는 위치 240에서 전방 판독을 자르고, 이들 위치가 품질이 낮기 때문에 처음 10 개의 뉴클레오티드를 트림합니다. 리버스 리드는 위치 160에서 트리밍됩니다.이 트리밍 매개 변수를 표준 필터링 매개 변수와 결합하면 읽기 당 최대 2 개의 예상 오류를 시행해야합니다. (힌트 : 페어링 된 읽기의 트림 및 필터는 공동으로 읽습니다. 즉, 두 판독은 쌍이 전달할 필터를 전달해야합니다. 입력 인수는 다음에 따라 선택해야합니다.<strong><a href="https://bioconductor.org/packages/dada2/">dada2</a></strong>비 네트 조심스럽게. 모호한 뉴클레오티드로 모든 읽기를 걸러내는 것이 좋습니다.)</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-43-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-43-contents callout-collapse collapse" id="callout-43">
<div class="callout-body-container callout-body">
<p>대부분의 일루미나 시퀀싱 데이터는 읽기 끝을 향한 품질이 감소하는 경향을 보여줍니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a>밖으로<span class="ot">=</span> <span class="fu">FilterAndtrim</span>(FNFS, FILTFS, FNRS, 필터,<span class="at">trunclen =</span><span class="fu">기음</span>(<span class="dv">240</span>,,,<span class="dv">160</span>),)</span>
<span id="cb80-2"><a aria-hidden="true" href="#cb80-2" tabindex="-1"></a>        <span class="at">maxn =</span><span class="dv">0</span>,,,<span class="at">Maxee =</span><span class="dv">2</span>,,,<span class="at">truncq =</span><span class="dv">2</span>,,,<span class="at">rm.phix =</span><span class="cn">진실</span>,,,<span class="at">trimleft =</span><span class="dv">10</span>,,,</span>
<span id="cb80-3"><a aria-hidden="true" href="#cb80-3" tabindex="-1"></a>        <span class="at">압축 =</span><span class="cn">진실</span>,,,<span class="at">multithread =</span><span class="cn">진실</span>))<span class="co"># Windows에서 SET Multithread = False</span></span>
<span id="cb80-4"><a aria-hidden="true" href="#cb80-4" tabindex="-1"></a><span class="fu">머리</span>(밖으로)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>reads.in reads.out
F3D0_S188_L001_R1_001.FASTQ 7793 7139
F3D1_S189_L001_R1_001.FASTQ 5869 5314
F3D141_S207_L001_R1_001.fastq 5958 5478
F3D142_S208_L001_R1_001.FASTQ 3183 2926
F3D143_S209_L001_R1_001.fastq 3178 2955
F3D144_S210_L001_R1_001.fastq 4827 4323</code></pre>
</div>
</div>
<p>그만큼<code>맥스</code>매개 변수는 모든 읽기 이상을 생략합니다<code>maxn = 0</code>모호한 뉴클레오티드 및<code>무엇</code>at 2는 2 개 이상의 예상 오류가있는 읽기를 제외합니다.</p>
<p>서열 데이터는 demultiplexed에서 r로 가져왔다<em>FASTQ</em>파일 (즉, 하나<em>FASTQ</em>각각의 샘플에 대해) 및 동시에 복제되어 중복성을 제거합니다. 샘플 출처별로 결과 객체의 이름을 지정하십시오. 그들은 가질 것입니다<em>최근의</em>그들의 수업으로.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a>derepfs<span class="ot">=</span> <span class="fu">derepfastq</span>(Pheltfs,<span class="at">verbose =</span> <span class="cn">거짓</span>))</span>
<span id="cb82-2"><a aria-hidden="true" href="#cb82-2" tabindex="-1"></a>Dereprs<span class="ot">=</span> <span class="fu">derepfastq</span>(필터,<span class="at">verbose =</span> <span class="cn">거짓</span>))</span>
<span id="cb82-3"><a aria-hidden="true" href="#cb82-3" tabindex="-1"></a><span class="fu">이름</span>(derepfs)<span class="ot">=</span>샘플레이 이름</span>
<span id="cb82-4"><a aria-hidden="true" href="#cb82-4" tabindex="-1"></a><span class="fu">이름</span>(Dereprs)<span class="ot">=</span>샘플레이 이름</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled" id="imp-clustering-blitzbombs">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">운동 5.8</div>
</div>
<div class="callout-body-container callout-body">
<p>R을 사용하여 표시된 것과 같은 맵을 만듭니다.<a class="quarto-xref" href="#fig-bombings">수치<span>5.2</span></a>. 힌트 :<a href="http://bombsight.org">영국 국립 아카이브의 웹 사이트</a>거리 주소를 다운로드하고 주소 해상도 서비스를 사용하여이를 지리적 좌표로 변환 한 다음 런던지도에 포인트를 표시합니다.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout" class="callout-header d-flex align-content-center" data-bs-target=".callout-45-contents" data-bs-toggle="collapse">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">해결책</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div class="callout-45-contents callout-collapse collapse" id="callout-45">
<div class="callout-body-container callout-body">
<p>요점을 참조하십시오<a class="uri" href="https://gist.github.com/wolfganghuber/523622aff6a156d26e77a87ccbe7bd0d">https://gist.github.com/wolfganghuber/523622aff6a156d26e77a87ccbe7bd0d</a>Andrzej Oles에 의해.</p>
</div>
</div>
</div>
<div class="references csl-bib-body hanging-indent" data-entry-spacing="0" id="refs" role="list" style="display: none">
<div class="csl-entry" id="ref-Aure2017" role="listitem">Aure, Miriam Ragle, Valeria Vitelli, Sandra Jernström, Surendra Kumar, Marit Krohn, Eldri U Due, Tonje Husby Haukaas 등. 2017.<span>“통합 클러스터링은 내강에서 소설 분할을 보여줍니다<span>에이</span>결과에 영향을 미치는 유방암 하위 유형.”</span> <em>유방암 연구</em>19 (1) : 44.</div>
<div class="csl-entry" id="ref-BendallCell" role="listitem">Bendall, Sean C, Garry P Nolan, Mario Roederer 및 Pratip K Chattopadhyay. 2012.<span>"세포 측정에 대한 깊은 프로파일 러 가이드."</span> <em>면역학 동향</em>33 (7) : 323–32.</div>
<div class="csl-entry" id="ref-Callahan2016Bioc" role="listitem">Callahan, Ben J, Kris Sankaran, Julia A Fukuyama, Paul J McMurdie 및 Susan P Holmes. 2016.<span>"마이크로 바이 옴 데이터 분석을위한 바이오 컨덕터 워크 플로 : RAW 판독에서 커뮤니티 분석에 이르기까지."</span> <em>F1000Research</em>5.</div>
<div class="csl-entry" id="ref-Callahan:2017" role="listitem">Callahan, Benjamin J, Paul J McMurdie 및 Susan P Holmes. 2017.<span>"정확한 서열 변형은 마커 유전자 데이터 분석에서 작동 분류 학적 단위를 대체해야합니다."</span> <em>ISM 저널</em>, 1–5.</div>
<div class="csl-entry" id="ref-dada2" role="listitem">Callahan, Benjamin J, Paul J McMurdie, Michael J Rosen, Andrew W Han, Amy J Johnson 및 Susan P Holmes. 2016.<span>"<span>dada2</span>: <span>시간</span>Amplicon 데이터의 이웃 해상도 샘플 추론.”</span> <em>자연 방법</em>, 1–4.</div>
<div class="csl-entry" id="ref-caporaso2010qiime" role="listitem">Stubinger, F. Busshman, EK, N. Fierer 및 Al. 2010 년.<span>"Qiime은 고 처리량 커뮤니티 시퀀싱 데이터를 분석 할 수 있습니다."</span> <em>자연 방법</em>7 (5) : 335–36.</div>
<div class="csl-entry" id="ref-distory-paper" role="listitem">Chakerian, John 및 Susan Holmes. 2012.<span>"계통 발생 학적 및 계층 적 클러스터링 트리를 평가하기위한 계산 도구."</span> <em>계산 및 그래픽 통계 저널</em>21 (3) : 581–99.</div>
<div class="csl-entry" id="ref-Diday1989" role="listitem">Diday, Edwin 및 M Paula Brito. 1989.<span>"상징적 인 클러스터 분석."</span>~ 안에<em>데이터의 개념적 및 수치 분석</em>, 45–84. 뛰는 것.</div>
<div class="csl-entry" id="ref-Dundar2014" role="listitem">Dundar, Murat, Ferit Akova, Khalid Z. Yerebakan 및 Bartek Rajwa. 2014.<span>“비모수 적<span>비</span>조인트 세포 클러스터링 및 클러스터 매칭에 대한 Ayesian 모델 : 무작위 효과를 가진 변칙적 샘플 표현형의 식별.”</span> <em>BMC 생물 정보학</em>15 (1) : 1–15.<a href="https://doi.org/10.1186/1471-2105-15-314">https://doi.org/10.1186/1471-2105-15-314</a>.
</div>
<div class="csl-entry" id="ref-freedman1991" role="listitem">Freedman, David A. 1991.<span>"통계 모델과 신발 가죽."</span> <em>사회 학적 방법론</em>21 (2) : 291–313.</div>
<div class="csl-entry" id="ref-Hallett2012" role="listitem">Hallett, Robin M, Anna Dvorkin-Gheva, Anita Bane 및 John A Hassell. 2012.<span>"기저 같은 유방암 환자의 결과를 예측하기위한 유전자 시그니처."</span> <em>과학적 보고서</em>2.</div>
<div class="csl-entry" id="ref-holmes2005memory" role="listitem">Holmes, Susan, Michael He, Tong Xu 및 Peter P Lee. 2005.<span>"메모리 T 세포는 순진하고 이펙터 사이의 유전자 발현 패턴을 가지고있다."</span> <em>PNA</em>102 (15) : 5519–23.</div>
<div class="csl-entry" id="ref-Hornik2005" role="listitem">Hornik, 커트. 2005.<span>"에이<span>단서</span>~을 위한<span>클루</span>스테르<span>이자형</span>nsemble. '</span> <em>통계 소프트웨어 저널</em>14 (12).</div>
<div class="csl-entry" id="ref-flowsort" role="listitem">Hulett, Henry R, ​​William A Bonner, Janet Barrett 및 Leonard a Herzenberg. 1969.<span>"세포 분류 : 세포 내 형광의 함수로서 포유 동물 세포의 자동 분리."</span> <em>과학</em>166 (3906) : 747–49.</div>
<div class="csl-entry" id="ref-kahneman2011" role="listitem">KAHNEMAN, 다니엘. 2011.<em>생각, 빠르고 느리게</em>. 맥밀란.</div>
<div class="csl-entry" id="ref-Kaufman2009" role="listitem">Kaufman, Leonard 및 Peter J Rousseeuw. 2009 년.<em>데이터에서 그룹 찾기 : 클러스터 분석 소개</em>. vol. 344. John Wiley &amp; Sons.</div>
<div class="csl-entry" id="ref-Kozich2013" role="listitem">Kozich, James J, Sarah L Westcott, Nielson T Baxter, Sarah K Highlander 및 Patrick D Schloss. 2013.<span>"MISEQ Illumina 시퀀싱 플랫폼에서 앰플 리콘 시퀀스 데이터를 분석하기위한 이중 인덱스 시퀀싱 전략 및 큐 레이션 파이프 라인의 개발."</span> <em>적용 및 환경 미생물학</em>79 (17) : 5112–20.</div>
<div class="csl-entry" id="ref-mandal2009" role="listitem">Mandal, Rakesh, Sophie St-Hilaire, John G Kie 및 Dewayne Derryberry. 2009 년.<span>"2000 년에서 2005 년 사이에 미국의 유방 및 전립선 암의 공간 경향."</span> <em>국제 건강 지리학 저널</em>8 (1) : 53.</div>
<div class="csl-entry" id="ref-mclachlan2007algorithm" role="listitem">McLachlan, Geoffrey 및 Thriyambakam Krishnan. 2007.<em>그만큼<span>여자 이름</span>알고리즘 및 확장</em>. vol. 382. John Wiley &amp; Sons.</div>
<div class="csl-entry" id="ref-Mullner:2013" role="listitem">ül너, 다니엘 2013.<span>"FastCluster : R과 Python의 빠른 계층 적, 응집 적 클러스터링 루틴."</span> <em>통계 소프트웨어 저널</em>53 (9) : 1–18.</div>
<div class="csl-entry" id="ref-oneill2013flow" role="listitem">O'Neill, Kieran, Nima Aghaeepour, Josef Špidlen 및 Ryan Brinkman. 2013.<span>"유세포 분석 생물 정보학."</span> <em>PLOS 계산 생물학</em>9 (12) : E1003365.</div>
<div class="csl-entry" id="ref-Ohnishi2014" role="listitem">Ohnishhi, Y., W. Huber, A. Tour, M. Kang, P. Xenopolos, K. Curioto, A. K. Oles 등. 2014.<span>"셀-세포 발현 변동성에 이어 신호 강화가 점차 초기 마우스 계보를 분리합니다."</span> <em>자연 세포 생물학</em>16 (1) : 27–37.</div>
<div class="csl-entry" id="ref-Rosen:2012" role="listitem">Rosen, Michael J, Benjamin J Callahan, Daniel S Fisher 및 Susan P Holmes. 2012.<span>“Denoising<span>PCR</span>-메타 게놈 데이터를 증폭시켰다.”</span> <em>BMC<span>비</span>ioinformatics</em>13 (1) : 283.</div>
<div class="csl-entry" id="ref-mothur" role="listitem">Schloss, P D, S L Westcott, T Ryabin, J R Hall, M Hartmann, E B Hollister, R A Lesniewski 등 2009 년.<span>"<span class="nocase">Mothur 소개 : 미생물 커뮤니티를 설명하고 비교하기위한 오픈 소스, 플랫폼 독립적 인 커뮤니티 지원 소프트웨어</span>.”</span> <em>적용 및 환경 미생물학</em>75 (23) : 7537–41.</div>
<div class="csl-entry" id="ref-schloss2012stabilization" role="listitem">Schloss, P.D., A. M. Schuber, J. P. Zackular, K. D. Iverson, Young V. B. 및 Petrosino J. F. 2012.<span>"이유 후 뮤린 장 미생물 군의 안정화."</span> <em>장내 미생물</em>3 (4) : 383–93.</div>
<div class="csl-entry" id="ref-gap2001" role="listitem">Tibshirani, Robert, Guenther Walther 및 Trevor Hastie. 2001.<span>"갭 통계를 통해 데이터 세트의 클러스터 수를 추정합니다."</span> <em>JRSSB</em>63 (2) : 411–23.</div>
<div class="csl-entry" id="ref-Tseng:2005" role="listitem">Tseng, George C 및 Wing H Wong. 2005.<span>"타이트 클러스터링 : 데이터에서 안정적이고 단단한 패턴을 식별하기위한 리 샘플링 기반 접근법."</span> <em>생체 인식</em>61 (1) : 10–16.</div>
<div class="csl-entry" id="ref-tversky1974heuristics" role="listitem">Tversky, Amos 및 Daniel Kahneman. 1974.<span>"휴리스틱과 편견 : 불확실성에 따른 판단."</span> <em>과학</em>185 : 1124–30.</div>
<div class="csl-entry" id="ref-tversky1975judgment" role="listitem">———. 1975.<span>"불확실한 판단 : 휴리스틱과 편견."</span>~ 안에<em>유용성, 확률 및 인간 의사 결정</em>, 141–62. 뛰는 것.</div>
</div>
</section>
<p>R 버전 4.5.1 (2025-06-13)을 사용하여 2025-09-01에 01:33에 구축 된 페이지</p></main> <!-- /main --><p class="build-date">이 책의 온라인 버전을 유지 관리하는 지원은 다음과 같습니다.<a href="http://www.denbi.de">de.nbi</a>
<img src="imgs/denbi.png" style="vertical-align: text-top;height: 16px"/><br/>웹 사이트 지원은 msmith@embl.de로 문의하십시오<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
  const anchorJS_eq = new window.AnchorJS();
  anchorJS_eq.options = {
    placement: 'left',
    class: 'eq-link',
    icon: icon
  };
  anchorJS_eq.add('.anchored-eq');
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.huber\.embl\.de\/msmb");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</p></div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>
</body></html>
